CREATE DATABASE  IF NOT EXISTS `pangya` /*!40100 DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_bin */ /*!80016 DEFAULT ENCRYPTION='N' */;
USE `pangya`;
-- MySQL dump 10.13  Distrib 8.0.25, for Win64 (x86_64)
--
-- Host: 192.168.15.20    Database: pangya
-- ------------------------------------------------------
-- Server version	8.0.28-0ubuntu0.20.04.3

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!50503 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `account`
--

DROP TABLE IF EXISTS `account`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `account` (
  `ID` varchar(25) NOT NULL,
  `UID` bigint NOT NULL AUTO_INCREMENT,
  `PASSWORD` varchar(33) NOT NULL,
  `IDState` bigint NOT NULL DEFAULT '0',
  `LastLogonTime` datetime DEFAULT NULL,
  `BlockTime` int NOT NULL DEFAULT '0',
  `Logon` smallint NOT NULL DEFAULT '0',
  `FIRST_LOGIN` smallint NOT NULL DEFAULT '0',
  `RegDate` datetime DEFAULT NULL,
  `NICK` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `FIRST_SET` smallint NOT NULL DEFAULT '0',
  `Guild_UID` int NOT NULL DEFAULT '0',
  `Sex` smallint NOT NULL DEFAULT '0',
  `doTutorial` smallint NOT NULL DEFAULT '0',
  `UserName` varchar(23) DEFAULT NULL,
  `UserIp` varchar(20) DEFAULT NULL,
  `ServerID` varchar(20) DEFAULT NULL,
  `game_server_id` varchar(20) DEFAULT NULL,
  `LastLeaveTime` datetime DEFAULT NULL,
  `LogonCount` bigint NOT NULL DEFAULT '0',
  `BlockRegDate` datetime DEFAULT NULL,
  `School` int NOT NULL DEFAULT '0',
  `capability` int NOT NULL DEFAULT '0',
  `Event` smallint NOT NULL DEFAULT '0',
  `MannerFlag` smallint NOT NULL DEFAULT '0',
  `Event1` smallint NOT NULL DEFAULT '0',
  `Event2` int NOT NULL DEFAULT '0',
  `domainid` int NOT NULL DEFAULT '0',
  `ChannelFlag` smallint NOT NULL DEFAULT '0',
  `change_nick` datetime DEFAULT NULL,
  PRIMARY KEY (`UID`),
  UNIQUE KEY `IX_account` (`ID`),
  UNIQUE KEY `IX_account_1` (`UID`)
) ENGINE=MyISAM AUTO_INCREMENT=14641 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `achievement_quest`
--

DROP TABLE IF EXISTS `achievement_quest`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `achievement_quest` (
  `IDX` bigint NOT NULL AUTO_INCREMENT,
  `UID` int NOT NULL DEFAULT '0',
  `ID_ACHIEVEMENT` int NOT NULL DEFAULT '0',
  `TypeID_ACHIEVE` int NOT NULL DEFAULT '0',
  `Count_ID` int NOT NULL DEFAULT '0',
  `Data_Sec` int NOT NULL DEFAULT '0',
  `Objetivo_Quest` int NOT NULL DEFAULT '0',
  PRIMARY KEY (`IDX`)
) ENGINE=MyISAM AUTO_INCREMENT=444811 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `achievement_tipo`
--

DROP TABLE IF EXISTS `achievement_tipo`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `achievement_tipo` (
  `UID` int NOT NULL DEFAULT '0',
  `Nome` varchar(50) DEFAULT NULL,
  `TypeID` int NOT NULL DEFAULT '0',
  `ID_ACHIEVEMENT` int NOT NULL AUTO_INCREMENT,
  `TIPO` smallint NOT NULL DEFAULT '0',
  `Option` int NOT NULL DEFAULT '0',
  PRIMARY KEY (`ID_ACHIEVEMENT`)
) ENGINE=MyISAM AUTO_INCREMENT=58399 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `achievements`
--

DROP TABLE IF EXISTS `achievements`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `achievements` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `typeid` int NOT NULL DEFAULT '0',
  `nome` varchar(100) NOT NULL,
  `tipo` smallint NOT NULL DEFAULT '0',
  `option` smallint NOT NULL DEFAULT '0',
  `quest_typeid` int NOT NULL DEFAULT '0',
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=4609 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `authkey_game`
--

DROP TABLE IF EXISTS `authkey_game`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `authkey_game` (
  `UID` int NOT NULL,
  `AuthKey` varchar(8) DEFAULT NULL,
  `ServerID` int NOT NULL DEFAULT '0',
  `valid` smallint NOT NULL DEFAULT '1'
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `authkey_login`
--

DROP TABLE IF EXISTS `authkey_login`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `authkey_login` (
  `UID` int NOT NULL,
  `AuthKey` varchar(8) NOT NULL,
  `valid` smallint NOT NULL DEFAULT '1'
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `black_papel_item`
--

DROP TABLE IF EXISTS `black_papel_item`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `black_papel_item` (
  `Index` bigint NOT NULL AUTO_INCREMENT,
  `Nome` varchar(32) NOT NULL,
  `Typeid` int NOT NULL,
  `Numero` int NOT NULL DEFAULT '-1',
  `Probabilidade` int NOT NULL,
  `Tipo` int NOT NULL,
  `Flag` smallint NOT NULL,
  `Active` smallint NOT NULL DEFAULT '1',
  PRIMARY KEY (`Index`)
) ENGINE=MyISAM AUTO_INCREMENT=56 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `black_papel_prob_sec`
--

DROP TABLE IF EXISTS `black_papel_prob_sec`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `black_papel_prob_sec` (
  `UID` int NOT NULL,
  `probabilidade` int NOT NULL DEFAULT '0',
  PRIMARY KEY (`UID`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `black_papel_qntd_prob`
--

DROP TABLE IF EXISTS `black_papel_qntd_prob`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `black_papel_qntd_prob` (
  `nome` varchar(50) DEFAULT NULL,
  `probabilidade` int NOT NULL,
  `tipo` int NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `black_papel_rate`
--

DROP TABLE IF EXISTS `black_papel_rate`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `black_papel_rate` (
  `Nome` varchar(50) DEFAULT NULL,
  `Probabilidade` int NOT NULL,
  `tipo` int NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `boxitemrarewin`
--

DROP TABLE IF EXISTS `boxitemrarewin`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `boxitemrarewin` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `UID` int NOT NULL DEFAULT '0',
  `box_typeid` int NOT NULL DEFAULT '0',
  `item_typeid` int NOT NULL DEFAULT '0',
  `REG_DATE` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=11 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `char_equip`
--

DROP TABLE IF EXISTS `char_equip`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `char_equip` (
  `UID` bigint NOT NULL DEFAULT '0',
  `Character` int NOT NULL DEFAULT '0',
  `part1` int NOT NULL DEFAULT '0',
  `part2` int NOT NULL DEFAULT '0',
  `part3` int NOT NULL DEFAULT '0',
  `part4` int NOT NULL DEFAULT '0',
  `part5` int NOT NULL DEFAULT '0',
  `part6` int NOT NULL DEFAULT '0',
  `part7` int NOT NULL DEFAULT '0',
  `part8` int NOT NULL DEFAULT '0',
  `part9` int NOT NULL DEFAULT '0',
  `part10` int NOT NULL DEFAULT '0',
  `part11` int NOT NULL DEFAULT '0',
  `part12` int NOT NULL DEFAULT '0',
  `part13` int NOT NULL DEFAULT '0',
  `part14` int NOT NULL DEFAULT '0',
  `part15` int NOT NULL DEFAULT '0',
  `part16` int NOT NULL DEFAULT '0',
  `part17` int NOT NULL DEFAULT '0',
  `part18` int NOT NULL DEFAULT '0',
  `part19` int NOT NULL DEFAULT '0',
  `part20` int NOT NULL DEFAULT '0',
  `part21` int NOT NULL DEFAULT '0',
  `part22` int NOT NULL DEFAULT '0',
  `part23` int NOT NULL DEFAULT '0',
  `part24` int NOT NULL DEFAULT '0',
  `auxpart1` int NOT NULL DEFAULT '0',
  `auxpart2` int NOT NULL DEFAULT '0',
  `auxpart3` int NOT NULL DEFAULT '0',
  `auxpart4` int NOT NULL DEFAULT '0',
  `auxpart5` int NOT NULL DEFAULT '0',
  `PCL0` smallint NOT NULL DEFAULT '0',
  `PCL1` smallint NOT NULL DEFAULT '0',
  `PCL2` smallint NOT NULL DEFAULT '0',
  `PCL3` smallint NOT NULL DEFAULT '0',
  `PCL4` smallint NOT NULL DEFAULT '0',
  `pucharge` smallint NOT NULL DEFAULT '0',
  `isValid` smallint NOT NULL DEFAULT '1',
  `default_hair` int NOT NULL DEFAULT '0',
  `default_shirts` int NOT NULL,
  PRIMARY KEY (`UID`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `contas_beta`
--

DROP TABLE IF EXISTS `contas_beta`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `contas_beta` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `uid` int NOT NULL DEFAULT '0',
  `nome` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `sobre_nome` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `email` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `key_uniq` varchar(64) NOT NULL,
  `finish_reg` tinyint unsigned NOT NULL DEFAULT '0',
  `ip_register` char(20) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `date_reg` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=10179 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `count_item`
--

DROP TABLE IF EXISTS `count_item`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `count_item` (
  `UID` int NOT NULL DEFAULT '0',
  `Nome` varchar(50) DEFAULT NULL,
  `ID_ACHIEVEMENT` int NOT NULL DEFAULT '0',
  `TypeID` int NOT NULL DEFAULT '0',
  `Count_ID` int NOT NULL AUTO_INCREMENT,
  `Count_Num_Item` bigint NOT NULL DEFAULT '0',
  `Data_Sec` int NOT NULL DEFAULT '0',
  `TIPO` smallint NOT NULL DEFAULT '0',
  PRIMARY KEY (`Count_ID`)
) ENGINE=MyISAM AUTO_INCREMENT=90816 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `counter_items`
--

DROP TABLE IF EXISTS `counter_items`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `counter_items` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `typeid` int NOT NULL DEFAULT '0',
  `nome` varchar(100) NOT NULL,
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=784 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `memorial_shop_coin`
--

DROP TABLE IF EXISTS `memorial_shop_coin`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `memorial_shop_coin` (
  `Name` varchar(50) NOT NULL,
  `TypeID` int NOT NULL,
  `Tipo` smallint NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `memorial_shop_item`
--

DROP TABLE IF EXISTS `memorial_shop_item`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `memorial_shop_item` (
  `Name` varchar(50) NOT NULL,
  `TypeID` int NOT NULL,
  `Gacha_num` int NOT NULL,
  `Quantidade` int NOT NULL DEFAULT '1',
  `Tipo` smallint NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `memorial_shop_rate`
--

DROP TABLE IF EXISTS `memorial_shop_rate`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `memorial_shop_rate` (
  `Nome` varchar(500) DEFAULT NULL,
  `Probabilidade` int NOT NULL,
  `tipo` int NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `memorialshopitemrarewin`
--

DROP TABLE IF EXISTS `memorialshopitemrarewin`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `memorialshopitemrarewin` (
  `UID` int NOT NULL,
  `TYPEID` int NOT NULL,
  `REG_DATE` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_1st_anniversary`
--

DROP TABLE IF EXISTS `pangya_1st_anniversary`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_1st_anniversary` (
  `EVENT_DONE` tinyint unsigned NOT NULL DEFAULT '0',
  `ALL_PLAYER_APT` bigint NOT NULL DEFAULT '0',
  `ALL_PLAYER_WIN` bigint NOT NULL DEFAULT '0',
  `REG_DATE` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`EVENT_DONE`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_1st_anniversary_player_win_cp`
--

DROP TABLE IF EXISTS `pangya_1st_anniversary_player_win_cp`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_1st_anniversary_player_win_cp` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `UID` int NOT NULL,
  `LOGIN_DAYS` int NOT NULL DEFAULT '0',
  `COOKIE_POINT` bigint NOT NULL DEFAULT '0',
  `REG_DATE` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`index`),
  UNIQUE KEY `IX_pangya_1st_aniversary_player_win_cp` (`UID`)
) ENGINE=MyISAM AUTO_INCREMENT=81 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_achievement`
--

DROP TABLE IF EXISTS `pangya_achievement`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_achievement` (
  `ID_ACHIEVEMENT` int NOT NULL AUTO_INCREMENT,
  `UID` int NOT NULL,
  `Nome` varbinary(200) DEFAULT NULL,
  `TypeID` int NOT NULL,
  `active` int NOT NULL DEFAULT '1',
  `status` int NOT NULL DEFAULT '1' COMMENT '1 em agurado, 2 excluido, 3 ativo, 4 concluido',
  PRIMARY KEY (`ID_ACHIEVEMENT`),
  UNIQUE KEY `IX_pangya_achievement` (`ID_ACHIEVEMENT`),
  UNIQUE KEY `IX_pangya_achievement_1` (`ID_ACHIEVEMENT`),
  KEY `IX_pangya_achievement_2` (`UID`)
) ENGINE=MyISAM AUTO_INCREMENT=74072 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_approach_missions`
--

DROP TABLE IF EXISTS `pangya_approach_missions`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_approach_missions` (
  `numero` bigint NOT NULL,
  `tipo` int NOT NULL DEFAULT '1',
  `reward_tipo` int NOT NULL DEFAULT '1',
  `box` int NOT NULL DEFAULT '1',
  `flag` int NOT NULL DEFAULT '0',
  `active` smallint NOT NULL DEFAULT '1',
  PRIMARY KEY (`numero`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_assistente`
--

DROP TABLE IF EXISTS `pangya_assistente`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_assistente` (
  `UID` int NOT NULL DEFAULT '1',
  `Assist` int NOT NULL DEFAULT '0',
  PRIMARY KEY (`UID`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_attendance_reward`
--

DROP TABLE IF EXISTS `pangya_attendance_reward`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_attendance_reward` (
  `UID` int NOT NULL,
  `counter` int NOT NULL DEFAULT '0',
  `item_typeid_now` int NOT NULL DEFAULT '0',
  `item_qntd_now` int NOT NULL DEFAULT '0',
  `item_typeid_after` int NOT NULL DEFAULT '0',
  `item_qntd_after` int NOT NULL DEFAULT '0',
  `last_login` datetime DEFAULT NULL,
  PRIMARY KEY (`UID`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_attendance_table_item_reward`
--

DROP TABLE IF EXISTS `pangya_attendance_table_item_reward`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_attendance_table_item_reward` (
  `idx` int NOT NULL AUTO_INCREMENT,
  `nome` varchar(50) DEFAULT NULL,
  `typeid` int NOT NULL,
  `quantidade` int NOT NULL,
  `tipo` int NOT NULL,
  PRIMARY KEY (`idx`)
) ENGINE=MyISAM AUTO_INCREMENT=21 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_auth_key`
--

DROP TABLE IF EXISTS `pangya_auth_key`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_auth_key` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `Server_UID` int DEFAULT NULL,
  `key` char(16) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `valid` tinyint unsigned DEFAULT '1',
  UNIQUE KEY `IX_pangya.auth_key` (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=9 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_bot_gm_event_reward`
--

DROP TABLE IF EXISTS `pangya_bot_gm_event_reward`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_bot_gm_event_reward` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `typeid` int NOT NULL,
  `qntd` int NOT NULL,
  `qntd_time` int NOT NULL,
  `rate` int NOT NULL,
  `valid` tinyint unsigned NOT NULL DEFAULT '1',
  `reg_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=27 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_bot_gm_event_time`
--

DROP TABLE IF EXISTS `pangya_bot_gm_event_time`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_bot_gm_event_time` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `inicio_time` time(6) NOT NULL,
  `fim_time` time(6) NOT NULL,
  `channel_id` tinyint unsigned NOT NULL,
  `valid` tinyint unsigned NOT NULL DEFAULT '0',
  `reg_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=7 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_box_item`
--

DROP TABLE IF EXISTS `pangya_box_item`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_box_item` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `nome` varchar(50) DEFAULT NULL,
  `typeid` int NOT NULL,
  `tipo` int NOT NULL,
  `flag` smallint NOT NULL,
  `msg` varchar(100) DEFAULT NULL,
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=30 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_box_table_item`
--

DROP TABLE IF EXISTS `pangya_box_table_item`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_box_table_item` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `nome` varchar(50) DEFAULT NULL,
  `numero` int NOT NULL DEFAULT '-1',
  `typeid` int NOT NULL,
  `qntd` int NOT NULL,
  `probabilidade` int NOT NULL,
  `tipo` int NOT NULL,
  `flag` smallint NOT NULL,
  `flag_rare` smallint NOT NULL,
  `Active` smallint NOT NULL DEFAULT '1',
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=948 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_caddie_information`
--

DROP TABLE IF EXISTS `pangya_caddie_information`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_caddie_information` (
  `item_id` bigint NOT NULL AUTO_INCREMENT,
  `UID` int NOT NULL,
  `typeid` int NOT NULL,
  `parts_typeid` int NOT NULL DEFAULT '0',
  `gift_flag` smallint NOT NULL DEFAULT '0',
  `cLevel` smallint NOT NULL DEFAULT '0',
  `Exp` int NOT NULL DEFAULT '0',
  `RegDate` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `Period` smallint NOT NULL DEFAULT '0',
  `EndDate` datetime DEFAULT NULL,
  `RentFlag` smallint NOT NULL DEFAULT '1',
  `Purchase` smallint NOT NULL DEFAULT '0',
  `parts_EndDate` datetime DEFAULT NULL,
  `CheckEnd` smallint NOT NULL DEFAULT '1',
  `Valid` smallint NOT NULL DEFAULT '1',
  PRIMARY KEY (`item_id`),
  UNIQUE KEY `IX_pangya_caddie_information` (`item_id`),
  KEY `IX_pangya_caddie_information_1` (`UID`)
) ENGINE=MyISAM AUTO_INCREMENT=156 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_card`
--

DROP TABLE IF EXISTS `pangya_card`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_card` (
  `card_itemid` bigint NOT NULL AUTO_INCREMENT,
  `UID` int NOT NULL,
  `card_typeid` int NOT NULL,
  `QNTD` int DEFAULT NULL,
  `GET_DT` datetime DEFAULT NULL,
  `USE_DT` datetime DEFAULT NULL,
  `END_DT` datetime DEFAULT NULL,
  `Slot` int NOT NULL DEFAULT '0',
  `Efeito` int NOT NULL DEFAULT '0',
  `Efeito_Qntd` int NOT NULL DEFAULT '0',
  `card_type` smallint NOT NULL DEFAULT '1',
  `USE_YN` char(1) DEFAULT NULL,
  PRIMARY KEY (`card_itemid`)
) ENGINE=MyISAM AUTO_INCREMENT=1857 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_card_equip`
--

DROP TABLE IF EXISTS `pangya_card_equip`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_card_equip` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `UID` int NOT NULL,
  `parts_id` int NOT NULL DEFAULT '0',
  `parts_typeid` int NOT NULL DEFAULT '0',
  `card_typeid` int NOT NULL,
  `Efeito` int NOT NULL DEFAULT '0',
  `Efeito_Qntd` int NOT NULL DEFAULT '0',
  `Slot` int NOT NULL DEFAULT '0',
  `USE_DT` datetime DEFAULT NULL,
  `END_DT` datetime DEFAULT NULL,
  `Tipo` int NOT NULL DEFAULT '0',
  `USE_YN` smallint NOT NULL DEFAULT '1',
  `date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY `IX_pangya_card_equip` (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=403 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_card_rate`
--

DROP TABLE IF EXISTS `pangya_card_rate`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_card_rate` (
  `nome` varchar(50) DEFAULT NULL,
  `tipo` int NOT NULL,
  `probabilidade` int NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_cardpack`
--

DROP TABLE IF EXISTS `pangya_cardpack`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_cardpack` (
  `Nome` varchar(50) DEFAULT NULL,
  `TypeID` int NOT NULL,
  `tipo_pack` int NOT NULL,
  `tipo` int NOT NULL,
  `probabilidade` int NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_cards`
--

DROP TABLE IF EXISTS `pangya_cards`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_cards` (
  `Nome` varchar(50) DEFAULT NULL,
  `TypeID_Pack` int NOT NULL,
  `TypeID_Card` int NOT NULL,
  `Tipo` int NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_change_nickname_log`
--

DROP TABLE IF EXISTS `pangya_change_nickname_log`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_change_nickname_log` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `uid` int NOT NULL DEFAULT '0',
  `nickname` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `change_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY `IX_pangya_change_nickname_log` (`index`),
  UNIQUE KEY `IX_pangya_change_nickname_log_1` (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=20 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_change_pwd_log`
--

DROP TABLE IF EXISTS `pangya_change_pwd_log`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_change_pwd_log` (
  `uid` int NOT NULL,
  `last_change` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `change_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `count` int NOT NULL DEFAULT '1',
  UNIQUE KEY `IX_pangya_change_pwd_log` (`uid`),
  UNIQUE KEY `IX_pangya_change_pwd_log_1` (`uid`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_character_information`
--

DROP TABLE IF EXISTS `pangya_character_information`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_character_information` (
  `item_id` bigint NOT NULL AUTO_INCREMENT,
  `typeid` int NOT NULL,
  `UID` int NOT NULL,
  `parts_1` int NOT NULL DEFAULT '0',
  `parts_2` int NOT NULL DEFAULT '0',
  `parts_3` int NOT NULL DEFAULT '0',
  `parts_4` int NOT NULL DEFAULT '0',
  `parts_5` int NOT NULL DEFAULT '0',
  `parts_6` int NOT NULL DEFAULT '0',
  `parts_7` int NOT NULL DEFAULT '0',
  `parts_8` int NOT NULL DEFAULT '0',
  `parts_9` int NOT NULL DEFAULT '0',
  `parts_10` int NOT NULL DEFAULT '0',
  `parts_11` int NOT NULL DEFAULT '0',
  `parts_12` int NOT NULL DEFAULT '0',
  `parts_13` int NOT NULL DEFAULT '0',
  `parts_14` int NOT NULL DEFAULT '0',
  `parts_15` int NOT NULL DEFAULT '0',
  `parts_16` int NOT NULL DEFAULT '0',
  `parts_17` int NOT NULL DEFAULT '0',
  `parts_18` int NOT NULL DEFAULT '0',
  `parts_19` int NOT NULL DEFAULT '0',
  `parts_20` int NOT NULL DEFAULT '0',
  `parts_21` int NOT NULL DEFAULT '0',
  `parts_22` int NOT NULL DEFAULT '0',
  `parts_23` int NOT NULL DEFAULT '0',
  `parts_24` int NOT NULL DEFAULT '0',
  `default_hair` smallint NOT NULL DEFAULT '0',
  `default_shirts` smallint NOT NULL DEFAULT '0',
  `gift_flag` smallint NOT NULL DEFAULT '0',
  `PCL0` smallint NOT NULL DEFAULT '0',
  `PCL1` smallint NOT NULL DEFAULT '0',
  `PCL2` smallint NOT NULL DEFAULT '0',
  `PCL3` smallint NOT NULL DEFAULT '0',
  `PCL4` smallint NOT NULL DEFAULT '0',
  `Purchase` smallint NOT NULL DEFAULT '0',
  `auxparts_1` int NOT NULL DEFAULT '0',
  `auxparts_2` int NOT NULL DEFAULT '0',
  `auxparts_3` int NOT NULL DEFAULT '0',
  `auxparts_4` int NOT NULL DEFAULT '0',
  `auxparts_5` int NOT NULL DEFAULT '0',
  `CutIn_1` int NOT NULL DEFAULT '0',
  `CutIn_2` int NOT NULL DEFAULT '0',
  `CutIn_3` int NOT NULL DEFAULT '0',
  `CutIn_4` int NOT NULL DEFAULT '0',
  `Mastery` int NOT NULL DEFAULT '0',
  PRIMARY KEY (`item_id`),
  UNIQUE KEY `IX_pangya_character_information` (`item_id`),
  KEY `IX_pangya_character_information_1` (`UID`)
) ENGINE=MyISAM AUTO_INCREMENT=499 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_character_information_antiga`
--

DROP TABLE IF EXISTS `pangya_character_information_antiga`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_character_information_antiga` (
  `item_id` bigint NOT NULL AUTO_INCREMENT,
  `typeid` int NOT NULL,
  `UID` int NOT NULL,
  `parts_1` int NOT NULL,
  `parts_2` int NOT NULL,
  `parts_3` int NOT NULL,
  `parts_4` int NOT NULL,
  `parts_5` int NOT NULL,
  `parts_6` int NOT NULL,
  `parts_7` int NOT NULL,
  `parts_8` int NOT NULL,
  `parts_9` int NOT NULL,
  `parts_10` int NOT NULL,
  `parts_11` int NOT NULL,
  `parts_12` int NOT NULL,
  `parts_13` int NOT NULL,
  `parts_14` int NOT NULL,
  `parts_15` int NOT NULL,
  `parts_16` int NOT NULL,
  `parts_17` int NOT NULL,
  `parts_18` int NOT NULL,
  `parts_19` int NOT NULL,
  `parts_20` int NOT NULL,
  `parts_21` int NOT NULL,
  `parts_22` int NOT NULL,
  `parts_23` int NOT NULL,
  `parts_24` int NOT NULL,
  `default_hair` smallint NOT NULL,
  `default_shirts` smallint NOT NULL,
  `gift_flag` smallint NOT NULL,
  `PCL0` smallint NOT NULL,
  `PCL1` smallint NOT NULL,
  `PCL2` smallint NOT NULL,
  `PCL3` smallint NOT NULL,
  `PCL4` smallint NOT NULL,
  `Purchase` smallint NOT NULL,
  `auxparts_1` int NOT NULL,
  `auxparts_2` int NOT NULL,
  `auxparts_3` int NOT NULL,
  `auxparts_4` int NOT NULL,
  `auxparts_5` int NOT NULL,
  `CutIn` int NOT NULL DEFAULT '0',
  `Mastery` int NOT NULL,
  PRIMARY KEY (`item_id`)
) ENGINE=MyISAM AUTO_INCREMENT=396 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_character_part_padrao`
--

DROP TABLE IF EXISTS `pangya_character_part_padrao`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_character_part_padrao` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `char_typeid` int NOT NULL DEFAULT '0',
  `parts_1` int NOT NULL DEFAULT '0',
  `parts_2` int NOT NULL DEFAULT '0',
  `parts_3` int NOT NULL DEFAULT '0',
  `parts_4` int NOT NULL DEFAULT '0',
  `parts_5` int NOT NULL DEFAULT '0',
  `parts_6` int NOT NULL DEFAULT '0',
  `parts_7` int NOT NULL DEFAULT '0',
  `parts_8` int NOT NULL DEFAULT '0',
  `parts_9` int NOT NULL DEFAULT '0',
  `parts_10` int NOT NULL DEFAULT '0',
  `parts_11` int NOT NULL DEFAULT '0',
  `parts_12` int NOT NULL DEFAULT '0',
  `parts_13` int NOT NULL DEFAULT '0',
  `parts_14` int NOT NULL DEFAULT '0',
  `parts_15` int NOT NULL DEFAULT '0',
  `parts_16` int NOT NULL DEFAULT '0',
  `parts_17` int NOT NULL DEFAULT '0',
  `parts_18` int NOT NULL DEFAULT '0',
  `parts_19` int NOT NULL DEFAULT '0',
  `parts_20` int NOT NULL DEFAULT '0',
  `parts_21` int NOT NULL DEFAULT '0',
  `parts_22` int NOT NULL DEFAULT '0',
  `parts_23` int NOT NULL DEFAULT '0',
  `parts_24` int NOT NULL DEFAULT '0',
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=15 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_clubset_enchant`
--

DROP TABLE IF EXISTS `pangya_clubset_enchant`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_clubset_enchant` (
  `uid` int NOT NULL,
  `item_id` int NOT NULL,
  `pang` bigint NOT NULL DEFAULT '0',
  `c0` smallint NOT NULL DEFAULT '0',
  `c1` smallint NOT NULL DEFAULT '0',
  `c2` smallint NOT NULL DEFAULT '0',
  `c3` smallint NOT NULL DEFAULT '0',
  `c4` smallint NOT NULL DEFAULT '0'
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_coin_cube_info`
--

DROP TABLE IF EXISTS `pangya_coin_cube_info`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_coin_cube_info` (
  `course_id` tinyint unsigned NOT NULL DEFAULT '0',
  `active` tinyint unsigned NOT NULL DEFAULT '1',
  `update_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_coin_cube_location`
--

DROP TABLE IF EXISTS `pangya_coin_cube_location`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_coin_cube_location` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `course` tinyint unsigned NOT NULL DEFAULT '0',
  `hole` tinyint unsigned NOT NULL DEFAULT '0',
  `tipo` tinyint unsigned NOT NULL DEFAULT '0',
  `tipo_location` tinyint unsigned NOT NULL DEFAULT '0',
  `rate` bigint NOT NULL DEFAULT '1',
  `x` double NOT NULL DEFAULT '0',
  `y` double NOT NULL DEFAULT '0',
  `z` double NOT NULL DEFAULT '0',
  `reg_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=1599 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_comet_refill`
--

DROP TABLE IF EXISTS `pangya_comet_refill`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_comet_refill` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `typeid` int NOT NULL,
  `min` smallint NOT NULL,
  `max` smallint NOT NULL,
  UNIQUE KEY `IX_pangya_comet_refill` (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_command`
--

DROP TABLE IF EXISTS `pangya_command`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_command` (
  `idx` bigint NOT NULL AUTO_INCREMENT,
  `command_id` int NOT NULL DEFAULT '0',
  `arg1` int NOT NULL DEFAULT '0',
  `arg2` int NOT NULL DEFAULT '0',
  `arg3` int NOT NULL DEFAULT '0',
  `arg4` int NOT NULL DEFAULT '0',
  `arg5` int NOT NULL DEFAULT '0',
  `target` int NOT NULL DEFAULT '0',
  `regDate` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `reserveDate` datetime DEFAULT NULL,
  `flag` smallint NOT NULL DEFAULT '0',
  `valid` smallint NOT NULL DEFAULT '1',
  PRIMARY KEY (`idx`)
) ENGINE=MyISAM AUTO_INCREMENT=6321 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_config`
--

DROP TABLE IF EXISTS `pangya_config`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_config` (
  `UID` int NOT NULL,
  `GrandZodiacEventTime` smallint NOT NULL DEFAULT '0',
  `ScratchyPorPointRate` smallint NOT NULL DEFAULT '100',
  `PapelShopRareItemRate` smallint NOT NULL DEFAULT '100',
  `PapelShopCookieItemRate` smallint NOT NULL DEFAULT '100',
  `TreasureRate` smallint NOT NULL DEFAULT '100',
  `PangRate` smallint NOT NULL DEFAULT '100',
  `ExpRate` smallint NOT NULL DEFAULT '100',
  `ClubMasteryRate` smallint NOT NULL DEFAULT '100',
  `ChuvaRate` smallint NOT NULL DEFAULT '100',
  `MemorialShopRate` smallint NOT NULL DEFAULT '100',
  `AngelEvent` smallint NOT NULL DEFAULT '0',
  `GrandPrixEvent` smallint NOT NULL DEFAULT '0',
  `GoldenTimeEvent` smallint NOT NULL DEFAULT '0',
  `LoginRewardEvent` smallint NOT NULL DEFAULT '0',
  `BotGMEvent` smallint NOT NULL DEFAULT '0',
  `SmartCalculator` smallint NOT NULL DEFAULT '0',
  UNIQUE KEY `IX_pangya_config` (`UID`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_cookie_point_item_log`
--

DROP TABLE IF EXISTS `pangya_cookie_point_item_log`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_cookie_point_item_log` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `cp_id_log` bigint DEFAULT '0',
  `typeid` int DEFAULT '0',
  `qnty` int DEFAULT '0',
  `price` bigint DEFAULT '0',
  UNIQUE KEY `IX_pangya_cookie_point_item_log` (`index`),
  UNIQUE KEY `IX_pangya_cookie_point_item_log_1` (`index`),
  KEY `IX_pangya_cookie_point_item_log_2` (`cp_id_log`)
) ENGINE=MyISAM AUTO_INCREMENT=606 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_cookie_point_log`
--

DROP TABLE IF EXISTS `pangya_cookie_point_log`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_cookie_point_log` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `uid` int DEFAULT '0',
  `type` tinyint unsigned DEFAULT '0',
  `mail_id` int DEFAULT '-1',
  `cookie` bigint DEFAULT '0',
  `item_qnty` int DEFAULT '0',
  `reg_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY `IX_pangya_cookie_point_log` (`id`),
  UNIQUE KEY `IX_pangya_cookie_point_log_1` (`id`),
  KEY `IX_pangya_cookie_point_log_2` (`uid`)
) ENGINE=MyISAM AUTO_INCREMENT=702 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_counter_item`
--

DROP TABLE IF EXISTS `pangya_counter_item`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_counter_item` (
  `Count_ID` int NOT NULL AUTO_INCREMENT,
  `UID` int NOT NULL,
  `TypeID` int NOT NULL,
  `active` int NOT NULL DEFAULT '1',
  `Count_Num_Item` int NOT NULL DEFAULT '0',
  PRIMARY KEY (`Count_ID`),
  UNIQUE KEY `IX_pangya.counter_item` (`Count_ID`),
  UNIQUE KEY `IX_pangya_counter_item` (`Count_ID`),
  KEY `IX_pangya_counter_item_1` (`UID`)
) ENGINE=MyISAM AUTO_INCREMENT=87175 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_coupon_desconto`
--

DROP TABLE IF EXISTS `pangya_coupon_desconto`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_coupon_desconto` (
  `Nome` varchar(50) NOT NULL,
  `typeid` int NOT NULL,
  `valor` int NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_course_cube_coin_temporada`
--

DROP TABLE IF EXISTS `pangya_course_cube_coin_temporada`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_course_cube_coin_temporada` (
  `index` int NOT NULL AUTO_INCREMENT,
  `course` int NOT NULL DEFAULT '0',
  `active` smallint NOT NULL DEFAULT '1',
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=22 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_course_drop`
--

DROP TABLE IF EXISTS `pangya_course_drop`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_course_drop` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `course` int NOT NULL DEFAULT '0',
  `rate` int NOT NULL DEFAULT '25',
  `active` smallint NOT NULL DEFAULT '1',
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_course_drop_item`
--

DROP TABLE IF EXISTS `pangya_course_drop_item`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_course_drop_item` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `course` int NOT NULL DEFAULT '0',
  `drop_typeid` int NOT NULL DEFAULT '0',
  `active` smallint NOT NULL DEFAULT '1',
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_course_reward_treasure`
--

DROP TABLE IF EXISTS `pangya_course_reward_treasure`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_course_reward_treasure` (
  `COURSE` smallint NOT NULL,
  `PANGREWARD` int NOT NULL,
  PRIMARY KEY (`COURSE`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_cube_coin_location`
--

DROP TABLE IF EXISTS `pangya_cube_coin_location`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_cube_coin_location` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `tipo` int NOT NULL,
  `config2` int NOT NULL,
  `course` smallint NOT NULL,
  `hole` smallint NOT NULL,
  `x` float(24,0) NOT NULL,
  `y` float(24,0) NOT NULL,
  `z` float(24,0) NOT NULL,
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=356 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_daily_quest`
--

DROP TABLE IF EXISTS `pangya_daily_quest`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_daily_quest` (
  `achieve_quest_1` int NOT NULL DEFAULT '0',
  `achieve_quest_2` int NOT NULL DEFAULT '0',
  `achieve_quest_3` int NOT NULL DEFAULT '0',
  `Reg_Date` datetime DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_daily_quest_player`
--

DROP TABLE IF EXISTS `pangya_daily_quest_player`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_daily_quest_player` (
  `uid` bigint NOT NULL,
  `last_quest_accept` datetime DEFAULT CURRENT_TIMESTAMP,
  `today_quest` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`uid`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_dolfini_locker`
--

DROP TABLE IF EXISTS `pangya_dolfini_locker`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_dolfini_locker` (
  `uid` int NOT NULL,
  `senha` varchar(5) DEFAULT NULL,
  `pang` bigint NOT NULL DEFAULT '0',
  `locker` smallint NOT NULL DEFAULT '0',
  PRIMARY KEY (`uid`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_dolfini_locker_item`
--

DROP TABLE IF EXISTS `pangya_dolfini_locker_item`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_dolfini_locker_item` (
  `idx` bigint NOT NULL AUTO_INCREMENT,
  `uid` int NOT NULL,
  `item_id` int NOT NULL,
  `flag` smallint NOT NULL DEFAULT '1',
  PRIMARY KEY (`idx`)
) ENGINE=MyISAM AUTO_INCREMENT=174 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_donation_epin`
--

DROP TABLE IF EXISTS `pangya_donation_epin`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_donation_epin` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `donation_id` bigint NOT NULL,
  `uid` int NOT NULL,
  `epin` varchar(64) NOT NULL,
  `qntd` bigint NOT NULL,
  `retrive_uid` int DEFAULT NULL,
  `valid` tinyint unsigned NOT NULL DEFAULT '1',
  PRIMARY KEY (`index`),
  UNIQUE KEY `IX_pangya_donation_epin` (`epin`),
  UNIQUE KEY `IX_pangya_donation_epin_1` (`donation_id`)
) ENGINE=MyISAM AUTO_INCREMENT=54 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_donation_item_log`
--

DROP TABLE IF EXISTS `pangya_donation_item_log`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_donation_item_log` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `donation_id` bigint NOT NULL DEFAULT '0',
  `item_typeid` int NOT NULL DEFAULT '0',
  `item_qntd` int NOT NULL DEFAULT '0',
  UNIQUE KEY `IX_pangya_donation_item_log` (`index`),
  UNIQUE KEY `IX_pangya_donation_item_log_1` (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=58 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_donation_log`
--

DROP TABLE IF EXISTS `pangya_donation_log`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_donation_log` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `ADM_uid` int NOT NULL DEFAULT '0' COMMENT 'quem registrou a do doação para o usuário',
  `uid` int NOT NULL DEFAULT '0',
  `plataforma` tinyint unsigned NOT NULL DEFAULT '0' COMMENT '0 nenhum, 1 Paypal, 2 PagSeguro',
  `cash` int NOT NULL DEFAULT '0',
  `cookie_point` int NOT NULL DEFAULT '0',
  `email` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `obs` varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `red_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY `IX_pangya_donation_log` (`index`),
  UNIQUE KEY `IX_pangya_donation_log_1` (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=22 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_donation_new`
--

DROP TABLE IF EXISTS `pangya_donation_new`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_donation_new` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `uid` int NOT NULL DEFAULT '-1',
  `plataforma` tinyint unsigned NOT NULL,
  `email` varchar(200) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `date` datetime NOT NULL,
  `update` datetime DEFAULT NULL,
  `code` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `type` tinyint unsigned NOT NULL,
  `status` tinyint unsigned NOT NULL,
  `reference` varchar(200) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `gross_amount` double NOT NULL,
  `net_amount` double NOT NULL,
  `escrow` datetime DEFAULT NULL,
  `epin_id` bigint NOT NULL DEFAULT '-1',
  `reg_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`index`),
  UNIQUE KEY `IX_pangya_donation_new` (`code`)
) ENGINE=MyISAM AUTO_INCREMENT=51 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_friend_list`
--

DROP TABLE IF EXISTS `pangya_friend_list`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_friend_list` (
  `uid` int NOT NULL DEFAULT '0',
  `uid_friend` int NOT NULL DEFAULT '0',
  `apelido` varchar(15) NOT NULL DEFAULT 'Friend',
  `unknown1` int NOT NULL DEFAULT '-1',
  `unknown2` int NOT NULL DEFAULT '0',
  `unknown3` int NOT NULL DEFAULT '-1',
  `unknown4` int NOT NULL DEFAULT '0',
  `unknown5` int NOT NULL DEFAULT '0',
  `unknown6` int NOT NULL DEFAULT '0',
  `flag1` smallint NOT NULL DEFAULT '-1',
  `state_flag` tinyint unsigned NOT NULL DEFAULT '0',
  `flag5` tinyint unsigned NOT NULL DEFAULT '0'
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_gacha`
--

DROP TABLE IF EXISTS `pangya_gacha`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_gacha` (
  `index` int NOT NULL,
  `townno` int NOT NULL DEFAULT '1',
  `charno` int NOT NULL DEFAULT '1',
  `shop` int NOT NULL DEFAULT '1',
  `numero` int NOT NULL DEFAULT '0',
  `coin` int NOT NULL DEFAULT '0',
  `rate` int NOT NULL DEFAULT '100',
  PRIMARY KEY (`index`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_gacha_coin`
--

DROP TABLE IF EXISTS `pangya_gacha_coin`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_gacha_coin` (
  `index` int NOT NULL AUTO_INCREMENT,
  `typeid` int NOT NULL DEFAULT '0',
  `qntd` int NOT NULL DEFAULT '0',
  `preco` int NOT NULL DEFAULT '0',
  `tipo` smallint NOT NULL DEFAULT '0',
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=10 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_gacha_items`
--

DROP TABLE IF EXISTS `pangya_gacha_items`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_gacha_items` (
  `index` int NOT NULL AUTO_INCREMENT,
  `gacha_num` int NOT NULL DEFAULT '0',
  `nome` varchar(50) DEFAULT NULL,
  `typeid` int NOT NULL DEFAULT '0',
  `qntd` int NOT NULL DEFAULT '0',
  `probabilidade` int NOT NULL DEFAULT '0',
  `tipo` smallint NOT NULL DEFAULT '0',
  `premio` smallint NOT NULL DEFAULT '0',
  `secret` smallint NOT NULL DEFAULT '0',
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=43 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_gacha_jp_all_item_list`
--

DROP TABLE IF EXISTS `pangya_gacha_jp_all_item_list`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_gacha_jp_all_item_list` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `typeid` int NOT NULL,
  `name` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `char_type` tinyint unsigned NOT NULL DEFAULT '0',
  `reg_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=74 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_gacha_jp_item_list`
--

DROP TABLE IF EXISTS `pangya_gacha_jp_item_list`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_gacha_jp_item_list` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `active` tinyint unsigned NOT NULL DEFAULT '1',
  `gacha_num` int NOT NULL,
  `typeid_1` int NOT NULL,
  `typeid_2` int DEFAULT NULL,
  `qnty_1` bigint NOT NULL,
  `qnty_2` bigint DEFAULT NULL,
  `rarity_type` tinyint unsigned NOT NULL,
  `reg_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=91 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_gacha_jp_player_win`
--

DROP TABLE IF EXISTS `pangya_gacha_jp_player_win`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_gacha_jp_player_win` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `uid` int NOT NULL,
  `gacha_num` int NOT NULL,
  `typeid` int NOT NULL,
  `qnty` bigint NOT NULL,
  `rarity_type` tinyint unsigned NOT NULL,
  `send_mail` tinyint unsigned NOT NULL,
  `valid` tinyint unsigned NOT NULL,
  `reg_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=2467 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_gacha_jp_rate`
--

DROP TABLE IF EXISTS `pangya_gacha_jp_rate`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_gacha_jp_rate` (
  `gacha_num` int NOT NULL,
  `rate_rare` int NOT NULL DEFAULT '100',
  `rate_normal` int NOT NULL DEFAULT '100'
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_gacha_user_key`
--

DROP TABLE IF EXISTS `pangya_gacha_user_key`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_gacha_user_key` (
  `uid` int NOT NULL,
  `coin_count_entrou` int NOT NULL DEFAULT '0',
  `att_flag` smallint NOT NULL DEFAULT '0',
  `key` varchar(22) NOT NULL,
  `date_key_generation` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`uid`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_gacha_user_won`
--

DROP TABLE IF EXISTS `pangya_gacha_user_won`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_gacha_user_won` (
  `index` int NOT NULL AUTO_INCREMENT,
  `gacha_num` int NOT NULL DEFAULT '0',
  `uid` int NOT NULL DEFAULT '0',
  `item_name` varchar(50) DEFAULT NULL,
  `item_typeid` int NOT NULL DEFAULT '0',
  `get_date` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=21 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_gift_table`
--

DROP TABLE IF EXISTS `pangya_gift_table`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_gift_table` (
  `UID` int NOT NULL,
  `Msg_ID` bigint NOT NULL AUTO_INCREMENT,
  `Flag` smallint NOT NULL DEFAULT '0',
  `fromid` varchar(30) NOT NULL,
  `message` varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `giftdate` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `enddate` datetime DEFAULT NULL,
  `Contador_Vista` int NOT NULL DEFAULT '0',
  `Lida_YN` smallint NOT NULL DEFAULT '0',
  `valid` smallint NOT NULL DEFAULT '1',
  PRIMARY KEY (`Msg_ID`)
) ENGINE=MyISAM AUTO_INCREMENT=10168 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_gm_gift_web_log`
--

DROP TABLE IF EXISTS `pangya_gm_gift_web_log`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_gm_gift_web_log` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `GM_UID` int NOT NULL,
  `PLAYER_UID` int NOT NULL,
  `MSG_ID` int NOT NULL,
  `REG_DATE` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY `IX_pangya_gm_gift_web_log` (`index`),
  UNIQUE KEY `IX_pangya_gm_gift_web_log_1` (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=39 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_golden_time_info`
--

DROP TABLE IF EXISTS `pangya_golden_time_info`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_golden_time_info` (
  `index` int NOT NULL AUTO_INCREMENT,
  `type` tinyint unsigned NOT NULL DEFAULT '0',
  `begin` date NOT NULL,
  `end` date DEFAULT NULL,
  `rate` int NOT NULL DEFAULT '1',
  `is_end` tinyint unsigned NOT NULL DEFAULT '0',
  `reg_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=10 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_golden_time_item`
--

DROP TABLE IF EXISTS `pangya_golden_time_item`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_golden_time_item` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `golden_time_id` bigint NOT NULL,
  `typeid` int NOT NULL,
  `qntd` int NOT NULL,
  `qntd_time` int NOT NULL,
  `rate` int NOT NULL DEFAULT '100',
  `reg_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=34 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_golden_time_round`
--

DROP TABLE IF EXISTS `pangya_golden_time_round`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_golden_time_round` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `golden_time_id` bigint NOT NULL,
  `time` time(6) NOT NULL,
  `reg_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=22 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_grand_zodiac_pontos`
--

DROP TABLE IF EXISTS `pangya_grand_zodiac_pontos`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_grand_zodiac_pontos` (
  `uid` int NOT NULL,
  `pontos` bigint NOT NULL DEFAULT '0',
  PRIMARY KEY (`uid`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_grand_zodiac_times`
--

DROP TABLE IF EXISTS `pangya_grand_zodiac_times`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_grand_zodiac_times` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `inicio_time` time(6) NOT NULL,
  `fim_time` time(6) NOT NULL,
  `type` tinyint unsigned NOT NULL DEFAULT '0',
  `valid` smallint NOT NULL DEFAULT '1',
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=18 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_grandprix_clear`
--

DROP TABLE IF EXISTS `pangya_grandprix_clear`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_grandprix_clear` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `uid` int NOT NULL DEFAULT '0',
  `typeid` int NOT NULL DEFAULT '0',
  `flag` int NOT NULL DEFAULT '0',
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=86 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_grandprix_event_config`
--

DROP TABLE IF EXISTS `pangya_grandprix_event_config`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_grandprix_event_config` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `flag` int NOT NULL DEFAULT '0',
  `Active` smallint NOT NULL DEFAULT '1',
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=5 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_guild`
--

DROP TABLE IF EXISTS `pangya_guild`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_guild` (
  `GUILD_UID` bigint NOT NULL AUTO_INCREMENT,
  `GUILD_ID` varchar(8) NOT NULL DEFAULT '',
  `GUILD_NAME` varchar(50) NOT NULL,
  `GUILD_LEADER` int NOT NULL,
  `GUILD_SUB_MASTER` int NOT NULL DEFAULT '0',
  `GUILD_CONDITION_LEVEL` smallint NOT NULL DEFAULT '0',
  `GUILD_STATE` tinyint unsigned NOT NULL DEFAULT '0',
  `GUILD_FLAG` tinyint unsigned NOT NULL DEFAULT '0',
  `GUILD_PERMITION_JOIN` tinyint unsigned NOT NULL DEFAULT '1',
  `GUILD_PANG` bigint NOT NULL DEFAULT '0',
  `GUILD_POINT` bigint NOT NULL DEFAULT '0',
  `GUILD_WIN` int NOT NULL DEFAULT '0',
  `GUILD_LOSE` int NOT NULL DEFAULT '0',
  `GUILD_DRAW` int NOT NULL DEFAULT '0',
  `GUILD_MARK_IMG` varchar(12) NOT NULL DEFAULT 'guildmark',
  `GUILD_MARK_IMG_IDX` int NOT NULL DEFAULT '0',
  `GUILD_NEW_MARK_IDX` int NOT NULL DEFAULT '0',
  `GUILD_INTRO_IMG` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `GUILD_NOTICE` varchar(110) NOT NULL DEFAULT '',
  `GUILD_INFO` varchar(110) NOT NULL,
  `GUILD_REG_DATE` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `GUILD_ACCEPT_DATE` datetime DEFAULT NULL,
  `GUILD_CLOSURE_DATE` datetime DEFAULT NULL,
  UNIQUE KEY `IX_pangya_guild` (`GUILD_UID`)
) ENGINE=MyISAM AUTO_INCREMENT=21 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_guild_atividade_player`
--

DROP TABLE IF EXISTS `pangya_guild_atividade_player`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_guild_atividade_player` (
  `IDX` bigint NOT NULL AUTO_INCREMENT,
  `UID` int NOT NULL,
  `GUILD_UID` int NOT NULL,
  `FLAG` int NOT NULL,
  `REG_DATE` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY `IX_pangya_guild_atividade_player` (`IDX`)
) ENGINE=MyISAM AUTO_INCREMENT=430 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_guild_bbs`
--

DROP TABLE IF EXISTS `pangya_guild_bbs`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_guild_bbs` (
  `SEQ` bigint NOT NULL AUTO_INCREMENT,
  `OWNER_UID` int NOT NULL,
  `TITLE` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `TEXT` varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `TYPE` tinyint unsigned NOT NULL DEFAULT '0',
  `STATE` tinyint unsigned NOT NULL DEFAULT '1',
  `VIEWS` bigint NOT NULL DEFAULT '0',
  `REG_DATE` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY `IX_pangya_guild_bbs` (`SEQ`),
  UNIQUE KEY `IX_pangya_guild_bbs_1` (`SEQ`),
  KEY `IX_pangya_guild_bbs_2` (`OWNER_UID`)
) ENGINE=MyISAM AUTO_INCREMENT=48 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_guild_bbs_res`
--

DROP TABLE IF EXISTS `pangya_guild_bbs_res`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_guild_bbs_res` (
  `SEQ` bigint NOT NULL AUTO_INCREMENT,
  `BBS_SEQ` bigint NOT NULL,
  `OWNER_UID` int NOT NULL,
  `TEXT` varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `STATE` tinyint unsigned NOT NULL DEFAULT '1',
  `REG_DATE` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY `IX_pangya_guild_bbs_res` (`SEQ`),
  UNIQUE KEY `IX_pangya_guild_bbs_res_1` (`SEQ`),
  KEY `IX_pangya_guild_bbs_res_2` (`BBS_SEQ`),
  KEY `IX_pangya_guild_bbs_res_3` (`OWNER_UID`)
) ENGINE=MyISAM AUTO_INCREMENT=32 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_guild_intro_img_log`
--

DROP TABLE IF EXISTS `pangya_guild_intro_img_log`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_guild_intro_img_log` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `intro_img` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `reg_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY `IX_pangya_guild_intro_img_log` (`index`),
  UNIQUE KEY `IX_pangya_guild_intro_img_log_1` (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=11 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_guild_mark_log`
--

DROP TABLE IF EXISTS `pangya_guild_mark_log`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_guild_mark_log` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `mark_idx` int NOT NULL,
  `reg_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY `IX_pangya.pangya_guild_mark_log` (`index`),
  UNIQUE KEY `IX_pangya.pangya_guild_mark_log_1` (`index`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_guild_match`
--

DROP TABLE IF EXISTS `pangya_guild_match`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_guild_match` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `guild_1_uid` int NOT NULL,
  `guild_2_uid` int NOT NULL,
  `guild_1_point` int NOT NULL,
  `guild_2_point` int NOT NULL,
  `guild_1_pang` int NOT NULL,
  `guild_2_pang` int NOT NULL,
  `reg_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY `IX_pangya_guild_match` (`index`),
  UNIQUE KEY `IX_pangya_guild_match_1` (`index`),
  KEY `IX_pangya_guild_match_2` (`guild_1_uid`),
  KEY `IX_pangya_guild_match_3` (`guild_2_uid`)
) ENGINE=MyISAM AUTO_INCREMENT=10 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_guild_member`
--

DROP TABLE IF EXISTS `pangya_guild_member`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_guild_member` (
  `GUILD_UID` int NOT NULL DEFAULT '0',
  `MEMBER_UID` int NOT NULL DEFAULT '0',
  `MEMBER_MSG` varchar(64) DEFAULT NULL,
  `GUILD_PANG` int NOT NULL DEFAULT '0',
  `GUILD_POINT` int NOT NULL DEFAULT '0',
  `MEMBER_FLAG` int NOT NULL DEFAULT '0',
  `MEMBER_STATE_FLAG` int NOT NULL DEFAULT '3',
  `REG_DATE` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_guild_notice`
--

DROP TABLE IF EXISTS `pangya_guild_notice`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_guild_notice` (
  `SEQ` bigint NOT NULL AUTO_INCREMENT,
  `GUILD_UID` int NOT NULL,
  `OWNER_UID` int NOT NULL,
  `TITLE` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `TEXT` varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `STATE` tinyint unsigned NOT NULL DEFAULT '1',
  `VIEWS` bigint NOT NULL DEFAULT '0',
  `REG_DATE` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY `IX_pangya_guild_notice` (`SEQ`),
  UNIQUE KEY `IX_pangya_guild_notice_1` (`SEQ`),
  KEY `IX_pangya_guild_notice_2` (`GUILD_UID`),
  KEY `IX_pangya_guild_notice_3` (`OWNER_UID`)
) ENGINE=MyISAM AUTO_INCREMENT=60 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_guild_private_bbs`
--

DROP TABLE IF EXISTS `pangya_guild_private_bbs`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_guild_private_bbs` (
  `SEQ` bigint NOT NULL AUTO_INCREMENT,
  `GUILD_UID` int NOT NULL,
  `OWNER_UID` int NOT NULL,
  `TITLE` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `TEXT` varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `VIEWS` bigint NOT NULL DEFAULT '0',
  `STATE` tinyint unsigned NOT NULL DEFAULT '1',
  `REG_DATE` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY `IX_pangya_guild_private_bbs` (`SEQ`),
  UNIQUE KEY `IX_pangya_guild_private_bbs_1` (`SEQ`),
  KEY `IX_pangya_guild_private_bbs_2` (`GUILD_UID`),
  KEY `IX_pangya_guild_private_bbs_3` (`OWNER_UID`)
) ENGINE=MyISAM AUTO_INCREMENT=68 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_guild_private_bbs_res`
--

DROP TABLE IF EXISTS `pangya_guild_private_bbs_res`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_guild_private_bbs_res` (
  `SEQ` bigint NOT NULL AUTO_INCREMENT,
  `GUILD_BBS_SEQ` bigint NOT NULL,
  `OWNER_UID` int NOT NULL,
  `TEXT` varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `STATE` tinyint unsigned NOT NULL DEFAULT '1',
  `REG_DATE` datetime DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY `IX_pangya_guild_private_bbs_res` (`SEQ`),
  UNIQUE KEY `IX_pangya_guild_private_bbs_res_1` (`SEQ`),
  KEY `IX_pangya_guild_private_bbs_res_2` (`GUILD_BBS_SEQ`),
  KEY `IX_pangya_guild_private_bbs_res_3` (`OWNER_UID`)
) ENGINE=MyISAM AUTO_INCREMENT=52 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_guild_ranking`
--

DROP TABLE IF EXISTS `pangya_guild_ranking`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_guild_ranking` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `GUILD_UID` int NOT NULL DEFAULT '0',
  `RANK` int NOT NULL DEFAULT '1',
  `LAST_RANK` int NOT NULL,
  `REG_DATE` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=4 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_guild_update_activity`
--

DROP TABLE IF EXISTS `pangya_guild_update_activity`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_guild_update_activity` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `GUILD_UID` int NOT NULL,
  `OWNER_UPDATE` int NOT NULL,
  `PLAYER_UID` int NOT NULL,
  `TYPE_UPDATE` tinyint unsigned NOT NULL DEFAULT '0',
  `STATE` tinyint unsigned NOT NULL DEFAULT '0',
  `REG_DATE` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`index`),
  KEY `IX_pangya_guild_update_activity` (`OWNER_UPDATE`)
) ENGINE=MyISAM AUTO_INCREMENT=58 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_gz_event_2016121600_rare_win`
--

DROP TABLE IF EXISTS `pangya_gz_event_2016121600_rare_win`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_gz_event_2016121600_rare_win` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `uid` int NOT NULL DEFAULT '0',
  `item_typeid` int DEFAULT '0',
  `win_date` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=58 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_ip_table`
--

DROP TABLE IF EXISTS `pangya_ip_table`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_ip_table` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `ip` varchar(40) NOT NULL,
  `mask` varchar(18) NOT NULL DEFAULT '255.255.255.255',
  `date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=4 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_item_buff`
--

DROP TABLE IF EXISTS `pangya_item_buff`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_item_buff` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `uid` int NOT NULL,
  `typeid` int NOT NULL,
  `reg_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `end_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `tipo` smallint NOT NULL DEFAULT '2',
  `percent` int NOT NULL DEFAULT '0',
  `use_yn` tinyint unsigned NOT NULL DEFAULT '1',
  UNIQUE KEY `IX_pangya_item_buff` (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=22 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_item_mail`
--

DROP TABLE IF EXISTS `pangya_item_mail`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_item_mail` (
  `Msg_ID` int NOT NULL,
  `item_id` int NOT NULL DEFAULT '-1',
  `item_typeid` int NOT NULL,
  `Flag` smallint NOT NULL DEFAULT '0',
  `GET_DATE` datetime DEFAULT CURRENT_TIMESTAMP,
  `Quantidade_item` int NOT NULL DEFAULT '0',
  `Quantidade_Dia` int NOT NULL DEFAULT '0',
  `Pang` bigint NOT NULL DEFAULT '0',
  `Cookie` bigint NOT NULL DEFAULT '0',
  `GM_ID` int NOT NULL DEFAULT '-1',
  `Flag_Gift` int NOT NULL DEFAULT '0',
  `UCC_IMG_MARK` varchar(12) NOT NULL,
  `Type` smallint NOT NULL DEFAULT '0',
  `valid` smallint NOT NULL DEFAULT '1'
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_item_typelist`
--

DROP TABLE IF EXISTS `pangya_item_typelist`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_item_typelist` (
  `TYPEID` int NOT NULL,
  `NAME` varchar(100) DEFAULT NULL,
  `ICON` varchar(50) DEFAULT NULL,
  `PRICE` int DEFAULT NULL,
  `ISCASH` smallint NOT NULL,
  `TYPE` int DEFAULT NULL,
  `COM0` int DEFAULT NULL,
  `COM1` int DEFAULT NULL,
  `COM2` int DEFAULT NULL,
  `COM3` int DEFAULT NULL,
  `COM4` int DEFAULT NULL,
  `CHAR_SERIALNO` varchar(10) DEFAULT NULL,
  `DESC` varchar(1000) DEFAULT NULL,
  `TNAME` varchar(50) DEFAULT NULL,
  `IS_SALABLE` smallint DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_item_warehouse`
--

DROP TABLE IF EXISTS `pangya_item_warehouse`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_item_warehouse` (
  `item_id` bigint NOT NULL AUTO_INCREMENT,
  `UID` int NOT NULL,
  `typeid` int NOT NULL,
  `valid` smallint NOT NULL DEFAULT '1',
  `regdate` datetime DEFAULT NULL,
  `Gift_flag` smallint NOT NULL DEFAULT '0',
  `flag` smallint NOT NULL DEFAULT '0',
  `Applytime` datetime DEFAULT CURRENT_TIMESTAMP,
  `EndDate` datetime DEFAULT CURRENT_TIMESTAMP,
  `C0` smallint NOT NULL DEFAULT '0',
  `C1` smallint NOT NULL DEFAULT '0',
  `C2` smallint NOT NULL DEFAULT '0',
  `C3` smallint NOT NULL DEFAULT '0',
  `C4` smallint NOT NULL DEFAULT '0',
  `Purchase` smallint NOT NULL DEFAULT '0',
  `ItemType` smallint NOT NULL DEFAULT '2',
  `ClubSet_WorkShop_Flag` smallint NOT NULL DEFAULT '0',
  `ClubSet_WorkShop_C0` smallint NOT NULL DEFAULT '0',
  `ClubSet_WorkShop_C1` smallint NOT NULL DEFAULT '0',
  `ClubSet_WorkShop_C2` smallint NOT NULL DEFAULT '0',
  `ClubSet_WorkShop_C3` smallint NOT NULL DEFAULT '0',
  `ClubSet_WorkShop_C4` smallint NOT NULL DEFAULT '0',
  `Mastery_Pts` int NOT NULL DEFAULT '0',
  `Recovery_Pts` int NOT NULL DEFAULT '0',
  `Level` int NOT NULL DEFAULT '0',
  `Up` int NOT NULL DEFAULT '0',
  `Total_Mastery_Pts` bigint NOT NULL DEFAULT '0',
  `Mastery_Gasto` int NOT NULL DEFAULT '0',
  PRIMARY KEY (`item_id`),
  UNIQUE KEY `IX_pangya_item_warehouse` (`item_id`),
  KEY `IX_pangya_item_warehouse_1` (`UID`)
) ENGINE=MyISAM AUTO_INCREMENT=11532 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_last_players_user`
--

DROP TABLE IF EXISTS `pangya_last_players_user`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_last_players_user` (
  `UID` int NOT NULL,
  `SEX_0` int DEFAULT NULL,
  `ID_0` varchar(22) DEFAULT NULL,
  `NICK_0` varchar(22) DEFAULT NULL,
  `UID_0` int DEFAULT NULL,
  `SEX_1` int DEFAULT NULL,
  `ID_1` varchar(22) DEFAULT NULL,
  `NICK_1` varchar(22) DEFAULT NULL,
  `UID_1` int DEFAULT NULL,
  `SEX_2` int DEFAULT NULL,
  `ID_2` varchar(22) DEFAULT NULL,
  `NICK_2` varchar(22) DEFAULT NULL,
  `UID_2` int DEFAULT NULL,
  `SEX_3` int DEFAULT NULL,
  `ID_3` varchar(22) DEFAULT NULL,
  `NICK_3` varchar(22) DEFAULT NULL,
  `UID_3` int DEFAULT NULL,
  `SEX_4` int DEFAULT NULL,
  `ID_4` varchar(22) DEFAULT NULL,
  `NICK_4` varchar(22) DEFAULT NULL,
  `UID_4` int DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_last_up_clubset`
--

DROP TABLE IF EXISTS `pangya_last_up_clubset`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_last_up_clubset` (
  `item_id` int NOT NULL,
  `UID` int NOT NULL,
  `State` smallint NOT NULL,
  `item_usado` int NOT NULL,
  `Quantidade` int NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_login_reward`
--

DROP TABLE IF EXISTS `pangya_login_reward`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_login_reward` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `name` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `type` tinyint unsigned NOT NULL DEFAULT '0',
  `days_to_gift` int NOT NULL DEFAULT '1',
  `n_times_gift` int NOT NULL DEFAULT '0',
  `item_typeid` int NOT NULL,
  `item_qntd` int NOT NULL,
  `item_qntd_time` int NOT NULL,
  `is_end` tinyint unsigned NOT NULL DEFAULT '0',
  `end_date` datetime DEFAULT NULL,
  `reg_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=12 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_login_reward_player`
--

DROP TABLE IF EXISTS `pangya_login_reward_player`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_login_reward_player` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `login_reward_id` bigint NOT NULL,
  `uid` int NOT NULL,
  `count_days` int NOT NULL DEFAULT '1',
  `count_seq` int NOT NULL DEFAULT '0',
  `is_clear` tinyint unsigned NOT NULL DEFAULT '0',
  `update_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `reg_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=187 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_lucia_attendance`
--

DROP TABLE IF EXISTS `pangya_lucia_attendance`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_lucia_attendance` (
  `UID` int NOT NULL,
  `count_day` bigint NOT NULL DEFAULT '0',
  `last_day_attendance` datetime DEFAULT NULL,
  `last_day_get_item` datetime DEFAULT NULL,
  `try_hacking_count` int NOT NULL DEFAULT '0',
  `block_type` tinyint unsigned NOT NULL DEFAULT '0',
  `block_end_date` datetime DEFAULT NULL,
  PRIMARY KEY (`UID`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_lucia_attendance_reward_log`
--

DROP TABLE IF EXISTS `pangya_lucia_attendance_reward_log`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_lucia_attendance_reward_log` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `UID` int NOT NULL,
  `MSG_ID` int NOT NULL,
  `ERROR` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `REG_DATE` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=133 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_mac_table`
--

DROP TABLE IF EXISTS `pangya_mac_table`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_mac_table` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `mac` varchar(20) NOT NULL,
  `date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY `IX_pangya_mac_table` (`index`),
  UNIQUE KEY `IX_pangya_mac_table_1` (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_mascot_info`
--

DROP TABLE IF EXISTS `pangya_mascot_info`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_mascot_info` (
  `item_id` bigint NOT NULL AUTO_INCREMENT,
  `UID` int NOT NULL,
  `typeid` int NOT NULL,
  `mLevel` smallint NOT NULL DEFAULT '0',
  `mExp` int NOT NULL DEFAULT '0',
  `Flag` smallint NOT NULL DEFAULT '0',
  `Tipo` smallint NOT NULL DEFAULT '0',
  `RegDate` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `Period` smallint NOT NULL DEFAULT '0',
  `EndDate` datetime DEFAULT NULL,
  `Message` varchar(30) NOT NULL DEFAULT 'PangYa SuperSS',
  `IsCash` smallint NOT NULL DEFAULT '0',
  `Price` int NOT NULL DEFAULT '0',
  `Valid` smallint NOT NULL DEFAULT '1',
  PRIMARY KEY (`item_id`),
  UNIQUE KEY `IX_pangya_mascot_info` (`item_id`),
  KEY `IX_pangya_mascot_info_1` (`UID`)
) ENGINE=MyISAM AUTO_INCREMENT=186 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_memorial_shop_coin_item`
--

DROP TABLE IF EXISTS `pangya_memorial_shop_coin_item`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_memorial_shop_coin_item` (
  `typeid` int NOT NULL,
  `tipo` int NOT NULL,
  `valor_1` int NOT NULL,
  `valor_2` int NOT NULL,
  `character_type` int NOT NULL,
  `outro_item` int NOT NULL,
  `tipo_item` int NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_memorial_shop_level`
--

DROP TABLE IF EXISTS `pangya_memorial_shop_level`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_memorial_shop_level` (
  `level` int NOT NULL,
  `gacha_inicio` int NOT NULL,
  `gacha_fim` int NOT NULL,
  PRIMARY KEY (`level`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_memorial_shop_luckyset`
--

DROP TABLE IF EXISTS `pangya_memorial_shop_luckyset`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_memorial_shop_luckyset` (
  `nome` varchar(50) DEFAULT NULL,
  `id` int NOT NULL,
  `typeid` int NOT NULL,
  `qntd` int NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_memorial_shop_normal_item`
--

DROP TABLE IF EXISTS `pangya_memorial_shop_normal_item`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_memorial_shop_normal_item` (
  `nome` varchar(50) DEFAULT NULL,
  `typeid` int NOT NULL,
  `qntd` int NOT NULL,
  `probabilidade` int NOT NULL,
  `tipo` int NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_memorial_shop_rare_item`
--

DROP TABLE IF EXISTS `pangya_memorial_shop_rare_item`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_memorial_shop_rare_item` (
  `gacha_num` int NOT NULL,
  `typeid` int NOT NULL,
  `probabilidade` int NOT NULL,
  `tipo` int NOT NULL,
  `tipo_item` int NOT NULL,
  `sexo` int NOT NULL,
  `valor_1` int NOT NULL,
  `outro_item` int NOT NULL,
  `character_type` int NOT NULL,
  `flag` smallint NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_memorial_shop_rate`
--

DROP TABLE IF EXISTS `pangya_memorial_shop_rate`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_memorial_shop_rate` (
  `nome` varchar(50) DEFAULT NULL,
  `probabilidade` int NOT NULL,
  `tipo` int NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_msg_user`
--

DROP TABLE IF EXISTS `pangya_msg_user`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_msg_user` (
  `msg_idx` bigint NOT NULL AUTO_INCREMENT,
  `uid` int NOT NULL DEFAULT '0',
  `uid_from` int NOT NULL DEFAULT '0',
  `valid` smallint NOT NULL DEFAULT '1',
  `msg` varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT 'hello',
  `reg_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`msg_idx`)
) ENGINE=MyISAM AUTO_INCREMENT=55 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_myroom`
--

DROP TABLE IF EXISTS `pangya_myroom`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_myroom` (
  `uid` int NOT NULL,
  `senha` varchar(15) DEFAULT NULL,
  `public_lock` smallint NOT NULL DEFAULT '0',
  `state` smallint NOT NULL DEFAULT '1',
  PRIMARY KEY (`uid`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_new_box`
--

DROP TABLE IF EXISTS `pangya_new_box`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_new_box` (
  `id` int NOT NULL AUTO_INCREMENT,
  `nome` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `typeid` int NOT NULL,
  `opened_typeid` int NOT NULL DEFAULT '0',
  `numero` int NOT NULL DEFAULT '1',
  `tipo_open` tinyint unsigned NOT NULL DEFAULT '0' COMMENT '0 SEND ITEM TO MAIL, 1 SEND ITEM TO MY ROOM',
  `tipo` tinyint unsigned NOT NULL DEFAULT '0' COMMENT '0 SEND ITEM TO MAIL, 1 SEND ITEM TO MY ROOM',
  `message` varchar(80) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT 'OUUUU VOCÊ GANHOU UM ITEM<SUPERSS>',
  `active` tinyint unsigned NOT NULL DEFAULT '1',
  UNIQUE KEY `IX_pangya_new_box` (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=50 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_new_box_item`
--

DROP TABLE IF EXISTS `pangya_new_box_item`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_new_box_item` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `box_id` int NOT NULL,
  `nome` char(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `typeid` int NOT NULL,
  `numero` int NOT NULL DEFAULT '-1',
  `probabilidade` int NOT NULL DEFAULT '100',
  `qntd` int NOT NULL DEFAULT '1',
  `raridade` tinyint unsigned NOT NULL DEFAULT '0' COMMENT '0 NORMAL, 1 RARE, 2 SUPER RARE',
  `duplicar` tinyint unsigned NOT NULL DEFAULT '0',
  `active` tinyint unsigned NOT NULL DEFAULT '1',
  UNIQUE KEY `IX_pangya_new_box_item` (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=1481 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_new_box_rare_win_log`
--

DROP TABLE IF EXISTS `pangya_new_box_rare_win_log`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_new_box_rare_win_log` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `uid` int NOT NULL,
  `box_typeid` int NOT NULL,
  `item_typeid` int NOT NULL,
  `qntd` int NOT NULL,
  `raridade` tinyint unsigned NOT NULL,
  `win_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY `IX_pangya_new_box_rare_win_log` (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=267 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_new_card_pack`
--

DROP TABLE IF EXISTS `pangya_new_card_pack`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_new_card_pack` (
  `index` int NOT NULL AUTO_INCREMENT,
  `name` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `typeid` int NOT NULL,
  `quantidade` smallint NOT NULL DEFAULT '1',
  `tipo` smallint NOT NULL,
  `rate_N` smallint NOT NULL DEFAULT '100',
  `rate_R` smallint NOT NULL DEFAULT '100',
  `rate_SR` smallint NOT NULL DEFAULT '100',
  `rate_SC` smallint NOT NULL DEFAULT '100',
  UNIQUE KEY `IX_pangya_new_card_pack` (`index`),
  KEY `IX_pangya_new_card_pack_1` (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=85 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_new_cards`
--

DROP TABLE IF EXISTS `pangya_new_cards`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_new_cards` (
  `index` int NOT NULL AUTO_INCREMENT,
  `name` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `typeid` int NOT NULL,
  `probabilidade` int NOT NULL,
  `tipo` tinyint unsigned NOT NULL,
  `pack` smallint NOT NULL,
  UNIQUE KEY `IX_pangya_new_cards` (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=2177 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_new_course_drop`
--

DROP TABLE IF EXISTS `pangya_new_course_drop`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_new_course_drop` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `rate_mana_artefact` int NOT NULL DEFAULT '100',
  `rate_grand_prix_ticket` int NOT NULL DEFAULT '100',
  `rate_SSC_ticket` int NOT NULL DEFAULT '100',
  UNIQUE KEY `IX_pangya_new_course_drop_1` (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_new_course_drop_item`
--

DROP TABLE IF EXISTS `pangya_new_course_drop_item`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_new_course_drop_item` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `course` tinyint unsigned NOT NULL,
  `tipo` tinyint unsigned NOT NULL DEFAULT '0',
  `typeid` int NOT NULL,
  `quantidade` int NOT NULL DEFAULT '1',
  `probabilidade_3H` int NOT NULL DEFAULT '0',
  `probabilidade_6H` int NOT NULL DEFAULT '0',
  `probabilidade_9H` int NOT NULL DEFAULT '0',
  `probabilidade_18H` int NOT NULL DEFAULT '0',
  `active` tinyint unsigned NOT NULL DEFAULT '1',
  UNIQUE KEY `IX_pangya_new_course_drop` (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=46 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_new_memorial_level`
--

DROP TABLE IF EXISTS `pangya_new_memorial_level`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_new_memorial_level` (
  `level` int NOT NULL,
  `gacha_start` int NOT NULL,
  `gacha_end` int NOT NULL,
  UNIQUE KEY `IX_pangya_new_memorial_level` (`level`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_new_memorial_lucky_set`
--

DROP TABLE IF EXISTS `pangya_new_memorial_lucky_set`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_new_memorial_lucky_set` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `set_id` int NOT NULL,
  `nome` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `typeid` int NOT NULL,
  `qntd` int NOT NULL,
  UNIQUE KEY `IX_pangya_new_memorial_lucky_set` (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=36 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_new_memorial_normal_item`
--

DROP TABLE IF EXISTS `pangya_new_memorial_normal_item`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_new_memorial_normal_item` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `nome` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `typeid` int NOT NULL,
  `qntd` int NOT NULL,
  `tipo` tinyint unsigned NOT NULL DEFAULT '0',
  `active` tinyint unsigned NOT NULL DEFAULT '1',
  UNIQUE KEY `IX_pangya_new_memorial_normal_item` (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=15 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_new_memorial_rare_win_log`
--

DROP TABLE IF EXISTS `pangya_new_memorial_rare_win_log`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_new_memorial_rare_win_log` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `uid` int NOT NULL,
  `coin_typeid` int NOT NULL,
  `item_typeid` int NOT NULL,
  `item_qntd` int NOT NULL,
  `item_raridade` int NOT NULL,
  `item_probabilidade` int NOT NULL,
  `win_date` datetime DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY `IX_pangya_new_memorial_rare_win_log` (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=120 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_notice_list`
--

DROP TABLE IF EXISTS `pangya_notice_list`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_notice_list` (
  `notice_id` bigint NOT NULL AUTO_INCREMENT,
  `message` varchar(1024) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `replayCount` int NOT NULL DEFAULT '1',
  `refreshTime` int NOT NULL DEFAULT '0',
  PRIMARY KEY (`notice_id`)
) ENGINE=MyISAM AUTO_INCREMENT=279 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_papel_shop_config`
--

DROP TABLE IF EXISTS `pangya_papel_shop_config`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_papel_shop_config` (
  `Numero` int NOT NULL DEFAULT '1',
  `Price_Normal` bigint NOT NULL DEFAULT '900',
  `Price_Big` bigint NOT NULL DEFAULT '10000',
  `Limitted_YN` tinyint unsigned NOT NULL DEFAULT '1',
  `Update_Date` datetime DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_papel_shop_coupon`
--

DROP TABLE IF EXISTS `pangya_papel_shop_coupon`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_papel_shop_coupon` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `typeid` int NOT NULL,
  `active` tinyint unsigned NOT NULL DEFAULT '1',
  UNIQUE KEY `IX_pangya_papel_shop_coupon` (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=4 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_papel_shop_info`
--

DROP TABLE IF EXISTS `pangya_papel_shop_info`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_papel_shop_info` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `uid` int NOT NULL,
  `current_cnt` smallint NOT NULL DEFAULT '0',
  `remain_cnt` smallint NOT NULL DEFAULT '0',
  `limit_cnt` smallint NOT NULL DEFAULT '50',
  `last_update` datetime DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY `IX_pangya_papel_shop_info` (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=10410 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_papel_shop_item`
--

DROP TABLE IF EXISTS `pangya_papel_shop_item`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_papel_shop_item` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `Nome` varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `typeid` int NOT NULL,
  `probabilidade` int NOT NULL,
  `numero` int NOT NULL DEFAULT '-1',
  `tipo` tinyint unsigned NOT NULL,
  `active` tinyint unsigned NOT NULL DEFAULT '1',
  UNIQUE KEY `IX_pangya_papel_shop_item` (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=392 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_papel_shop_rare_win_log`
--

DROP TABLE IF EXISTS `pangya_papel_shop_rare_win_log`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_papel_shop_rare_win_log` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `uid` int NOT NULL,
  `typeid` int NOT NULL,
  `qntd` int NOT NULL,
  `ball_color` tinyint unsigned NOT NULL,
  `probabilidade` int NOT NULL,
  `reg_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY `IX_pangya_papel_shop_rare_win` (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=170 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_parts_list`
--

DROP TABLE IF EXISTS `pangya_parts_list`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_parts_list` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `typeid` int NOT NULL DEFAULT '0',
  `tipo` int NOT NULL DEFAULT '0',
  `equip_flag` int NOT NULL DEFAULT '0',
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=7326 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_personal_shop_log`
--

DROP TABLE IF EXISTS `pangya_personal_shop_log`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_personal_shop_log` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `player_sell_uid` int NOT NULL,
  `player_buy_uid` int NOT NULL,
  `item_typeid` int NOT NULL,
  `item_id_sell` int NOT NULL,
  `item_id_buy` int NOT NULL,
  `item_qntd` int NOT NULL,
  `item_pang` bigint NOT NULL,
  `total_pang` bigint NOT NULL,
  `reg_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY `IX_pangya_personal_shop_log` (`index`),
  UNIQUE KEY `IX_pangya_personal_shop_log_1` (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=79 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_player_ip`
--

DROP TABLE IF EXISTS `pangya_player_ip`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_player_ip` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `uid` int NOT NULL DEFAULT '0',
  `ip` varchar(18) NOT NULL DEFAULT '000.000.000.000',
  `block_beta` tinyint unsigned NOT NULL DEFAULT '1',
  `flag_day` smallint NOT NULL DEFAULT '1',
  `change_count` int NOT NULL DEFAULT '0',
  `change_date` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=10159 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_player_location`
--

DROP TABLE IF EXISTS `pangya_player_location`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_player_location` (
  `UID` int NOT NULL,
  `channel` smallint NOT NULL DEFAULT '-1',
  `lobby` smallint NOT NULL DEFAULT '-1',
  `room` smallint NOT NULL DEFAULT '-1',
  `place` smallint NOT NULL DEFAULT '0',
  UNIQUE KEY `IX_pangya_player_location` (`UID`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_quest`
--

DROP TABLE IF EXISTS `pangya_quest`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_quest` (
  `id` int NOT NULL AUTO_INCREMENT,
  `achievement_id` int NOT NULL,
  `uid` int NOT NULL,
  `name` varbinary(200) DEFAULT NULL,
  `typeid` int NOT NULL,
  `counter_item_id` int NOT NULL DEFAULT '0',
  `Date` datetime DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `IX_pangya_quest_1` (`id`),
  UNIQUE KEY `IX_pangya_quest_2` (`id`),
  KEY `IX_pangya_quest` (`achievement_id`),
  KEY `IX_pangya_quest_3` (`uid`)
) ENGINE=MyISAM AUTO_INCREMENT=543100 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_quest_clear`
--

DROP TABLE IF EXISTS `pangya_quest_clear`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_quest_clear` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `uid` int NOT NULL DEFAULT '0',
  `quest_id` int NOT NULL DEFAULT '0',
  `option` smallint NOT NULL DEFAULT '1',
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=55029 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_rank_antes`
--

DROP TABLE IF EXISTS `pangya_rank_antes`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_rank_antes` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `position` int NOT NULL DEFAULT '0',
  `UID` int NOT NULL DEFAULT '0',
  `tipo_rank` smallint NOT NULL DEFAULT '0',
  `tipo_rank_seq` smallint NOT NULL DEFAULT '0',
  `valor` int NOT NULL DEFAULT '0',
  `reg_date` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=2896 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_rank_atual`
--

DROP TABLE IF EXISTS `pangya_rank_atual`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_rank_atual` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `position` int NOT NULL DEFAULT '0',
  `UID` int NOT NULL DEFAULT '0',
  `tipo_rank` smallint NOT NULL DEFAULT '0',
  `tipo_rank_seq` smallint NOT NULL DEFAULT '0',
  `valor` int NOT NULL DEFAULT '0',
  `reg_date` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=2905 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_rank_atual_character`
--

DROP TABLE IF EXISTS `pangya_rank_atual_character`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_rank_atual_character` (
  `uid` int NOT NULL,
  `item_id` int NOT NULL DEFAULT '0',
  `typeid` int NOT NULL DEFAULT '0',
  `itemid_parts_1` int NOT NULL DEFAULT '0',
  `itemid_parts_2` int NOT NULL DEFAULT '0',
  `itemid_parts_3` int NOT NULL DEFAULT '0',
  `itemid_parts_4` int NOT NULL DEFAULT '0',
  `itemid_parts_5` int NOT NULL DEFAULT '0',
  `itemid_parts_6` int NOT NULL DEFAULT '0',
  `itemid_parts_7` int NOT NULL DEFAULT '0',
  `itemid_parts_8` int NOT NULL DEFAULT '0',
  `itemid_parts_9` int NOT NULL DEFAULT '0',
  `itemid_parts_10` int NOT NULL DEFAULT '0',
  `itemid_parts_11` int NOT NULL DEFAULT '0',
  `itemid_parts_12` int NOT NULL DEFAULT '0',
  `itemid_parts_13` int NOT NULL DEFAULT '0',
  `itemid_parts_14` int NOT NULL DEFAULT '0',
  `itemid_parts_15` int NOT NULL DEFAULT '0',
  `itemid_parts_16` int NOT NULL DEFAULT '0',
  `itemid_parts_17` int NOT NULL DEFAULT '0',
  `itemid_parts_18` int NOT NULL DEFAULT '0',
  `itemid_parts_19` int NOT NULL DEFAULT '0',
  `itemid_parts_20` int NOT NULL DEFAULT '0',
  `itemid_parts_21` int NOT NULL DEFAULT '0',
  `itemid_parts_22` int NOT NULL DEFAULT '0',
  `itemid_parts_23` int NOT NULL DEFAULT '0',
  `itemid_parts_24` int NOT NULL DEFAULT '0',
  `parts_1` int NOT NULL DEFAULT '0',
  `parts_2` int NOT NULL DEFAULT '0',
  `parts_3` int NOT NULL DEFAULT '0',
  `parts_4` int NOT NULL DEFAULT '0',
  `parts_5` int NOT NULL DEFAULT '0',
  `parts_6` int NOT NULL DEFAULT '0',
  `parts_7` int NOT NULL DEFAULT '0',
  `parts_8` int NOT NULL DEFAULT '0',
  `parts_9` int NOT NULL DEFAULT '0',
  `parts_10` int NOT NULL DEFAULT '0',
  `parts_11` int NOT NULL DEFAULT '0',
  `parts_12` int NOT NULL DEFAULT '0',
  `parts_13` int NOT NULL DEFAULT '0',
  `parts_14` int NOT NULL DEFAULT '0',
  `parts_15` int NOT NULL DEFAULT '0',
  `parts_16` int NOT NULL DEFAULT '0',
  `parts_17` int NOT NULL DEFAULT '0',
  `parts_18` int NOT NULL DEFAULT '0',
  `parts_19` int NOT NULL DEFAULT '0',
  `parts_20` int NOT NULL DEFAULT '0',
  `parts_21` int NOT NULL DEFAULT '0',
  `parts_22` int NOT NULL DEFAULT '0',
  `parts_23` int NOT NULL DEFAULT '0',
  `parts_24` int NOT NULL DEFAULT '0',
  `default_hair` smallint NOT NULL DEFAULT '0',
  `default_shirts` smallint NOT NULL DEFAULT '0',
  `gift_flag` smallint NOT NULL DEFAULT '0',
  `PCL0` smallint NOT NULL DEFAULT '0',
  `PCL1` smallint NOT NULL DEFAULT '0',
  `PCL2` smallint NOT NULL DEFAULT '0',
  `PCL3` smallint NOT NULL DEFAULT '0',
  `PCL4` smallint NOT NULL DEFAULT '0',
  `purchase` smallint NOT NULL DEFAULT '0',
  `AUXPARTS_1` int NOT NULL DEFAULT '0',
  `AUXPARTS_2` int NOT NULL DEFAULT '0',
  `AUXPARTS_3` int NOT NULL DEFAULT '0',
  `AUXPARTS_4` int NOT NULL DEFAULT '0',
  `AUXPARTS_5` int NOT NULL DEFAULT '0',
  `CutIn_1` int NOT NULL DEFAULT '0',
  `CutIn_2` int NOT NULL DEFAULT '0',
  `CutIn_3` int NOT NULL DEFAULT '0',
  `CutIn_4` int NOT NULL DEFAULT '0',
  `mastery` int NOT NULL DEFAULT '0',
  `CARD_CHARACTER_1` int NOT NULL DEFAULT '0',
  `CARD_CHARACTER_2` int NOT NULL DEFAULT '0',
  `CARD_CHARACTER_3` int NOT NULL DEFAULT '0',
  `CARD_CHARACTER_4` int NOT NULL DEFAULT '0',
  `CARD_CADDIE_1` int NOT NULL DEFAULT '0',
  `CARD_CADDIE_2` int NOT NULL DEFAULT '0',
  `CARD_CADDIE_3` int NOT NULL DEFAULT '0',
  `CARD_CADDIE_4` int NOT NULL DEFAULT '0',
  `CARD_NPC_1` int NOT NULL DEFAULT '0',
  `CARD_NPC_2` int NOT NULL DEFAULT '0',
  `CARD_NPC_3` int NOT NULL DEFAULT '0',
  `CARD_NPC_4` int NOT NULL DEFAULT '0',
  PRIMARY KEY (`uid`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_rank_config`
--

DROP TABLE IF EXISTS `pangya_rank_config`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_rank_config` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `refresh_time_H` int NOT NULL DEFAULT '0',
  `reg_date` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_record`
--

DROP TABLE IF EXISTS `pangya_record`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_record` (
  `UID` int NOT NULL,
  `tipo` smallint NOT NULL DEFAULT '0',
  `course` smallint NOT NULL DEFAULT '0',
  `best_score` smallint NOT NULL DEFAULT '127',
  `best_pang` bigint NOT NULL DEFAULT '0',
  `character_typeid` int NOT NULL DEFAULT '0',
  `event_score` smallint NOT NULL DEFAULT '0',
  `tacada` int NOT NULL DEFAULT '0',
  `putt` int NOT NULL DEFAULT '0',
  `hole` int NOT NULL DEFAULT '0',
  `fairway` int NOT NULL DEFAULT '0',
  `puttin` int NOT NULL DEFAULT '0',
  `total_score` int NOT NULL DEFAULT '0',
  `holein` int NOT NULL DEFAULT '0',
  `assist` smallint NOT NULL DEFAULT '0'
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_rescue_pwd_log`
--

DROP TABLE IF EXISTS `pangya_rescue_pwd_log`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_rescue_pwd_log` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `uid` int NOT NULL,
  `tipo` tinyint unsigned NOT NULL DEFAULT '1',
  `key_uniq` varchar(64) NOT NULL,
  `state` tinyint unsigned NOT NULL DEFAULT '0',
  `send_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY `IX_pangya_rescue_pwd_log_2` (`index`),
  UNIQUE KEY `IX_pangya_rescue_pwd_log_3` (`index`),
  KEY `IX_pangya_rescue_pwd_log` (`uid`)
) ENGINE=MyISAM AUTO_INCREMENT=55 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_reward_ssc`
--

DROP TABLE IF EXISTS `pangya_reward_ssc`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_reward_ssc` (
  `valor` int NOT NULL DEFAULT '0',
  `probabilidade` int NOT NULL DEFAULT '0',
  `tipo` int NOT NULL DEFAULT '0'
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_scratchy_prob_sec`
--

DROP TABLE IF EXISTS `pangya_scratchy_prob_sec`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_scratchy_prob_sec` (
  `uid` int NOT NULL,
  `scratchy_sec` int NOT NULL DEFAULT '0',
  PRIMARY KEY (`uid`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_server_list`
--

DROP TABLE IF EXISTS `pangya_server_list`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_server_list` (
  `Name` varchar(50) NOT NULL,
  `UID` int NOT NULL,
  `IP` varchar(20) NOT NULL,
  `Port` int NOT NULL,
  `MaxUser` int NOT NULL,
  `CurrUser` int NOT NULL,
  `Type` smallint NOT NULL,
  `UpdateTime` datetime NOT NULL,
  `State` smallint NOT NULL,
  `PCBangUser` smallint NOT NULL,
  `PangRate` int NOT NULL,
  `ServerVersion` varchar(40) NOT NULL,
  `ClientVersion` varchar(20) NOT NULL,
  `property` int NOT NULL,
  `AngelicWingsNum` int NOT NULL,
  `EventFlag` smallint NOT NULL,
  `ExpRate` int NOT NULL,
  `RareItemRate` int NOT NULL,
  `CookieItemRate` int NOT NULL,
  `ServiceControl` int NOT NULL,
  `ImgNo` smallint NOT NULL,
  `AppRate` smallint NOT NULL,
  `ScratchRate` smallint NOT NULL,
  `EventMap` int NOT NULL,
  `EventDropRate` int NOT NULL,
  `HanbitUser` int NOT NULL,
  `ParanUser` int NOT NULL,
  `AuthState` smallint NOT NULL,
  `MasteryRate` smallint NOT NULL,
  `TreasureRate` smallint NOT NULL,
  `ChuvaRate` smallint NOT NULL,
  UNIQUE KEY `IX_pangya_server_list` (`UID`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_shutdown_list`
--

DROP TABLE IF EXISTS `pangya_shutdown_list`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_shutdown_list` (
  `id` bigint NOT NULL AUTO_INCREMENT,
  `date_shutdown` datetime DEFAULT CURRENT_TIMESTAMP,
  `replayCount` int NOT NULL DEFAULT '1',
  `refreshTime` int NOT NULL DEFAULT '0',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=198 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_ticker_list`
--

DROP TABLE IF EXISTS `pangya_ticker_list`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_ticker_list` (
  `ticker_id` bigint NOT NULL AUTO_INCREMENT,
  `message` varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
  `nick` varchar(22) NOT NULL,
  `replayCount` int NOT NULL DEFAULT '1',
  `refreshTime` int NOT NULL DEFAULT '0',
  PRIMARY KEY (`ticker_id`)
) ENGINE=MyISAM AUTO_INCREMENT=429 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_ticket_report`
--

DROP TABLE IF EXISTS `pangya_ticket_report`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_ticket_report` (
  `idx` bigint NOT NULL AUTO_INCREMENT,
  `trofel_typeid` int NOT NULL DEFAULT '738197504',
  `flag` smallint NOT NULL DEFAULT '0',
  `reg_date` datetime DEFAULT CURRENT_TIMESTAMP,
  `tipo` int NOT NULL DEFAULT '4',
  PRIMARY KEY (`idx`)
) ENGINE=MyISAM AUTO_INCREMENT=491 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_ticket_report_dados`
--

DROP TABLE IF EXISTS `pangya_ticket_report_dados`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_ticket_report_dados` (
  `report_id` bigint NOT NULL,
  `player_uid` int NOT NULL,
  `player_score` smallint NOT NULL DEFAULT '0',
  `player_medalha` smallint NOT NULL DEFAULT '0',
  `player_trofel` smallint NOT NULL DEFAULT '0',
  `player_pang` bigint NOT NULL DEFAULT '0',
  `player_bonus_pang` bigint NOT NULL DEFAULT '0',
  `player_exp` int NOT NULL DEFAULT '0',
  `player_mascot_typeid` int NOT NULL DEFAULT '0',
  `player_state` smallint NOT NULL DEFAULT '0',
  `flag_item_pang` smallint NOT NULL DEFAULT '0',
  `flag_premium_user` smallint NOT NULL DEFAULT '0',
  `finish_date` datetime DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_tiki_points`
--

DROP TABLE IF EXISTS `pangya_tiki_points`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_tiki_points` (
  `UID` int NOT NULL,
  `Tiki_Points` bigint NOT NULL DEFAULT '0',
  `REG_DATE` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `MOD_DATE` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_transforme_clubset_temp`
--

DROP TABLE IF EXISTS `pangya_transforme_clubset_temp`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_transforme_clubset_temp` (
  `trans_index` bigint NOT NULL AUTO_INCREMENT,
  `UID` int NOT NULL DEFAULT '0',
  `TAQUEIRA_ID` int NOT NULL DEFAULT '0',
  `STATE` int NOT NULL DEFAULT '0',
  `MASTERY` int NOT NULL DEFAULT '0',
  `STATE2` int NOT NULL DEFAULT '0',
  `FLAG` smallint NOT NULL DEFAULT '0',
  `CARD_TYPEID` int NOT NULL DEFAULT '0',
  `CARD_QNTD` int NOT NULL DEFAULT '0',
  `TAQUEIRA_TRANS_TYPEID` int NOT NULL DEFAULT '0',
  PRIMARY KEY (`trans_index`)
) ENGINE=MyISAM AUTO_INCREMENT=21 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_treasure_item`
--

DROP TABLE IF EXISTS `pangya_treasure_item`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_treasure_item` (
  `Name` varchar(50) DEFAULT NULL,
  `typeid` int NOT NULL,
  `quantidade` int NOT NULL,
  `probabilidade` int NOT NULL,
  `tipo` int NOT NULL,
  `flag` smallint NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_trofel_especial`
--

DROP TABLE IF EXISTS `pangya_trofel_especial`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_trofel_especial` (
  `item_id` bigint NOT NULL AUTO_INCREMENT,
  `UID` int NOT NULL DEFAULT '0',
  `typeid` int NOT NULL DEFAULT '0',
  `qntd` int NOT NULL DEFAULT '0',
  PRIMARY KEY (`item_id`)
) ENGINE=MyISAM AUTO_INCREMENT=7 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_trofel_grandprix`
--

DROP TABLE IF EXISTS `pangya_trofel_grandprix`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_trofel_grandprix` (
  `item_id` bigint NOT NULL AUTO_INCREMENT,
  `UID` int NOT NULL DEFAULT '0',
  `typeid` int NOT NULL DEFAULT '0',
  `qntd` int NOT NULL DEFAULT '0',
  PRIMARY KEY (`item_id`)
) ENGINE=MyISAM AUTO_INCREMENT=24 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_user_equip`
--

DROP TABLE IF EXISTS `pangya_user_equip`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_user_equip` (
  `UID` int NOT NULL,
  `caddie_id` int NOT NULL DEFAULT '0',
  `character_id` int NOT NULL DEFAULT '0',
  `club_id` int NOT NULL DEFAULT '0',
  `ball_type` int NOT NULL DEFAULT '0',
  `item_slot_1` int NOT NULL DEFAULT '0',
  `item_slot_2` int NOT NULL DEFAULT '0',
  `item_slot_3` int NOT NULL DEFAULT '0',
  `item_slot_4` int NOT NULL DEFAULT '0',
  `item_slot_5` int NOT NULL DEFAULT '0',
  `item_slot_6` int NOT NULL DEFAULT '0',
  `item_slot_7` int NOT NULL DEFAULT '0',
  `item_slot_8` int NOT NULL DEFAULT '0',
  `item_slot_9` int NOT NULL DEFAULT '0',
  `item_slot_10` int NOT NULL DEFAULT '0',
  `Skin_1` int NOT NULL DEFAULT '0',
  `Skin_2` int NOT NULL DEFAULT '0',
  `Skin_3` int NOT NULL DEFAULT '0',
  `Skin_4` int NOT NULL DEFAULT '0',
  `Skin_5` int NOT NULL DEFAULT '0',
  `Skin_6` int NOT NULL DEFAULT '0',
  `mascot_id` int NOT NULL DEFAULT '0',
  `poster_1` int NOT NULL DEFAULT '0',
  `poster_2` int NOT NULL DEFAULT '0',
  PRIMARY KEY (`UID`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_user_macro`
--

DROP TABLE IF EXISTS `pangya_user_macro`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_user_macro` (
  `UID` int NOT NULL,
  `Macro1` varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT 'Pangya!',
  `Macro2` varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT 'Pangya!',
  `Macro3` varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT 'Pangya!',
  `Macro4` varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT 'Pangya!',
  `Macro5` varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT 'Pangya!',
  `Macro6` varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT 'Pangya!',
  `Macro7` varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT 'Pangya!',
  `Macro8` varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT 'Pangya!',
  `Macro9` varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT 'Pangya!',
  `Macro10` varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT 'Pangya!'
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `pangya_weblink_key`
--

DROP TABLE IF EXISTS `pangya_weblink_key`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `pangya_weblink_key` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `uid` int NOT NULL DEFAULT '0',
  `key` varchar(8) NOT NULL DEFAULT '123456',
  `valid` smallint NOT NULL DEFAULT '1',
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=80 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `papelshopitemrarewin`
--

DROP TABLE IF EXISTS `papelshopitemrarewin`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `papelshopitemrarewin` (
  `UID` int NOT NULL,
  `TYPEID` int NOT NULL,
  `REG_DATE` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `quest_items`
--

DROP TABLE IF EXISTS `quest_items`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `quest_items` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `typeid` int NOT NULL DEFAULT '0',
  `nome` varchar(100) NOT NULL,
  `stuff_typeid` int NOT NULL DEFAULT '0',
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=802 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `quest_stuffs`
--

DROP TABLE IF EXISTS `quest_stuffs`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `quest_stuffs` (
  `index` bigint NOT NULL AUTO_INCREMENT,
  `typeid` int NOT NULL DEFAULT '0',
  `nome` varchar(100) NOT NULL,
  `counter_typeid` int NOT NULL DEFAULT '0',
  `counter_qntd` int NOT NULL DEFAULT '0',
  PRIMARY KEY (`index`)
) ENGINE=MyISAM AUTO_INCREMENT=5497 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `scratchy_item`
--

DROP TABLE IF EXISTS `scratchy_item`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `scratchy_item` (
  `Name` varchar(50) NOT NULL,
  `TypeID` int NOT NULL,
  `Numero` int NOT NULL DEFAULT '-1',
  `Quantidade` int NOT NULL,
  `Probabilidade` int NOT NULL,
  `Tipo` int NOT NULL,
  `flag` smallint NOT NULL,
  `Active` smallint NOT NULL DEFAULT '1'
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `scratchy_rare_win`
--

DROP TABLE IF EXISTS `scratchy_rare_win`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `scratchy_rare_win` (
  `UID` int NOT NULL,
  `TypeID` int NOT NULL,
  `REG_DATE` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `scratchy_rate`
--

DROP TABLE IF EXISTS `scratchy_rate`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `scratchy_rate` (
  `nome` varchar(50) DEFAULT NULL,
  `tipo` int NOT NULL,
  `probabilidade` int NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `td_char_equip_s4`
--

DROP TABLE IF EXISTS `td_char_equip_s4`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `td_char_equip_s4` (
  `SEQ` bigint NOT NULL AUTO_INCREMENT,
  `UID` int NOT NULL,
  `CHAR_ITEMID` int NOT NULL DEFAULT '0',
  `ITEMID` int NOT NULL DEFAULT '0',
  `IN_DATE` datetime DEFAULT NULL,
  `EQUIP_NUM` int NOT NULL DEFAULT '0',
  `EQUIP_TYPE` int NOT NULL DEFAULT '0',
  `USE_YN` varchar(1) DEFAULT 'Y',
  PRIMARY KEY (`SEQ`)
) ENGINE=MyISAM AUTO_INCREMENT=114373 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `td_room_data`
--

DROP TABLE IF EXISTS `td_room_data`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `td_room_data` (
  `MYROOM_ID` bigint NOT NULL AUTO_INCREMENT,
  `UID` int NOT NULL DEFAULT '0',
  `ROOM_NO` int NOT NULL DEFAULT '0',
  `TYPEID` int NOT NULL DEFAULT '0',
  `POS_X` float(24,0) NOT NULL DEFAULT '0',
  `POS_Y` float(24,0) NOT NULL DEFAULT '0',
  `POS_Z` float(24,0) NOT NULL DEFAULT '0',
  `POS_R` float(24,0) NOT NULL DEFAULT '0',
  `MOD_SEQ` int NOT NULL DEFAULT '0',
  `DISPLAY_YN` varchar(1) NOT NULL DEFAULT 'N',
  `USE_YN` varchar(1) NOT NULL DEFAULT 'Y',
  `MOD_DT` datetime DEFAULT CURRENT_TIMESTAMP,
  `valid` tinyint unsigned DEFAULT '1',
  PRIMARY KEY (`MYROOM_ID`)
) ENGINE=MyISAM AUTO_INCREMENT=10892 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `temp_counter_typeid_init`
--

DROP TABLE IF EXISTS `temp_counter_typeid_init`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `temp_counter_typeid_init` (
  `index` int NOT NULL AUTO_INCREMENT,
  `uid` int NOT NULL DEFAULT '0',
  `typeid` int NOT NULL DEFAULT '0',
  PRIMARY KEY (`index`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `temp_tmp`
--

DROP TABLE IF EXISTS `temp_tmp`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `temp_tmp` (
  `idx` int NOT NULL AUTO_INCREMENT,
  `uid` int NOT NULL,
  `item_id` int NOT NULL,
  `typeid` int NOT NULL,
  `time` int NOT NULL,
  `qntd` int NOT NULL,
  `pang` int NOT NULL,
  `cookie` int NOT NULL,
  `coupon_id` int NOT NULL,
  `item_tipo` smallint NOT NULL,
  `tipo` smallint NOT NULL,
  `item_tempo` int NOT NULL,
  `c1` smallint NOT NULL,
  `c2` smallint NOT NULL,
  `c3` smallint NOT NULL,
  `c4` smallint NOT NULL,
  `c5` smallint NOT NULL,
  `x` bigint NOT NULL,
  `y` bigint NOT NULL,
  `z` bigint NOT NULL,
  `r` bigint NOT NULL,
  `UCCIDX` varchar(8) NOT NULL,
  PRIMARY KEY (`idx`)
) ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `temp_typeid`
--

DROP TABLE IF EXISTS `temp_typeid`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `temp_typeid` (
  `ITEM_ID` int NOT NULL,
  `TYPEID` int NOT NULL,
  `QUANTIDADE` int NOT NULL,
  `QNTD_DIA` int NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `trofel_stat`
--

DROP TABLE IF EXISTS `trofel_stat`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `trofel_stat` (
  `UID` bigint NOT NULL DEFAULT '0',
  `AMA_6_G` smallint NOT NULL DEFAULT '0',
  `AMA_6_S` smallint NOT NULL DEFAULT '0',
  `AMA_6_B` smallint NOT NULL DEFAULT '0',
  `AMA_5_G` smallint NOT NULL DEFAULT '0',
  `AMA_5_S` smallint NOT NULL DEFAULT '0',
  `AMA_5_B` smallint NOT NULL DEFAULT '0',
  `AMA_4_G` smallint NOT NULL DEFAULT '0',
  `AMA_4_S` smallint NOT NULL DEFAULT '0',
  `AMA_4_B` smallint NOT NULL DEFAULT '0',
  `AMA_3_G` smallint NOT NULL DEFAULT '0',
  `AMA_3_S` smallint NOT NULL DEFAULT '0',
  `AMA_3_B` smallint NOT NULL DEFAULT '0',
  `AMA_2_G` smallint NOT NULL DEFAULT '0',
  `AMA_2_S` smallint NOT NULL DEFAULT '0',
  `AMA_2_B` smallint NOT NULL DEFAULT '0',
  `AMA_1_G` smallint NOT NULL DEFAULT '0',
  `AMA_1_S` smallint NOT NULL DEFAULT '0',
  `AMA_1_B` smallint NOT NULL DEFAULT '0',
  `PRO_1_G` smallint NOT NULL DEFAULT '0',
  `PRO_1_S` smallint NOT NULL DEFAULT '0',
  `PRO_1_B` smallint NOT NULL DEFAULT '0',
  `PRO_2_G` smallint NOT NULL DEFAULT '0',
  `PRO_2_S` smallint NOT NULL DEFAULT '0',
  `PRO_2_B` smallint NOT NULL DEFAULT '0',
  `PRO_3_G` smallint NOT NULL DEFAULT '0',
  `PRO_3_S` smallint NOT NULL DEFAULT '0',
  `PRO_3_B` smallint NOT NULL DEFAULT '0',
  `PRO_4_G` smallint NOT NULL DEFAULT '0',
  `PRO_4_S` smallint NOT NULL DEFAULT '0',
  `PRO_4_B` smallint NOT NULL DEFAULT '0',
  `PRO_5_G` smallint NOT NULL DEFAULT '0',
  `PRO_5_S` smallint NOT NULL DEFAULT '0',
  `PRO_5_B` smallint NOT NULL DEFAULT '0',
  `PRO_6_G` smallint NOT NULL DEFAULT '0',
  `PRO_6_S` smallint NOT NULL DEFAULT '0',
  `PRO_6_B` smallint NOT NULL DEFAULT '0',
  `PRO_7_G` smallint NOT NULL DEFAULT '0',
  `PRO_7_S` smallint NOT NULL DEFAULT '0',
  `PRO_7_B` smallint NOT NULL DEFAULT '0',
  PRIMARY KEY (`UID`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `tu_ucc`
--

DROP TABLE IF EXISTS `tu_ucc`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `tu_ucc` (
  `UID` bigint NOT NULL,
  `TYPEID` bigint NOT NULL,
  `UCCIDX` varchar(8) DEFAULT NULL,
  `SEQ` int NOT NULL DEFAULT '1',
  `UCC_NAME` varchar(50) DEFAULT NULL,
  `USE_YN` varchar(1) NOT NULL DEFAULT 'N',
  `IN_DATE` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `COPIER` int DEFAULT NULL,
  `ITEM_ID` bigint NOT NULL,
  `COPIER_NICK` varchar(32) DEFAULT NULL,
  `DRAW_DT` datetime DEFAULT NULL,
  `STATUS` smallint NOT NULL,
  `Flag` smallint NOT NULL,
  `SKEY` varchar(20) DEFAULT NULL,
  `TRADE` smallint NOT NULL,
  PRIMARY KEY (`UID`,`TYPEID`,`SEQ`,`ITEM_ID`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `tutorial`
--

DROP TABLE IF EXISTS `tutorial`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `tutorial` (
  `UID` bigint NOT NULL DEFAULT '0',
  `Rookie` int NOT NULL DEFAULT '0',
  `Beginner` int NOT NULL DEFAULT '0',
  `Advancer` int NOT NULL DEFAULT '0',
  PRIMARY KEY (`UID`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `type_list`
--

DROP TABLE IF EXISTS `type_list`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `type_list` (
  `TypeId` bigint NOT NULL DEFAULT '0',
  `Name` varchar(100) NOT NULL DEFAULT '0',
  `Icon` varchar(50) NOT NULL DEFAULT '0',
  `Price` bigint NOT NULL DEFAULT '0',
  `type` smallint NOT NULL DEFAULT '0',
  PRIMARY KEY (`TypeId`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Table structure for table `user_info`
--

DROP TABLE IF EXISTS `user_info`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `user_info` (
  `UID` bigint NOT NULL DEFAULT '0',
  `Tacadas` bigint NOT NULL DEFAULT '0',
  `Putt` bigint NOT NULL DEFAULT '0',
  `Tempo` bigint NOT NULL DEFAULT '0',
  `Tempo tacadas` bigint NOT NULL DEFAULT '0',
  `Max_distancia` float(24,0) NOT NULL DEFAULT '0',
  `Acerto_pangya` bigint NOT NULL DEFAULT '0',
  `Bunker` int NOT NULL DEFAULT '0',
  `O.B` bigint NOT NULL DEFAULT '0',
  `Total_distancia` bigint NOT NULL DEFAULT '0',
  `Holes` bigint NOT NULL DEFAULT '0',
  `Holein` int NOT NULL DEFAULT '0',
  `HIO` bigint NOT NULL DEFAULT '0',
  `Timeout` smallint NOT NULL DEFAULT '0',
  `Fairway` bigint NOT NULL DEFAULT '0',
  `Albatross` bigint NOT NULL DEFAULT '0',
  `MaConduta` int NOT NULL DEFAULT '0',
  `Acerto_Putt` bigint NOT NULL DEFAULT '0',
  `Long-putt` float(24,0) NOT NULL DEFAULT '0',
  `Chip-in` float(24,0) NOT NULL DEFAULT '0',
  `Xp` bigint NOT NULL DEFAULT '0',
  `level` tinyint unsigned NOT NULL DEFAULT '0',
  `Pang` bigint NOT NULL DEFAULT '0',
  `Media_score` int NOT NULL DEFAULT '0',
  `BestScore0` smallint NOT NULL DEFAULT '0',
  `BestScore1` smallint NOT NULL DEFAULT '0',
  `BestScore2` smallint NOT NULL DEFAULT '0',
  `BestScore3` smallint NOT NULL DEFAULT '0',
  `BestScore4` smallint NOT NULL DEFAULT '0',
  `MaxPang0` bigint NOT NULL DEFAULT '0',
  `maxPang1` bigint NOT NULL DEFAULT '0',
  `maxPang2` bigint NOT NULL DEFAULT '0',
  `maxPang3` bigint NOT NULL DEFAULT '0',
  `maxPang4` bigint NOT NULL DEFAULT '0',
  `SumPang` bigint NOT NULL DEFAULT '0',
  `EventFlag` smallint NOT NULL DEFAULT '0',
  `Jogado` bigint NOT NULL DEFAULT '0',
  `Quitado` bigint NOT NULL DEFAULT '0',
  `SkinPang` bigint NOT NULL DEFAULT '0',
  `SkinWin` int NOT NULL DEFAULT '0',
  `SkinLose` int NOT NULL DEFAULT '0',
  `SkinRunHole` int NOT NULL DEFAULT '-1',
  `SkinStrikePoint` int NOT NULL DEFAULT '0',
  `SkinAllinCount` int NOT NULL DEFAULT '0',
  `Todos_combos` bigint NOT NULL DEFAULT '0',
  `Combos` bigint NOT NULL DEFAULT '0',
  `TeamWin` int NOT NULL DEFAULT '0',
  `TeamGames` int NOT NULL DEFAULT '0',
  `Teamhole` bigint NOT NULL DEFAULT '0',
  `LadderPoint` int NOT NULL DEFAULT '1000',
  `LadderWin` int NOT NULL DEFAULT '0',
  `LadderLose` int NOT NULL DEFAULT '0',
  `LadderDraw` int NOT NULL DEFAULT '0',
  `LadderHole` int NOT NULL DEFAULT '0',
  `EventValue` smallint NOT NULL DEFAULT '0',
  `NaoSei` int NOT NULL DEFAULT '0',
  `MaxJogoNaoSei` int NOT NULL DEFAULT '0',
  `JogosNaoSei` int NOT NULL DEFAULT '0',
  `GameCountSeason` int NOT NULL DEFAULT '0',
  `Cookie` bigint NOT NULL DEFAULT '0',
  `total_pang_win_game` bigint NOT NULL DEFAULT '0',
  `lucky_medal` int NOT NULL DEFAULT '0',
  `fast_medal` int NOT NULL DEFAULT '0',
  `best_drive_medal` int NOT NULL DEFAULT '0',
  `best_chipin_medal` int NOT NULL DEFAULT '0',
  `best_puttin_medal` int NOT NULL DEFAULT '0',
  `best_recovery_medal` int NOT NULL DEFAULT '0',
  `16bit_naosei` smallint NOT NULL DEFAULT '0',
  PRIMARY KEY (`UID`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping events for database 'pangya'
--

--
-- Dumping routines for database 'pangya'
--
/*!50003 DROP FUNCTION IF EXISTS `GetAchievementPoint` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`pangya_extrn`@`192.168.15.13` FUNCTION `GetAchievementPoint`(
	__IDUSER INT
) RETURNS int
    DETERMINISTIC
BEGIN

	RETURN 
	(
		SELECT
			COUNT(b.id) * 10 AS `LEVEL`
		FROM
			pangya.pangya_achievement a
			INNER JOIN
			pangya.pangya_quest b
			ON a.ID_ACHIEVEMENT = b.achievement_id
		WHERE 
			a.`UID` = __IDUSER
			AND b.`Date` IS NOT NULL
		GROUP BY a.UID
	);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP FUNCTION IF EXISTS `GetCardExpRate` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `GetCardExpRate`(
	__IDUSER INT
) RETURNS int
    DETERMINISTIC
BEGIN

	DECLARE __qntd_efeito int DEFAULT 0; 
	DECLARE __qntd int DEFAULT 0; 
	DECLARE __FINISHED BOOL DEFAULT TRUE;

	DECLARE TYPEID_CURSOR CURSOR FOR 
		SELECT pangya_card_equip.Efeito_Qntd
		FROM pangya.pangya_card_equip
		WHERE 
			pangya_card_equip.UID = __IDUSER AND 
			pangya_card_equip.Efeito = 3 AND 
			pangya_card_equip.END_DT > now();
	
	DECLARE CONTINUE HANDLER FOR NOT FOUND SET __FINISHED = FALSE;

	OPEN TYPEID_CURSOR;
    FETCH TYPEID_CURSOR INTO __qntd_efeito;

	WHILE (__FINISHED) DO
	BEGIN

		SET __qntd = __qntd + __qntd_efeito;
        
        FETCH TYPEID_CURSOR INTO __qntd_efeito;
	END;
    END WHILE;

	CLOSE TYPEID_CURSOR;

	RETURN __qntd;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP FUNCTION IF EXISTS `GetCardPangRate` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `GetCardPangRate`(
	__IDUSER INT
) RETURNS int
    DETERMINISTIC
BEGIN

	DECLARE __qntd_efeito int DEFAULT 0; 
	DECLARE __qntd int DEFAULT 0; 
	DECLARE __FINISHED BOOL DEFAULT TRUE;

	DECLARE TYPEID_CURSOR CURSOR FOR 

	SELECT pangya_card_equip.Efeito_Qntd
	FROM pangya.pangya_card_equip
	WHERE pangya_card_equip.UID = __IDUSER AND pangya_card_equip.Efeito = 2 OR (pangya_card_equip.Efeito = 3 AND pangya_card_equip.card_typeid = 436207841) AND pangya_card_equip.END_DT > now();

	DECLARE CONTINUE HANDLER FOR NOT FOUND SET __FINISHED = FALSE;

	OPEN TYPEID_CURSOR;

	FETCH TYPEID_CURSOR INTO __qntd_efeito;

	WHILE (__FINISHED) DO
	BEGIN

		SET __qntd = __qntd + __qntd_efeito;
        
		FETCH TYPEID_CURSOR INTO __qntd_efeito;
	END;
    END WHILE;

	CLOSE TYPEID_CURSOR;

	RETURN __qntd;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP FUNCTION IF EXISTS `GetEXPByLevel` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `GetEXPByLevel`(
	__IDUSER INT
) RETURNS int
    DETERMINISTIC
BEGIN

	-- #Get Experience of player by LEVEL
	DECLARE __EXP INT DEFAULT 0;
	DECLARE __LVL INT;
	
	SET __LVL = (SELECT `level` FROM user_info WHERE UID = __IDUSER);

	IF __LVL = 0 THEN
		SET __EXP = 30;
	ELSEIF __LVL = 1 THEN
		SET __EXP = 40;
	ELSEIF __LVL = 2 THEN
		SET __EXP = 50;
	ELSEIF __LVL = 3 THEN
		SET __EXP = 60;
	ELSEIF __LVL = 4 THEN
		SET __EXP = 70;
	ELSEIF __LVL = 5 THEN
		SET __EXP = 140;
	ELSEIF __LVL = 6 THEN
		SET __EXP = 105;
	ELSEIF __LVL = 7 THEN
		SET __EXP = 125;
	ELSEIF __LVL = 8 THEN
		SET __EXP = 145;
	ELSEIF __LVL = 9 THEN
		SET __EXP = 165;
	ELSEIF __LVL = 10 THEN
		SET __EXP = 330;
	ELSEIF __LVL = 11 THEN
		SET __EXP = 248;
	ELSEIF __LVL = 12 THEN
		SET __EXP = 278;
	ELSEIF __LVL = 13 THEN
		SET __EXP = 308;
	ELSEIF __LVL = 14 THEN
		SET __EXP = 338;
	ELSEIF __LVL = 15 THEN
		SET __EXP = 675;
	ELSEIF __LVL = 16 THEN
		SET __EXP = 506;
	ELSEIF __LVL = 17 THEN
		SET __EXP = 546;
	ELSEIF __LVL = 18 THEN
		SET __EXP = 586;
	ELSEIF __LVL = 19 THEN
		SET __EXP = 626;
	ELSEIF __LVL = 20 THEN
		SET __EXP = 1253;
	ELSEIF __LVL = 21 THEN
		SET __EXP = 1002;
	ELSEIF __LVL = 22 THEN
		SET __EXP = 1052;
	ELSEIF __LVL = 23 THEN
		SET __EXP = 1102;
	ELSEIF __LVL = 24 THEN
		SET __EXP = 1152;
	ELSEIF __LVL = 25 THEN
		SET __EXP = 2304;
	ELSEIF __LVL = 26 THEN
		SET __EXP = 1843;
	ELSEIF __LVL = 27 THEN
		SET __EXP = 1903;
	ELSEIF __LVL = 28 THEN
		SET __EXP = 1963;
	ELSEIF __LVL = 29 THEN
		SET __EXP = 2023;
	ELSEIF __LVL = 30 THEN
		SET __EXP = 4046;
	ELSEIF __LVL = 31 THEN
		SET __EXP = 3237;
	ELSEIF __LVL = 32 THEN
		SET __EXP = 3307;
	ELSEIF __LVL = 33 THEN
		SET __EXP = 3377;
	ELSEIF __LVL = 34 THEN
		SET __EXP = 3447;
	ELSEIF __LVL = 35 THEN
		SET __EXP = 6894;
	ELSEIF __LVL = 36 THEN
		SET __EXP = 5515;
	ELSEIF __LVL = 37 THEN
		SET __EXP = 5595;
	ELSEIF __LVL = 38 THEN
		SET __EXP = 5675;
	ELSEIF __LVL = 39 THEN
		SET __EXP = 5755;
	ELSEIF __LVL = 40 THEN
		SET __EXP = 11511;
	ELSEIF __LVL = 41 THEN
		SET __EXP = 8058;
	ELSEIF __LVL = 42 THEN
		SET __EXP = 8148;
	ELSEIF __LVL = 43 THEN
		SET __EXP = 8238;
	ELSEIF __LVL = 44 THEN
		SET __EXP = 8328;
	ELSEIF __LVL = 45 THEN
		SET __EXP = 16655;
	ELSEIF __LVL = 46 THEN
		SET __EXP = 8328;
	ELSEIF __LVL = 47 THEN
		SET __EXP = 8428;
	ELSEIF __LVL = 48 THEN
		SET __EXP = 8528;
	ELSEIF __LVL = 49 THEN
		SET __EXP = 8628;
	ELSEIF __LVL = 50 THEN
		SET __EXP = 17255;
	ELSEIF __LVL = 51 THEN
		SET __EXP = 9490;
	ELSEIF __LVL = 52 THEN
		SET __EXP = 9690;
	ELSEIF __LVL = 53 THEN
		SET __EXP = 9890;
	ELSEIF __LVL = 54 THEN
		SET __EXP = 10090;
	ELSEIF __LVL = 55 THEN
		SET __EXP = 20181;
	ELSEIF __LVL = 56 THEN
		SET __EXP = 20181;
	ELSEIF __LVL = 57 THEN
		SET __EXP = 20481;
	ELSEIF __LVL = 58 THEN
		SET __EXP = 20781;
	ELSEIF __LVL = 59 THEN
		SET __EXP = 21081;
	ELSEIF __LVL = 60 THEN
		SET __EXP = 42161;
	ELSEIF __LVL = 61 THEN
		SET __EXP = 37945;
	ELSEIF __LVL = 62 THEN
		SET __EXP = 68301;
	ELSEIF __LVL = 63 THEN
		SET __EXP = 122942;
	ELSEIF __LVL = 64 THEN
		SET __EXP = 221296;
	ELSEIF __LVL = 65 THEN
		SET __EXP = 442592;
	ELSEIF __LVL = 66 THEN
		SET __EXP = 663887;
	ELSEIF __LVL = 67 THEN
		SET __EXP = 995831;
	ELSEIF __LVL = 68 THEN
		SET __EXP = 1493747;
	ELSEIF __LVL = 69 THEN
		SET __EXP = 2240620;
	ELSEIF __LVL >= 70 THEN
		SET __EXP = 999999999;
	END IF;
	
	RETURN __EXP;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP FUNCTION IF EXISTS `GetItensExpRate` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `GetItensExpRate`(
	__IDUSER INT
) RETURNS int
    DETERMINISTIC
BEGIN

	DECLARE __item_typeid int DEFAULT 0; 
	DECLARE __qntd int DEFAULT 0; 
	DECLARE __FINISHED BOOL DEFAULT TRUE;

	DECLARE TYPEID_CURSOR CURSOR FOR 

	SELECT pangya_item_warehouse.typeid
	FROM pangya.pangya_item_warehouse
	WHERE 
		pangya_item_warehouse.UID = __IDUSER AND 
		pangya_item_warehouse.valid = 1 AND 
		pangya_item_warehouse.C0 > 0 AND 
		pangya_item_warehouse.typeid IN ( 
		436207626, 
		436207627, 
		436207629, 
		436207630, 
		436207631, 
		436207636, 
		436207669, 
		436207749, 
		436207769, 
		436207868 );
        
	DECLARE CONTINUE HANDLER FOR NOT FOUND SET __FINISHED = FALSE;

	OPEN TYPEID_CURSOR;
    FETCH TYPEID_CURSOR INTO __item_typeid;

	WHILE (__FINISHED) DO
	BEGIN

		SET __qntd = __qntd + 200;
        
        FETCH TYPEID_CURSOR INTO __item_typeid;

	END;
    END WHILE;

	CLOSE TYPEID_CURSOR;

	RETURN __qntd;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP FUNCTION IF EXISTS `GetItensPangRate` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `GetItensPangRate`(
	__IDUSER INT
) RETURNS int
    DETERMINISTIC
BEGIN

	DECLARE __item_typeid int DEFAULT 0; 
	DECLARE __qntd int DEFAULT 0; 
	DECLARE __FINISHED BOOL DEFAULT TRUE;

	DECLARE TYPEID_CURSOR CURSOR FOR 

	SELECT pangya_item_warehouse.typeid
	FROM pangya.pangya_item_warehouse
	WHERE 
		pangya_item_warehouse.UID = __IDUSER AND 
		pangya_item_warehouse.valid = 1 AND 
		pangya_item_warehouse.C0 > 0 AND 
		pangya_item_warehouse.typeid IN ( 
		436207617, 
		436207618, 
		436207621, 
		436207625, 
		436207628 );
        
	DECLARE CONTINUE HANDLER FOR NOT FOUND SET __FINISHED = FALSE;

	OPEN TYPEID_CURSOR;
    FETCH TYPEID_CURSOR INTO __item_typeid;

	WHILE (__FINISHED) DO
	BEGIN

		IF __item_typeid IN ( 436207617, 436207618 ) THEN
			SET __qntd = __qntd + 200;
		ELSEIF __item_typeid = 436207621 THEN
			SET __qntd = __qntd + 300;
		ELSE 
			SET __qntd = __qntd + 20;
		END IF;
        
        FETCH TYPEID_CURSOR INTO __item_typeid;

	END;
    END WHILE;

	CLOSE TYPEID_CURSOR;

	RETURN __qntd;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP FUNCTION IF EXISTS `GetLevelClubSet` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `GetLevelClubSet`(
	__IDUSER int,
	__taqueira_id int,
	__qntd int
) RETURNS int
    DETERMINISTIC
BEGIN

	DECLARE __LEVEL int DEFAULT 0;

	IF __LEVEL < 30 THEN
		SET __LEVEL = -1;
	ELSEIF __LEVEL < 35 THEN
		SET __LEVEL = __LEVEL - 30;
	ELSEIF __LEVEL < 40 THEN
		SET __LEVEL = __LEVEL - 35;
	ELSEIF __LEVEL < 45 THEN
		SET __LEVEL = __LEVEL - 40;
	ELSEIF __LEVEL < 50 THEN
		SET __LEVEL = __LEVEL - 45;
	ELSEIF __LEVEL < 55 THEN
		SET __LEVEL = __LEVEL - 50;
	ELSEIF __LEVEL < 60 THEN
		SET __LEVEL = -1;
	END IF;

	RETURN __LEVEL;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP FUNCTION IF EXISTS `GetLevelMemorial` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `GetLevelMemorial`(
	__IDUSER int
) RETURNS int
    DETERMINISTIC
BEGIN

	RETURN NULL;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP FUNCTION IF EXISTS `GetRankClubSet` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `GetRankClubSet`(
	__IDUSER int,
	__taqueira_id int,
	__qntd int
) RETURNS int
    DETERMINISTIC
BEGIN

	DECLARE __LEVEL int DEFAULT 0;

	IF __LEVEL < 30 THEN
		SET __LEVEL = -1;
	ELSEIF __LEVEL < 35 THEN
		SET __LEVEL = 0;
	ELSEIF __LEVEL < 40 THEN
		SET __LEVEL = 1;
	ELSEIF __LEVEL < 45 THEN
		SET __LEVEL = 2;
	ELSEIF __LEVEL < 50 THEN
		SET __LEVEL = 3;
	ELSEIF __LEVEL < 55 THEN
		SET __LEVEL = 4;
	ELSEIF __LEVEL < 60 THEN
		SET __LEVEL = 5;
	END IF;

	RETURN __LEVEL;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP FUNCTION IF EXISTS `GroupID` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `GroupID`(__item_typeid int) RETURNS int
    DETERMINISTIC
BEGIN
	-- Return the result of the function
	RETURN (__item_typeid & 0xFF000000) >> 24;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP FUNCTION IF EXISTS `SPLIT_STR` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` FUNCTION `SPLIT_STR`(
  x VARCHAR(8000),
  delim VARCHAR(12),
  pos INT
) RETURNS varchar(8000) CHARSET latin1
    DETERMINISTIC
RETURN REPLACE(SUBSTRING(SUBSTRING_INDEX(x, delim, pos),
       LENGTH(SUBSTRING_INDEX(x, delim, pos -1)) + 1),
       delim, '') ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `AddMsgOff` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `AddMsgOff`(
	__from_uid int,
	__uid_to int,
	__msg_in nvarchar(64)
)
BEGIN

	INSERT pangya.pangya_msg_user(
         pangya.pangya_msg_user.uid, 
         pangya.pangya_msg_user.uid_from, 
         pangya.pangya_msg_user.valid, 
         pangya.pangya_msg_user.msg, 
         pangya.pangya_msg_user.reg_date)
         VALUES (
            __uid_to, 
            __from_uid, 
            1, 
            __msg_in, 
            ifnull(now(), now()));

      UPDATE pangya.user_info
         SET 
            pang = user_info.Pang - 10
      WHERE user_info.UID = __from_uid;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `CheckDolfiniPassword` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `CheckDolfiniPassword`(
	__IDUSER int
)
BEGIN
	IF 
         (
            SELECT pangya_dolfini_locker.uid
            FROM pangya.pangya_dolfini_locker
            WHERE pangya_dolfini_locker.uid = __IDUSER
         ) IS NULL THEN
         BEGIN

            INSERT pangya.pangya_dolfini_locker(pangya.pangya_dolfini_locker.uid, pangya.pangya_dolfini_locker.pang, pangya.pangya_dolfini_locker.locker)
               VALUES (__IDUSER, 0, 0);

            SELECT 2 AS OPT;

         END;
      ELSEIF 
            (
               SELECT pangya_dolfini_locker.senha
               FROM pangya.pangya_dolfini_locker
               WHERE pangya_dolfini_locker.uid = __IDUSER
            ) IS NULL THEN
            SELECT 2 AS OPT;
         ELSE 
            SELECT 76 AS OPT;
		END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `CheckWeblink_Key` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `CheckWeblink_Key`(
	__id_in nvarchar(25),
	__weblink_key nvarchar(8)
)
BEGIN
    
    DECLARE __RET int DEFAULT -1;

      SET __RET = IFNULL(
         (
            SELECT a.uid
            FROM pangya.pangya_weblink_key  AS a, pangya.account  AS b
            WHERE 
               b.ID = __id_in AND 
               b.UID = a.uid AND 
               a.`key` = __weblink_key AND 
               a.valid = 1
         ), CAST((-1) AS char(50)));

      IF __RET >= 0 THEN
         UPDATE pangya.pangya_weblink_key
            SET 
               valid = 0
         WHERE pangya_weblink_key.uid = __RET;
		END IF;

      SELECT __RET AS uid;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `Evento1` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `Evento1`(
	__IDUSER int
)
BEGIN
    
    DECLARE __MSGID int;
    DECLARE __temp int DEFAULT -1;
    DECLARE __temp$2 int DEFAULT -1;

      INSERT pangya.pangya_gift_table(
         pangya.pangya_gift_table.UID, 
         pangya.pangya_gift_table.fromid, 
         pangya.pangya_gift_table.message, 
         pangya.pangya_gift_table.giftdate, 
         pangya.pangya_gift_table.Lida_YN, 
         pangya.pangya_gift_table.valid, 
         pangya.pangya_gift_table.Flag, 
         pangya.pangya_gift_table.Contador_Vista)
         VALUES (
            __IDUSER, 
            '__SUPER', 
            'NICE FINISH TUTORIAL ROOKIE', 
            ifnull(now(), now()), 
            0, 
            1, 
            0, 
            0);

      SELECT max(pangya_gift_table.Msg_ID) INTO __MSGID
      FROM pangya.pangya_gift_table;

      CALL pangya.ProcInsertItemNoEmail( 
         0, 
         __IDUSER, 
         __MSGID, 
         __temp, 
         0x1C000000, 
         0, 
         1, 
         0);

      CALL pangya.ProcInsertItemNoEmail(
         0, 
         __IDUSER, 
         __MSGID, 
         __temp$2, 
         0x10000012, 
         0, 
         1, 
         0);

      UPDATE pangya.account
         SET 
            Event1 = 1
      WHERE account.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `Evento2` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `Evento2`(
	__IDUSER int
)
BEGIN
    
    DECLARE __MSGID int;
    DECLARE __temp int DEFAULT -1;
    DECLARE __temp$2 int DEFAULT -1;

      INSERT pangya.pangya_gift_table(
         pangya.pangya_gift_table.UID, 
         pangya.pangya_gift_table.fromid, 
         pangya.pangya_gift_table.message, 
         pangya.pangya_gift_table.giftdate, 
         pangya.pangya_gift_table.Lida_YN, 
         pangya.pangya_gift_table.valid, 
         pangya.pangya_gift_table.Flag, 
         pangya.pangya_gift_table.Contador_Vista)
         VALUES (
            __IDUSER, 
            '__SUPER', 
            'NICE FINISH TUTORIAL BEGINNER', 
            ifnull(now(), now()), 
            0, 
            1, 
            0, 
            0);

      SELECT max(pangya_gift_table.Msg_ID) INTO __MSGID
      FROM pangya.pangya_gift_table;

      CALL pangya.ProcInsertItemNoEmail(
         0, 
         __IDUSER, 
         __MSGID, 
         __temp, 
         0x18000027, 
         0, 
         10, 
         0);

      CALL pangya.ProcInsertItemNoEmail(
         0, 
         __IDUSER, 
         __MSGID, 
         __temp$2, 
         0x1A000010, 
         0, 
         10000, 
         0);

      UPDATE pangya.account
         SET 
            Event2 = 1
      WHERE account.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `FLUSHTUTORIAL` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `FLUSHTUTORIAL`(
	__IDUSER int,
	__TIPO int,
	__VALOR int
)
BEGIN
    
	IF __TIPO = 0 THEN
	BEGIN

		UPDATE pangya.tutorial
			SET 
				Rookie = tutorial.Rookie + __VALOR
		WHERE tutorial.UID = __IDUSER;

		CALL pangya.ProcDestribuiItemTutorial(__IDUSER, __VALOR, 0);

	END;
	ELSEIF __TIPO = 1 THEN
	BEGIN

		UPDATE pangya.tutorial
			SET 
				Rookie = tutorial.Rookie + __VALOR
		WHERE tutorial.UID = __IDUSER;

		UPDATE pangya.account
			SET 
				doTutorial = 1
		WHERE account.UID = __IDUSER;

		CALL pangya.ProcDestribuiItemTutorial(__IDUSER, __VALOR, 0);

		CALL pangya.Evento1(__IDUSER);

	END;
	ELSE 
	BEGIN
		IF __TIPO = 256 THEN
		BEGIN

			DECLARE __TESTE int;

			UPDATE pangya.tutorial
				SET 
					Beginner = tutorial.Beginner + __VALOR
			WHERE tutorial.UID = __IDUSER;

			CALL pangya.ProcDestribuiItemTutorial(__IDUSER, __VALOR, 1);

			SELECT tutorial.Beginner INTO __TESTE
			FROM pangya.tutorial
			WHERE tutorial.UID = __IDUSER;

			IF __TESTE = 16128 THEN
			BEGIN

				UPDATE pangya.account
				  SET 
					 doTutorial = 1
				WHERE account.UID = __IDUSER;

				CALL pangya.Evento2(__IDUSER);

			END;
            END IF;

		END;
        END IF;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `FuncConcertaPartsCharacter` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `FuncConcertaPartsCharacter`(
	__IDUSER int,
	__CHARTYPE int
)
BEGIN
    
	DECLARE __CHAR_TYPE int;

	SET __CHAR_TYPE = (__CHARTYPE & 255);

	IF __CHAR_TYPE = 0 THEN
	BEGIN

		UPDATE pangya.pangya_character_information
			SET 
				parts_1 = 134218752
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
			parts_3 = 134235136
			WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_4 = 134243328
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_5 = 134251520
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_6 = 134259712
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_8 = 134276096
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_9 = 134284288
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	END;
	ELSEIF __CHAR_TYPE = 1 THEN
	BEGIN

		UPDATE pangya.pangya_character_information
			SET 
				parts_1 = 134480896
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_2 = 134489088
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_3 = 134497280
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_4 = 134505472
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_5 = 134513664
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_7 = 134530048
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_8 = 134538240
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	END;
	ELSEIF __CHAR_TYPE = 2 THEN
	BEGIN

		UPDATE pangya.pangya_character_information
			SET 
				parts_1 = 134743040
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_2 = 134751232
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_3 = 134759424
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_4 = 134767616
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_5 = 134775808
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_6 = 134784000
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_7 = 134792192
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_8 = 134800384
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	END;
	ELSEIF __CHAR_TYPE = 3 THEN
	BEGIN

		UPDATE pangya.pangya_character_information
			SET 
				parts_1 = 135005184
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_2 = 135013376
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_3 = 135021568
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_4 = 135029760
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_5 = 135037952
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_6 = 135046144
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_7 = 135054336
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_8 = 135062528
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	END;
	ELSEIF __CHAR_TYPE = 4 THEN
	BEGIN

		UPDATE pangya.pangya_character_information
			SET 
				parts_1 = 135267328
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_2 = 135275520
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_3 = 135283712
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_4 = 135291904
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_5 = 135300096
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_6 = 135308288
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	END;
	ELSEIF __CHAR_TYPE = 5 THEN
	BEGIN

		UPDATE pangya.pangya_character_information
			SET 
				parts_1 = 135529472
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_2 = 135537664
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_3 = 135545856
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_4 = 135554048
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_5 = 135562240
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_6 = 135570432
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_7 = 135578624
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_8 = 135586816
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	END;
	ELSEIF __CHAR_TYPE = 6 THEN
	BEGIN

		UPDATE pangya.pangya_character_information
			SET 
				parts_1 = 135791616
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_2 = 135799808
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_3 = 135808000
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_4 = 135816192
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_5 = 135824384
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_6 = 135832576
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_7 = 135840768
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	END;
	ELSEIF __CHAR_TYPE = 7 THEN
	BEGIN

		UPDATE pangya.pangya_character_information
			SET 
				parts_1 = 136053760
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_2 = 136061952
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_3 = 136070144
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_4 = 136078336
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_5 = 136086528
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_6 = 136094720
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_7 = 136102912
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_8 = 136111104
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_9 = 136119296
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	END;
	ELSEIF __CHAR_TYPE = 8 THEN
	BEGIN

		UPDATE pangya.pangya_character_information
			SET 
				parts_1 = 136315904
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_2 = 136324096
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_3 = 136332288
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_4 = 136340480
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_5 = 136348672
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_6 = 136356864
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_7 = 136365056
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_8 = 136373248
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	END;
	ELSEIF __CHAR_TYPE = 9 THEN
	BEGIN

		UPDATE pangya.pangya_character_information
			SET 
				parts_1 = 136578048
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_2 = 136586240
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_3 = 136594432
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_4 = 136602624
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_5 = 136610816
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_6 = 136619008
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_7 = 136627200
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_8 = 136635392
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	END;
	ELSEIF __CHAR_TYPE = 10 THEN
	BEGIN

		UPDATE pangya.pangya_character_information
			SET 
				parts_1 = 136840192
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_2 = 136848384
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_3 = 136856576
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_4 = 136864768
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_5 = 136872960
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_6 = 136881152
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_7 = 136889344
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_8 = 136897536
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `FuncInsertPartsCharacter` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `FuncInsertPartsCharacter`(
	__IDUSER int,
	__CHARTYPE int,
	__shirts smallint,
	__hairs smallint
)
BEGIN
    
	DECLARE __CHAR_TYPE int;

	SET __CHAR_TYPE = (__CHARTYPE & 255);

	IF __CHAR_TYPE = 0 THEN
	BEGIN

		INSERT pangya.pangya_character_information(
			pangya.pangya_character_information.UID, 
			pangya.pangya_character_information.typeid, 
			pangya.pangya_character_information.parts_1, 
			pangya.pangya_character_information.parts_2, 
			pangya.pangya_character_information.parts_3, 
			pangya.pangya_character_information.parts_4, 
			pangya.pangya_character_information.parts_5, 
			pangya.pangya_character_information.parts_6, 
			pangya.pangya_character_information.parts_7, 
			pangya.pangya_character_information.parts_8, 
			pangya.pangya_character_information.parts_9, 
			pangya.pangya_character_information.parts_10, 
			pangya.pangya_character_information.parts_11, 
			pangya.pangya_character_information.parts_12, 
			pangya.pangya_character_information.parts_13, 
			pangya.pangya_character_information.parts_14, 
			pangya.pangya_character_information.parts_15, 
			pangya.pangya_character_information.parts_16, 
			pangya.pangya_character_information.parts_17, 
			pangya.pangya_character_information.parts_18, 
			pangya.pangya_character_information.parts_19, 
			pangya.pangya_character_information.parts_20, 
			pangya.pangya_character_information.parts_21, 
			pangya.pangya_character_information.parts_22, 
			pangya.pangya_character_information.parts_23, 
			pangya.pangya_character_information.parts_24, 
			pangya.pangya_character_information.default_hair, 
			pangya.pangya_character_information.default_shirts, 
			pangya.pangya_character_information.gift_flag, 
			pangya.pangya_character_information.PCL0, 
			pangya.pangya_character_information.PCL1, 
			pangya.pangya_character_information.PCL2, 
			pangya.pangya_character_information.PCL3, 
			pangya.pangya_character_information.PCL4, 
			pangya.pangya_character_information.Purchase, 
			pangya.pangya_character_information.auxparts_1, 
			pangya.pangya_character_information.auxparts_2, 
			pangya.pangya_character_information.auxparts_3, 
			pangya.pangya_character_information.auxparts_4, 
			pangya.pangya_character_information.auxparts_5, 
			pangya.pangya_character_information.Mastery)
		VALUES (
			__IDUSER, 
			__CHARTYPE, 
			134218752, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0);

		UPDATE pangya.pangya_character_information
			SET 
				parts_3 = 134235136
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_4 = 134243328
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_5 = 134251520
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_6 = 134259712
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_8 = 134276096
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_9 = 134284288
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	END;
	ELSEIF __CHAR_TYPE = 1 THEN
	BEGIN

		INSERT pangya.pangya_character_information(
			pangya.pangya_character_information.UID, 
			pangya.pangya_character_information.typeid, 
			pangya.pangya_character_information.parts_1, 
			pangya.pangya_character_information.parts_2, 
			pangya.pangya_character_information.parts_3, 
			pangya.pangya_character_information.parts_4, 
			pangya.pangya_character_information.parts_5, 
			pangya.pangya_character_information.parts_6, 
			pangya.pangya_character_information.parts_7, 
			pangya.pangya_character_information.parts_8, 
			pangya.pangya_character_information.parts_9, 
			pangya.pangya_character_information.parts_10, 
			pangya.pangya_character_information.parts_11, 
			pangya.pangya_character_information.parts_12, 
			pangya.pangya_character_information.parts_13, 
			pangya.pangya_character_information.parts_14, 
			pangya.pangya_character_information.parts_15, 
			pangya.pangya_character_information.parts_16, 
			pangya.pangya_character_information.parts_17, 
			pangya.pangya_character_information.parts_18, 
			pangya.pangya_character_information.parts_19, 
			pangya.pangya_character_information.parts_20, 
			pangya.pangya_character_information.parts_21, 
			pangya.pangya_character_information.parts_22, 
			pangya.pangya_character_information.parts_23, 
			pangya.pangya_character_information.parts_24, 
			pangya.pangya_character_information.default_hair, 
			pangya.pangya_character_information.default_shirts, 
			pangya.pangya_character_information.gift_flag, 
			pangya.pangya_character_information.PCL0, 
			pangya.pangya_character_information.PCL1, 
			pangya.pangya_character_information.PCL2, 
			pangya.pangya_character_information.PCL3, 
			pangya.pangya_character_information.PCL4, 
			pangya.pangya_character_information.Purchase, 
			pangya.pangya_character_information.auxparts_1, 
			pangya.pangya_character_information.auxparts_2, 
			pangya.pangya_character_information.auxparts_3, 
			pangya.pangya_character_information.auxparts_4, 
			pangya.pangya_character_information.auxparts_5, 
			pangya.pangya_character_information.Mastery)
		VALUES (
			__IDUSER, 
			__CHARTYPE, 
			134480896, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0);

		UPDATE pangya.pangya_character_information
			SET 
				parts_2 = 134489088
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_3 = 134497280
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_4 = 134505472
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_5 = 134513664
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_7 = 134530048
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_8 = 134538240
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	END;
	ELSEIF __CHAR_TYPE = 2 THEN
	BEGIN

		INSERT pangya.pangya_character_information(
			pangya.pangya_character_information.UID, 
			pangya.pangya_character_information.typeid, 
			pangya.pangya_character_information.parts_1, 
			pangya.pangya_character_information.parts_2, 
			pangya.pangya_character_information.parts_3, 
			pangya.pangya_character_information.parts_4, 
			pangya.pangya_character_information.parts_5, 
			pangya.pangya_character_information.parts_6, 
			pangya.pangya_character_information.parts_7, 
			pangya.pangya_character_information.parts_8, 
			pangya.pangya_character_information.parts_9, 
			pangya.pangya_character_information.parts_10, 
			pangya.pangya_character_information.parts_11, 
			pangya.pangya_character_information.parts_12, 
			pangya.pangya_character_information.parts_13, 
			pangya.pangya_character_information.parts_14, 
			pangya.pangya_character_information.parts_15, 
			pangya.pangya_character_information.parts_16, 
			pangya.pangya_character_information.parts_17, 
			pangya.pangya_character_information.parts_18, 
			pangya.pangya_character_information.parts_19, 
			pangya.pangya_character_information.parts_20, 
			pangya.pangya_character_information.parts_21, 
			pangya.pangya_character_information.parts_22, 
			pangya.pangya_character_information.parts_23, 
			pangya.pangya_character_information.parts_24, 
			pangya.pangya_character_information.default_hair, 
			pangya.pangya_character_information.default_shirts, 
			pangya.pangya_character_information.gift_flag, 
			pangya.pangya_character_information.PCL0, 
			pangya.pangya_character_information.PCL1, 
			pangya.pangya_character_information.PCL2, 
			pangya.pangya_character_information.PCL3, 
			pangya.pangya_character_information.PCL4, 
			pangya.pangya_character_information.Purchase, 
			pangya.pangya_character_information.auxparts_1, 
			pangya.pangya_character_information.auxparts_2, 
			pangya.pangya_character_information.auxparts_3, 
			pangya.pangya_character_information.auxparts_4, 
			pangya.pangya_character_information.auxparts_5, 
			pangya.pangya_character_information.Mastery)
		VALUES (
			__IDUSER, 
			__CHARTYPE, 
			134743040, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0);

		UPDATE pangya.pangya_character_information
			SET 
				parts_2 = 134751232
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_3 = 134759424
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_4 = 134767616
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_5 = 134775808
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_6 = 134784000
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;
        
		UPDATE pangya.pangya_character_information
			SET 
				parts_7 = 134792192
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_8 = 134800384
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	END;
	ELSEIF __CHAR_TYPE = 3 THEN
	BEGIN

		INSERT pangya.pangya_character_information(
			pangya.pangya_character_information.UID, 
			pangya.pangya_character_information.typeid, 
			pangya.pangya_character_information.parts_1, 
			pangya.pangya_character_information.parts_2, 
			pangya.pangya_character_information.parts_3, 
			pangya.pangya_character_information.parts_4, 
			pangya.pangya_character_information.parts_5, 
			pangya.pangya_character_information.parts_6, 
			pangya.pangya_character_information.parts_7, 
			pangya.pangya_character_information.parts_8, 
			pangya.pangya_character_information.parts_9, 
			pangya.pangya_character_information.parts_10, 
			pangya.pangya_character_information.parts_11, 
			pangya.pangya_character_information.parts_12, 
			pangya.pangya_character_information.parts_13, 
			pangya.pangya_character_information.parts_14, 
			pangya.pangya_character_information.parts_15, 
			pangya.pangya_character_information.parts_16, 
			pangya.pangya_character_information.parts_17, 
			pangya.pangya_character_information.parts_18, 
			pangya.pangya_character_information.parts_19, 
			pangya.pangya_character_information.parts_20, 
			pangya.pangya_character_information.parts_21, 
			pangya.pangya_character_information.parts_22, 
			pangya.pangya_character_information.parts_23, 
			pangya.pangya_character_information.parts_24, 
			pangya.pangya_character_information.default_hair, 
			pangya.pangya_character_information.default_shirts, 
			pangya.pangya_character_information.gift_flag, 
			pangya.pangya_character_information.PCL0, 
			pangya.pangya_character_information.PCL1, 
			pangya.pangya_character_information.PCL2, 
			pangya.pangya_character_information.PCL3, 
			pangya.pangya_character_information.PCL4, 
			pangya.pangya_character_information.Purchase, 
			pangya.pangya_character_information.auxparts_1, 
			pangya.pangya_character_information.auxparts_2, 
			pangya.pangya_character_information.auxparts_3, 
			pangya.pangya_character_information.auxparts_4, 
			pangya.pangya_character_information.auxparts_5, 
			pangya.pangya_character_information.Mastery)
		VALUES (
			__IDUSER, 
			__CHARTYPE, 
			135005184, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0);

		UPDATE pangya.pangya_character_information
			SET 
				parts_2 = 135013376
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_3 = 135021568
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_4 = 135029760
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_5 = 135037952
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;
        
		UPDATE pangya.pangya_character_information
			SET 
				parts_6 = 135046144
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_7 = 135054336
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_8 = 135062528
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	END;
	ELSEIF __CHAR_TYPE = 4 THEN
	BEGIN

		INSERT pangya.pangya_character_information(
			pangya.pangya_character_information.UID, 
			pangya.pangya_character_information.typeid, 
			pangya.pangya_character_information.parts_1, 
			pangya.pangya_character_information.parts_2, 
			pangya.pangya_character_information.parts_3, 
			pangya.pangya_character_information.parts_4, 
			pangya.pangya_character_information.parts_5, 
			pangya.pangya_character_information.parts_6, 
			pangya.pangya_character_information.parts_7, 
			pangya.pangya_character_information.parts_8, 
			pangya.pangya_character_information.parts_9, 
			pangya.pangya_character_information.parts_10, 
			pangya.pangya_character_information.parts_11, 
			pangya.pangya_character_information.parts_12, 
			pangya.pangya_character_information.parts_13, 
			pangya.pangya_character_information.parts_14, 
			pangya.pangya_character_information.parts_15, 
			pangya.pangya_character_information.parts_16, 
			pangya.pangya_character_information.parts_17, 
			pangya.pangya_character_information.parts_18, 
			pangya.pangya_character_information.parts_19, 
			pangya.pangya_character_information.parts_20, 
			pangya.pangya_character_information.parts_21, 
			pangya.pangya_character_information.parts_22, 
			pangya.pangya_character_information.parts_23, 
			pangya.pangya_character_information.parts_24, 
			pangya.pangya_character_information.default_hair, 
			pangya.pangya_character_information.default_shirts, 
			pangya.pangya_character_information.gift_flag, 
			pangya.pangya_character_information.PCL0, 
			pangya.pangya_character_information.PCL1, 
			pangya.pangya_character_information.PCL2, 
			pangya.pangya_character_information.PCL3, 
			pangya.pangya_character_information.PCL4, 
			pangya.pangya_character_information.Purchase, 
			pangya.pangya_character_information.auxparts_1, 
			pangya.pangya_character_information.auxparts_2, 
			pangya.pangya_character_information.auxparts_3, 
			pangya.pangya_character_information.auxparts_4, 
			pangya.pangya_character_information.auxparts_5, 
			pangya.pangya_character_information.Mastery)
		VALUES (
			__IDUSER, 
			__CHARTYPE, 
			135267328, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0);

		UPDATE pangya.pangya_character_information
			SET 
				parts_2 = 135275520
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_3 = 135283712
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_4 = 135291904
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_5 = 135300096
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_6 = 135308288
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	END;
	ELSEIF __CHAR_TYPE = 5 THEN
	BEGIN

		INSERT pangya.pangya_character_information(
			pangya.pangya_character_information.UID, 
			pangya.pangya_character_information.typeid, 
			pangya.pangya_character_information.parts_1, 
			pangya.pangya_character_information.parts_2, 
			pangya.pangya_character_information.parts_3, 
			pangya.pangya_character_information.parts_4, 
			pangya.pangya_character_information.parts_5, 
			pangya.pangya_character_information.parts_6, 
			pangya.pangya_character_information.parts_7, 
			pangya.pangya_character_information.parts_8, 
			pangya.pangya_character_information.parts_9, 
			pangya.pangya_character_information.parts_10, 
			pangya.pangya_character_information.parts_11, 
			pangya.pangya_character_information.parts_12, 
			pangya.pangya_character_information.parts_13, 
			pangya.pangya_character_information.parts_14, 
			pangya.pangya_character_information.parts_15, 
			pangya.pangya_character_information.parts_16, 
			pangya.pangya_character_information.parts_17, 
			pangya.pangya_character_information.parts_18, 
			pangya.pangya_character_information.parts_19, 
			pangya.pangya_character_information.parts_20, 
			pangya.pangya_character_information.parts_21, 
			pangya.pangya_character_information.parts_22, 
			pangya.pangya_character_information.parts_23, 
			pangya.pangya_character_information.parts_24, 
			pangya.pangya_character_information.default_hair, 
			pangya.pangya_character_information.default_shirts, 
			pangya.pangya_character_information.gift_flag, 
			pangya.pangya_character_information.PCL0, 
			pangya.pangya_character_information.PCL1, 
			pangya.pangya_character_information.PCL2, 
			pangya.pangya_character_information.PCL3, 
			pangya.pangya_character_information.PCL4, 
			pangya.pangya_character_information.Purchase, 
			pangya.pangya_character_information.auxparts_1, 
			pangya.pangya_character_information.auxparts_2, 
			pangya.pangya_character_information.auxparts_3, 
			pangya.pangya_character_information.auxparts_4, 
			pangya.pangya_character_information.auxparts_5, 
			pangya.pangya_character_information.Mastery)
		VALUES (
			__IDUSER, 
			__CHARTYPE, 
			135529472, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0);

		UPDATE pangya.pangya_character_information
			SET 
				parts_2 = 135537664
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_3 = 135545856
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_4 = 135554048
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_5 = 135562240
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_6 = 135570432
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_7 = 135578624
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_8 = 135586816
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	END;
	ELSEIF __CHAR_TYPE = 6 THEN
	BEGIN

		INSERT pangya.pangya_character_information(
			pangya.pangya_character_information.UID, 
			pangya.pangya_character_information.typeid, 
			pangya.pangya_character_information.parts_1, 
			pangya.pangya_character_information.parts_2, 
			pangya.pangya_character_information.parts_3, 
			pangya.pangya_character_information.parts_4, 
			pangya.pangya_character_information.parts_5, 
			pangya.pangya_character_information.parts_6, 
			pangya.pangya_character_information.parts_7, 
			pangya.pangya_character_information.parts_8, 
			pangya.pangya_character_information.parts_9, 
			pangya.pangya_character_information.parts_10, 
			pangya.pangya_character_information.parts_11, 
			pangya.pangya_character_information.parts_12, 
			pangya.pangya_character_information.parts_13, 
			pangya.pangya_character_information.parts_14, 
			pangya.pangya_character_information.parts_15, 
			pangya.pangya_character_information.parts_16, 
			pangya.pangya_character_information.parts_17, 
			pangya.pangya_character_information.parts_18, 
			pangya.pangya_character_information.parts_19, 
			pangya.pangya_character_information.parts_20, 
			pangya.pangya_character_information.parts_21, 
			pangya.pangya_character_information.parts_22, 
			pangya.pangya_character_information.parts_23, 
			pangya.pangya_character_information.parts_24, 
			pangya.pangya_character_information.default_hair, 
			pangya.pangya_character_information.default_shirts, 
			pangya.pangya_character_information.gift_flag, 
			pangya.pangya_character_information.PCL0, 
			pangya.pangya_character_information.PCL1, 
			pangya.pangya_character_information.PCL2, 
			pangya.pangya_character_information.PCL3, 
			pangya.pangya_character_information.PCL4, 
			pangya.pangya_character_information.Purchase, 
			pangya.pangya_character_information.auxparts_1, 
			pangya.pangya_character_information.auxparts_2, 
			pangya.pangya_character_information.auxparts_3, 
			pangya.pangya_character_information.auxparts_4, 
			pangya.pangya_character_information.auxparts_5, 
			pangya.pangya_character_information.Mastery)
		VALUES (
			__IDUSER, 
			__CHARTYPE, 
			135791616, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0);

		UPDATE pangya.pangya_character_information
			SET 
				parts_2 = 135799808
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_3 = 135808000
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_4 = 135816192
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_5 = 135824384
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_6 = 135832576
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_7 = 135840768
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	END;
	ELSEIF __CHAR_TYPE = 7 THEN
	BEGIN

		INSERT pangya.pangya_character_information(
			pangya.pangya_character_information.UID, 
			pangya.pangya_character_information.typeid, 
			pangya.pangya_character_information.parts_1, 
			pangya.pangya_character_information.parts_2, 
			pangya.pangya_character_information.parts_3, 
			pangya.pangya_character_information.parts_4, 
			pangya.pangya_character_information.parts_5, 
			pangya.pangya_character_information.parts_6, 
			pangya.pangya_character_information.parts_7, 
			pangya.pangya_character_information.parts_8, 
			pangya.pangya_character_information.parts_9, 
			pangya.pangya_character_information.parts_10, 
			pangya.pangya_character_information.parts_11, 
			pangya.pangya_character_information.parts_12, 
			pangya.pangya_character_information.parts_13, 
			pangya.pangya_character_information.parts_14, 
			pangya.pangya_character_information.parts_15, 
			pangya.pangya_character_information.parts_16, 
			pangya.pangya_character_information.parts_17, 
			pangya.pangya_character_information.parts_18, 
			pangya.pangya_character_information.parts_19, 
			pangya.pangya_character_information.parts_20, 
			pangya.pangya_character_information.parts_21, 
			pangya.pangya_character_information.parts_22, 
			pangya.pangya_character_information.parts_23, 
			pangya.pangya_character_information.parts_24, 
			pangya.pangya_character_information.default_hair, 
			pangya.pangya_character_information.default_shirts, 
			pangya.pangya_character_information.gift_flag, 
			pangya.pangya_character_information.PCL0, 
			pangya.pangya_character_information.PCL1, 
			pangya.pangya_character_information.PCL2, 
			pangya.pangya_character_information.PCL3, 
			pangya.pangya_character_information.PCL4, 
			pangya.pangya_character_information.Purchase, 
			pangya.pangya_character_information.auxparts_1, 
			pangya.pangya_character_information.auxparts_2, 
			pangya.pangya_character_information.auxparts_3, 
			pangya.pangya_character_information.auxparts_4, 
			pangya.pangya_character_information.auxparts_5, 
			pangya.pangya_character_information.Mastery)
		VALUES (
			__IDUSER, 
			__CHARTYPE, 
			136053760, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0);

		UPDATE pangya.pangya_character_information
			SET 
				parts_2 = 136061952
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_3 = 136070144
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_4 = 136078336
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_5 = 136086528
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_6 = 136094720
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_7 = 136102912
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_8 = 136111104
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_9 = 136119296
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	END;
	ELSEIF __CHAR_TYPE = 8 THEN
	BEGIN

		INSERT pangya.pangya_character_information(
			pangya.pangya_character_information.UID, 
			pangya.pangya_character_information.typeid, 
			pangya.pangya_character_information.parts_1, 
			pangya.pangya_character_information.parts_2, 
			pangya.pangya_character_information.parts_3, 
			pangya.pangya_character_information.parts_4, 
			pangya.pangya_character_information.parts_5, 
			pangya.pangya_character_information.parts_6, 
			pangya.pangya_character_information.parts_7, 
			pangya.pangya_character_information.parts_8, 
			pangya.pangya_character_information.parts_9, 
			pangya.pangya_character_information.parts_10, 
			pangya.pangya_character_information.parts_11, 
			pangya.pangya_character_information.parts_12, 
			pangya.pangya_character_information.parts_13, 
			pangya.pangya_character_information.parts_14, 
			pangya.pangya_character_information.parts_15, 
			pangya.pangya_character_information.parts_16, 
			pangya.pangya_character_information.parts_17, 
			pangya.pangya_character_information.parts_18, 
			pangya.pangya_character_information.parts_19, 
			pangya.pangya_character_information.parts_20, 
			pangya.pangya_character_information.parts_21, 
			pangya.pangya_character_information.parts_22, 
			pangya.pangya_character_information.parts_23, 
			pangya.pangya_character_information.parts_24, 
			pangya.pangya_character_information.default_hair, 
			pangya.pangya_character_information.default_shirts, 
			pangya.pangya_character_information.gift_flag, 
			pangya.pangya_character_information.PCL0, 
			pangya.pangya_character_information.PCL1, 
			pangya.pangya_character_information.PCL2, 
			pangya.pangya_character_information.PCL3, 
			pangya.pangya_character_information.PCL4, 
			pangya.pangya_character_information.Purchase, 
			pangya.pangya_character_information.auxparts_1, 
			pangya.pangya_character_information.auxparts_2, 
			pangya.pangya_character_information.auxparts_3, 
			pangya.pangya_character_information.auxparts_4, 
			pangya.pangya_character_information.auxparts_5, 
			pangya.pangya_character_information.Mastery)
		VALUES (
			__IDUSER, 
			__CHARTYPE, 
			136315904, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0);

		UPDATE pangya.pangya_character_information
			SET 
				parts_2 = 136324096
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_3 = 136332288
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_4 = 136340480
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_5 = 136348672
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;
        
		UPDATE pangya.pangya_character_information
			SET 
				parts_6 = 136356864
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_7 = 136365056
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_8 = 136373248
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	END;
	ELSEIF __CHAR_TYPE = 9 THEN
	BEGIN

		INSERT pangya.pangya_character_information(
			pangya.pangya_character_information.UID, 
			pangya.pangya_character_information.typeid, 
			pangya.pangya_character_information.parts_1, 
			pangya.pangya_character_information.parts_2, 
			pangya.pangya_character_information.parts_3, 
			pangya.pangya_character_information.parts_4, 
			pangya.pangya_character_information.parts_5, 
			pangya.pangya_character_information.parts_6, 
			pangya.pangya_character_information.parts_7, 
			pangya.pangya_character_information.parts_8, 
			pangya.pangya_character_information.parts_9, 
			pangya.pangya_character_information.parts_10, 
			pangya.pangya_character_information.parts_11, 
			pangya.pangya_character_information.parts_12, 
			pangya.pangya_character_information.parts_13, 
			pangya.pangya_character_information.parts_14, 
			pangya.pangya_character_information.parts_15, 
			pangya.pangya_character_information.parts_16, 
			pangya.pangya_character_information.parts_17, 
			pangya.pangya_character_information.parts_18, 
			pangya.pangya_character_information.parts_19, 
			pangya.pangya_character_information.parts_20, 
			pangya.pangya_character_information.parts_21, 
			pangya.pangya_character_information.parts_22, 
			pangya.pangya_character_information.parts_23, 
			pangya.pangya_character_information.parts_24, 
			pangya.pangya_character_information.default_hair, 
			pangya.pangya_character_information.default_shirts, 
			pangya.pangya_character_information.gift_flag, 
			pangya.pangya_character_information.PCL0, 
			pangya.pangya_character_information.PCL1, 
			pangya.pangya_character_information.PCL2, 
			pangya.pangya_character_information.PCL3, 
			pangya.pangya_character_information.PCL4, 
			pangya.pangya_character_information.Purchase, 
			pangya.pangya_character_information.auxparts_1, 
			pangya.pangya_character_information.auxparts_2, 
			pangya.pangya_character_information.auxparts_3, 
			pangya.pangya_character_information.auxparts_4, 
			pangya.pangya_character_information.auxparts_5, 
			pangya.pangya_character_information.Mastery)
		VALUES (
			__IDUSER, 
			__CHARTYPE, 
			136578048, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0);

		UPDATE pangya.pangya_character_information
			SET 
				parts_2 = 136586240
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_3 = 136594432
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_4 = 136602624
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_5 = 136610816
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_6 = 136619008
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_7 = 136627200
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_8 = 136635392
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	END;
	ELSEIF __CHAR_TYPE = 10 THEN
	BEGIN

		INSERT pangya.pangya_character_information(
			pangya.pangya_character_information.UID, 
			pangya.pangya_character_information.typeid, 
			pangya.pangya_character_information.parts_1, 
			pangya.pangya_character_information.parts_2, 
			pangya.pangya_character_information.parts_3, 
			pangya.pangya_character_information.parts_4, 
			pangya.pangya_character_information.parts_5, 
			pangya.pangya_character_information.parts_6, 
			pangya.pangya_character_information.parts_7, 
			pangya.pangya_character_information.parts_8, 
			pangya.pangya_character_information.parts_9, 
			pangya.pangya_character_information.parts_10, 
			pangya.pangya_character_information.parts_11, 
			pangya.pangya_character_information.parts_12, 
			pangya.pangya_character_information.parts_13, 
			pangya.pangya_character_information.parts_14, 
			pangya.pangya_character_information.parts_15, 
			pangya.pangya_character_information.parts_16, 
			pangya.pangya_character_information.parts_17, 
			pangya.pangya_character_information.parts_18, 
			pangya.pangya_character_information.parts_19, 
			pangya.pangya_character_information.parts_20, 
			pangya.pangya_character_information.parts_21, 
			pangya.pangya_character_information.parts_22, 
			pangya.pangya_character_information.parts_23, 
			pangya.pangya_character_information.parts_24, 
			pangya.pangya_character_information.default_hair, 
			pangya.pangya_character_information.default_shirts, 
			pangya.pangya_character_information.gift_flag, 
			pangya.pangya_character_information.PCL0, 
			pangya.pangya_character_information.PCL1, 
			pangya.pangya_character_information.PCL2, 
			pangya.pangya_character_information.PCL3, 
			pangya.pangya_character_information.PCL4, 
			pangya.pangya_character_information.Purchase, 
			pangya.pangya_character_information.auxparts_1, 
			pangya.pangya_character_information.auxparts_2, 
			pangya.pangya_character_information.auxparts_3, 
			pangya.pangya_character_information.auxparts_4, 
			pangya.pangya_character_information.auxparts_5, 
			pangya.pangya_character_information.Mastery)
		VALUES (
			__IDUSER, 
			__CHARTYPE, 
			136840192, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0);

		UPDATE pangya.pangya_character_information
			SET 
				parts_2 = 136848384
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_3 = 136856576
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_4 = 136864768
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_5 = 136872960
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_6 = 136881152
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_7 = 136889344
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_8 = 136897536
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	END;
	ELSEIF __CHAR_TYPE = 11 THEN
	BEGIN

		INSERT pangya.pangya_character_information(
			pangya.pangya_character_information.UID, 
			pangya.pangya_character_information.typeid, 
			pangya.pangya_character_information.parts_1, 
			pangya.pangya_character_information.parts_2, 
			pangya.pangya_character_information.parts_3, 
			pangya.pangya_character_information.parts_4, 
			pangya.pangya_character_information.parts_5, 
			pangya.pangya_character_information.parts_6, 
			pangya.pangya_character_information.parts_7, 
			pangya.pangya_character_information.parts_8, 
			pangya.pangya_character_information.parts_9, 
			pangya.pangya_character_information.parts_10, 
			pangya.pangya_character_information.parts_11, 
			pangya.pangya_character_information.parts_12, 
			pangya.pangya_character_information.parts_13, 
			pangya.pangya_character_information.parts_14, 
			pangya.pangya_character_information.parts_15, 
			pangya.pangya_character_information.parts_16, 
			pangya.pangya_character_information.parts_17, 
			pangya.pangya_character_information.parts_18, 
			pangya.pangya_character_information.parts_19, 
			pangya.pangya_character_information.parts_20, 
			pangya.pangya_character_information.parts_21, 
			pangya.pangya_character_information.parts_22, 
			pangya.pangya_character_information.parts_23, 
			pangya.pangya_character_information.parts_24, 
			pangya.pangya_character_information.default_hair, 
			pangya.pangya_character_information.default_shirts, 
			pangya.pangya_character_information.gift_flag, 
			pangya.pangya_character_information.PCL0, 
			pangya.pangya_character_information.PCL1, 
			pangya.pangya_character_information.PCL2, 
			pangya.pangya_character_information.PCL3, 
			pangya.pangya_character_information.PCL4, 
			pangya.pangya_character_information.Purchase, 
			pangya.pangya_character_information.auxparts_1, 
			pangya.pangya_character_information.auxparts_2, 
			pangya.pangya_character_information.auxparts_3, 
			pangya.pangya_character_information.auxparts_4, 
			pangya.pangya_character_information.auxparts_5, 
			pangya.pangya_character_information.Mastery)
		VALUES (
			__IDUSER, 
			__CHARTYPE, 
			137102336, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0);

		UPDATE pangya.pangya_character_information
			SET 
				parts_2 = 137110528
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_3 = 137118720
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_4 = 137126912
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_5 = 137135104
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_6 = 137143296
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_7 = 137151488
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_8 = 137159680
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	END;
	ELSEIF __CHAR_TYPE = 12 THEN
	BEGIN

		INSERT pangya.pangya_character_information(
			pangya.pangya_character_information.UID, 
			pangya.pangya_character_information.typeid, 
			pangya.pangya_character_information.parts_1, 
			pangya.pangya_character_information.parts_2, 
			pangya.pangya_character_information.parts_3, 
			pangya.pangya_character_information.parts_4, 
			pangya.pangya_character_information.parts_5, 
			pangya.pangya_character_information.parts_6, 
			pangya.pangya_character_information.parts_7, 
			pangya.pangya_character_information.parts_8, 
			pangya.pangya_character_information.parts_9, 
			pangya.pangya_character_information.parts_10, 
			pangya.pangya_character_information.parts_11, 
			pangya.pangya_character_information.parts_12, 
			pangya.pangya_character_information.parts_13, 
			pangya.pangya_character_information.parts_14, 
			pangya.pangya_character_information.parts_15, 
			pangya.pangya_character_information.parts_16, 
			pangya.pangya_character_information.parts_17, 
			pangya.pangya_character_information.parts_18, 
			pangya.pangya_character_information.parts_19, 
			pangya.pangya_character_information.parts_20, 
			pangya.pangya_character_information.parts_21, 
			pangya.pangya_character_information.parts_22, 
			pangya.pangya_character_information.parts_23, 
			pangya.pangya_character_information.parts_24, 
			pangya.pangya_character_information.default_hair, 
			pangya.pangya_character_information.default_shirts, 
			pangya.pangya_character_information.gift_flag, 
			pangya.pangya_character_information.PCL0, 
			pangya.pangya_character_information.PCL1, 
			pangya.pangya_character_information.PCL2, 
			pangya.pangya_character_information.PCL3, 
			pangya.pangya_character_information.PCL4, 
			pangya.pangya_character_information.Purchase, 
			pangya.pangya_character_information.auxparts_1, 
			pangya.pangya_character_information.auxparts_2, 
			pangya.pangya_character_information.auxparts_3, 
			pangya.pangya_character_information.auxparts_4, 
			pangya.pangya_character_information.auxparts_5, 
			pangya.pangya_character_information.Mastery)
		VALUES (
			__IDUSER, 
			__CHARTYPE, 
			137364480, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0);

		UPDATE pangya.pangya_character_information
			SET 
				parts_2 = 137372672
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_3 = 137380864
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_4 = 137389056
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_5 = 137397248
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_6 = 137405440
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_7 = 137413632
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_8 = 137421824
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	END;
	ELSEIF __CHAR_TYPE = 14 THEN
	BEGIN

		INSERT pangya.pangya_character_information(
			pangya.pangya_character_information.UID, 
			pangya.pangya_character_information.typeid, 
			pangya.pangya_character_information.parts_1, 
			pangya.pangya_character_information.parts_2, 
			pangya.pangya_character_information.parts_3, 
			pangya.pangya_character_information.parts_4, 
			pangya.pangya_character_information.parts_5, 
			pangya.pangya_character_information.parts_6, 
			pangya.pangya_character_information.parts_7, 
			pangya.pangya_character_information.parts_8, 
			pangya.pangya_character_information.parts_9, 
			pangya.pangya_character_information.parts_10, 
			pangya.pangya_character_information.parts_11, 
			pangya.pangya_character_information.parts_12, 
			pangya.pangya_character_information.parts_13, 
			pangya.pangya_character_information.parts_14, 
			pangya.pangya_character_information.parts_15, 
			pangya.pangya_character_information.parts_16, 
			pangya.pangya_character_information.parts_17, 
			pangya.pangya_character_information.parts_18, 
			pangya.pangya_character_information.parts_19, 
			pangya.pangya_character_information.parts_20, 
			pangya.pangya_character_information.parts_21, 
			pangya.pangya_character_information.parts_22, 
			pangya.pangya_character_information.parts_23, 
			pangya.pangya_character_information.parts_24, 
			pangya.pangya_character_information.default_hair, 
			pangya.pangya_character_information.default_shirts, 
			pangya.pangya_character_information.gift_flag, 
			pangya.pangya_character_information.PCL0, 
			pangya.pangya_character_information.PCL1, 
			pangya.pangya_character_information.PCL2, 
			pangya.pangya_character_information.PCL3, 
			pangya.pangya_character_information.PCL4, 
			pangya.pangya_character_information.Purchase, 
			pangya.pangya_character_information.auxparts_1, 
			pangya.pangya_character_information.auxparts_2, 
			pangya.pangya_character_information.auxparts_3, 
			pangya.pangya_character_information.auxparts_4, 
			pangya.pangya_character_information.auxparts_5, 
			pangya.pangya_character_information.Mastery)
		VALUES (
			__IDUSER, 
			__CHARTYPE, 
			137888768, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0);

		UPDATE pangya.pangya_character_information
			SET 
				parts_2 = 137896960
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_3 = 137905152
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_4 = 137913344
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_5 = 137921536
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_6 = 137929728
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_7 = 137937920
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

		UPDATE pangya.pangya_character_information
			SET 
				parts_8 = 137946112
		WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	END;
    END IF;

	UPDATE pangya.pangya_character_information
		SET 
			default_shirts = __shirts
	WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;

	UPDATE pangya.pangya_character_information
		SET 
			default_hair = __hairs
	WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.typeid = __CHARTYPE;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `GeraRankAll` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `GeraRankAll`(
)
BEGIN
    	
	DECLARE __CHECK BIGINT;
	
	-- Table variável
	DROP TEMPORARY TABLE IF EXISTS __tabRank;
	CREATE TEMPORARY TABLE __tabRank
	(
		`index` BIGINT NOT NULL DEFAULT 0,
		`UID` INT NOT NULL DEFAULT 0,
		`valor` INT NOT NULL DEFAULT 0
	);

	-- Table RANK temp
	DROP TEMPORARY TABLE IF EXISTS __tabRankTmp;
	CREATE TEMPORARY TABLE __tabRankTmp
	(
		`index` BIGINT NOT NULL AUTO_INCREMENT,
		`position` INT NOT NULL DEFAULT 0,
		`UID` INT NOT NULL DEFAULT 0,
		`tipo_rank` SMALLINT NOT NULL DEFAULT 0,
		`tipo_rank_seq` SMALLINT NOT NULL DEFAULT 0,
		`valor` INT NOT NULL DEFAULT 0,
        KEY(`index`)
	);
	
	SET @row_number = 0;
        
    /*
    *    Info do rank normal - 0
    *    Dados Gerais 0
    *    Score 1 - (50 - (Score)) * 1 * Estrela
    */
    INSERT INTO __tabRank (`index`, `UID`, `valor`)
	SELECT
		(@row_number := @row_number + 1) AS `index`,
		X.`UID`,
		X.`Score`
	FROM
	(
		SELECT
			`UID`, 
			(B.Score_1 + B.Score_2 + B.Score_3 + B.Score_4 + B.Score_5 + B.Score_7 + B.Score_8 + B.Score_9 + B.Score_10 + B.Score_11 + B.Score_12 + B.Score_13 + B.Score_14 + B.Score_15 + B.Score_16 + B.Score_17 + B.Score_18 + B.Score_19 + B.Score_20) AS Score
		FROM 
		(
			SELECT 
				A.`uid`, 
				MAX(CASE WHEN A.course = 0 THEN (50 - A.Score_1) * 10 ELSE 50 END) AS Score_1, 
				MAX(CASE WHEN A.course = 5 THEN (50 - A.Score_1) * 10 ELSE 50 END) AS Score_2, 
				MAX(CASE WHEN A.course = 11 THEN (50 - A.Score_1) * 10 ELSE 50 END) AS Score_3, 
				MAX(CASE WHEN A.course = 14 THEN (50 - A.Score_1) * 10 ELSE 50 END) AS Score_4, 
				MAX(CASE WHEN A.course = 15 THEN (50 - A.Score_1) * 10 ELSE 50 END) AS Score_5, 
				MAX(CASE WHEN A.course = 8 THEN (50 - A.Score_1) * 20 ELSE 50 END) AS Score_6, 
				MAX(CASE WHEN A.course = 10 THEN (50 - A.Score_1) * 20 ELSE 50 END) AS Score_7, 
				MAX(CASE WHEN A.course = 16 THEN (50 - A.Score_1) * 20 ELSE 50 END) AS Score_8, 
				MAX(CASE WHEN A.course = 19 THEN (50 - A.Score_1) * 20 ELSE 50 END) AS Score_9, 
				MAX(CASE WHEN A.course = 20 THEN (50 - A.Score_1) * 20 ELSE 50 END) AS Score_10, 
				MAX(CASE WHEN A.course = 1 THEN (50 - A.Score_1) * 30 ELSE 50 END) AS Score_11, 
				MAX(CASE WHEN A.course = 2 THEN (50 - A.Score_1) * 30 ELSE 50 END) AS Score_12, 
				MAX(CASE WHEN A.course = 6 THEN (50 - A.Score_1) * 30 ELSE 50 END) AS Score_13, 
				MAX(CASE WHEN A.course = 9 THEN (50 - A.Score_1) * 30 ELSE 50 END) AS Score_14, 
				MAX(CASE WHEN A.course = 21 THEN (50 - A.Score_1) * 30 ELSE 50 END) AS Score_15, 
				MAX(CASE WHEN A.course = 4 THEN (50 - A.Score_1) * 40 ELSE 50 END) AS Score_16, 
				MAX(CASE WHEN A.course = 7 THEN (50 - A.Score_1) * 40 ELSE 50 END) AS Score_17, 
				MAX(CASE WHEN A.course = 18 THEN (50 - A.Score_1) * 40 ELSE 50 END) AS Score_18, 
				MAX(CASE WHEN A.course = 3 THEN (50 - A.Score_1) * 50 ELSE 50 END) AS Score_19, 
				MAX(CASE WHEN A.course = 13 THEN (50 - A.Score_1) * 50 ELSE 50 END) AS Score_20
			FROM 
			(
				SELECT 
					f.course, 
					f.`uid`, 
					f.best_score AS Score_1
				FROM 
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
				WHERE 
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND best_score != 127 /*AND assist = 0*/ AND tipo IN(0, 51, 52) -- Normal, Natural e Grand Prix, soma todos
			) AS A
			GROUP BY A.`uid`
		) AS B
	) X
	ORDER BY X.Score DESC, X.`UID`;

	-- Insert Score
    INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 0, 1, `valor` FROM __tabRank;

	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;

	/* 
	* Trofeu 2 
	*/ 
	INSERT  INTO __tabRank(`index`, `uid`, valor)
	SELECT
		(@row_number := @row_number + 1) AS `index`,
		C.`UID`,
		C.SOMA
	FROM 
	(
		SELECT 
			a.`uid`,
			(a.AMA_6_G * 3 * 1) + (a.AMA_6_S * 2 * 1) + (a.AMA_6_B * 1 * 1) + (a.AMA_5_G * 3 * 1) + (a.AMA_5_S * 2 * 1) + (a.AMA_5_B * 1 * 1) + (a.AMA_4_G * 3 * 1) + (a.AMA_4_S * 2 * 1) + (a.AMA_4_B * 1 * 1) + (a.AMA_3_G * 3 * 2) + (a.AMA_3_S * 2 * 2) + (a.AMA_3_B * 1 * 2) + (a.AMA_2_G * 3 * 2) + (a.AMA_2_S * 2 * 2) + (a.AMA_2_B * 1 * 2) + (a.AMA_1_G * 3 * 2) + (a.AMA_1_S * 2 * 2) + (a.AMA_1_B * 1 * 2) + (a.PRO_1_G * 3 * 3) + (a.PRO_1_S * 2 * 3) + (a.PRO_1_B * 1 * 3) + (a.PRO_2_G * 3 * 3) + (a.PRO_2_S * 2 * 3) + (a.PRO_2_B * 1 * 3) + (a.PRO_3_G * 3 * 3) + (a.PRO_3_S * 2 * 3) + (a.PRO_3_B * 1 * 3) + (a.PRO_4_G * 3 * 4) + (a.PRO_4_S * 2 * 4) + (a.PRO_4_B * 1 * 4) + (a.PRO_5_G * 3 * 4) + (a.PRO_5_S * 2 * 4) + (a.PRO_5_B * 1 * 4) + (a.PRO_6_G * 3 * 4) + (a.PRO_6_S * 2 * 4) + (a.PRO_6_B * 1 * 4) + (a.PRO_7_G * 3 * 5) + (a.PRO_7_S * 2 * 5) + (a.PRO_7_B * 1 * 5) AS SOMA
		FROM 
			pangya.trofel_stat AS A
			INNER JOIN
			pangya.account AS B
			ON A.`UID` = B.`UID`
		WHERE (B.first_login + B.first_set) = 2
	) AS C
	ORDER BY C.SOMA DESC, C.`uid`;

	-- Insert Trofeu 2
    INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 0, 2, `valor` FROM __tabRank;

	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;
     
	/*
	*    Total Pangs ganho em jogo 3 - Pangs / 1000
	*    Aqui estou usando o do pang total, mas tem que criar outra
	*/ 
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT 
		(@row_number := @row_number + 1) AS `index`,
		B.`UID`,
		B.pangs
	FROM 
	(
		SELECT 
			a.`uid`, 
			floor(a.total_pang_win_game / 1000) AS pangs
		FROM 
			pangya.user_info AS a
			INNER JOIN
			pangya.account AS b
			ON a.`uid` = b.`UID`
		WHERE
			(b.first_login + b.first_set) = 2
	)  B
	ORDER BY b.pangs DESC, b.`uid`;

	-- Insert Total Pangs 3
    INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 0, 3, `valor` FROM __tabRank;

	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;

	/* 
	* Holes 4 - (Holes - Holein) / 18
	*/ 
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT 
		(@row_number := @row_number + 1) AS `index`,
		B.`UID`,
		B.holes
	FROM 
	(
		SELECT 
			a.`uid`, 
			floor((a.holes - a.holein) / 18) AS holes
		FROM 
			pangya.user_info a
			INNER JOIN
			pangya.account  b
			ON a.`UID` = b.`UID`
		WHERE
			(b.first_login + b.first_set) = 2
	) B
	ORDER BY b.holes DESC, b.`uid`;

	-- Insert Total Holes 4
    INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 0, 4, `valor` FROM __tabRank;

	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;
     
	/* 
	* Achievement Pontos 5
	*/ 
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT 
		(@row_number := @row_number + 1) AS `index`,
		B.`UID`,
		B.pontos
	FROM 
	(
		SELECT
			a.`UID`,
			IFNULL(X.pontos, 0) AS `pontos`
		FROM
			pangya.account a
			LEFT OUTER JOIN
		(
			SELECT
				b.`UID`,
				IFNULL(count(b.`uid`), 0) * 10 AS `pontos`
			FROM
				pangya.pangya_achievement b
				LEFT OUTER JOIN
				pangya.pangya_quest c
				ON b.ID_ACHIEVEMENT = c.achievement_id
			WHERE 
				c.`Date` IS NOT NULL
			GROUP BY b.`UID`
		) X
		ON a.`UID` = X.`UID`
		WHERE (a.FIRST_LOGIN + a.FIRST_SET) = 2
	)  B
	ORDER BY b.pontos DESC, b.`uid`;

	-- Insert Total Achievements Points 5
    INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 0, 5, `valor` FROM __tabRank;

	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;

	/*
	* A Soma de todos Dados Gerais 0
	*/ 
	INSERT  INTO __tabRank(`index`, `UID`, valor)
	SELECT 
		(@row_number := @row_number + 1) AS `index`,
		A.`UID`,
		A.valor
	FROM 
	(
		SELECT 
			`uid`, 
			SUM(valor) AS valor
		FROM 
			__tabRankTmp
		WHERE 
			tipo_rank = 0
		GROUP BY `uid`
	)  A
	ORDER BY A.valor DESC;

	-- Insert Total Overall 0
    INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 0, 0, `valor` FROM __tabRank;

	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;

   /*
   *    Infos hio alba level e total_distancia - 2
   *    Tem que colocar só os que fizeram o first login e character
   *    Albatross 0
   */ 
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
		(@row_number := @row_number + 1) AS `index`,
		a.`uid`,
		a.albatross
	FROM 
		pangya.user_info a
		INNER JOIN
		pangya.account b
		ON a.`UID` = b.`UID`
	WHERE 
		(b.first_login + b.first_set) = 2
	ORDER BY a.albatross DESC, a.`uid`;

	-- Insert Total Albatross 0
    INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 2, 0, `valor` FROM __tabRank;

	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;

	/* 
	* Hole In One 1
	*/ 
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
		(@row_number := @row_number + 1) AS `index`,
		a.`uid`,
		a.hio
	FROM 
		pangya.user_info a
		INNER JOIN
		pangya.account b
		ON a.`UID` = b.`UID`
	WHERE 
		(b.first_login + b.first_set) = 2
	ORDER BY a.hio DESC, a.`uid`;

	-- Insert Total HIO 1
    INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 2, 1, `valor` FROM __tabRank;

	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;

	/*
	* Level 3
	*/ 
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
		(@row_number := @row_number + 1) AS `index`,
		a.`uid`, 
		a.`level`
	FROM 
		pangya.user_info a
		INNER JOIN
		pangya.account b
		ON a.`UID` = b.`UID`
	WHERE 
		(b.first_login + b.first_set) = 2
	ORDER BY 
		a.`level` DESC, a.xp DESC, a.`uid`;

	-- Insert Total Level 3
    INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 2, 3, `valor` FROM __tabRank;

	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;

	/*
	* Total distancia 4 - o PangYa faz a divisão por 10k sozinho
	*/ 
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
		(@row_number := @row_number + 1) AS `index`,
		a.`uid`,
		a.total_distancia
	FROM 
		pangya.user_info a
		INNER JOIN
		pangya.account b
		ON a.`UID` = b.`UID`
	WHERE 
		(b.first_login + b.first_set) = 2
	ORDER BY a.total_distancia DESC, a.`uid`;

	-- Insert Total Distância 4
    INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 2, 4, `valor` FROM __tabRank;

	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;
   
	/*
	*       -------------- Normal --------------
	*       Nome            CODE            ESTRELA
	*       BL              0               *
	*       BW              1               ***
	*       SW              2               ***
	*       WH              3               *****
	*       WW              4               ****
	*       West            5               *
	*       BM              6               ***
	*       SC              7               ****
	*       IC              8               **
	*       WhW             9               ***
	*       SS              10              **
	*       PW              11              *
	*       DI              13              *****
	*       IS              14              *
	*       LS              15              *
	*       EV              16              **
	*       IF              18              ****
	*       WC              19              **
	*       AM              20              **
	*       MR              21              ***
	*       -----------------*------------------
	**/
	/*
	*   RECORD 1
	*   BL 0
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 0 AND f.tipo = 0
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (BL) 0
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 1, 0, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 1
	*   BW 1
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 1 AND f.tipo = 0
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (BW) 1
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 1, 1, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 1
	*   SW 2
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 2 AND f.tipo = 0
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (SW) 2
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 1, 2, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 1
	*   WH 3
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 3 AND f.tipo = 0
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (WH) 3
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 1, 3, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 1
	*   WW 4
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 4 AND f.tipo = 0
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (WW) 4
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 1, 4, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 1
	*   West 5
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 5 AND f.tipo = 0
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (West) 5
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 1, 5, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 1
	*   BM 6
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 6 AND f.tipo = 0
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (BM) 6
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 1, 6, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 1
	*   SC 7
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 7 AND f.tipo = 0
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (SC) 7
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 1, 7, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 1
	*   IC 8
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 8 AND f.tipo = 0
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (IC) 8
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 1, 8, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 1
	*   WhW 9
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 9 AND f.tipo = 0
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (WhW) 9
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 1, 9, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 1
	*   SS 10
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 10 AND f.tipo = 0
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (SS) 10
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 1, 10, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 1
	*   PW 11
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 11 AND f.tipo = 0
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (PW) 11
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 1, 11, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 1
	*   DI 13
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 13 AND f.tipo = 0
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (DI) 13
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 1, 12, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 1
	*   IS 14
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 14 AND f.tipo = 0
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (IS) 14
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 1, 13, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 1
	*   LS 15
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 15 AND f.tipo = 0
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (LS) 15
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 1, 14, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 1
	*   EV 16
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 16 AND f.tipo = 0
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (EV) 16
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 1, 15, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 1
	*   IF 18
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 18 AND f.tipo = 0
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (IF) 18
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 1, 16, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 1
	*   WC 19
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 19 AND f.tipo = 0
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (WC) 19
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 1, 17, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 1
	*   AM 20
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 20 AND f.tipo = 0
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (AM) 20
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 1, 18, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 1
	*   MR 21
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 21 AND f.tipo = 0
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (MR) 21
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 1, 19, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;




	/*
	*       -------------- Natural --------------
	*       Nome            CODE            ESTRELA
	*       BL              0               *
	*       BW              1               ***
	*       SW              2               ***
	*       WH              3               *****
	*       WW              4               ****
	*       West            5               *
	*       BM              6               ***
	*       SC              7               ****
	*       IC              8               **
	*       WhW             9               ***
	*       SS              10              **
	*       PW              11              *
	*       DI              13              *****
	*       IS              14              *
	*       LS              15              *
	*       EV              16              **
	*       IF              18              ****
	*       WC              19              **
	*       AM              20              **
	*       MR              21              ***
	*       -----------------*------------------
	**/
	/*
	*   RECORD 3
	*   BL 0
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 0 AND f.tipo = 51
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (BL) 0
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 3, 0, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 3
	*   BW 1
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 1 AND f.tipo = 51
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (BW) 1
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 3, 1, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 3
	*   SW 2
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 2 AND f.tipo = 51
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (SW) 2
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 3, 2, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 3
	*   WH 3
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 3 AND f.tipo = 51
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (WH) 3
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 3, 3, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 3
	*   WW 4
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 4 AND f.tipo = 51
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (WW) 4
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 3, 4, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 3
	*   West 5
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 5 AND f.tipo = 51
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (West) 5
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 3, 5, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 3
	*   BM 6
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 6 AND f.tipo = 51
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (BM) 6
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 3, 6, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 3
	*   SC 7
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 7 AND f.tipo = 51
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (SC) 7
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 3, 7, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 3
	*   IC 8
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 8 AND f.tipo = 51
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (IC) 8
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 3, 8, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 3
	*   WhW 9
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 9 AND f.tipo = 51
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (WhW) 9
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 3, 9, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 3
	*   SS 10
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 10 AND f.tipo = 51
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (SS) 10
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 3, 10, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 3
	*   PW 11
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 11 AND f.tipo = 51
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (PW) 11
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 3, 11, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 3
	*   DI 13
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 13 AND f.tipo = 51
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (DI) 13
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 3, 12, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 3
	*   IS 14
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 14 AND f.tipo = 51
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (IS) 14
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 3, 13, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 3
	*   LS 15
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 15 AND f.tipo = 51
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (LS) 15
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 3, 14, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 3
	*   EV 16
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 16 AND f.tipo = 51
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (EV) 16
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 3, 15, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 3
	*   IF 18
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 18 AND f.tipo = 51
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (IF) 18
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 3, 16, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 3
	*   WC 19
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 19 AND f.tipo = 51
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (WC) 19
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 3, 17, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 3
	*   AM 20
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 20 AND f.tipo = 51
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (AM) 20
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 3, 18, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 3
	*   MR 21
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 21 AND f.tipo = 51
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (MR) 21
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 3, 19, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;




	/*
	*       -------------- Grand Prix --------------
	*       Nome            CODE            ESTRELA
	*       BL              0               *
	*       BW              1               ***
	*       SW              2               ***
	*       WH              3               *****
	*       WW              4               ****
	*       West            5               *
	*       BM              6               ***
	*       SC              7               ****
	*       IC              8               **
	*       WhW             9               ***
	*       SS              10              **
	*       PW              11              *
	*       DI              13              *****
	*       IS              14              *
	*       LS              15              *
	*       EV              16              **
	*       IF              18              ****
	*       WC              19              **
	*       AM              20              **
	*       MR              21              ***
	*       -----------------*------------------
	**/
	/*
	*   RECORD 4
	*   BL 0
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 0 AND f.tipo = 52
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (BL) 0
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 4, 0, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 4
	*   BW 1
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 1 AND f.tipo = 52
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (BW) 1
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 4, 1, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 4
	*   SW 2
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 2 AND f.tipo = 52
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (SW) 2
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 4, 2, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 4
	*   WH 3
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 3 AND f.tipo = 52
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (WH) 3
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 4, 3, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 4
	*   WW 4
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 4 AND f.tipo = 52
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (WW) 4
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 4, 4, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 4
	*   West 5
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 5 AND f.tipo = 52
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (West) 5
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 4, 5, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 4
	*   BM 6
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 6 AND f.tipo = 52
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (BM) 6
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 4, 6, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 4
	*   SC 7
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 7 AND f.tipo = 52
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (SC) 7
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 4, 7, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 4
	*   IC 8
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 8 AND f.tipo = 52
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (IC) 8
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 4, 8, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 4
	*   WhW 9
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 9 AND f.tipo = 52
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (WhW) 9
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 4, 9, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 4
	*   SS 10
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 10 AND f.tipo = 52
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (SS) 10
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 4, 10, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 4
	*   PW 11
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 11 AND f.tipo = 52
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (PW) 11
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 4, 11, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 4
	*   DI 13
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 13 AND f.tipo = 52
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (DI) 13
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 4, 12, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 4
	*   IS 14
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 14 AND f.tipo = 52
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (IS) 14
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 4, 13, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 4
	*   LS 15
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 15 AND f.tipo = 52
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (LS) 15
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 4, 14, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 4
	*   EV 16
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 16 AND f.tipo = 52
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (EV) 16
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 4, 15, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 4
	*   IF 18
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 18 AND f.tipo = 52
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (IF) 18
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 4, 16, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 4
	*   WC 19
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 19 AND f.tipo = 52
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (WC) 19
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 4, 17, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 4
	*   AM 20
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 20 AND f.tipo = 52
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (AM) 20
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 4, 18, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;
	
	SET @row_number = 0;


	/*
	*   RECORD 4
	*   MR 21
	*/
	INSERT INTO __tabRank(`index`, `UID`, valor)
	SELECT
			(@row_number := @row_number + 1) AS `index`,
			Z.`UID`,
			Z.best_score
	FROM
	(
			SELECT
					f.`uid`,
					MIN(f.best_score) as best_score,
					MAX(f.best_pang) as best_pang
			FROM
					pangya.pangya_record f
					INNER JOIN
					pangya.account g
					ON f.`UID` = g.`UID`
			WHERE
					(g.FIRST_LOGIN + g.FIRST_SET) = 2
					AND f.best_score != 127 /*AND f.assist = 0*/
					AND f.course = 21 AND f.tipo = 52
			GROUP BY f.`UID`
	) Z
	ORDER BY
			Z.best_score,
			Z.best_pang DESC,
			Z.`uid`;


	-- Insert Best Score Course (MR) 21
	INSERT __tabRankTmp(position, `UID`, tipo_rank, tipo_rank_seq, valor)
	SELECT `index`, `UID`, 4, 19, `valor` FROM __tabRank;


	-- Clear __tabRank
	DELETE FROM __tabRank;

	SET __CHECK = (SELECT COUNT(`index`) FROM __tabRankTmp);

	-- Verifica se enseriu os dados para a table rank tmp tudo ok
	IF __CHECK IS NOT NULL AND __CHECK > 0 AND __CHECK >= (SELECT COUNT(`index`) FROM pangya.pangya_rank_atual) THEN
	BEGIN
		
		-- TUDO OK Exclui os dados antigos que estavam no rank_antes
		-- e passa o atual para o antes e passa o temp para o atual
		
		-- Rank Antes
		DELETE FROM pangya.pangya_rank_antes;

		ALTER TABLE pangya.pangya_rank_antes AUTO_INCREMENT = 1;

		INSERT INTO pangya.pangya_rank_antes(`position`, `UID`, `tipo_rank`, `tipo_rank_seq`, `valor`)
		SELECT `position`, `UID`, `tipo_rank`, `tipo_rank_seq`, `valor` FROM pangya.pangya_rank_atual;

		-- Rank Atual
		DELETE FROM pangya.pangya_rank_atual;

		ALTER TABLE pangya.pangya_rank_atual AUTO_INCREMENT = 1;

		INSERT INTO pangya.pangya_rank_atual(`position`, `UID`, `tipo_rank`, `tipo_rank_seq`, `valor`)
		SELECT `position`, `UID`, `tipo_rank`, `tipo_rank_seq`, `valor` FROM __tabRankTmp;

		-- Free tmp
		DELETE FROM __tabRankTmp;

		-- Update rank Character Equiped
		-- ------- Aqui atualizar o character que o player estava no momento -----------

		-- Delete os antigos
		DELETE FROM pangya.pangya_rank_atual_character;
      
		-- Insere os novos
		INSERT pangya.pangya_rank_atual_character(	`uid`, 
													item_id, 
													typeid, 
													itemid_parts_1, 
													itemid_parts_2, 
													itemid_parts_3, 
													itemid_parts_4, 
													itemid_parts_5, 
													itemid_parts_6, 
													itemid_parts_7, 
													itemid_parts_8, 
													itemid_parts_9, 
													itemid_parts_10, 
													itemid_parts_11, 
													itemid_parts_12, 
													itemid_parts_13, 
													itemid_parts_14, 
													itemid_parts_15, 
													itemid_parts_16, 
													itemid_parts_17, 
													itemid_parts_18, 
													itemid_parts_19, 
													itemid_parts_20, 
													itemid_parts_21, 
													itemid_parts_22, 
													itemid_parts_23, 
													itemid_parts_24, 
													parts_1, 
													parts_2, 
													parts_3, 
													parts_4, 
													parts_5, 
													parts_6, 
													parts_7, 
													parts_8, 
													parts_9, 
													parts_10, 
													parts_11, 
													parts_12, 
													parts_13, 
													parts_14, 
													parts_15, 
													parts_16, 
													parts_17, 
													parts_18, 
													parts_19, 
													parts_20, 
													parts_21, 
													parts_22, 
													parts_23, 
													parts_24, 
													default_hair, 
													default_shirts, 
													gift_flag, 
													PCL0, 
													PCL1, 
													PCL2, 
													PCL3, 
													PCL4, 
													purchase, 
													AUXPARTS_1, 
													AUXPARTS_2, 
													AUXPARTS_3, 
													AUXPARTS_4, 
													AUXPARTS_5, 
													CutIn_1,
													CutIn_2,
													CutIn_3,
													CutIn_4, 
													mastery, 
													CARD_CHARACTER_1, 
													CARD_CHARACTER_2, 
													CARD_CHARACTER_3, 
													CARD_CHARACTER_4, 
													CARD_CADDIE_1, 
													CARD_CADDIE_2, 
													CARD_CADDIE_3, 
													CARD_CADDIE_4, 
													CARD_NPC_1, 
													CARD_NPC_2, 
													CARD_NPC_3, 
													CARD_NPC_4
		)
		SELECT 
			X.`UID`, 
			X.item_id, 
			X.typeid, 
			Y.ITEMID_PARTS_1, 
			Y.ITEMID_PARTS_2, 
			Y.ITEMID_PARTS_3, 
			Y.ITEMID_PARTS_4, 
			Y.ITEMID_PARTS_5, 
			Y.ITEMID_PARTS_6, 
			Y.ITEMID_PARTS_7, 
			Y.ITEMID_PARTS_8, 
			Y.ITEMID_PARTS_9, 
			Y.ITEMID_PARTS_10, 
			Y.ITEMID_PARTS_11, 
			Y.ITEMID_PARTS_12, 
			Y.ITEMID_PARTS_13, 
			Y.ITEMID_PARTS_14, 
			Y.ITEMID_PARTS_15, 
			Y.ITEMID_PARTS_16, 
			Y.ITEMID_PARTS_17, 
			Y.ITEMID_PARTS_18, 
			Y.ITEMID_PARTS_19, 
			Y.ITEMID_PARTS_20, 
			Y.ITEMID_PARTS_21, 
			Y.ITEMID_PARTS_22, 
			Y.ITEMID_PARTS_23, 
			Y.ITEMID_PARTS_24, 
			X.parts_1, 
			X.parts_2, 
			X.parts_3, 
			X.parts_4, 
			X.parts_5, 
			X.parts_6, 
			X.parts_7, 
			X.parts_8, 
			X.parts_9, 
			X.parts_10, 
			X.parts_11, 
			X.parts_12, 
			X.parts_13, 
			X.parts_14, 
			X.parts_15, 
			X.parts_16, 
			X.parts_17, 
			X.parts_18, 
			X.parts_19, 
			X.parts_20, 
			X.parts_21, 
			X.parts_22, 
			X.parts_23, 
			X.parts_24, 
			X.default_hair, 
			X.default_shirts, 
			X.gift_flag, 
			X.PCL0, 
			X.PCL1, 
			X.PCL2, 
			X.PCL3, 
			X.PCL4, 
			X.Purchase, 
			X.auxparts_1, 
			X.auxparts_2, 
			X.auxparts_3, 
			X.auxparts_4, 
			X.auxparts_5, 
			X.CutIn_1, 
			X.CutIn_2, 
			X.CutIn_3, 
			X.CutIn_4, 
			X.Mastery, 
			Z.CARD_CHARACTER_1, 
			Z.CARD_CHARACTER_2, 
			Z.CARD_CHARACTER_3, 
			Z.CARD_CHARACTER_4, 
			Z.CARD_CADDIE_1, 
			Z.CARD_CADDIE_2, 
			Z.CARD_CADDIE_3, 
			Z.CARD_CADDIE_4, 
			Z.CARD_NPC_1, 
			Z.CARD_NPC_2, 
			Z.CARD_NPC_3, 
			Z.CARD_NPC_4
		FROM 
		(
			SELECT 
				pangya_character_information.`UID`, 
				pangya_character_information.item_id, 
				pangya_character_information.typeid, 
				pangya_character_information.parts_1, 
				pangya_character_information.parts_2, 
				pangya_character_information.parts_3, 
				pangya_character_information.parts_4, 
				pangya_character_information.parts_5, 
				pangya_character_information.parts_6, 
				pangya_character_information.parts_7, 
				pangya_character_information.parts_8, 
				pangya_character_information.parts_9, 
				pangya_character_information.parts_10, 
				pangya_character_information.parts_11, 
				pangya_character_information.parts_12, 
				pangya_character_information.parts_13, 
				pangya_character_information.parts_14, 
				pangya_character_information.parts_15, 
				pangya_character_information.parts_16, 
				pangya_character_information.parts_17, 
				pangya_character_information.parts_18, 
				pangya_character_information.parts_19, 
				pangya_character_information.parts_20, 
				pangya_character_information.parts_21, 
				pangya_character_information.parts_22, 
				pangya_character_information.parts_23, 
				pangya_character_information.parts_24, 
				pangya_character_information.auxparts_1, 
				pangya_character_information.auxparts_2, 
				pangya_character_information.auxparts_3, 
				pangya_character_information.auxparts_4, 
				pangya_character_information.auxparts_5, 
				pangya_character_information.default_hair, 
				pangya_character_information.default_shirts, 
				pangya_character_information.gift_flag, 
				pangya_character_information.PCL0, 
				pangya_character_information.PCL1, 
				pangya_character_information.PCL2, 
				pangya_character_information.PCL3, 
				pangya_character_information.PCL4, 
				pangya_character_information.Purchase, 
				pangya_character_information.CutIn_1, 
				pangya_character_information.CutIn_2,
				pangya_character_information.CutIn_3,
				pangya_character_information.CutIn_4,
				pangya_character_information.Mastery
			FROM 
				pangya.pangya_character_information
		) AS X 
		INNER JOIN 
		(
			SELECT
				A.item_id, 
				MAX(CASE WHEN B.EQUIP_NUM = 1 THEN B.ITEMID ELSE 0 END) AS ITEMID_PARTS_1, 
				MAX(CASE WHEN B.EQUIP_NUM = 2 THEN B.ITEMID ELSE 0 END) AS ITEMID_PARTS_2, 
				MAX(CASE WHEN B.EQUIP_NUM = 3 THEN B.ITEMID ELSE 0 END) AS ITEMID_PARTS_3, 
				MAX(CASE WHEN B.EQUIP_NUM = 4 THEN B.ITEMID ELSE 0 END) AS ITEMID_PARTS_4, 
				MAX(CASE WHEN B.EQUIP_NUM = 5 THEN B.ITEMID ELSE 0 END) AS ITEMID_PARTS_5, 
				MAX(CASE WHEN B.EQUIP_NUM = 6 THEN B.ITEMID ELSE 0 END) AS ITEMID_PARTS_6, 
				MAX(CASE WHEN B.EQUIP_NUM = 7 THEN B.ITEMID ELSE 0 END) AS ITEMID_PARTS_7, 
				MAX(CASE WHEN B.EQUIP_NUM = 8 THEN B.ITEMID ELSE 0 END) AS ITEMID_PARTS_8, 
				MAX(CASE WHEN B.EQUIP_NUM = 9 THEN B.ITEMID ELSE 0 END) AS ITEMID_PARTS_9, 
				MAX(CASE WHEN B.EQUIP_NUM = 10 THEN B.ITEMID ELSE 0 END) AS ITEMID_PARTS_10, 
				MAX(CASE WHEN B.EQUIP_NUM = 11 THEN B.ITEMID ELSE 0 END) AS ITEMID_PARTS_11, 
				MAX(CASE WHEN B.EQUIP_NUM = 12 THEN B.ITEMID ELSE 0 END) AS ITEMID_PARTS_12, 
				MAX(CASE WHEN B.EQUIP_NUM = 13 THEN B.ITEMID ELSE 0 END) AS ITEMID_PARTS_13, 
				MAX(CASE WHEN B.EQUIP_NUM = 14 THEN B.ITEMID ELSE 0 END) AS ITEMID_PARTS_14, 
				MAX(CASE WHEN B.EQUIP_NUM = 15 THEN B.ITEMID ELSE 0 END) AS ITEMID_PARTS_15, 
				MAX(CASE WHEN B.EQUIP_NUM = 16 THEN B.ITEMID ELSE 0 END) AS ITEMID_PARTS_16, 
				MAX(CASE WHEN B.EQUIP_NUM = 17 THEN B.ITEMID ELSE 0 END) AS ITEMID_PARTS_17, 
				MAX(CASE WHEN B.EQUIP_NUM = 18 THEN B.ITEMID ELSE 0 END) AS ITEMID_PARTS_18, 
				MAX(CASE WHEN B.EQUIP_NUM = 19 THEN B.ITEMID ELSE 0 END) AS ITEMID_PARTS_19, 
				MAX(CASE WHEN B.EQUIP_NUM = 20 THEN B.ITEMID ELSE 0 END) AS ITEMID_PARTS_20, 
				MAX(CASE WHEN B.EQUIP_NUM = 21 THEN B.ITEMID ELSE 0 END) AS ITEMID_PARTS_21, 
				MAX(CASE WHEN B.EQUIP_NUM = 22 THEN B.ITEMID ELSE 0 END) AS ITEMID_PARTS_22, 
				MAX(CASE WHEN B.EQUIP_NUM = 23 THEN B.ITEMID ELSE 0 END) AS ITEMID_PARTS_23, 
				MAX(CASE WHEN B.EQUIP_NUM = 24 THEN B.ITEMID ELSE 0 END) AS ITEMID_PARTS_24
			FROM 
			(
				SELECT 
					pangya_character_information.item_id
				FROM 
					pangya.pangya_character_information
			) AS A 
			LEFT OUTER JOIN 
			(
				SELECT 
					td_char_equip_s4.CHAR_ITEMID,
					td_char_equip_s4.ITEMID,
					td_char_equip_s4.EQUIP_NUM
				FROM 
					pangya.td_char_equip_s4
				WHERE 
					td_char_equip_s4.USE_YN = 'Y'
			) AS B 
			ON A.item_id = B.CHAR_ITEMID
			GROUP BY A.item_id
		) AS Y
		ON X.item_id = Y.item_id
		INNER JOIN 
		(
			SELECT 
				E.item_id, 
				MAX(CASE WHEN F.Tipo = 0 AND F.Slot = 1 THEN F.card_typeid ELSE 0 END) AS CARD_CHARACTER_1, 
				MAX(CASE WHEN F.Tipo = 0 AND F.Slot = 2 THEN F.card_typeid ELSE 0 END) AS CARD_CHARACTER_2, 
				MAX(CASE WHEN F.Tipo = 0 AND F.Slot = 3 THEN F.card_typeid ELSE 0 END) AS CARD_CHARACTER_3, 
				MAX(CASE WHEN F.Tipo = 0 AND F.Slot = 4 THEN F.card_typeid ELSE 0 END) AS CARD_CHARACTER_4, 
				MAX(CASE WHEN F.Tipo = 1 AND F.Slot = 5 THEN F.card_typeid ELSE 0 END) AS CARD_CADDIE_1, 
				MAX(CASE WHEN F.Tipo = 1 AND F.Slot = 6 THEN F.card_typeid ELSE 0 END) AS CARD_CADDIE_2, 
				MAX(CASE WHEN F.Tipo = 1 AND F.Slot = 7 THEN F.card_typeid ELSE 0 END) AS CARD_CADDIE_3, 
				MAX(CASE WHEN F.Tipo = 1 AND F.Slot = 8 THEN F.card_typeid ELSE 0 END) AS CARD_CADDIE_4, 
				MAX(CASE WHEN F.Tipo = 5 AND F.Slot = 9 THEN F.card_typeid ELSE 0 END) AS CARD_NPC_1, 
				MAX(CASE WHEN F.Tipo = 5 AND F.Slot = 10 THEN F.card_typeid ELSE 0 END) AS CARD_NPC_2, 
				MAX(CASE WHEN F.Tipo = 5 AND F.Slot = 11 THEN F.card_typeid ELSE 0 END) AS CARD_NPC_3, 
				MAX(CASE WHEN F.Tipo = 5 AND F.Slot = 12 THEN F.card_typeid ELSE 0 END) AS CARD_NPC_4
			FROM 
			(
				SELECT 
					pangya_character_information.item_id
				FROM 
					pangya.pangya_character_information
			) AS E 
			LEFT OUTER JOIN 
			(
				SELECT 
					pangya_card_equip.Tipo, 
					pangya_card_equip.Slot, 
					pangya_card_equip.card_typeid, 
					pangya_card_equip.parts_id
				FROM 
					pangya.pangya_card_equip
				WHERE 
					pangya_card_equip.USE_YN = 1
			) AS F 
			ON F.parts_id = E.item_id
			GROUP BY E.item_id
		) AS Z
		ON Y.item_id = Z.item_id
		INNER JOIN 
		(
			SELECT 
				ff.character_id
			FROM 
				pangya.pangya_user_equip AS ff
				INNER JOIN
				pangya.account AS bb
				ON ff.`UID` = bb.`UID`
			WHERE 
				(bb.FIRST_LOGIN + bb.FIRST_SET) = 2
		) AS W 
		ON Z.item_id = W.character_id
		ORDER BY X.`UID`;

		-- Update Time Refresh Rank Generation
		UPDATE 
			pangya.pangya_rank_config
		SET 
			reg_date = now();

		-- Fim
		SELECT 
			1 AS SUCCESS,
			reg_date
		FROM
			pangya.pangya_rank_config;

	END;
	ELSE
	BEGIN
		-- Error
		SELECT 0 AS SUCCESS;
	END;
	END IF;
	
	DROP TEMPORARY TABLE __tabRank;
	DROP TEMPORARY TABLE __tabRankTmp;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `GeraRankAll_Ant` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `GeraRankAll_Ant`(
)
BEGIN
	DELETE 
	FROM pangya.pangya_rank_antes;

	INSERT pangya.pangya_rank_antes(
		pangya.pangya_rank_antes.position, 
		pangya.pangya_rank_antes.UID, 
		pangya.pangya_rank_antes.tipo_rank, 
		pangya.pangya_rank_antes.tipo_rank_seq, 
		pangya.pangya_rank_antes.valor)
		SELECT 
			pangya_rank_atual.position, 
			pangya_rank_atual.UID, 
			pangya_rank_atual.tipo_rank, 
			pangya_rank_atual.tipo_rank_seq, 
			pangya_rank_atual.valor
		FROM pangya.pangya_rank_atual;

	DELETE 
	FROM pangya.pangya_rank_atual;

	DELETE 
	FROM pangya.pangya_rank_atual_character;

	UPDATE pangya.pangya_rank_config
		SET 
		reg_date = now();
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `GetInfo_user` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `GetInfo_user`(
	__IDUSER int
)
BEGIN
	
	SELECT 
         user_info.UID, 
         user_info.Tacadas, 
         user_info.Putt, 
         user_info.Tempo, 
         user_info.`Tempo tacadas`, 
         user_info.Max_distancia, 
         user_info.Acerto_pangya, 
         user_info.Bunker, 
         user_info.`O.B`, 
         user_info.Total_distancia, 
         user_info.Holes, 
         user_info.Holein, 
         user_info.HIO, 
         user_info.Timeout, 
         user_info.Fairway, 
         user_info.Albatross, 
         user_info.MaConduta, 
         user_info.Acerto_Putt, 
         user_info.`Long-putt`, 
         user_info.`Chip-in`, 
         user_info.Xp, 
         user_info.`level`, 
         user_info.Pang, 
         user_info.Media_score, 
         user_info.BestScore0, 
         user_info.BestScore1, 
         user_info.BestScore2, 
         user_info.BestScore3, 
         user_info.BestScore4, 
         user_info.MaxPang0, 
         user_info.maxPang1, 
         user_info.maxPang2, 
         user_info.maxPang3, 
         user_info.maxPang4, 
         user_info.SumPang, 
         user_info.EventFlag, 
         user_info.Jogado, 
         user_info.Quitado, 
         user_info.SkinPang, 
         user_info.SkinWin, 
         user_info.SkinLose, 
         user_info.SkinRunHole, 
         user_info.SkinStrikePoint, 
         user_info.SkinAllinCount, 
         user_info.Todos_combos, 
         user_info.Combos, 
         user_info.TeamWin, 
         user_info.TeamGames, 
         user_info.Teamhole, 
         user_info.LadderPoint, 
         user_info.LadderWin, 
         user_info.LadderLose, 
         user_info.LadderDraw, 
         user_info.LadderHole, 
         user_info.EventValue, 
         user_info.NaoSei, 
         user_info.MaxJogoNaoSei, 
         user_info.JogosNaoSei, 
         user_info.GameCountSeason, 
         user_info.Cookie, 
         user_info.lucky_medal, 
         user_info.fast_medal, 
         user_info.best_drive_medal, 
         user_info.best_chipin_medal, 
         user_info.best_puttin_medal, 
         user_info.best_recovery_medal, 
         user_info.`16bit_naosei`,
		 user_info.total_pang_win_game
      FROM pangya.user_info
      WHERE user_info.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `GetTutorial` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `GetTutorial`(
	__IDUSER int
)
BEGIN
	
	SELECT tutorial.Rookie, tutorial.Beginner, tutorial.Advancer
	FROM pangya.tutorial
	WHERE tutorial.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcAddBall` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcAddBall`(
	__IDUSER INT,
	__GIFTFLAG INT,
	__PURCHASE_IN TINYINT,
	__IDITEM int,
	__ITEMTYPEID INT,
	__TYPEFLAG TINYINT,
	__TEMPO INT,
	__C_0 smallint,
	__C_1 smallint,
	__C_2 smallint,
	__C_3 smallint,
	__C_4 smallint
)
BEGIN
	-- Insert statements for procedure here
	INSERT INTO pangya.pangya_item_warehouse(UID, typeid, valid, regdate, Gift_flag, flag, C0, Purchase, ItemType)
							VALUES(__IDUSER, __ITEMTYPEID, 1, now(), __GIFTFLAG, __TYPEFLAG, __C_0, 0, 2);

	SELECT last_insert_id() AS ITEM_ID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcAddCaddie` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcAddCaddie`(
	__IDUSER INT,
	__IDITEM INT,
	___TYPEID INT,
	__GIFT_FLAG INT,
	__PURCHASE INT,
	__RENT_FLAG INT,
	__TEMPO INT
)
BEGIN
	IF __IDITEM <= 0 THEN
	BEGIN
		INSERT INTO pangya.pangya_caddie_information(UID, typeid, gift_flag, Purchase, RentFlag, Period, RegDate, EndDate)
			VALUES(__IDUSER, ___TYPEID, __GIFT_FLAG, __PURCHASE, __RENT_FLAG, __TEMPO, now(), TIMESTAMPADD(DAY, __TEMPO, now()));

		SELECT item_id, EndDate FROM pangya.pangya_caddie_information WHERE item_id = last_insert_id();
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcAddCharacter` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcAddCharacter`(
	__IDUSER INT,
	__IDITEM INT, -- Character ID
	___TYPEID INT,
	__DEFAULT_HAIR INT,
	__DEFAULT_SHIRTS INT,
	__PURCHAGE INT,
	__GIFT_FLAG INT,
	__PART1 INT,
	__PART2 INT,
	__PART3 INT,
	__PART4 INT,
	__PART5 INT,
	__PART6 INT,
	__PART7 INT,
	__PART8 INT,
	__PART9 INT,
	__PART10 INT,
	__PART11 INT,
	__PART12 INT,
	__PART13 INT,
	__PART14 INT,
	__PART15 INT,
	__PART16 INT,
	__PART17 INT,
	__PART18 INT,
	__PART19 INT,
	__PART20 INT,
	__PART21 INT,
	__PART22 INT,
	__PART23 INT,
	__PART24 INT
)
BEGIN
	DECLARE __COUNT INT DEFAULT 0;
    
	IF __IDITEM <= 0 THEN
	BEGIN
		SET __IDITEM = IFNULL((SELECT item_id FROM pangya.pangya_character_information WHERE UID = __IDUSER AND typeid = ___TYPEID), -1);
	END;
    END IF;

	IF __IDITEM <= 0 THEN
	BEGIN
		INSERT INTO pangya.pangya_character_information(UID, TYPEID, default_hair, default_shirts, Purchase, gift_flag, 
			parts_1, parts_2, parts_3, parts_4, parts_5, parts_6, parts_7, parts_8, parts_9, parts_10, parts_11, parts_12,
			parts_13, parts_14, parts_15, parts_16, parts_17, parts_18, parts_19, parts_20, parts_21, parts_22, parts_23, parts_24) 
		VALUES(__IDUSER, ___TYPEID, __DEFAULT_HAIR, __DEFAULT_SHIRTS, __PURCHAGE, __GIFT_FLAG, __PART1, __PART2, __PART3, __PART4, __PART5, __PART6, __PART7, __PART8,
				__PART9, __PART10, __PART11, __PART12, __PART13, __PART14, __PART15, __PART16, __PART17, __PART18, __PART19, __PART20, __PART21, __PART22, __PART23, __PART24);

		-- Character ID
		SET __IDITEM = last_insert_id();

		WHILE __COUNT < 24 DO
		BEGIN
			INSERT INTO pangya.td_char_equip_s4(UID, CHAR_ITEMID, IN_DATE, EQUIP_NUM, USE_YN)
				VALUES(__IDUSER, __IDITEM, now(), __COUNT + 1, 'Y');
			SET __COUNT = __COUNT + 1;
		END;
        END WHILE;
	END;
    END IF;

	SELECT __IDITEM AS ITEM_ID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcAddCounterItem` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcAddCounterItem`(
	__IDUSER BIGINT,
	__ITEMTYPEID INT,
	__ACTIVE TINYINT,
	__COUNT_NUM_ITEM INT
)
BEGIN

	INSERT INTO pangya.pangya_counter_item(UID, TypeID, `active`, Count_Num_Item) VALUES(__IDUSER, __ITEMTYPEID, __ACTIVE, __COUNT_NUM_ITEM);
	
	SELECT last_insert_id() AS COUNTER_ITEM_ID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcAddFriend` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcAddFriend`(
	__IDUSER INT,
	__FRIEND_UID INT,
	__FRIEND_APELIDO NVARCHAR(15),
	__FRIEND_UNK1 INT,
	__FRIEND_UNK2 INT,
	__FRIEND_UNK3 INT,
	__FRIEND_UNK4 INT,
	__FRIEND_UNK5 INT,
	__FRIEND_UNK6 INT,
	__FRIEND_FLAG1 SMALLINT,
	__FRIEND_STATE TINYINT
)
BEGIN
	IF __IDUSER > 0 AND __FRIEND_UID > 0 AND (SELECT UID FROM pangya.pangya_friend_list WHERE UID = __IDUSER AND uid_friend = __FRIEND_UID) IS NULL THEN
	BEGIN
		INSERT INTO pangya.pangya_friend_list(UID, uid_friend, apelido, unknown1, unknown2, unknown3, unknown4, unknown5, unknown6, flag1, state_flag, flag5)
			VALUES(__IDUSER, __FRIEND_UID, __FRIEND_APELIDO, __FRIEND_UNK1, __FRIEND_UNK2, __FRIEND_UNK3, __FRIEND_UNK4, __FRIEND_UNK5, __FRIEND_UNK6, __FRIEND_FLAG1, __FRIEND_STATE, 0);
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcAddFurniture` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcAddFurniture`(
	__IDUSER INT,
	__ITEMTYPEID INT,
	__X FLOAT,
	__Y FLOAT,
	__Z FLOAT,
	__R FLOAT
)
BEGIN
	DECLARE __ITEMID INT DEFAULT -1;

    -- Insert statements for procedure here
	IF __IDUSER > 0 THEN
	BEGIN
		INSERT INTO pangya.td_room_data(UID, TYPEID, POS_X, POS_Y, POS_Z, POS_R)
			VALUES(__IDUSER, __ITEMTYPEID, __X, __Y, __Z, __R);

		SET __ITEMID = last_insert_id();
	END;
    END IF;

	SELECT __ITEMID AS ITEM_ID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcAddItem` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcAddItem`(
	__IDUSER INT,
	__GIFTFLAG INT,
	__PURCHASE_IN TINYINT,
	__IDITEM int,
	__ITEMTYPEID INT,
	__TYPEFLAG TINYINT,
	__TEMPO INT,
	__C_0 smallint,
	__C_1 smallint,
	__C_2 smallint,
	__C_3 smallint,
	__C_4 smallint
)
BEGIN

	-- Insert statements for procedure here
	IF __TEMPO > 0 THEN
	BEGIN
		INSERT INTO pangya_item_warehouse(UID, typeid, valid, regdate, EndDate, Gift_flag, flag, C0, C1, C2, C3, C4, Purchase, ItemType)
				VALUES(__IDUSER, __ITEMTYPEID, 1, now(), timestampadd(DAY, __TEMPO, now()), __GIFTFLAG, __TYPEFLAG, __C_0, __C_1, __C_2, __C_3, __C_4, 0, 2);
					
		SET __IDITEM = last_insert_id();
	END;
    ELSE
	BEGIN
		INSERT INTO pangya_item_warehouse(UID, typeid, valid, regdate, Gift_flag, flag, C0, C1, C2, C3, C4, Purchase, ItemType)
				VALUES(__IDUSER, __ITEMTYPEID, 1, now(), __GIFTFLAG, __TYPEFLAG, __C_0, __C_1, __C_2, __C_3, __C_4, 0, 2);
				
		SET __IDITEM = last_insert_id();
	END;
    END IF;

	SELECT __IDITEM AS ITEM_ID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcAddItemDolfiniLocker` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcAddItemDolfiniLocker`(
	__IDUSER int,
	__ITEMID bigint
)
BEGIN
	UPDATE pangya.pangya_item_warehouse SET valid = 0
	WHERE UID = __IDUSER AND item_id = __ITEMID;

	INSERT pangya.pangya_dolfini_locker_item(UID, item_id) VALUES (__IDUSER, __ITEMID);

	SELECT last_insert_id() AS `INDEX`; 
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcAddMsgOff` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcAddMsgOff`(
	__IDUSER INT,
	__TO_UID INT,
	__MSG NVARCHAR(500)
)
BEGIN
	IF __IDUSER > 0 AND __TO_UID > 0 THEN
	BEGIN
		INSERT INTO pangya.pangya_msg_user(UID, uid_from, valid, msg, reg_date)
			VALUES(__TO_UID, __IDUSER, 1, __MSG, now());
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcAddPart` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcAddPart`(
	__IDUSER INT,
	__GIFTFLAG INT,
	__PURCHASE_IN TINYINT,
	__IDITEM int,
	__ITEMTYPEID INT,
	__TYPEFLAG TINYINT,
	__TYPEFLAG_IFF TINYINT,
	__TEMPO INT,
	__C_0 smallint,
	__C_1 smallint,
	__C_2 smallint,
	__C_3 smallint,
	__C_4 smallint
)
BEGIN
	-- Insert statements for procedure here
	IF __TYPEFLAG_IFF = 8 OR __TYPEFLAG_IFF = 9 THEN -- UCC
	BEGIN
		IF __IDITEM <= 0 THEN
			call pangya.USP_ADD_UCC(__IDUSER, __ITEMTYPEID, __GIFTFLAG, __C_0, __C_1, __C_2, __C_3, __C_4, __PURCHASE_IN, __TYPEFLAG_IFF, __TEMPO);
		END IF;
	END;
	ELSE	-- Normal Item
	BEGIN					
			IF __TEMPO > 0 THEN
			BEGIN
				INSERT INTO pangya.pangya_item_warehouse(UID, typeid, valid, regdate, Gift_flag, flag, Purchase, ItemType, EndDate, c0, c1, c2, c3, c4)
							VALUES(__IDUSER, __ITEMTYPEID, 1, now(), __GIFTFLAG, __TYPEFLAG, 0, 2, TIMESTAMPADD(DAY, __TEMPO, now()), __C_0, __C_1, __C_2, __C_3, __C_4);
			END;
			ELSE
			BEGIN
				INSERT INTO pangya.pangya_item_warehouse(UID, typeid, valid, regdate, enddate, Gift_flag, flag, Purchase, ItemType, c0, c1, c2, c3, c4)
							VALUES(__IDUSER, __ITEMTYPEID, 1, now(), now(), __GIFTFLAG, __TYPEFLAG, 0, 2, __C_0, __C_1, __C_2, __C_3, __C_4);
			END;
            END IF;

			SET __IDITEM = last_insert_id();

		SELECT __IDITEM AS ITEM_ID, NULL AS UCC_IDX, 0 AS SD_SEQ;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcAddTrofelGrandPrix` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcAddTrofelGrandPrix`(
	__IDUSER BIGINT,
	__ITEMTYPEID INT,
	__QNTD INT
)
BEGIN
	INSERT INTO pangya.pangya_trofel_grandprix(UID, TYPEID, qntd) VALUES(__IDUSER, __ITEMTYPEID, __QNTD);
	
	SELECT last_insert_id() AS ITEM_ID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcAddTrofelSpecial` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcAddTrofelSpecial`(
	__IDUSER BIGINT,
	__ITEMTYPEID INT,
	__QNTD INT
)
BEGIN
	INSERT INTO pangya.pangya_trofel_especial(UID, TYPEID, qntd) VALUES(__IDUSER, __ITEMTYPEID, __QNTD);
	
	SELECT last_insert_id() AS ITEM_ID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcAddUserFriend` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcAddUserFriend`(
	__IDUSER int,
	__friend_uid int,
	__nickname nvarchar(23)
)
BEGIN
	DECLARE __OPT int DEFAULT 0;

	IF 
	(
		SELECT account.UID
		FROM pangya.account
		WHERE account.UID = __friend_uid AND account.NICK = __nickname
	) IS NOT NULL THEN

		IF 
		(
			SELECT count_big(pangya_friend_list.uid_friend)
			FROM pangya.pangya_friend_list
			WHERE pangya_friend_list.uid = __friend_uid
		) < 50 THEN

			IF 
			(
				SELECT pangya_friend_list.uid
				FROM pangya.pangya_friend_list
				WHERE pangya_friend_list.uid = __IDUSER AND pangya_friend_list.uid_friend = __friend_uid
			) IS NULL THEN
			BEGIN

				INSERT pangya.pangya_friend_list(pangya.pangya_friend_list.uid, pangya.pangya_friend_list.uid_friend, pangya.pangya_friend_list.state_flag)
				VALUES (__IDUSER, __friend_uid, 8);

				INSERT pangya.pangya_friend_list(pangya.pangya_friend_list.uid, pangya.pangya_friend_list.uid_friend, pangya.pangya_friend_list.state_flag)
				VALUES (__friend_uid, __IDUSER, 0);

			END;
			ELSE 
				SET __OPT = 2;
			END IF;
		ELSE 
			SET __OPT = 3;
		END IF;
	ELSE 
		SET __OPT = 1;
	END IF;

	SELECT __OPT AS retorno;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcBlockPlayerLuciaAttendance` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcBlockPlayerLuciaAttendance`(
	__UID INT,
	__BLOCK_TYPE INT
)
BEGIN
	DECLARE __END_DATE DATETIME;
    
	IF __UID > 0 AND __BLOCK_TYPE > 0 THEN
	BEGIN
		
		SET __END_DATE = (CASE __BLOCK_TYPE
							WHEN 1 THEN
								TIMESTAMPADD(DAY, 1, now())
							WHEN 2 THEN
								TIMESTAMPADD(WEEK, 1, now())
							WHEN 3 THEN
								TIMESTAMPADD(MONTH, 1, now())
							ELSE NULL
						END);

		UPDATE pangya.pangya_lucia_attendance 
			SET block_type = __BLOCK_TYPE, 
				block_end_date = __END_DATE,
				try_hacking_count = 0
		WHERE UID = __UID;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcCancelUpLevelClubSet` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcCancelUpLevelClubSet`(
	__IDUSER int,
	__TAQUEIRA_ID int
)
BEGIN
	UPDATE pangya.pangya_item_warehouse
         SET 
            Recovery_Pts = pangya_item_warehouse.Recovery_Pts + 1
      WHERE pangya_item_warehouse.UID = __IDUSER AND pangya_item_warehouse.item_id = __TAQUEIRA_ID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcChangeDolfiniLockerPass` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcChangeDolfiniLockerPass`(
	__UID INT,
	__PASS VARCHAR(5)
)
BEGIN
	IF __UID > 0 AND __PASS != '' THEN
		UPDATE pangya.pangya_dolfini_locker SET senha = __PASS WHERE UID = __UID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcChangeNickname` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcChangeNickname`(
	__UID INT
)
BEGIN
	DECLARE __RET INT DEFAULT -1;
	DECLARE __CP BIGINT DEFAULT 0;

	IF __UID > 0 THEN
	BEGIN

		IF (SELECT FIRST_LOGIN FROM pangya.account WHERE UID = __UID) = 1 THEN
		BEGIN

			IF (SELECT IF(change_nick IS NULL, 1, TIMESTAMPDIFF(MONTH, change_nick, now())) as diff FROM pangya.account WHERE UID = __UID) > 0 THEN
			BEGIN
		
				IF (SELECT cookie FROM pangya.user_info WHERE uid = __UID) >= 60 THEN
				BEGIN

					-- Update cookie, tira os 60 CP que gastar para trocar o nickname
					UPDATE pangya.user_info SET Cookie = Cookie - 60 WHERE UID = __UID;

					-- Atualiza CP que vai ser retornado
					SET __CP = (SELECT cookie FROM pangya.user_info WHERE uid = __UID);

					-- Insere o nickname antigo no log de change nickname
					INSERT INTO pangya.pangya_change_nickname_log(UID, nickname) SELECT UID, NICK FROM pangya.account WHERE UID = __UID LIMIT 1;

					-- Atualiza a flag de first login e a data que o player pediu para trocar de nickname
					UPDATE pangya.account 
						SET FIRST_LOGIN = 0,			-- Ele pode trocar o nick quando ele logar no jogo
							change_nick = now()			-- Atualiza a data que ele atualizou o nickname
					WHERE UID = __UID;

					SET __RET = 1;	-- Fez o pedido de troca de nickname com sucesso

				END;
				ELSE
					SET __RET = -2;	-- Não tem cookies suficiente
				END IF;

			END;
			ELSE
				SET __RET = -3;	-- Ainda não deu um mês desde que ele trocou o nickname
			END IF;

		END;
		ELSE
			SET __RET = -4;	-- Já pediu para trocar o nickname
		END IF;

	END;
    END IF;

	SELECT __RET as RET, __CP as cookie;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcChangePassword` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcChangePassword`(
	__UID INT,
	__PWD VARCHAR(33)
)
BEGIN
	
    DECLARE __RET INT DEFAULT -1;
	DECLARE __EMAIL NVARCHAR(100) DEFAULT '';

	IF __UID > 0 AND __PWD != '' THEN
	BEGIN

		-- Pega email do player
		SET __EMAIL = (SELECT email FROM pangya.contas_beta WHERE UID = __UID);

		-- Verifica se tem log de troca de senha
		IF (SELECT UID FROM pangya.pangya_change_pwd_log WHERE UID = __UID) IS NOT NULL THEN
		BEGIN

			DECLARE __COUNT INT DEFAULT 0;
			DECLARE __CHANGE_DATE DATETIME;

			-- Pega o contador de vez que o player trocou o login e a primeira data que ele trocou
			SELECT __COUNT = `count`, __CHANGE_DATE = change_date
			FROM pangya.pangya_change_pwd_log
			WHERE UID = __UID;
			
			IF TIMESTAMPDIFF(MINUTE, __CHANGE_DATE, now()) >= 1440 THEN -- 24 horas em minutos
			BEGIN
			
				-- Faz mais de 24 horas que ele trocou de senha	
				UPDATE pangya.pangya_change_pwd_log 
					SET last_change = now(),
						change_date = now(),
						`count` = 1
				WHERE UID = __UID;

				-- Troca a senha
				UPDATE pangya.account SET `PASSWORD` = __PWD WHERE UID = __UID;

				SET __RET = 1;

			END;
			ELSEIF __COUNT = 1 THEN
			BEGIN
				
				-- Menos de 24 horas que ele trocou de senha uma vez
				UPDATE pangya.pangya_change_pwd_log
					SET last_change = now(),
						`count` = __COUNT + 1
				WHERE UID = __UID;

				-- Troca a senha
				UPDATE pangya.account SET `PASSWORD` = __PWD WHERE UID = __UID;

				SET __RET = 1;

			END;
			ELSE
				SET __RET = -2;
			END IF;

		END;
		ELSE
		BEGIN
			
			-- Ele não tem log de troca de senha, cria um novo para ele
			INSERT INTO pangya.pangya_change_pwd_log(UID) VALUES(__UID);

			-- Troca a senha
			UPDATE pangya.account SET `PASSWORD` = __PWD WHERE UID = __UID;

			SET __RET = 1;

		END;
        END IF;
		
	END;
    END IF;

	SELECT __RET AS RET, __EMAIL AS EMAIL;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcCheckAchievement` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcCheckAchievement`(
	__UID bigint
)
BEGIN
	
	SELECT COUNT(UID) AS `COUNT` FROM pangya.pangya_achievement WHERE UID = __UID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcCheckDailyQuest` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcCheckDailyQuest`(
)
BEGIN
	
    IF 
         (
            SELECT count(*)
            FROM pangya.pangya_daily_quest
         ) > 0 THEN
         SELECT IFNULL(timestampdiff(day, pangya_daily_quest.Reg_Date, now()), 1) AS `DATE`
         FROM pangya.pangya_daily_quest;
      ELSE 
         SELECT 1 AS `DATE`;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcCheckGuildName` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcCheckGuildName`(
	__NAME NVARCHAR(20)
)
BEGIN
	
    SELECT GUILD_UID FROM pangya.pangya_guild WHERE GUILD_NAME = __NAME;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcCheckPlayerDailyQuest` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcCheckPlayerDailyQuest`(
	__IDUSER int
)
BEGIN
	
    DECLARE __RET int DEFAULT 0;

      IF 
         (
            SELECT pangya_daily_quest_player.today_quest
            FROM pangya.pangya_daily_quest_player
            WHERE pangya_daily_quest_player.uid = __IDUSER
         ) IS NULL THEN
         SET __RET = 1;
      ELSE 
         BEGIN
            IF 
               (
                  SELECT day(pangya_daily_quest_player.today_quest)
                  FROM pangya.pangya_daily_quest_player
                  WHERE pangya_daily_quest_player.uid = __IDUSER
               ) <> 
               (
                  SELECT day(pangya_daily_quest.Reg_Date)
                  FROM pangya.pangya_daily_quest
               ) THEN
               SET __RET = 1;
			END IF;
         END;
         END IF;

      SELECT __RET;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcCheckRankRefreshTime` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcCheckRankRefreshTime`(
)
BEGIN
	
    SELECT
         CASE 
            WHEN (timestampadd(hour, pangya_rank_config.refresh_time_H, pangya_rank_config.reg_date) < now()) THEN 1
            ELSE 0
         END AS booleann
      FROM pangya.pangya_rank_config LIMIT 1;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcCheckRescuePasswordAndIDKey` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcCheckRescuePasswordAndIDKey`(
	__INDEX BIGINT,
	__KEY NVARCHAR(100)
)
BEGIN

	DECLARE __RET INT DEFAULT -1;
	DECLARE __UID INT DEFAULT 0;
	DECLARE __TIPO TINYINT DEFAULT 0;
	
	IF __INDEX > 0 AND __KEY != '' THEN
	BEGIN

		SET __UID = (SELECT UID FROM pangya.pangya_rescue_pwd_log WHERE `index` = __INDEX AND key_uniq = __KEY AND state = 0 AND TIMESTAMPADD(HOUR, 1, send_date) > now());

		IF __UID IS NOT NULL AND __UID > 0 THEN
		BEGIN

			-- Pega o tipo de recuperação se é de senha ou de id
			SELECT __TIPO = tipo FROM pangya.pangya_rescue_pwd_log WHERE `index` = __INDEX AND UID = __UID;

			-- Atualiza o state da chave para utilizada
			IF __TIPO = 2 THEN -- ID Faz agora por que ele só precisa ver o id, e não trocar ele como a senha
				UPDATE pangya.pangya_rescue_pwd_log SET state = 1 WHERE `index` = __INDEX AND UID = __UID;
			END IF;

			-- Verificou a chave com sucesso
			SET __RET = 1;

		END;
		ELSE
			SET __RET = -2;	-- Chave invalida, não existe a chave, já foi utilizada ou  ela expirou
		END IF;

	END;
    END IF;

	SELECT __RET AS RET, __UID as UID, __TIPO AS TIPO;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcCheckSecurityKey` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcCheckSecurityKey`(
	__IDUSER int,
	__IDITEM int,
	__KEY nvarchar(20)
)
BEGIN

	SELECT tu_ucc.UID
      FROM pangya.tu_ucc
      WHERE 
         tu_ucc.UID = __IDUSER AND 
         tu_ucc.ITEM_ID = __IDITEM AND 
         tu_ucc.SKEY = __KEY;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcCheckUCCDraws` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcCheckUCCDraws`(
	__IDUSER int
)
BEGIN

	SELECT tu_ucc.ITEM_ID
      FROM pangya.tu_ucc
      WHERE tu_ucc.UID = __IDUSER AND tu_ucc.DRAW_DT IS NOT NULL;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcColocaMsgNoGiftTable` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcColocaMsgNoGiftTable`(
	__From_UID int,
	__To_UID int,
	__MSG nvarchar(500)
)
BEGIN
	
	DECLARE __NICKNAME NVARCHAR(100);

	SELECT NICK INTO __NICKNAME FROM pangya.account WHERE UID = __From_UID;

	IF __NICKNAME IS NULL OR __NICKNAME = '' THEN
		SET __NICKNAME = '@SUPERSS';
	END IF;

	INSERT pangya.pangya_gift_table(
		pangya.pangya_gift_table.UID, 
		pangya.pangya_gift_table.fromid, 
		pangya.pangya_gift_table.message, 
		pangya.pangya_gift_table.giftdate, 
		pangya.pangya_gift_table.Lida_YN, 
		pangya.pangya_gift_table.valid, 
		pangya.pangya_gift_table.Flag, 
		pangya.pangya_gift_table.Contador_Vista)
	VALUES (
		__To_UID, 
		__NICKNAME, 
		__MSG, 
		ifnull(now(), now()), 
		0, 
		1, 
		0, 
		0);

	SELECT LAST_INSERT_ID() AS MSG_ID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcDeletaQuestAnterior` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcDeletaQuestAnterior`(
)
BEGIN

	DELETE 
      FROM pangya.achievement_quest
      WHERE achievement_quest.ID_ACHIEVEMENT IN 
         (
            SELECT achievement_tipo.ID_ACHIEVEMENT
            FROM pangya.achievement_tipo
            WHERE achievement_tipo.`Option` = 1
         );

      DELETE 
      FROM pangya.achievement_tipo
      WHERE achievement_tipo.`Option` = 1;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcDeleteBlockIPFromTable` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcDeleteBlockIPFromTable`(
	__INDEX INT
)
BEGIN

	IF __INDEX > 0 THEN
	BEGIN
		
		DELETE FROM pangya.pangya_ip_table WHERE `index` = __INDEX;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcDeleteBlockMACFromTable` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcDeleteBlockMACFromTable`(
	__INDEX INT
)
BEGIN

	IF __INDEX > 0 THEN
		DELETE FROM pangya.pangya_mac_table WHERE `index` = __INDEX;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcDeleteBotGMEventReward` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcDeleteBotGMEventReward`(
	__ID BIGINT
)
BEGIN

	IF __ID > 0 THEN
	BEGIN

		DELETE FROM pangya.pangya_bot_gm_event_reward WHERE `index` = __ID;

		SELECT __ID AS ID;

	END;
	ELSE
		SELECT -1 AS ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcDeleteBotGMEventTime` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcDeleteBotGMEventTime`(
	__ID BIGINT
)
BEGIN

	IF __ID > 0 THEN
	BEGIN

		DELETE FROM pangya.pangya_bot_gm_event_time WHERE `index` = __ID;

		SELECT __ID AS ID;

	END;
	ELSE
		SELECT -1 AS ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcDeleteDonationByGM` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcDeleteDonationByGM`(
	__ID BIGINT
)
BEGIN

	IF __ID != -1 AND (SELECT `index` FROM pangya.pangya_donation_new WHERE `index` = __ID) IS NOT NULL THEN
	BEGIN

		DELETE FROM pangya.pangya_donation_new WHERE `index` = __ID;

		SELECT __ID AS ID;

	END;
	ELSE
		SELECT -1 AS ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcDeleteGoldenTimeEvent` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcDeleteGoldenTimeEvent`(
	__ID BIGINT
)
BEGIN

	IF __ID > 0 THEN
	BEGIN

		DELETE FROM pangya.pangya_golden_time_info WHERE `index` = __ID;

		DELETE FROM pangya.pangya_golden_time_item WHERE golden_time_id = __ID;

		DELETE FROM pangya.pangya_golden_time_round WHERE golden_time_id = __ID;

		SELECT __ID AS ID;

	END;
	ELSE
		SELECT -1 AS ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcDeleteGoldenTimeItem` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcDeleteGoldenTimeItem`(
	__ID BIGINT
)
BEGIN

	IF __ID > 0 THEN
	BEGIN

		DELETE FROM pangya.pangya_golden_time_item WHERE `index` = __ID;

		SELECT __ID AS ID;

	END;
	ELSE
		SELECT -1 AS ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcDeleteGoldenTimeRound` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcDeleteGoldenTimeRound`(
	__ID BIGINT
)
BEGIN

	IF __ID > 0 THEN
	BEGIN

		DELETE FROM pangya.pangya_golden_time_round WHERE `index` = __ID;

		SELECT __ID AS ID;

	END;
	ELSE
		SELECT -1 AS ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcDeleteGuildBBS` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcDeleteGuildBBS`(
	__OWNER_UID INT,
	__BBS_SEQ BIGINT
)
BEGIN

	IF __BBS_SEQ > 0 THEN
		UPDATE pangya.pangya_guild_bbs SET STATE = 2 WHERE SEQ = __BBS_SEQ AND OWNER_UID = __OWNER_UID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcDeleteGuildBBSReply` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcDeleteGuildBBSReply`(
	__OWNER_UID INT,
	__BBS_SEQ BIGINT
)
BEGIN

	IF __BBS_SEQ > 0 THEN
		UPDATE pangya.pangya_guild_bbs_res SET STATE = 2 WHERE SEQ = __BBS_SEQ AND OWNER_UID = __OWNER_UID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcDeleteGuildNotice` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcDeleteGuildNotice`(
	__OWNER_UID INT,
	__NOTICE_SEQ BIGINT
)
BEGIN

	IF __NOTICE_SEQ > 0 THEN
		UPDATE
			pangya.pangya_guild_notice notice
			INNER JOIN
			pangya.pangya_guild b
			ON notice.GUILD_UID = b.GUILD_UID
				SET notice.STATE = 2
		WHERE notice.SEQ = __NOTICE_SEQ
			AND (__OWNER_UID = notice.OWNER_UID OR b.GUILD_LEADER = __OWNER_UID);
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcDeleteGuildPrivateBBS` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcDeleteGuildPrivateBBS`(
	__OWNER_UID INT,
	__SEQ BIGINT
)
BEGIN

	IF __SEQ > 0 THEN
		UPDATE 
			pangya.pangya_guild_private_bbs bbs
			INNER JOIN
			pangya.pangya_guild b
			ON bbs.GUILD_UID = b.GUILD_UID
				SET bbs.STATE = 2
		WHERE bbs.SEQ = __SEQ
			AND (bbs.OWNER_UID = __OWNER_UID OR b.GUILD_LEADER = __OWNER_UID);
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcDeleteGuildPrivateBBSReply` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcDeleteGuildPrivateBBSReply`(
	__OWNER_UID INT,
	__SEQ BIGINT
)
BEGIN

	IF __SEQ > 0 THEN
		UPDATE 
			pangya.pangya_guild a
			INNER JOIN
			pangya.pangya_guild_private_bbs b
			ON a.GUILD_UID = b.GUILD_UID
			INNER JOIN 
			pangya.pangya_guild_private_bbs_res bbs
			ON bbs.GUILD_BBS_SEQ = b.SEQ
				SET bbs.STATE = 2
		WHERE bbs.SEQ = __SEQ
			AND (bbs.OWNER_UID = __OWNER_UID OR a.GUILD_LEADER = __OWNER_UID);
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcDeleteLoginRewardEvent` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcDeleteLoginRewardEvent`(
	__ID BIGINT
)
BEGIN

	IF __ID > 0 THEN
	BEGIN

		DELETE FROM pangya.pangya_login_reward WHERE `index` = __ID;

		SELECT __ID AS ID;

	END;
	ELSE
		SELECT -1 AS ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcDeleteLogRescuePasswordAndID` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcDeleteLogRescuePasswordAndID`(
	__UID INT,
	__INDEX BIGINT
)
BEGIN

	IF __UID > 0 AND __INDEX > 0 THEN
	BEGIN
		
		DELETE FROM pangya.pangya_rescue_pwd_log WHERE UID = __UID AND `index` = __INDEX;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcDestribuiItemTutorial` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcDestribuiItemTutorial`(
	__IDUSER int,
	__VALOR int,
	__OPT int
)
BEGIN

	DECLARE __MSGID int;
	DECLARE __TYPEIDITEM int; 
	DECLARE __QNTD int;
    DECLARE __temp int DEFAULT -1;

	INSERT pangya.pangya_gift_table(
		pangya.pangya_gift_table.UID, 
		pangya.pangya_gift_table.fromid, 
		pangya.pangya_gift_table.message, 
		pangya.pangya_gift_table.giftdate, 
		pangya.pangya_gift_table.Lida_YN, 
		pangya.pangya_gift_table.valid, 
		pangya.pangya_gift_table.Flag, 
		pangya.pangya_gift_table.Contador_Vista)
	VALUES (
		__IDUSER, 
		'__SUPER', 
		'NICE TUTORIAL', 
		ifnull(now(), now()), 
		0, 
		1, 
		0, 
		0);

	SELECT max(pangya_gift_table.Msg_ID) INTO __MSGID
	FROM pangya.pangya_gift_table;

	IF __OPT = 0 THEN
	BEGIN

		IF __VALOR = 1 THEN
		BEGIN

			SET __TYPEIDITEM = 436207631;

			SET __QNTD = 3;

		END;
		ELSEIF __VALOR = 2 THEN
		BEGIN

			SET __TYPEIDITEM = 402653191;

			SET __QNTD = 3;

		END;
		ELSEIF __VALOR = 4 THEN
		BEGIN

			SET __TYPEIDITEM = 402653189;

			SET __QNTD = 3;

		END;
		ELSEIF __VALOR = 8 THEN
		BEGIN

			SET __TYPEIDITEM = 402653192;

			SET __QNTD = 3;

		END;
		ELSEIF __VALOR = 16 THEN
		BEGIN

			SET __TYPEIDITEM = 436207632;

			SET __QNTD = 500;

		END;
		ELSEIF __VALOR = 32 THEN
		BEGIN

			SET __TYPEIDITEM = 402653188;

			SET __QNTD = 3;

		END;
		ELSEIF __VALOR = 64 THEN
		BEGIN

			SET __TYPEIDITEM = 436207632;

			SET __QNTD = 500;

		END;
		ELSEIF __VALOR = 128 THEN
		BEGIN

			SET __TYPEIDITEM = 436207632;

			SET __QNTD = 1000;

		END;
        END IF;
	END;
	ELSE 
	BEGIN

		IF __VALOR = 256 THEN
		BEGIN

			SET __TYPEIDITEM = 436207631;

			SET __QNTD = 3;

		END;
		ELSEIF __VALOR = 512 THEN
		BEGIN

			SET __TYPEIDITEM = 402653224;

			SET __QNTD = 1;

		END;
		ELSEIF __VALOR = 1024 THEN
		BEGIN

			SET __TYPEIDITEM = 402653190;

			SET __QNTD = 1;

		END;
		ELSEIF __VALOR = 2048 THEN
		BEGIN

			SET __TYPEIDITEM = 402653191;

			SET __QNTD = 5;

		END;
		ELSEIF __VALOR = 4096 THEN
		BEGIN

			SET __TYPEIDITEM = 402653184;

			SET __QNTD = 4;

		END;
		ELSEIF __VALOR = 8192 THEN
		BEGIN

			SET __TYPEIDITEM = 402653185;

			SET __QNTD = 4;

		END;
        END IF;
	END;
    END IF;

	CALL pangya.ProcInsertItemNoEmail(
	0, 
	__IDUSER, 
	__MSGID, 
	__temp, 
	__TYPEIDITEM, 
	0, 
	__QNTD, 
	0);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcDo1stAnniversary` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcDo1stAnniversary`(
)
BEGIN

	-- Check if event 1st aniversary was finished
	IF NOT EXISTS (SELECT EVENT_DONE FROM pangya.pangya_1st_anniversary WHERE EVENT_DONE = 1 LIMIT 1) THEN
	BEGIN

		DECLARE __UID INT;
		DECLARE __LOGIN_DAYS INT;
		DECLARE __CP BIGINT;
		DECLARE __APT BIGINT DEFAULT 0;
		DECLARE __WIN BIGINT DEFAULT 0;
		DECLARE __MSG NVARCHAR(500);
		DECLARE __MSGID INT;
        DECLARE __FINISHED BOOL DEFAULT TRUE;

		-- Make cursor to all players win CP in 1st aniversary event
		DECLARE BIRTHDAY_EVENT CURSOR FOR
			SELECT 
				a.UID, a.COUNTER 
			FROM 
				pangya.pangya_attendance_reward a
				INNER JOIN
				pangya.user_info b
				ON a.UID = b.UID
			WHERE a.COUNTER >= 10;
            
		DECLARE CONTINUE HANDLER FOR NOT FOUND SET __FINISHED = FALSE;
            
		-- All players apt
		SELECT 
			__APT = COUNT(`counter`) 
		FROM 
			pangya.pangya_attendance_reward a
			INNER JOIN
			pangya.user_info b
			ON a.UID = b.UID;

		OPEN BIRTHDAY_EVENT;
		FETCH FROM BIRTHDAY_EVENT INTO __UID, __LOGIN_DAYS;
		
		WHILE (__FINISHED) DO
		BEGIN

			SET __MSGID = 0;
			
			-- CP Insert
			SET __CP = __LOGIN_DAYS * 10;

			SET __MSG = CONCAT('First anniversary celebration, You logged ', __LOGIN_DAYS, ' days and won ', __CP, 'CP.');

			INSERT INTO pangya.pangya_gift_table(UID, fromid, message, giftdate, Lida_YN, valid, Flag, Contador_Vista)
			VALUES(__UID, '__SUPERSS', __MSG, now(), 0, 1, 0, 0);

			SET __MSGID = last_insert_id();

			IF __MSGID > 0 THEN
			BEGIN

				-- INSERT Cookie Point to player
				UPDATE pangya.user_info SET Cookie = Cookie + __CP WHERE UID = __UID;

				-- Log
				INSERT INTO pangya.pangya_1st_anniversary_player_win_cp(UID, LOGIN_DAYS, COOKIE_POINT) VALUES(__UID, __LOGIN_DAYS, __CP);

				-- Comando para mostrar no jogo que o player recebeu um presente
				CALL pangya.ProcInsertCommand(4, __UID, __MSGID, 0, 0, 0, 1, 0, 1, null);

			END; -- IF MSG IS IS OK
			-- ELSE
				-- PRINT CONCAT('Failed to make gift table message to player[UID=', __UID, ']');
			END IF;

			-- Count Win player
			SET __WIN = __WIN + 1;

			-- NEXT ROW
			FETCH FROM BIRTHDAY_EVENT INTO __UID, __LOGIN_DAYS;

		END; -- End While
        END WHILE;

		-- Close cursor
		CLOSE BIRTHDAY_EVENT;
			
		-- Finish Event 1st aniversary
		IF (SELECT EVENT_DONE FROM pangya.pangya_1st_anniversary) IS NULL THEN
			INSERT INTO pangya.pangya_1st_anniversary(EVENT_DONE, ALL_PLAYER_APT, ALL_PLAYER_WIN) VALUES(1, __APT, __WIN);
		ELSE
			UPDATE pangya.pangya_1st_anniversary SET EVENT_DONE = 1, ALL_PLAYER_APT = __APT, ALL_PLAYER_WIN = __WIN;
		END IF;

		-- PRINT 'Event 1s Anniversary was finished succeful';

	END;
	ELSE
	BEGIN
		DECLARE __MSG_ERR NVARCHAR(500);

		SELECT __MSG_ERR = CONCAT('Event 1s Anniversary was finished in ', REG_DATE) FROM pangya.pangya_1st_anniversary LIMIT 1;

		-- PRINT __MSG_ERR;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcEquipCard` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcEquipCard`(
	__IDUSER INT,
	__CARD_TYPEID INT,
	__PART_ID INT,
	__PART_TYPEID INT,
	__EFEITO INT,
	__EFEITO_QNTD INT,
	__SLOT INT,
	__TIPO INT,
	__TEMPO INT
)
BEGIN

	DECLARE __INDEX BIGINT DEFAULT -1;

    -- Insert statements for procedure here
	IF __IDUSER > 0 AND __CARD_TYPEID > 0 THEN
	BEGIN
		DECLARE __REG_DT datetime DEFAULT NULL;
		DECLARE __END_DT datetime DEFAULT NULL;

		IF __TEMPO > 0 THEN
		BEGIN
			SET __REG_DT = now();
			SET __END_DT = TIMESTAMPADD(MINUTE, __TEMPO, __REG_DT);
		END;
        END IF;

		INSERT INTO pangya.pangya_card_equip(UID, parts_id, parts_typeid, card_typeid, Efeito, Efeito_Qntd, Slot, USE_DT, END_DT, Tipo, USE_YN)
			VALUES(__IDUSER, __PART_ID, __PART_TYPEID, __CARD_TYPEID, __EFEITO, __EFEITO_QNTD, __SLOT, __REG_DT, __END_DT, __TIPO, 1);

		SET __INDEX = last_insert_id();
	END;
	END IF;

	SELECT __INDEX AS `INDEX`;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcExchangeCookiePointByEpin` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcExchangeCookiePointByEpin`(
	__EPIN_ID BIGINT,
	__UID INT,
	__VALUE BIGINT
)
BEGIN

	IF __EPIN_ID > 0 AND __UID > 0 AND __VALUE > 0 THEN
	BEGIN

		-- Update Epin to valid = 0, já trocou o epin e o uid de quem trocou o epin por CP
		UPDATE pangya.pangya_donation_epin
			SET
				retrive_uid = __UID,
				valid = 0
		WHERE
			`index` = __EPIN_ID;

		-- Adiciona os CPs para o player
		UPDATE pangya.user_info
			SET
				Cookie = Cookie + __VALUE
		WHERE
			UID = __UID;

		-- CP Log
		INSERT INTO pangya.pangya_cookie_point_log(UID, `TYPE`, mail_id, cookie, item_qnty)
		VALUES(__UID, 4/*ADD CP FROM EPIN DONATION*/, -1, __VALUE, 0);

		SELECT __EPIN_ID AS ID;

	END;
	ELSE
		SELECT -1 AS ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcExcluiMsgMailBox` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcExcluiMsgMailBox`(
	__IDUSER int,
	__IDMSG int
)
BEGIN

	UPDATE pangya.pangya_gift_table
         SET 
            valid = 0
      WHERE pangya_gift_table.UID = __IDUSER AND pangya_gift_table.Msg_ID = __IDMSG;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcExtendeDiasCaddie` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcExtendeDiasCaddie`(
	__IDUSER int,
	__Caddie_ID int
)
BEGIN

	UPDATE pangya.pangya_caddie_information
         SET 
            EndDate = dateadd(day, 30, now())
      WHERE pangya_caddie_information.UID = __IDUSER AND pangya_caddie_information.item_id = __Caddie_ID;

      SELECT pangya_caddie_information.typeid
      FROM pangya.pangya_caddie_information
      WHERE pangya_caddie_information.UID = __IDUSER AND pangya_caddie_information.item_id = __caddie_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcExtendRental` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcExtendRental`(
	__IDUSER INT,
	__IDITEM INT,
	__END_DATE DATETIME
)
BEGIN

	UPDATE pangya.pangya_item_warehouse SET EndDate = __END_DATE WHERE UID = __IDUSER AND item_id = __IDITEM;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcFindCaddie` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcFindCaddie`(
	__IDUSER BIGINT,
	__ITEMTYPEID INT
)
BEGIN

	DECLARE __ITEM_ID BIGINT DEFAULT (SELECT item_id FROM pangya.pangya_caddie_information WHERE UID = __IDUSER AND typeid = __ITEMTYPEID LIMIT 1);
	
	IF __ITEM_ID IS NOT NULL THEN
		call pangya.ProcGetCaddieInfo_One(__IDUSER, __ITEM_ID);
	ELSE
		SELECT -1 AS item_id,
				0 as uid,
				0 as typeid,
				0 as parts_typeid,
				0 as clevel,
				0 as exp,
				0 as RentFlag,
				null as EndDate,
				0 as Purchase,
				null as parts_EndDate,
				0 CheckEnd;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcFindCard` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcFindCard`(
	__IDUSER BIGINT,
	__ITEMTYPEID INT
)
BEGIN

	DECLARE __ITEM_ID BIGINT DEFAULT (SELECT card_itemid FROM pangya.pangya_card WHERE QNTD > 0 AND UID = __IDUSER AND card_typeid = __ITEMTYPEID LIMIT 1);
	
	IF __ITEM_ID IS NOT NULL THEN
		call pangya.ProcGetCardInfo_One(__IDUSER, __ITEM_ID);
	ELSE
		SELECT -1 AS item_id,
				0 as uid,
				0 as card_typeid,
				0 as slot,
				0 as Efeito,
				0 as Efeito_Qntd,
				0 as qntd,
				null as use_dt,
				null as end_dt,
				0 as card_type,
				0 as use_yn;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcFindCharacter` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcFindCharacter`(
	__IDUSER BIGINT,
	__ITEMTYPEID INT
)
BEGIN

	DECLARE __ITEM_ID BIGINT DEFAULT (SELECT item_id FROM pangya.pangya_character_information WHERE UID = __IDUSER AND typeid = __ITEMTYPEID LIMIT 1);
	
	IF __ITEM_ID IS NOT NULL THEN
		call pangya.USP_CHAR_EQUIP_LOAD_S4_ONE(__IDUSER, __ITEM_ID);
	ELSE
		SELECT -1 AS item_id, 
            0 as typeid, 
            0 as ITEMID_PARTS_1, 
            0 as ITEMID_PARTS_2, 
            0 as ITEMID_PARTS_3, 
            0 as ITEMID_PARTS_4, 
            0 as ITEMID_PARTS_5, 
            0 as ITEMID_PARTS_6, 
            0 as ITEMID_PARTS_7, 
            0 as ITEMID_PARTS_8, 
            0 as ITEMID_PARTS_9, 
            0 as ITEMID_PARTS_10, 
            0 as ITEMID_PARTS_11, 
            0 as ITEMID_PARTS_12, 
            0 as ITEMID_PARTS_13, 
            0 as ITEMID_PARTS_14, 
            0 as ITEMID_PARTS_15, 
            0 as ITEMID_PARTS_16, 
            0 as ITEMID_PARTS_17, 
            0 as ITEMID_PARTS_18, 
            0 as ITEMID_PARTS_19, 
            0 as ITEMID_PARTS_20, 
            0 as ITEMID_PARTS_21, 
            0 as ITEMID_PARTS_22, 
            0 as ITEMID_PARTS_23, 
            0 as ITEMID_PARTS_24, 
            0 as parts_1, 
            0 as parts_2, 
            0 as parts_3, 
            0 as parts_4, 
            0 as parts_5, 
            0 as parts_6, 
            0 as parts_7, 
            0 as parts_8, 
            0 as parts_9, 
            0 as parts_10, 
            0 as parts_11, 
            0 as parts_12, 
            0 as parts_13, 
            0 as parts_14, 
            0 as parts_15, 
            0 as parts_16, 
            0 as parts_17, 
            0 as parts_18, 
            0 as parts_19, 
            0 as parts_20, 
            0 as parts_21, 
            0 as parts_22, 
            0 as parts_23, 
            0 as parts_24, 
            0 as default_hair, 
            0 as default_shirts, 
            0 as gift_flag, 
            0 as PCL0, 
            0 as PCL1, 
            0 as PCL2, 
            0 as PCL3, 
            0 as PCL4, 
            0 as Purchase, 
            0 as auxparts_1, 
            0 as auxparts_2, 
            0 as auxparts_3, 
            0 as auxparts_4, 
            0 as auxparts_5, 
            0 as CutIn_1,
            0 as CutIn_2,
            0 as CutIn_3,
            0 as CutIn_4,
            0 as Mastery, 
            0 as CARD_CHARACTER_1, 
            0 as CARD_CHARACTER_2, 
            0 as CARD_CHARACTER_3, 
            0 as CARD_CHARACTER_4, 
            0 as CARD_CADDIE_1, 
            0 as CARD_CADDIE_2, 
            0 as CARD_CADDIE_3, 
            0 as CARD_CADDIE_4, 
            0 as CARD_NPC_1, 
            0 as CARD_NPC_2, 
            0 as CARD_NPC_3, 
            0 as CARD_NPC_4;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcFindDolfiniLockerItem` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcFindDolfiniLockerItem`(
	__IDUSER BIGINT,
	__ITEMTYPEID INT
)
BEGIN

	DECLARE __ITEM_ID BIGINT DEFAULT (SELECT a.item_id FROM pangya.pangya_item_warehouse a INNER JOIN pangya.pangya_dolfini_locker_item b ON a.item_id = b.item_id WHERE a.UID = __IDUSER AND b.flag = 1 AND a.typeid = __ITEMTYPEID LIMIT 1);
	
	IF __ITEM_ID IS NOT NULL THEN
		call pangya.ProcGetDolfiniLockerItemOne(__IDUSER, __ITEM_ID);
	ELSE
		SELECT -1 AS item_id,
				0 as uid,
				0 as typeid,
				null as sd_name,
				null as sd_idx,
				0 as sd_seq,
				null as sd_copier_nick,
				0 as sd_status,
				0 as idx_dolfini_locker_item,
				0 as flag_dolfini_locker_item;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcFindFurniture` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcFindFurniture`(
	__IDUSER BIGINT,
	__ITEMTYPEID INT
)
BEGIN

	DECLARE __ITEM_ID BIGINT DEFAULT (SELECT MYROOM_ID FROM pangya.td_room_data WHERE UID = __IDUSER AND valid = 1 AND TYPEID = __ITEMTYPEID LIMIT 1);
	
	IF __ITEM_ID IS NOT NULL THEN
		call pangya.ProcGetMyRoom_One(__IDUSER, __ITEM_ID);
	ELSE
		SELECT -1 AS item_id,
				0 as uid,
				0 as typeid,
				0 as room_no,
				0 as pos_x,
				0 as pos_y,
				0 as pos_z,
				0 as pos_r,
				0 as use_yn;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcFindMailBoxItem` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcFindMailBoxItem`(
	__IDUSER BIGINT,
	__ITEMTYPEID INT
)
BEGIN

	DECLARE __ITEM_TYPEID INT DEFAULT 
		(SELECT b.item_typeid FROM pangya.pangya_gift_table a INNER JOIN pangya.pangya_item_mail b ON a.Msg_ID = b.Msg_ID WHERE a.UID = __IDUSER AND a.valid = 1 AND b.valid = 1 AND b.item_typeid = __ITEMTYPEID LIMIT 1);
	
	IF __ITEM_TYPEID IS NOT NULL THEN
		SELECT __ITEM_TYPEID AS ITEM_TYPEID; 
	ELSE 
		SELECT -1 AS ITEM_TYPEID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcFindMascot` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcFindMascot`(
	__IDUSER BIGINT,
	__ITEMTYPEID INT
)
BEGIN

	DECLARE __ITEM_ID BIGINT DEFAULT (SELECT item_id FROM pangya.pangya_mascot_info WHERE valid = 1 AND UID =  __IDUSER AND typeid = __ITEMTYPEID LIMIT 1);
	
	IF __ITEM_ID IS NOT NULL THEN
		call pangya.ProcGetMascotInfo_One(__IDUSER, __ITEM_ID);
	ELSE
		SELECT -1 AS ITEM_ID,
				0 as uid,
				0 as typeid,
				0 as mLevel,
				0 as mExp,
				0 as flag,
				null as message,
				0 as tipo,
				0 as IsCash,
				null as EndDate;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcFindTrofelGrandPrix` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcFindTrofelGrandPrix`(
	__IDUSER BIGINT,
	__ITEMTYPEID INT
)
BEGIN

	DECLARE __ITEM_ID BIGINT DEFAULT (SELECT item_id FROM pangya.pangya_trofel_grandprix WHERE UID = __IDUSER AND typeid = __ITEMTYPEID LIMIT 1);
	
	IF __ITEM_ID IS NOT NULL THEN
		SELECT item_id, typeid, qntd FROM pangya.pangya_trofel_grandprix WHERE UID = __IDUSER AND item_id = __ITEM_ID;
	ELSE
		SELECT -1 AS ITEM_ID,
				0 as typeid,
				0 as qntd;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcFindTrofelSpecial` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcFindTrofelSpecial`(
	__IDUSER BIGINT,
	__ITEMTYPEID INT
)
BEGIN

	DECLARE __ITEM_ID INT DEFAULT (SELECT item_id FROM pangya.pangya_trofel_especial WHERE UID = __IDUSER AND typeid = __ITEMTYPEID LIMIT 1);
	
	IF __ITEM_ID IS NOT NULL THEN
		SELECT item_id, typeid, qntd FROM pangya.pangya_trofel_especial WHERE UID = __IDUSER AND item_id = __ITEM_ID;
	ELSE
		SELECT -1 AS ITEM_ID,
				0 as typeid,
				0 as qntd;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcFindUCC` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcFindUCC`(
	__UCC_ID INT
)
BEGIN

	IF __UCC_ID > 0 THEN
	BEGIN
		DECLARE __IDUSER INT DEFAULT (SELECT uid FROM pangya.pangya_item_warehouse WHERE valid = 1 AND Gift_Flag = 0 AND item_id = __UCC_ID LIMIT 1);

		IF __IDUSER IS NOT NULL AND __IDUSER > 0
			AND (SELECT COPIER FROM pangya.tu_ucc WHERE UID = __IDUSER AND ITEM_ID = __UCC_ID) IS NOT NULL THEN
		BEGIN
	
			call pangya.ProcGetWareHouseItem_One(__IDUSER, __UCC_ID);
		END;
		ELSE
			SELECT -1 AS ITEM_ID,
				0 as uid,
				0 as typeid,
				0 as ano,
				0 as c0,
				0 as c1,
				0 as c2,
				0 as c3,
				0 as c4,
				0 as Purchase,
				0 as gift_flag,
				0 as flag,
				0 as apply_date,
				0 as end_date,
				0 as ItemType,
				0 as card_character_1,
				0 as card_character_2,
				0 as card_character_3,
				0 as card_character_4,
				0 as card_caddie_1,
				0 as card_caddie_2,
				0 as card_caddie_3,
				0 as card_caddie_4,
				0 as card_npc_1,
				0 as card_npc_2,
				0 as card_npc_3,
				0 as card_npc_4,
				0 as clubset_workshop_flag,
				0 as clubset_workshop_c0,
				0 as clubset_workshop_c1,
				0 as clubset_workshop_c2,
				0 as clubset_workshop_c3,
				0 as clubset_workshop_c4,
				0 as mastery_pts,
				0 as recovery_pts,
				0 as `level`,
				0 as up,
				null as sd_name,
				null as sd_idx,
				0 as sd_seq,
				null as sd_copier_nick,
				0 as sd_copier,
				0 as sd_trade,
				0 as sd_flag,
				0 as sd_status;
		END IF;
	END;
	ELSE
		SELECT -1 AS ITEM_ID,
				0 as uid,
				0 as typeid,
				0 as ano,
				0 as c0,
				0 as c1,
				0 as c2,
				0 as c3,
				0 as c4,
				0 as Purchase,
				0 as gift_flag,
				0 as flag,
				0 as apply_date,
				0 as end_date,
				0 as ItemType,
				0 as card_character_1,
				0 as card_character_2,
				0 as card_character_3,
				0 as card_character_4,
				0 as card_caddie_1,
				0 as card_caddie_2,
				0 as card_caddie_3,
				0 as card_caddie_4,
				0 as card_npc_1,
				0 as card_npc_2,
				0 as card_npc_3,
				0 as card_npc_4,
				0 as clubset_workshop_flag,
				0 as clubset_workshop_c0,
				0 as clubset_workshop_c1,
				0 as clubset_workshop_c2,
				0 as clubset_workshop_c3,
				0 as clubset_workshop_c4,
				0 as mastery_pts,
				0 as recovery_pts,
				0 as `level`,
				0 as up,
				null as sd_name,
				null as sd_idx,
				0 as sd_seq,
				null as sd_copier_nick,
				0 as sd_copier,
				0 as sd_trade,
				0 as sd_flag,
				0 as sd_status;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcFindWarehouseItem` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcFindWarehouseItem`(
	__IDUSER BIGINT,
	__ITEMTYPEID INT
)
BEGIN
	
   DECLARE __ITEM_ID BIGINT DEFAULT (SELECT item_id FROM pangya.pangya_item_warehouse WHERE valid = 1 AND Gift_Flag = 0 AND UID = __IDUSER AND typeid = __ITEMTYPEID LIMIT 1);
	
	IF __ITEM_ID IS NOT NULL THEN
		CALL pangya.ProcGetWareHouseItem_One(__IDUSER, __ITEM_ID);
	ELSE
		SELECT -1 AS ITEM_ID,
				0 as UID, 
				0 as typeid, 
				0 as Ano, 
				0 as C0, 
				0 as C1, 
				0 as C2, 
				0 as C3, 
				0 as C4, 
				0 as Purchase, 
				0 as Gift_flag, 
				0 as Flag, 
				0 as APPLY_DATE, 
				0 as END_DATE, 
				0 as ItemType, 
				0 as CARD_CHARACTER_1, 
				0 as CARD_CHARACTER_2, 
				0 as CARD_CHARACTER_3, 
				0 as CARD_CHARACTER_4, 
				0 as CARD_CADDIE_1, 
				0 as CARD_CADDIE_2, 
				0 as CARD_CADDIE_3, 
				0 as CARD_CADDIE_4, 
				0 as CARD_NPC_1, 
				0 as CARD_NPC_2, 
				0 as CARD_NPC_3, 
				0 as CARD_NPC_4, 
				0 as ClubSet_WorkShop_Flag, 
				0 as ClubSet_WorkShop_C0, 
				0 as ClubSet_WorkShop_C1, 
				0 as ClubSet_WorkShop_C2, 
				0 as ClubSet_WorkShop_C3, 
				0 as ClubSet_WorkShop_C4, 
				0 as Mastery_Pts, 
				0 as Recovery_Pts, 
				0 as `Level`, 
				0 as Up, 
				null as SD_NAME, 
				null as SD_IDX, 
				0 as SD_SEQ, 
				null as SD_COPIER_NICK, 
				0 as SD_COPIER, 
				0 as SD_TRADE, 
				0 as SD_FLAG, 
				0 as SD_STATUS;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcFinishLuciaAttendanceReward` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcFinishLuciaAttendanceReward`(
	__UID INT
)
BEGIN

	IF __UID > 0 THEN
	BEGIN
		UPDATE pangya.pangya_lucia_attendance
			SET last_day_get_item = now(),
				last_day_attendance = now(),
				count_day = 0
		WHERE UID = __UID;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcFinishQuestUser` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcFinishQuestUser`(
	__IDUSER BIGINT,
	__ID INT
)
BEGIN

	DECLARE __DT_NOW datetime DEFAULT now();
	
	UPDATE pangya.pangya_quest SET `Date` = __DT_NOW WHERE UID = __IDUSER AND id = __ID;
	
	SELECT CAST(UNIX_TIMESTAMP(__DT_NOW) AS signed) AS `Date`;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcFirstSet` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcFirstSet`(
	__IDUSER INT
)
BEGIN

	DECLARE __ITEMID INT DEFAULT 0;

    -- Club CV1 0x10000000
	-- exec USP_ADD_ITEM __IDUSER, 0, 0, -1, 268435456, 0, 0, 0, 8, 9, 8, 3, 3, 0, 0, 0, 0 
	call pangya.USP_ADD_ITEM(__IDUSER, 0, 0, -1, 268435456, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
	
	SET __ITEMID = (SELECT item_id FROM pangya.pangya_item_warehouse WHERE UID = __IDUSER AND typeid = 268435456);

	UPDATE pangya.pangya_user_equip SET club_id = __ITEMID WHERE UID = __IDUSER;

	-- Ball Padrão 0x14000000
	call pangya.USP_ADD_ITEM(__IDUSER, 0, 0, -1, 335544320, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);

	UPDATE pangya.pangya_user_equip SET ball_type = 335544320 WHERE UID = __IDUSER;

	-- Item Padrão que da pixel para os rookie
	call pangya.USP_ADD_ITEM(__IDUSER, 0, 0, -1, 436207622, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0);
    
    -- MP, Mileage Points Tiki Shop
	call pangya.USP_ADD_ITEM(__IDUSER, 0, 0, -1, 436208295, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0);
    
    -- Assist Item, para o modo assistente
	call pangya.USP_ADD_ITEM(__IDUSER, 0, 0, -1, 467664918, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0);
    
    -- Ativa Assistente no banco de dados
    UPDATE pangya.pangya_assistente SET assist = 1 WHERE UID = __IDUSER;
    
    -- 30 Grand Prix Ticket para jogar Grand Prix
    call pangya.USP_ADD_ITEM(__IDUSER, 0, 0, -1, 0x1A000264, 0, 0, 0, 30, 0, 0, 0, 0, 0, 0, 0, 0);

	-- User info, ESSES VALORES É SÓ PARA O CLOSED BETA, TROCA ISSO DEPOIS PARA O NORMAL
    UPDATE pangya.user_info SET Pang = Pang + 1000000, Cookie = Cookie + 90 WHERE UID = __IDUSER;
	
	-- Seta o Primeiro Set do Usuario
	UPDATE pangya.account SET FIRST_SET = 1, `Event` = 1 WHERE UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGachaCheckPlayer` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGachaCheckPlayer`(
	__id_in NVARCHAR(22),
	__pass NVARCHAR(32)
)
BEGIN

	DECLARE __IDUSER INT;
	DECLARE __returnvalue INT;

	call pangya.CheckWeblink_Key$IMPL(__id_in, __pass, __returnvalue);

	SET __IDUSER = __returnvalue;
    
	IF __IDUSER >= 0 THEN
	BEGIN
		DECLARE __KEY_ NVARCHAR(22);
		DECLARE __coin_count INT;

		SET __KEY_ = upper(left(md5(rand()), 22));

        SET __coin_count = IFNULL((SELECT COUNT(c0) as c0 FROM pangya.pangya_item_warehouse WHERE UID = __IDUSER AND typeid = 436207832), 0);
        
		IF (SELECT UID FROM pangya.pangya_gacha_user_key WHERE UID = __IDUSER) IS NULL THEN -- # Insere na tabela
			INSERT INTO pangya_gacha_user_key(uid, coin_count_entrou, `key`) VALUES(__IDUSER, __coin_count, __KEY_);
        ELSE -- # Att a Key
			UPDATE pangya.pangya_gacha_user_key SET att_flag = 0, coin_count_entrou = __coin_count, `key` = __KEY_, date_key_generation = now() WHERE uid = __IDUSER;
		END IF;
        
        SELECT __IDUSER as UID, __KEY_ as `KEY`;

	END;
	ELSE
		SELECT -1 as UID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGeraAuthKeyGame` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGeraAuthKeyGame`(
	__IDUSER int,
	__SERVERID INT
)
BEGIN
	
	DECLARE __Auth_Key nvarchar(7);

	DECLARE __COUNTER int DEFAULT 0;

	SELECT upper(left(md5(rand()), 7)) INTO __Auth_Key;

	SELECT __COUNTER = count(*)
	FROM pangya.authkey_game
	WHERE UID = __IDUSER AND ServerID = __SERVERID;

	IF __COUNTER > 0 THEN
	BEGIN
		UPDATE pangya.authkey_game
		SET 
		AuthKey = __Auth_Key, 
		valid = 1
		WHERE UID = __IDUSER AND ServerID = __SERVERID;
	END;
	ELSE 
	BEGIN
		INSERT pangya.authkey_game(UID, AuthKey, ServerID, valid)
		VALUES (__IDUSER, __Auth_Key, __SERVERID, 1);
	END;
    END IF;

	SELECT AuthKey
	FROM pangya.authkey_game
	WHERE UID = __IDUSER AND ServerID = __SERVERID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGeraAuthKeyLogin` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGeraAuthKeyLogin`(
	_IDUSER int
)
BEGIN
	
	DECLARE _Auth_Key nvarchar(7);

	DECLARE COUNTER int DEFAULT 0;

	SELECT upper(left(md5(rand()), 7)) INTO _Auth_Key;     

	SELECT count(*) INTO COUNTER
	FROM pangya.authkey_login
	WHERE UID = _IDUSER;

	IF COUNTER > 0 THEN
	BEGIN
		UPDATE pangya.authkey_login
			SET 
				AuthKey = _Auth_Key, 
				valid = 1
		WHERE UID = _IDUSER;
	END;
	ELSE 
	BEGIN

		INSERT pangya.authkey_login(UID, AuthKey, valid)
		VALUES (_IDUSER, _Auth_Key, 1);
	END;
    END IF;

	SELECT AuthKey
	FROM pangya.authkey_login
	WHERE UID = _IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGeraSecurityKey` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGeraSecurityKey`(
	__IDUSER int,
	__IDITEM int
)
BEGIN

	DECLARE __S_KEY nvarchar(20);

	SELECT __S_KEY = upper(left(md5(rand()), 20));

	UPDATE pangya.tu_ucc
		SET 
			SKEY = __S_KEY
	WHERE tu_ucc.UID = __IDUSER AND tu_ucc.ITEM_ID = __IDITEM;

	SELECT __S_KEY AS S_KEY;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGeraWeblinkKey` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGeraWeblinkKey`(
	__IDUSER int
)
BEGIN
	
	DECLARE __WEBLINK_KEY VARCHAR(6);
    
	-- upper(convert(varchar(32), hashbytes('md5', convert(varchar(32), rand(), 2)), 2))

    SELECT upper(left(md5(rand()), 6)) INTO __WEBLINK_KEY;
    
    IF (SELECT uid FROM pangya.pangya_weblink_key WHERE UID = __IDUSER) IS NOT NULL THEN
		UPDATE pangya.pangya_weblink_key SET pangya_weblink_key.`key` = __WEBLINK_KEY, valid = 1 WHERE UID = __IDUSER;
    ELSE
		INSERT INTO pangya.pangya_weblink_key(uid, pangya_weblink_key.`key`, valid) VALUES(__IDUSER, __WEBLINK_KEY, 1);
	END IF;
    
    SELECT pangya_weblink_key.`key` FROM pangya.pangya_weblink_key WHERE UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetAchievementQuest` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetAchievementQuest`(
	__IDUSER int
)
BEGIN

	SELECT 
         Z.TypeID AS ACHIEVEMENT_TYPEID, 
         Z.ID_ACHIEVEMENT AS ACHIEVEMENT_ID, 
         A.TypeID_ACHIEVE AS ACHIEVEMENT_QUEST_TYPEID, 
         A.Count_Num_Item AS ACHIEVEMENT_COUNTER_NUM, 
         A.Data_Sec AS ACHIEVEMENT_COUNTER_DATA_SEC
      FROM 
         (

            SELECT achievement_tipo.TypeID, achievement_tipo.ID_ACHIEVEMENT
            FROM pangya.achievement_tipo
            WHERE achievement_tipo.UID = __IDUSER AND achievement_tipo.TypeID < 2030043136
               ORDER BY achievement_tipo.ID_ACHIEVEMENT LIMIT 9223372036854775807
         )  AS Z 
            LEFT OUTER JOIN 
            (
               SELECT 
                  X.IDX, 
                  X.ID_ACHIEVEMENT, 
                  X.TypeID_ACHIEVE, 
                  X.Data_Sec, 
                  Y.Count_Num_Item
               FROM 
                  (
                     SELECT 
                        achievement_quest.IDX, 
                        achievement_quest.ID_ACHIEVEMENT, 
                        achievement_quest.TypeID_ACHIEVE, 
                        achievement_quest.Data_Sec, 
                        achievement_quest.Count_ID
                     FROM pangya.achievement_quest
                     WHERE achievement_quest.UID = __IDUSER
                  )  AS X 
                     INNER JOIN 
                     (
                        SELECT count_item.Count_Num_Item, count_item.Count_ID
                        FROM pangya.count_item
                        WHERE count_item.UID = __IDUSER
                     )  AS Y 
                     ON X.Count_ID = Y.Count_ID
            )  AS A 
            ON Z.ID_ACHIEVEMENT = A.ID_ACHIEVEMENT
         ORDER BY A.IDX;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetAchievement_New` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetAchievement_New`(
	__IDUSER int
)
BEGIN

	SELECT 
         Z.TIPO AS ACHIEVEMENT_TIPO, 
         Z.TypeID AS ACHIEVEMENT_TYPEID, 
         Z.ID_ACHIEVEMENT AS ACHIEVEMENT_ID, 
         Z.`Option` AS ACHIEVEMENT_OPTION, 
         A.TypeID_ACHIEVE AS ACHIEVEMENT_QUEST_TYPEID, 
         A.COUNT_TYPEID AS ACHIEVEMENT_COUNTER_TYPEID, 
         A.Count_ID AS ACHIEVEMENT_COUNTER_ID, 
         A.Count_Num_Item, 
         A.Data_Sec AS ACHIEVEMENT_COUNTER_DATA_SEC
      FROM 
         (

            SELECT achievement_tipo.TypeID, achievement_tipo.ID_ACHIEVEMENT, achievement_tipo.TIPO, achievement_tipo.`Option`
            FROM pangya.achievement_tipo
            WHERE achievement_tipo.UID = __IDUSER AND achievement_tipo.TypeID < 2030043136
         )  AS Z 
            LEFT OUTER JOIN 
            (
               SELECT 
                  X.IDX, 
                  X.ID_ACHIEVEMENT, 
                  X.TypeID_ACHIEVE, 
                  X.Data_Sec, 
                  Y.Count_ID, 
                  Y.TypeID AS COUNT_TYPEID, 
                  Y.Count_Num_Item
               FROM 
                  (
                     SELECT 
                        achievement_quest.IDX, 
                        achievement_quest.ID_ACHIEVEMENT, 
                        achievement_quest.TypeID_ACHIEVE, 
                        achievement_quest.Data_Sec, 
                        achievement_quest.Count_ID
                     FROM pangya.achievement_quest
                     WHERE achievement_quest.UID = __IDUSER
                  )  AS X 
                     INNER JOIN 
                     (
                        SELECT count_item.TypeID, count_item.Count_ID, count_item.Count_Num_Item
                        FROM pangya.count_item
                        WHERE count_item.UID = __IDUSER
                     )  AS Y 
                     ON X.Count_ID = Y.Count_ID
            )  AS A 
            ON Z.ID_ACHIEVEMENT = A.ID_ACHIEVEMENT
         ORDER BY A.IDX;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetAchieveQuest` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetAchieveQuest`(
	__IDUSER int
)
BEGIN

	SELECT B.TypeID_ACHIEVE, IFNULL(C.TypeID, 0) AS TypeID, IFNULL(C.Count_ID, 0) AS Count_ID, IFNULL(C.Data_Sec, 0) AS Data_Sec
      FROM 
         (
            SELECT 
               a.TypeID, 
               D.IDX, 
               D.UID, 
               D.ID_ACHIEVEMENT, 
               D.TypeID_ACHIEVE, 
               D.Count_ID, 
               D.Data_Sec, 
               D.Objetivo_Quest
            FROM pangya.achievement_tipo  AS a, pangya.achievement_quest  AS D
            WHERE D.UID = __IDUSER AND a.ID_ACHIEVEMENT = D.ID_ACHIEVEMENT
         )  AS B 
            LEFT OUTER JOIN 
            (
               SELECT 
                  count_item.UID, 
                  count_item.Nome, 
                  count_item.ID_ACHIEVEMENT, 
                  count_item.TypeID, 
                  count_item.Count_ID, 
                  count_item.Count_Num_Item, 
                  count_item.Data_Sec, 
                  count_item.TIPO
               FROM pangya.count_item
               WHERE count_item.UID = __IDUSER
            )  AS C 
            ON C.Count_ID = B.Count_ID
      WHERE B.UID = __IDUSER
         ORDER BY B.IDX;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetAchieveQuestGUI` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetAchieveQuestGUI`(
	__IDUSER int
)
BEGIN

	SELECT B.TypeID_ACHIEVE, min(c.Count_Num_Item) AS Count_Num_Item, min(c.Data_Sec) AS Data_Sec
      FROM pangya.achievement_tipo  AS A, pangya.achievement_quest  AS B, pangya.count_item  AS c
      WHERE 
         A.ID_ACHIEVEMENT = B.ID_ACHIEVEMENT AND 
         B.Count_ID = c.Count_ID AND 
         A.UID = __IDUSER AND 
         A.TypeID < 1946157056
      GROUP BY B.TypeID_ACHIEVE
         ORDER BY min(B.IDX);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetAchieveType` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetAchieveType`(
	__IDUSER int
)
BEGIN

	SELECT 
         min(A.TIPO) AS TIPO, 
         min(A.TypeID) AS TypeID, 
         min(A.ID_ACHIEVEMENT) AS ID_ACHIEVEMENT, 
         min(A.`Option`) AS `Option`, 
         count_big(b.ID_ACHIEVEMENT) AS COUNTER
      FROM pangya.achievement_tipo  AS A, pangya.achievement_quest  AS b
      WHERE 
         A.ID_ACHIEVEMENT = b.ID_ACHIEVEMENT AND 
         A.UID = __IDUSER AND 
         A.TIPO <> 2
      GROUP BY b.ID_ACHIEVEMENT
         ORDER BY b.ID_ACHIEVEMENT;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetAchieveTypeGUI` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetAchieveTypeGUI`(
	__IDUSER int
)
BEGIN

	SELECT min(A.TypeID) AS TypeID, min(A.ID_ACHIEVEMENT) AS ID_ACHIEVEMENT, count_big(b.ID_ACHIEVEMENT) AS COUNTER
      FROM pangya.achievement_tipo  AS A, pangya.achievement_quest  AS b
      WHERE 
         A.ID_ACHIEVEMENT = b.ID_ACHIEVEMENT AND 
         A.UID = __IDUSER AND 
         A.TypeID < 1946157056
      GROUP BY b.ID_ACHIEVEMENT
         ORDER BY b.ID_ACHIEVEMENT;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetAllDonationAndEpinByPlayer` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetAllDonationAndEpinByPlayer`(
	__UID INT
)
BEGIN

	IF __UID > 0 THEN
	BEGIN
		
		SELECT
			a.`code`,
			a.plataforma,
			a.`date`,
			a.gross_amount,
			a.`status`,
			b.epin,
			b.qntd as cp_qntd,
			b.valid as epin_valid
		FROM
			pangya.pangya_donation_new a
			LEFT OUTER JOIN
			pangya.pangya_donation_epin b
			ON a.`index` = b.donation_id AND a.epin_id = b.`index`
		WHERE
			a.UID = __UID;
	END;
	ELSE
		SELECT -1 AS `CODE`;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetAllDonationsAndEpin` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetAllDonationsAndEpin`(
)
BEGIN

	SELECT
		a.`code`,
		a.`date`,
		a.email,
		a.escrow,
		a.gross_amount,
		a.net_amount,
		a.plataforma,
		a.epin_id,
		a.`reference`,
		a.reg_date,
		a.`status`,
		a.`type`,
		a.`update`,
		a.uid,
		a.`index`,
		b.epin,
		b.qntd as cp_qntd,
		b.retrive_uid as epin_get_uid,
		b.valid as epin_valid
	FROM
		pangya.pangya_donation_new a
		LEFT OUTER JOIN
		pangya.pangya_donation_epin b
		ON a.`index` = b.donation_id AND a.epin_id = b.`index`;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetAllEmailFromMailBox` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetAllEmailFromMailBox`(
	__IDUSER INT
)
BEGIN
	
	IF __IDUSER > 0 THEN
	BEGIN
		
        SELECT 
            A.Msg_ID, 
            A.fromid,  
			A.giftdate, 
            A.`message`, 
            A.Contador_Vista, 
            A.Lida_YN, 
            IFNULL(B.item_id, 0) AS ITEM_ID,
            IFNULL(B.item_typeid, 0) AS ITEM_TYPEID, 
            IFNULL(B.Flag, 0) AS FLAG, 
			IFNULL(B.Quantidade_item, 0) AS QUANTIDADE_ITEM, 
			IFNULL(B.Quantidade_Dia, 0) AS QUANTIDADE_DIA, 
            IFNULL(B.Pang, 0) AS PANG, 
			IFNULL(B.Cookie, 0) AS COOKIE, 
			IFNULL(B.GM_ID, 0) AS GM_ID, 
			IFNULL(B.Flag_Gift, 0) AS FLAG_GIFT,  
			IFNULL((SELECT UCCIDX FROM pangya.tu_ucc WHERE item_id = B.item_id), '0') AS UCC_IMG_MARK, 
            IFNULL(B.`Type`, 0) AS `TYPE`
        FROM 
        (
            SELECT 
				UID, 
				Msg_ID, 
				fromid, 
				`message`, 
				giftdate, 
				Flag, 
				Contador_Vista, 
				Lida_YN
            FROM pangya.pangya_gift_table
            WHERE valid = 1
        )  AS A 
        LEFT OUTER JOIN 
        (
            SELECT 
				Msg_ID AS ID_MSG, 
				item_id, 
				item_typeid, 
				Flag, 
				Quantidade_item, 
				Quantidade_Dia, 
				Pang, 
				Cookie, 
				GM_ID, 
				Flag_Gift, 
				UCC_IMG_MARK, 
				`Type`
            FROM pangya.pangya_item_mail
            WHERE valid = 1
        )  AS B 
        ON A.Msg_ID = B.ID_MSG
		WHERE UID = __IDUSER;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetAllItemByPlayer` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetAllItemByPlayer`(
	__IDUSER INT
)
BEGIN

	IF __IDUSER > 0 THEN
	BEGIN

		SELECT
			a.TYPEID,
			a.`TYPE`
		FROM
		(
			-- Select Caddie item
			SELECT typeid, 0 as `type` FROM pangya.pangya_caddie_information WHERE UID = __IDUSER AND Valid = 1 AND typeid > 0
			GROUP BY typeid 
			-- ORDER BY typeid
			UNION ALL
			-- Select Mascot item
			SELECT typeid, 1 as `type` FROM pangya.pangya_mascot_info WHERE UID = __IDUSER AND Valid = 1 AND
				(Tipo != 1 OR Period = 0 OR EndDate = RegDate OR TIMESTAMPDIFF(SECOND, now(), EndDate) > 0)
				AND typeid > 0
			GROUP BY typeid 
			-- ORDER BY typeid
			UNION ALL
			-- Select Warehouse item
			SELECT typeid, 2 as `type` FROM pangya.pangya_item_warehouse WHERE UID = __IDUSER AND valid = 1 AND 
				Gift_Flag = 0 AND (flag = 96 OR applytime = enddate OR typeid = 0x1A000042/*TICKET REPORT*/ OR enddate > CURRENT_TIMESTAMP)
				AND typeid > 0
			GROUP BY typeid
			-- ORDER BY typeid
			UNION ALL
			-- Dolphin Locker
			SELECT
				a.typeid, 3 as `type`
			FROM 
				pangya.pangya_item_warehouse a
				INNER JOIN pangya.pangya_dolfini_locker_item c
				ON a.item_id = c.item_id
			WHERE a.uid = __IDUSER AND c.flag = 1 AND a.typeid > 0
			GROUP BY a.typeid
			-- ORDER BY a.typeid
			UNION ALL
			-- Mail Box
			SELECT
				b.item_typeid as typeid, 4 as `type`
			FROM
				pangya.pangya_gift_table a
				INNER JOIN
				pangya.pangya_item_mail b
				ON a.Msg_ID = b.Msg_ID
			WHERE
				a.UID = __IDUSER AND a.valid = 1 AND b.valid = 1
				AND b.item_typeid > 0
			GROUP BY b.item_typeid
		) a
		ORDER BY a.`type`, a.typeid;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetApproachMissions` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetApproachMissions`()
BEGIN
	
	SELECT 
         pangya_approach_missions.numero, 
         pangya_approach_missions.tipo, 
         pangya_approach_missions.reward_tipo, 
         pangya_approach_missions.box, 
         pangya_approach_missions.flag
      FROM pangya.pangya_approach_missions
      WHERE pangya_approach_missions.active = 1;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetAttendanceReward` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetAttendanceReward`(
	__IDUSER int
)
BEGIN
	
	SELECT 
         `counter`, 
         item_typeid_now, 
         item_qntd_now, 
         item_typeid_after, 
         item_qntd_after,
		 last_login
      FROM pangya.pangya_attendance_reward
      WHERE UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetAuthKeyGame` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetAuthKeyGame`(
	__IDUSER INT,
	__SERVERID INT
)
BEGIN

	SELECT AuthKey, ServerID, valid
	FROM pangya.authkey_game
	WHERE UID = __IDUSER AND ServerID = __SERVERID;

	UPDATE pangya.authkey_game SET valid = 0 WHERE UID = __IDUSER AND ServerID = __SERVERID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetAuthKeyLogin` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetAuthKeyLogin`(
	__IDUSER int
)
BEGIN
	
	SELECT AuthKey, valid
	FROM pangya.authkey_login
	WHERE UID = __IDUSER;

	UPDATE pangya.authkey_login SET valid = 0 WHERE UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetBlackPapelItem` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetBlackPapelItem`(
)
BEGIN

	SELECT black_papel_item.Typeid, black_papel_item.Tipo
      FROM pangya.black_papel_item
         ORDER BY black_papel_item.Tipo;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetBlackPapelRate` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetBlackPapelRate`(
)
BEGIN

	SELECT black_papel_rate.Nome, black_papel_rate.Probabilidade, black_papel_rate.tipo
      FROM pangya.black_papel_rate;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetBoxInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetBoxInfo`()
BEGIN
	
	SELECT 
		 a.id
		,a.typeid
		,a.numero
		,a.tipo_open
		,a.tipo
		,a.opened_typeid
		,a.`message`
		,b.typeid as item_typeid
		,b.numero as item_numero
		,b.probabilidade as item_probabilidade
		,b.qntd as item_qntd
		,b.raridade as item_raridade
		,b.duplicar as item_duplicar
		,b.active as item_active
	FROM pangya.pangya_new_box as a
	INNER JOIN
	pangya.pangya_new_box_item as b
	ON a.id = b.box_id AND (a.numero = b.numero OR b.numero = -1)
	WHERE a.active = 1;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetBPCouponsUser` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetBPCouponsUser`(
	__IDUSER int
)
BEGIN

	DECLARE __ITEMTYPEID int DEFAULT 0 ;
	DECLARE __QNTD int DEFAULT 0; 
	DECLARE __C0_QNTD int DEFAULT 0;
	DECLARE __COUNT int DEFAULT 0; 
	DECLARE __OPT int DEFAULT 0;

	SET __ITEMTYPEID = 436207656;

	SET __COUNT = 0;

	whLoop: WHILE (1 = 1) DO
	BEGIN

		IF __COUNT < 3 THEN
		BEGIN

			SELECT __QNTD = pangya_item_warehouse.item_id
			FROM pangya.pangya_item_warehouse
			WHERE pangya_item_warehouse.UID = __IDUSER AND pangya_item_warehouse.typeid = __ITEMTYPEID + __COUNT;

			SELECT __C0_QNTD = pangya_item_warehouse.C0
			FROM pangya.pangya_item_warehouse
			WHERE pangya_item_warehouse.UID = __IDUSER AND pangya_item_warehouse.typeid = __ITEMTYPEID + __COUNT;

			IF __QNTD > 0 AND __C0_QNTD > 0 THEN
			BEGIN

				SET __ITEMTYPEID = __ITEMTYPEID + __COUNT;

				SELECT pangya_item_warehouse.typeid
				FROM pangya.pangya_item_warehouse
				WHERE pangya_item_warehouse.UID = __IDUSER AND pangya_item_warehouse.typeid = __ITEMTYPEID;

				SET __OPT = 1;

				LEAVE whLoop;

			END;
            END IF;

			SET __COUNT = __COUNT + 1;

			ITERATE whLoop;

		END;
        END IF;

		LEAVE whLoop;

	END;
	END WHILE whLoop;

	IF __OPT = 0 THEN
	BEGIN

		UPDATE pangya.user_info
			SET 
				Pang = user_info.Pang - 900
		WHERE user_info.UID = __IDUSER;

		SELECT __OPT AS typeid;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetCaddieFerias` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetCaddieFerias`(
	__IDUSER INT
)
BEGIN
	
	IF __IDUSER > 0 THEN
	BEGIN
		SELECT 
			pangya_caddie_information.item_id, 
			pangya_caddie_information.UID, 
			pangya_caddie_information.typeid, 
			pangya_caddie_information.parts_typeid,
			pangya_caddie_information.cLevel, 
			pangya_caddie_information.`Exp`, 
			pangya_caddie_information.RentFlag, 
			pangya_caddie_information.EndDate,
			pangya_caddie_information.Purchase, 
			pangya_caddie_information.parts_EndDate,
			pangya_caddie_information.CheckEnd
		FROM pangya.pangya_caddie_information
		WHERE pangya_caddie_information.UID = __IDUSER 
			AND pangya_caddie_information.Valid = 1
			AND (timestampdiff(SECOND, now(), pangya_caddie_information.EndDate) <= 0 
				AND pangya_caddie_information.RentFlag = 2
				AND pangya_caddie_information.CheckEnd = 1);
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetCaddieInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetCaddieInfo`(
	__IDUSER int
)
BEGIN
	
	IF __IDUSER > 0 THEN
	BEGIN
		SELECT 
			pangya_caddie_information.item_id, 
			pangya_caddie_information.UID, 
			pangya_caddie_information.typeid, 
			pangya_caddie_information.parts_typeid,
			pangya_caddie_information.cLevel, 
			pangya_caddie_information.`Exp`, 
			pangya_caddie_information.RentFlag, 
			pangya_caddie_information.EndDate,
			pangya_caddie_information.Purchase, 
			pangya_caddie_information.parts_EndDate,
			pangya_caddie_information.CheckEnd
		FROM pangya.pangya_caddie_information
		WHERE pangya_caddie_information.UID = __IDUSER 
		AND pangya_caddie_information.Valid = 1;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetCaddieInfo_One` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetCaddieInfo_One`(
	__IDUSER int,
	__CaddieID int
)
BEGIN

	IF __IDUSER > 0 AND __CaddieID > 0 THEN
	BEGIN
		SELECT 
			pangya_caddie_information.item_id, 
			pangya_caddie_information.UID, 
			pangya_caddie_information.typeid, 
			pangya_caddie_information.parts_typeid,
			pangya_caddie_information.cLevel, 
			pangya_caddie_information.Exp, 
			pangya_caddie_information.RentFlag, 
			pangya_caddie_information.EndDate,
			pangya_caddie_information.Purchase, 
			pangya_caddie_information.parts_EndDate,
			pangya_caddie_information.CheckEnd
		FROM pangya.pangya_caddie_information
		WHERE pangya_caddie_information.UID = __IDUSER 
			AND pangya_caddie_information.Valid = 1
			AND item_id = __CaddieID;
	END;
	ELSE
		SELECT -1 AS ITEM_ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetCardEquip` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetCardEquip`(
	__IDUSER int,
	__OPT int
)
BEGIN
	
	IF __OPT = 0 THEN
	BEGIN

		SELECT 
			pangya_card_equip.`index`,
			pangya_card_equip.card_typeid, 
			pangya_card_equip.UID, 
			pangya_card_equip.parts_typeid, 
			pangya_card_equip.parts_id, 
			pangya_card_equip.Efeito, 
			pangya_card_equip.Efeito_Qntd, 
			pangya_card_equip.Slot, 
			USE_DT, 
			END_DT, 
			NULL AS TEMPO,
			pangya_card_equip.Tipo, 
			pangya_card_equip.USE_YN
		FROM pangya.pangya_card_equip
		WHERE 
			pangya_card_equip.UID = __IDUSER AND 
			pangya_card_equip.USE_YN = 1 AND 
			GroupID(pangya_card_equip.card_typeid) BETWEEN 124 AND 125 AND (USE_DT IS NULL OR timestampdiff(minute, now(), pangya_card_equip.END_DT) > 0)
			ORDER BY pangya_card_equip.card_typeid;      

	END;
	ELSE 
	BEGIN
		IF __OPT = 1 THEN

			SELECT 
				-1 as `index`,
				pangya_card_equip.card_typeid, 
				pangya_card_equip.UID, 
				pangya_card_equip.parts_typeid, 
				pangya_card_equip.parts_id, 
				pangya_card_equip.Efeito, 
				pangya_card_equip.Efeito_Qntd, 
				pangya_card_equip.Slot, 
				USE_DT, 
				END_DT,
				timestampdiff(second, now(), pangya_card_equip.END_DT) AS TEMPO, 
				pangya_card_equip.Tipo, 
				pangya_card_equip.USE_YN
			FROM pangya.pangya_card_equip
			WHERE 
				pangya_card_equip.UID = __IDUSER AND 
				pangya_card_equip.USE_YN = 1 AND 
				GroupID(pangya_card_equip.card_typeid) = 26 AND (USE_DT IS NULL OR timestampdiff(minute, now(), pangya_card_equip.END_DT) > 0)
				ORDER BY pangya_card_equip.card_typeid;
		END IF;
        
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetCardInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetCardInfo`(
	__IDUSER int
)
BEGIN
	
	SELECT 
         pangya_card.card_itemid, 
         pangya_card.UID, 
         pangya_card.card_typeid, 
         pangya_card.Slot, 
         pangya_card.Efeito, 
         pangya_card.Efeito_Qntd, 
         pangya_card.QNTD, 
         pangya_card.USE_DT,
         pangya_card.END_DT, 
         pangya_card.card_type, 
          (CASE 
            WHEN pangya_card.USE_YN = 'N' THEN 0
            ELSE 1
         END) AS USE_YN
      FROM pangya.pangya_card
      WHERE pangya_card.UID = __IDUSER AND pangya_card.QNTD > 0
         ORDER BY pangya_card.card_itemid;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetCardInfo_One` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetCardInfo_One`(
	__IDUSER int,
	__IDITEM int
)
BEGIN

	SELECT 
         pangya_card.card_itemid, 
         pangya_card.UID, 
         pangya_card.card_typeid, 
         pangya_card.Slot, 
         pangya_card.Efeito, 
         pangya_card.Efeito_Qntd, 
         pangya_card.QNTD, 
         pangya_card.USE_DT, 
         pangya_card.END_DT, 
         pangya_card.card_type, 
          (CASE 
            WHEN pangya_card.USE_YN = 'N' THEN 0
            ELSE 1
         END) AS USE_YN
      FROM pangya.pangya_card
      WHERE pangya_card.UID = __IDUSER AND pangya_card.card_itemid = __IDITEM;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetCardPack` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetCardPack`(
	__TYPEIDCARDPACK int
)
BEGIN

	SELECT pangya_cards.TypeID_Card, pangya_cards.Tipo
      FROM pangya.pangya_cards
      WHERE pangya_cards.TypeID_Pack = __TYPEIDCARDPACK
         ORDER BY pangya_cards.Tipo;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetCardRate` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetCardRate`(
)
BEGIN

	SELECT pangya_card_rate.nome, pangya_card_rate.tipo, pangya_card_rate.probabilidade
      FROM pangya.pangya_card_rate;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetCharacterInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetCharacterInfo`(
	__IDUSER int
)
BEGIN

	SELECT 
         pangya_character_information.item_id, 
         pangya_character_information.UID, 
         pangya_character_information.typeid, 
         pangya_character_information.parts_1, 
         pangya_character_information.parts_2, 
         pangya_character_information.parts_3, 
         pangya_character_information.parts_4, 
         pangya_character_information.parts_5, 
         pangya_character_information.parts_6, 
         pangya_character_information.parts_7, 
         pangya_character_information.parts_8, 
         pangya_character_information.parts_9, 
         pangya_character_information.parts_10, 
         pangya_character_information.parts_11, 
         pangya_character_information.parts_12, 
         pangya_character_information.parts_13, 
         pangya_character_information.parts_14, 
         pangya_character_information.parts_15, 
         pangya_character_information.parts_16, 
         pangya_character_information.parts_17, 
         pangya_character_information.parts_18, 
         pangya_character_information.parts_19, 
         pangya_character_information.parts_20, 
         pangya_character_information.parts_21, 
         pangya_character_information.parts_22, 
         pangya_character_information.parts_23, 
         pangya_character_information.parts_24, 
         pangya_character_information.default_hair, 
         pangya_character_information.default_shirts, 
         pangya_character_information.gift_flag, 
         pangya_character_information.PCL0, 
         pangya_character_information.PCL1, 
         pangya_character_information.PCL2, 
         pangya_character_information.PCL3, 
         pangya_character_information.PCL4, 
         pangya_character_information.Purchase, 
         pangya_character_information.auxparts_1, 
         pangya_character_information.auxparts_2, 
         pangya_character_information.auxparts_3, 
         pangya_character_information.auxparts_4, 
         pangya_character_information.auxparts_5
      FROM pangya.pangya_character_information
      WHERE pangya_character_information.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetCharacterInfo_One` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetCharacterInfo_One`(
	__IDUSER int
)
BEGIN

	DECLARE __IDITEM int;

      SELECT __IDITEM = pangya_user_equip.character_id
      FROM pangya.pangya_user_equip
      WHERE pangya_user_equip.UID = __IDUSER;

      SELECT 
         pangya_character_information.item_id, 
         pangya_character_information.UID, 
         pangya_character_information.typeid, 
         pangya_character_information.parts_1, 
         pangya_character_information.parts_2, 
         pangya_character_information.parts_3, 
         pangya_character_information.parts_4, 
         pangya_character_information.parts_5, 
         pangya_character_information.parts_6, 
         pangya_character_information.parts_7, 
         pangya_character_information.parts_8, 
         pangya_character_information.parts_9, 
         pangya_character_information.parts_10, 
         pangya_character_information.parts_11, 
         pangya_character_information.parts_12, 
         pangya_character_information.parts_13, 
         pangya_character_information.parts_14, 
         pangya_character_information.parts_15, 
         pangya_character_information.parts_16, 
         pangya_character_information.parts_17, 
         pangya_character_information.parts_18, 
         pangya_character_information.parts_19, 
         pangya_character_information.parts_20, 
         pangya_character_information.parts_21, 
         pangya_character_information.parts_22, 
         pangya_character_information.parts_23, 
         pangya_character_information.parts_24, 
         pangya_character_information.default_hair, 
         pangya_character_information.default_shirts, 
         pangya_character_information.gift_flag, 
         pangya_character_information.PCL0, 
         pangya_character_information.PCL1, 
         pangya_character_information.PCL2, 
         pangya_character_information.PCL3, 
         pangya_character_information.PCL4, 
         pangya_character_information.Purchase, 
         pangya_character_information.auxparts_1, 
         pangya_character_information.auxparts_2, 
         pangya_character_information.auxparts_3, 
         pangya_character_information.auxparts_4, 
         pangya_character_information.auxparts_5
      FROM pangya.pangya_character_information
      WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.item_id = __IDITEM;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetCometRefillInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetCometRefillInfo`()
BEGIN
	
	SELECT typeid, `min`, `max` FROM pangya.pangya_comet_refill;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetCommands` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetCommands`()
BEGIN
	
    SELECT idx, command_id, arg1, arg2, arg3, arg4, arg5, target, flag, valid,
			IFNULL(UNIX_TIMESTAMP(reserveDate), 0) as reserveDate
	FROM pangya.pangya_command 
	WHERE valid = 1 AND (reserveDate IS NULL OR now() >= reserveDate)
	ORDER BY regDate;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetCountItem` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetCountItem`(
	__IDUSER int
)
BEGIN

	SELECT count_item.TIPO, count_item.TypeID, count_item.Count_ID, count_item.Count_Num_Item
      FROM pangya.count_item
      WHERE count_item.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetCourseReward` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetCourseReward`()
BEGIN
	
	SELECT pangya_course_reward_treasure.COURSE, pangya_course_reward_treasure.PANGREWARD
      FROM pangya.pangya_course_reward_treasure
         ORDER BY pangya_course_reward_treasure.COURSE;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetCourseRewardOne` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetCourseRewardOne`(
	__course_in int
)
BEGIN

	SELECT pangya_course_reward_treasure.COURSE, pangya_course_reward_treasure.PANGREWARD
      FROM pangya.pangya_course_reward_treasure
      WHERE pangya_course_reward_treasure.COURSE = __course_in;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetCubeCoinLocation` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetCubeCoinLocation`(
	__tipo_in int,
	__course_in int,
	__hole_in int,
	__config2_in int
)
BEGIN

	SELECT 
         pangya_cube_coin_location.tipo, 
         pangya_cube_coin_location.config2, 
         pangya_cube_coin_location.x AS X, 
         pangya_cube_coin_location.y AS Y, 
         pangya_cube_coin_location.z AS Z
      FROM pangya.pangya_cube_coin_location
      WHERE 
         pangya_cube_coin_location.tipo = __tipo_in AND 
         pangya_cube_coin_location.course = __course_in AND 
         pangya_cube_coin_location.hole = __hole_in AND 
         pangya_cube_coin_location.config2 = __config2_in;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetDailyAchieveQuest` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetDailyAchieveQuest`(
	__IDUSER int
)
BEGIN

	SELECT B.TypeID_ACHIEVE, IFNULL(min(C.TypeID), 0) AS TypeID, IFNULL(min(C.Count_ID), 0) AS Count_ID, IFNULL(min(C.Data_Sec), 0) AS Data_Sec
      FROM 
         (
            SELECT 
               a.TypeID, 
               a.`Option`, 
               D.IDX, 
               D.UID, 
               D.ID_ACHIEVEMENT, 
               D.TypeID_ACHIEVE, 
               D.Count_ID, 
               D.Data_Sec, 
               D.Objetivo_Quest
            FROM pangya.achievement_tipo  AS a, pangya.achievement_quest  AS D
            WHERE D.UID = __IDUSER AND a.ID_ACHIEVEMENT = D.ID_ACHIEVEMENT
         )  AS B 
            LEFT OUTER JOIN 
            (
               SELECT 
                  count_item.UID, 
                  count_item.Nome, 
                  count_item.ID_ACHIEVEMENT, 
                  count_item.TypeID, 
                  count_item.Count_ID, 
                  count_item.Count_Num_Item, 
                  count_item.Data_Sec, 
                  count_item.TIPO
               FROM pangya.count_item
               WHERE count_item.UID = __IDUSER
            )  AS C 
            ON C.Count_ID = B.Count_ID
      WHERE 
         B.UID = __IDUSER AND 
         B.`Option` = 3 AND 
         B.TypeID >= 2013265920 AND 
         B.TypeID < 2017460224
      GROUP BY B.TypeID_ACHIEVE
         ORDER BY min(B.IDX);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetDailyAchieveType` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetDailyAchieveType`(
	__IDUSER int
)
BEGIN

	SELECT 
         min(A.TIPO) AS TIPO, 
         min(A.TypeID) AS TypeID, 
         A.ID_ACHIEVEMENT, 
         min(A.`Option`) AS `Option`, 
         count_big(B.ID_ACHIEVEMENT) AS COUNTER
      FROM 
         (

            SELECT achievement_tipo.TIPO, achievement_tipo.TypeID, achievement_tipo.ID_ACHIEVEMENT, achievement_tipo.`Option`
            FROM pangya.achievement_tipo
            WHERE 
               achievement_tipo.UID = __IDUSER AND 
               achievement_tipo.`Option` = 3 AND 
               achievement_tipo.TypeID >= 2013265920 AND 
               achievement_tipo.TypeID < 2021654529
         )  AS A 
            INNER JOIN 
            (
               SELECT achievement_quest.ID_ACHIEVEMENT
               FROM pangya.achievement_quest
            )  AS B 
            ON A.ID_ACHIEVEMENT = B.ID_ACHIEVEMENT
      GROUP BY A.ID_ACHIEVEMENT
         ORDER BY A.ID_ACHIEVEMENT;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetDailyQuest_New` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetDailyQuest_New`(
	__IDUSER int
)
BEGIN
	
	-- Get Daily Quest
	DECLARE __today datetime;
	DECLARE __last_accept datetime;

	SET __last_accept = (SELECT last_quest_accept FROM pangya.pangya_daily_quest_player WHERE uid = __IDUSER);
	SET __today = (SELECT today_quest FROM pangya.pangya_daily_quest_player WHERE uid = __IDUSER);
    
	SELECT CAST(UNIX_TIMESTAMP(Reg_Date) AS SIGNED) AS Reg_Date,	-- Deprecated Column
			CASE WHEN __last_accept IS NULL THEN 0 ELSE CAST(UNIX_TIMESTAMP(__last_accept) AS SIGNED) END AS Reg_Date_player, 
			CASE WHEN __today IS NULL THEN 0 ELSE CAST(UNIX_TIMESTAMP(__today) AS SIGNED) END AS today_quest,
			achieve_quest_1, achieve_quest_2, achieve_quest_3
	FROM pangya.pangya_daily_quest;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetDolfiniLockerInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetDolfiniLockerInfo`(
	__IDUSER int
)
BEGIN
	
	SELECT uid, senha, pang, locker FROM pangya.pangya_dolfini_locker WHERE uid = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetDolfiniLockerItem` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetDolfiniLockerItem`(
	__IDUSER int
)
BEGIN
	
	SELECT
		a.item_id,
		a.uid,
		a.typeid,
		CASE WHEN b.UCC_NAME IS NULL THEN '' ELSE b.UCC_NAME END as SD_NAME,
		CASE WHEN b.UCCIDX IS NULL THEN '' ELSE b.UCCIDX END as SD_IDX,
		CASE WHEN b.SEQ IS NULL THEN 0 ELSE b.SEQ END as SD_SEQ,
		CASE WHEN b.COPIER_NICK IS NULL THEN '' ELSE b.COPIER_NICK END as SD_COPIER_NICK,
		-- CASE WHEN b.COPIER IS NULL THEN 0 ELSE b.COPIER END as SD_COPIER,
		-- CASE WHEN b.TRADE IS NULL THEN 0 ELSE b.TRADE END as SD_TRADE,
		-- CASE WHEN b.Flag IS NULL THEN 0 ELSE b.Flag END as SD_FLAG,
		CASE WHEN b.`STATUS` IS NULL THEN 0 ELSE b.`STATUS` END as SD_STATUS,
		c.idx as IDX_DOLFINI_LOCKER_ITEM,
		c.flag as FLAG_DOLFINI_LOCKER_ITEM
	FROM 
		pangya.pangya_item_warehouse a
		LEFT OUTER JOIN
		pangya.tu_ucc b
	ON	a.item_id = b.ITEM_ID
	INNER JOIN pangya.pangya_dolfini_locker_item c
	ON a.item_id = c.item_id
	WHERE a.uid = __IDUSER AND c.flag = 1;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetDolfiniLockerItemOne` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetDolfiniLockerItemOne`(
	__IDUSER INT,
	__ITEM_ID INT
)
BEGIN

	IF __IDUSER > 0 AND __ITEM_ID > 0 THEN
	BEGIN
		SELECT
			a.item_id,
			a.uid,
			a.typeid,
			CASE WHEN b.UCC_NAME IS NULL THEN '' ELSE b.UCC_NAME END as SD_NAME,
			CASE WHEN b.UCCIDX IS NULL THEN '' ELSE b.UCCIDX END as SD_IDX,
			CASE WHEN b.SEQ IS NULL THEN 0 ELSE b.SEQ END as SD_SEQ,
			CASE WHEN b.COPIER_NICK IS NULL THEN '' ELSE b.COPIER_NICK END as SD_COPIER_NICK,
			-- CASE WHEN b.COPIER IS NULL THEN 0 ELSE b.COPIER END as SD_COPIER,
			-- CASE WHEN b.TRADE IS NULL THEN 0 ELSE b.TRADE END as SD_TRADE,
			-- CASE WHEN b.Flag IS NULL THEN 0 ELSE b.Flag END as SD_FLAG,
			CASE WHEN b.`STATUS` IS NULL THEN 0 ELSE b.`STATUS` END as SD_STATUS,
			c.idx as IDX_DOLFINI_LOCKER_ITEM,
			c.flag as FLAG_DOLFINI_LOCKER_ITEM
		FROM 
			pangya.pangya_item_warehouse a
			LEFT OUTER JOIN
			pangya.tu_ucc b
		ON	a.item_id = b.ITEM_ID
		INNER JOIN pangya.pangya_dolfini_locker_item c
		ON a.item_id = c.item_id
		WHERE a.uid = __IDUSER AND a.item_id = __ITEM_ID AND c.flag = 1;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetDonationInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetDonationInfo`(
)
BEGIN

	SELECT	a.ADM_uid,
		a.uid,
		a.plataforma,
		a.cash,
		a.cookie_point,
		(SELECT COUNT(donation_id) FROM pangya.pangya_donation_item_log WHERE donation_id = a.`index`) as count_item,
		a.email,
		a.obs,
		CAST(a.red_date AS NCHAR(19)) AS red_date
	FROM pangya.pangya_donation_log a
	ORDER BY a.`index`;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetDropCourseConfig` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetDropCourseConfig`()
BEGIN
	
	SELECT rate_mana_artefact, rate_grand_prix_ticket, rate_SSC_ticket FROM pangya.pangya_new_course_drop LIMIT 1;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetEmailNaoLidaFromMailBox` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetEmailNaoLidaFromMailBox`(
	__IDUSER int
)
BEGIN

	SELECT
         X.Msg_ID, 
         X.fromid, 
         X.message, 
         X.giftdate, 
         X.Contador_Vista, 
         X.Lida_YN, 
         (CASE 
            WHEN X.CONTADOR IS NULL THEN 0
            ELSE X.CONTADOR
         END) AS CONTADOR, 
         (CASE 
            WHEN X.item_id IS NULL THEN 0
            ELSE X.item_id
         END) AS ITEM_ID, 
         (CASE 
            WHEN X.item_typeid IS NULL THEN 0
            ELSE X.item_typeid
         END) AS ITEM_TYPEID, 
         (CASE 
            WHEN X.Flag IS NULL THEN 0
            ELSE X.Flag
         END) AS FLAG, 
         (CASE 
            WHEN X.Quantidade_item IS NULL THEN 0
            ELSE X.Quantidade_item
         END) AS QUANTIDADE_ITEM, 
         (CASE 
            WHEN X.Quantidade_Dia IS NULL THEN 0
            ELSE X.Quantidade_Dia
         END) AS QUANTIDADE_DIA, 
         (CASE 
            WHEN X.Pang IS NULL THEN 0
            ELSE X.Pang
         END) AS PANG, 
         (CASE 
            WHEN X.Cookie IS NULL THEN 0
            ELSE X.Cookie
         END) AS COOKIE, 
         (CASE 
            WHEN X.GM_ID IS NULL THEN 0
            ELSE X.GM_ID
         END) AS GM_ID, 
         (CASE 
            WHEN X.Flag_Gift IS NULL THEN 0
            ELSE X.Flag_Gift
         END) AS FLAG_GIFT, 
         (CASE 
            WHEN X.UCC_IMG_MARK IS NULL THEN '0'
            ELSE X.UCC_IMG_MARK
         END) AS UCC_IMG_MARK, 
         (CASE 
            WHEN X.`Type` IS NULL THEN 0
            ELSE X.`Type`
         END) AS `TYPE`
      FROM 
         (
            SELECT
               C.UID, 
               C.Msg_ID, 
               C.fromid, 
               C.message, 
               C.giftdate, 
               C.Contador_Vista, 
               C.Lida_YN, 
               C.Flag AS Flag_MSG, 
               (SELECT count(Msg_ID) FROM pangya_item_mail WHERE Msg_ID = C.Msg_ID AND valid = 1 GROUP BY Msg_ID) AS CONTADOR, 
               C.IDMSG, 
			   C.item_id, 
               C.item_typeid, 
               C.Flag, 
               C.Quantidade_item,
               C.Quantidade_Dia, 
               C.GET_DATE, 
               C.Pang, 
               C.Cookie, 
               C.GM_ID, 
               C.Flag_Gift, 
               /*B.UCC_IMG_MARK*/
			   IFNULL((SELECT UCCIDX FROM pangya.tu_ucc WHERE item_id = C.item_id), '0') AS UCC_IMG_MARK, 
               C.`Type`
            FROM 
               (
				SELECT B.item_id, 
						B.item_typeid, 
						B.Flag, 
						B.Quantidade_item, 
						B.Quantidade_Dia, 
						B.GET_DATE, 
						B.Pang, 
						B.Cookie, 
						B.GM_ID, 
						B.Flag_Gift, 
						B.UCC_IMG_MARK, 
						B.`Type`,
						A.UID, 
						A.Msg_ID, 
						A.fromid, 
						A.message, 
						A.giftdate, 
						A.Contador_Vista, 
						A.Lida_YN, 
						A.Flag AS Flag_MSG,
						B.IDMSG
				FROM(
						SELECT 
							pangya_gift_table.UID, 
							pangya_gift_table.Msg_ID, 
							pangya_gift_table.fromid, 
							pangya_gift_table.message, 
							pangya_gift_table.giftdate, 
							pangya_gift_table.Flag, 
							pangya_gift_table.Contador_Vista, 
							pangya_gift_table.Lida_YN
						FROM pangya.pangya_gift_table
						WHERE pangya_gift_table.valid = 1 AND pangya_gift_table.Lida_YN = 0/*Não lida*/
					)  AS A 
						LEFT OUTER JOIN 
						(
							SELECT
							pangya_item_mail.Msg_ID AS IDMSG, 
							pangya_item_mail.item_id, 
							pangya_item_mail.item_typeid, 
							pangya_item_mail.Flag, 
							pangya_item_mail.Quantidade_item, 
							pangya_item_mail.Quantidade_Dia, 
							pangya_item_mail.GET_DATE, 
							pangya_item_mail.Pang, 
							pangya_item_mail.Cookie, 
							pangya_item_mail.GM_ID, 
							pangya_item_mail.Flag_Gift, 
							pangya_item_mail.UCC_IMG_MARK, 
							pangya_item_mail.`Type`
							FROM pangya.pangya_item_mail
							WHERE pangya_item_mail.valid = 1
						)  AS B 
						ON A.Msg_ID = B.IDMSG
						-- WHERE B.item_id IS NOT NULL
				  ) AS C
				 -- WHERE C.item_id IS NOT NULL
				  GROUP BY C.UID, C.Msg_ID, C.fromid, C.message, C.giftdate, C.Contador_Vista, C.Lida_YN, C.Flag, C.IDMSG, C.item_id, C.item_typeid,
							C.Quantidade_item, C.Quantidade_Dia, C.GET_DATE, C.Pang, C.Cookie, C.GM_ID, C.Flag_Gift, C.UCC_IMG_MARK, C.`Type`
         )  AS X
      WHERE X.UID = __IDUSER
         ORDER BY X.Msg_ID DESC LIMIT 300;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetEmailNaoLidaFromMailBoxOne` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetEmailNaoLidaFromMailBoxOne`(
	__IDUSER int,
	__msg_id_in int
)
BEGIN

	SELECT A.Msg_ID, A.fromid, A.message, A.giftdate, A.Contador_Vista, A.Lida_YN, COUNT(B.Msg_ID) AS CONTADOR, 
				(CASE WHEN b.item_id IS NULL THEN 0 ELSE b.item_id END) AS item_id, 
				(CASE WHEN b.item_typeid IS NULL THEN 0 ELSE b.item_typeid END) AS item_typeid, 
				(CASE WHEN b.Flag IS NULL THEN 0 ELSE b.Flag END) AS Flag, 
				(CASE WHEN b.Quantidade_item IS NULL THEN 0 ELSE b.Quantidade_item END) AS Quantidade_item, 
				(CASE WHEN b.Quantidade_Dia IS NULL THEN 0	ELSE b.Quantidade_Dia END) AS Quantidade_Dia, 
				(CASE WHEN b.Pang IS NULL THEN 0 ELSE b.Pang END) AS Pang, 
				(CASE WHEN b.Cookie IS NULL THEN 0 ELSE b.Cookie END) AS Cookie, 
				(CASE WHEN b.GM_ID IS NULL THEN 0 ELSE b.GM_ID END) AS GM_ID, 
				(CASE WHEN b.Flag_Gift IS NULL THEN 0 ELSE b.Flag_Gift END) AS Flag_Gift, 
				-- (CASE WHEN b.UCC_IMG_MARK IS NULL THEN 0 ELSE b.UCC_IMG_MARK END) AS UCC_IMG_MARK, 
				/*B.UCC_IMG_MARK*/
			   IFNULL((SELECT UCCIDX FROM pangya.tu_ucc WHERE item_id = B.item_id), '0') AS UCC_IMG_MARK, 
				(CASE WHEN b.`Type` IS NULL THEN 0 ELSE b.`Type` END) AS `Type`
				/*B.item_id, B.item_typeid, B.Flag, B.Quantidade_item, B.Quantidade_Dia, B.Pang, B.Cookie, B.GM_ID, B.Flag_Gift, B.UCC_IMG_MARK, B.[Type]*/
		FROM pangya.pangya_gift_table A
		 LEFT OUTER JOIN
		 pangya.pangya_item_mail B
		 ON A.Msg_ID = B.Msg_ID AND B.valid = 1
		 WHERE A.valid = 1 AND A.Lida_YN = 0 AND A.UID = __IDUSER AND A.Msg_ID = __msg_id_in
		 ORDER BY A.Msg_ID DESC;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetFriendAndGuildMemberInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetFriendAndGuildMemberInfo`(
	__IDUSER INT
)
BEGIN
	
    IF __IDUSER > 0 THEN
	BEGIN
		DECLARE __GUILD_UID INT DEFAULT (SELECT Guild_UID FROM pangya.account WHERE UID = __IDUSER);

		SELECT   (SELECT NICK FROM pangya.account WHERE UID = z.uid_friend) as NICK
				,z.uid_friend
				,y.apelido
				,CASE WHEN y.unknown1 IS NULL THEN -1 ELSE y.unknown1 END as unknown1 
				,CASE WHEN y.unknown2 IS NULL THEN 0 ELSE y.unknown2 END as unknown2
				,CASE WHEN y.unknown3 IS NULL THEN -1 ELSE y.unknown3 END as unknown3
				,CASE WHEN y.unknown4 IS NULL THEN 0 ELSE y.unknown4 END as unknown4
				,CASE WHEN y.unknown5 IS NULL THEN 0 ELSE y.unknown5 END as unknown5
				,CASE WHEN y.unknown6 IS NULL THEN 0 ELSE y.unknown6 END as unknown6
				,CASE WHEN y.flag1 IS NULL THEN -1 ELSE y.flag1 END as flag1
				,(CASE WHEN y.state_flag IS NULL THEN 0 ELSE y.state_flag END) + (SELECT Sex FROM pangya.account WHERE UID = z.uid_friend) as state_flag
				,(SELECT `level` FROM pangya.user_info WHERE UID = z.uid_friend) as `level`
				,CASE WHEN z._count = 2 OR y.uid_friend IS NULL THEN z._count + 1 ELSE z._count END as PLAYER_FLAG
		FROM
		(
			SELECT x.uid_friend, COUNT(x.uid_friend) as _count
			FROM
			(
				SELECT uid_friend
				FROM
					pangya.pangya_friend_list
				WHERE UID = __IDUSER
				UNION ALL
				(
					SELECT 
						b.MEMBER_UID as uid_friend
					FROM
						pangya.pangya_guild a
						INNER JOIN
						pangya.pangya_guild_member b
						ON a.GUILD_UID = b.GUILD_UID
					WHERE 
						a.GUILD_UID = __GUILD_UID
						AND b.MEMBER_STATE_FLAG < 9
						AND (a.GUILD_STATE NOT IN(4, 5) OR a.GUILD_CLOSURE_DATE IS NULL OR now() < a.GUILD_CLOSURE_DATE)
				)
			) x
			GROUP BY x.uid_friend
		) z
		LEFT OUTER JOIN
		pangya.pangya_friend_list y
		ON z.uid_friend = y.uid_friend AND y.UID = __IDUSER;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetFriendAndGuildMemberInfo_One` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetFriendAndGuildMemberInfo_One`(
	__IDUSER INT,
	__FRIEND_UID INT
)
BEGIN

	IF __IDUSER > 0 AND __FRIEND_UID > 0 THEN
	BEGIN
		DECLARE __GUILD_UID INT DEFAULT (SELECT Guild_UID FROM pangya.account WHERE UID = __IDUSER);

		SELECT   (SELECT NICK FROM pangya.account WHERE UID = z.uid_friend) as NICK
				,z.uid_friend
				,y.apelido
				,CASE WHEN y.unknown1 IS NULL THEN -1 ELSE y.unknown1 END as unknown1 
				,CASE WHEN y.unknown2 IS NULL THEN 0 ELSE y.unknown2 END as unknown2
				,CASE WHEN y.unknown3 IS NULL THEN -1 ELSE y.unknown3 END as unknown3
				,CASE WHEN y.unknown4 IS NULL THEN 0 ELSE y.unknown4 END as unknown4
				,CASE WHEN y.unknown5 IS NULL THEN 0 ELSE y.unknown5 END as unknown5
				,CASE WHEN y.unknown6 IS NULL THEN 0 ELSE y.unknown6 END as unknown6
				,CASE WHEN y.flag1 IS NULL THEN -1 ELSE y.flag1 END as flag1
				,(CASE WHEN y.state_flag IS NULL THEN 0 ELSE y.state_flag END) + (SELECT Sex FROM pangya.account WHERE UID = z.uid_friend) as state_flag
				,(SELECT `level` FROM pangya.user_info WHERE UID = z.uid_friend) as `level`
				,CASE WHEN z._count = 2 OR y.uid_friend IS NULL THEN z._count + 1 ELSE z._count END as PLAYER_FLAG
		FROM
		(
			SELECT x.uid_friend, COUNT(x.uid_friend) as _count
			FROM
			(
				SELECT uid_friend
				FROM
					pangya.pangya_friend_list
				WHERE UID = __IDUSER
				UNION ALL
				(
					SELECT 
						b.MEMBER_UID as uid_friend
					FROM
						pangya.pangya_guild a
						INNER JOIN
						pangya.pangya_guild_member b
						ON a.GUILD_UID = b.GUILD_UID
					WHERE 
						a.GUILD_UID = __GUILD_UID
						AND b.MEMBER_STATE_FLAG < 9
						AND (a.GUILD_STATE NOT IN(4, 5) OR a.GUILD_CLOSURE_DATE IS NULL OR now() < a.GUILD_CLOSURE_DATE)
				)
			) x
			GROUP BY x.uid_friend
		) z
		LEFT OUTER JOIN
		pangya.pangya_friend_list y
		ON z.uid_friend = y.uid_friend AND y.UID = __IDUSER
		WHERE  z.uid_friend = __FRIEND_UID;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetFriendInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetFriendInfo`(
	__UID BIGINT
)
BEGIN
	
	SELECT a.uid_friend, a.apelido, b.id, b.nick, b.sex FROM pangya.pangya_friend_list a INNER JOIN pangya.account b ON a.UID_FRIEND = b.UID WHERE a.UID = __UID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetGachaJPConfig` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetGachaJPConfig`(
)
BEGIN

	SELECT rate_normal, rate_rare, gacha_num FROM pangya.pangya_gacha_jp_rate;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetGiftClubSet` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetGiftClubSet`(
	__IDUSER INT,
	__IDITEM INT,
	__ITEMTYPEID INT
)
BEGIN

	IF __IDITEM > 0 AND __ITEMTYPEID > 0 THEN
	BEGIN
		UPDATE pangya.pangya_item_warehouse SET UID = __IDUSER, valid = 1, Gift_flag = 0
		WHERE item_id = __IDITEM;

		UPDATE pangya.pangya_clubset_enchant SET UID = __IDUSER WHERE item_id = __IDITEM;

		call pangya.ProcGetWareHouseItem_One(__IDUSER, __IDITEM);
	END;
	ELSE
		SELECT -1 AS ITEM_ID,
				0 as UID, 
				0 as typeid, 
				0 as Ano, 
				0 as C0, 
				0 as C1, 
				0 as C2, 
				0 as C3, 
				0 as C4, 
				0 as Purchase, 
				0 as Gift_flag, 
				0 as Flag, 
				0 as APPLY_DATE, 
				0 as END_DATE, 
				0 as ItemType, 
				0 as CARD_CHARACTER_1, 
				0 as CARD_CHARACTER_2, 
				0 as CARD_CHARACTER_3, 
				0 as CARD_CHARACTER_4, 
				0 as CARD_CADDIE_1, 
				0 as CARD_CADDIE_2, 
				0 as CARD_CADDIE_3, 
				0 as CARD_CADDIE_4, 
				0 as CARD_NPC_1, 
				0 as CARD_NPC_2, 
				0 as CARD_NPC_3, 
				0 as CARD_NPC_4, 
				0 as ClubSet_WorkShop_Flag, 
				0 as ClubSet_WorkShop_C0, 
				0 as ClubSet_WorkShop_C1, 
				0 as ClubSet_WorkShop_C2, 
				0 as ClubSet_WorkShop_C3, 
				0 as ClubSet_WorkShop_C4, 
				0 as Mastery_Pts, 
				0 as Recovery_Pts, 
				0 as `Level`, 
				0 as Up, 
				null as SD_NAME, 
				null as SD_IDX, 
				0 as SD_SEQ, 
				null as SD_COPIER_NICK, 
				0 as SD_COPIER, 
				0 as SD_TRADE, 
				0 as SD_FLAG, 
				0 as SD_STATUS;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetGiftPart` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetGiftPart`(
	__IDUSER INT,
	__IDITEM INT,
	__ITEMTYPEID INT,
	__TYPE_IFF TINYINT
)
BEGIN

	IF __IDITEM > 0 AND __ITEMTYPEID > 0 THEN
	BEGIN
		UPDATE pangya.pangya_item_warehouse SET UID = __IDUSER, valid = 1, Gift_flag = 0
		WHERE item_id = __IDITEM;

		IF __TYPE_IFF = 8 OR __TYPE_IFF = 9 THEN
			UPDATE pangya.tu_ucc SET UID = __IDUSER WHERE ITEM_ID = __IDITEM;
		END IF;

		call pangya.ProcGetWareHouseItem_One(__IDUSER, __IDITEM);
	END;
	ELSE
		SELECT -1 AS ITEM_ID,
				0 as UID, 
				0 as typeid, 
				0 as Ano, 
				0 as C0, 
				0 as C1, 
				0 as C2, 
				0 as C3, 
				0 as C4, 
				0 as Purchase, 
				0 as Gift_flag, 
				0 as Flag, 
				0 as APPLY_DATE, 
				0 as END_DATE, 
				0 as ItemType, 
				0 as CARD_CHARACTER_1, 
				0 as CARD_CHARACTER_2, 
				0 as CARD_CHARACTER_3, 
				0 as CARD_CHARACTER_4, 
				0 as CARD_CADDIE_1, 
				0 as CARD_CADDIE_2, 
				0 as CARD_CADDIE_3, 
				0 as CARD_CADDIE_4, 
				0 as CARD_NPC_1, 
				0 as CARD_NPC_2, 
				0 as CARD_NPC_3, 
				0 as CARD_NPC_4, 
				0 as ClubSet_WorkShop_Flag, 
				0 as ClubSet_WorkShop_C0, 
				0 as ClubSet_WorkShop_C1, 
				0 as ClubSet_WorkShop_C2, 
				0 as ClubSet_WorkShop_C3, 
				0 as ClubSet_WorkShop_C4, 
				0 as Mastery_Pts, 
				0 as Recovery_Pts, 
				0 as `Level`, 
				0 as Up, 
				null as SD_NAME, 
				null as SD_IDX, 
				0 as SD_SEQ, 
				null as SD_COPIER_NICK, 
				0 as SD_COPIER, 
				0 as SD_TRADE, 
				0 as SD_FLAG, 
				0 as SD_STATUS;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetGMGiftWebInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetGMGiftWebInfo`(
)
BEGIN

	SELECT 
		a.GM_UID,
		a.PLAYER_UID,
		COUNT(c.MSG_ID) as COUNT_ITEM,
		b.message,
		CAST(a.REG_DATE AS NCHAR(19)) AS REG_DATE
	FROM 
		pangya.pangya_gm_gift_web_log a
		INNER JOIN
		pangya.pangya_gift_table b
		ON a.MSG_ID = b.Msg_ID
		LEFT OUTER JOIN
		pangya.pangya_item_mail c
		ON b.Msg_ID = c.Msg_ID
	GROUP BY a.MSG_ID, a.GM_UID, a.PLAYER_UID, b.message, a.REG_DATE
	ORDER BY a.REG_DATE;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetGoldenTimeInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetGoldenTimeInfo`()
BEGIN
	
	SELECT `index`, `type`, `begin`, `end`, rate, is_end FROM pangya.pangya_golden_time_info WHERE is_end = 0;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetGrandPrixClear` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetGrandPrixClear`(
	__UID BIGINT
)
BEGIN
	
	SELECT `typeid`, `flag` FROM pangya.pangya_grandprix_clear WHERE UID = __UID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetGuildAllNoticeInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetGuildAllNoticeInfo`(
	__PLAYER_UID INT
)
BEGIN

	IF __PLAYER_UID > 0 THEN
	BEGIN

		DECLARE __OTHER_GUILD INT DEFAULT (
			SELECT
				a.Guild_UID
			FROM
				pangya.account a
				INNER JOIN
				pangya.pangya_guild b
				ON a.Guild_UID = b.GUILD_UID
			WHERE a.UID = __PLAYER_UID AND 
				(b.GUILD_STATE NOT IN(4, 5) OR b.GUILD_CLOSURE_DATE IS NULL OR now() < b.GUILD_CLOSURE_DATE)
		);

		-- Player está em uma guild válida
		IF __OTHER_GUILD IS NOT NULL THEN
		BEGIN

			DECLARE __GUILD_UID INT DEFAULT 0;

			SET __GUILD_UID = (SELECT Guild_UID FROM pangya.account WHERE UID = __PLAYER_UID);

			IF __GUILD_UID IS NOT NULL AND __GUILD_UID > 0 THEN
			BEGIN

				SELECT 
					b.TITLE,
					b.`TEXT`,
					(SELECT nick FROM pangya.account WHERE uid = b.OWNER_UID) AS NICKNAME,
					CAST(b.REG_DATE AS NCHAR(19)) AS REG_DATE
				FROM 
					pangya.pangya_guild a
					INNER JOIN
					pangya.pangya_guild_notice b
					ON a.GUILD_UID = b.GUILD_UID
				WHERE a.GUILD_UID = __GUILD_UID AND b.STATE = 1
				ORDER BY b.REG_DATE DESC;

			END;
            END IF;

		END;
        END IF;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetGuildBBSInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetGuildBBSInfo`(
	__BBS_SEQ BIGINT
)
BEGIN

	IF __BBS_SEQ > 0 THEN
	BEGIN

		-- Update VIEWS BBS
		UPDATE pangya.pangya_guild_bbs SET VIEWS = VIEWS + 1 WHERE SEQ = __BBS_SEQ AND STATE = 1;
		
		-- BBS
		SELECT
			a.SEQ,
			a.TITLE,
			a.`TEXT`,
			a.`TYPE`,
			a.OWNER_UID,
			(SELECT nick FROM pangya.account WHERE `UID` = a.OWNER_UID) AS NICKNAME,
			a.VIEWS,
			CAST(a.REG_DATE AS NCHAR(19)) AS REG_DATE
		FROM
			pangya.pangya_guild_bbs a
		WHERE a.SEQ = __BBS_SEQ AND a.STATE = 1;

		-- Reply
		SELECT
			b.SEQ,
			b.`TEXT`,
			b.OWNER_UID,
			(SELECT nick FROM pangya.account WHERE UID = b.OWNER_UID) AS NICKNAME,
			CAST(b.REG_DATE AS NCHAR(19)) AS REG_DATE
		FROM
			pangya.pangya_guild_bbs a
			INNER JOIN
			pangya.pangya_guild_bbs_res b
			ON a.SEQ = b.BBS_SEQ
		WHERE a.SEQ = __BBS_SEQ AND a.STATE = 1 AND b.STATE = 1
		ORDER BY b.REG_DATE;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetGuildBBSReplyInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetGuildBBSReplyInfo`(
	__BBS_SEQ BIGINT
)
BEGIN

	IF __BBS_SEQ > 0 THEN
	BEGIN

		-- Reply
		SELECT
			b.SEQ,
			b.`TEXT`,
			b.OWNER_UID,
			(SELECT nick FROM pangya.account WHERE UID = b.OWNER_UID) AS NICKNAME,
			CAST(b.REG_DATE AS NCHAR(19)) AS REG_DATE
		FROM
			pangya.pangya_guild_bbs a
			INNER JOIN
			pangya.pangya_guild_bbs_res b
			ON a.SEQ = b.BBS_SEQ
		WHERE a.SEQ = __BBS_SEQ AND a.STATE = 1 AND b.STATE = 1
		ORDER BY b.REG_DATE;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetGuildInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetGuildInfo`(
	__IDUSER int,
	__opt int
)
BEGIN
	
	IF __IDUSER > 0 THEN
	BEGIN

		SELECT 
			a.GUILD_UID, 
			a.GUILD_NAME, 
			(SELECT count(*) FROM pangya.pangya_guild_member WHERE GUILD_UID = a.GUILD_UID AND MEMBER_STATE_FLAG < 9) AS GUILD_NUM_MEMBER, 
			IF(b.MEMBER_STATE_FLAG < 9, a.GUILD_MARK_IMG, N'') AS GUILD_MARK_IMG,
			IF(b.MEMBER_STATE_FLAG < 9, a.GUILD_MARK_IMG_IDX, 0) AS GUILD_MARK_IMG_IDX,
			a.GUILD_NOTICE, 
			a.GUILD_INFO,
			IF(__opt = 1, a.GUILD_POINT, b.GUILD_POINT) AS GUILD_POINT,
			IF(__opt = 1, a.GUILD_PANG, b.GUILD_PANG) AS GUILD_PANG, 
			b.MEMBER_STATE_FLAG AS GUILD_MEMBER_IDENTITY, 
			a.GUILD_LEADER, 
			(SELECT account.NICK FROM pangya.account WHERE account.UID = a.GUILD_LEADER) AS GUILD_LEADER_NICK, 
			a.GUILD_REG_DATE
		FROM 
		pangya.pangya_guild AS a
		INNER JOIN 
		pangya.pangya_guild_member AS b
		ON a.GUILD_UID = b.GUILD_UID 
			AND b.MEMBER_STATE_FLAG < 9
			AND (a.GUILD_STATE NOT IN(4, 5) OR a.GUILD_CLOSURE_DATE IS NULL OR now() < a.GUILD_CLOSURE_DATE)
		INNER JOIN
		pangya.account AS c
		ON b.MEMBER_UID = c.UID
		WHERE 
			c.UID = __IDUSER;    

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetGuildInfoComplete` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetGuildInfoComplete`(
	__UID INT
)
BEGIN

	SELECT 
		a.GUILD_UID, 
		a.GUILD_NAME, 
		(SELECT NICK FROM pangya.account WHERE UID = a.GUILD_LEADER) AS GUILD_MASTER,
		IFNULL((SELECT NICK FROM pangya.account WHERE UID = a.GUILD_SUB_MASTER), '') AS GUILD_SUB_MASTER,
		(SELECT count(GUILD_UID) FROM pangya.pangya_guild_member WHERE GUILD_UID = a.GUILD_UID AND MEMBER_STATE_FLAG < 9) AS GUILD_MEMBERS,
		a.GUILD_STATE,
		a.GUILD_FLAG,
		a.GUILD_CONDITION_LEVEL,
		a.GUILD_PERMITION_JOIN,
		CAST(a.GUILD_REG_DATE AS NCHAR(10)) AS GUILD_REG_DATE,
		a.GUILD_INFO,
		a.GUILD_NOTICE,
		a.GUILD_MARK_IMG_IDX,
		a.GUILD_NEW_MARK_IDX,
		a.GUILD_INTRO_IMG,
		CAST(a.GUILD_CLOSURE_DATE AS NCHAR(19)) AS GUILD_CLOSURE_DATE
	FROM
		pangya.pangya_guild a
		WHERE a.GUILD_UID = __UID
			AND (a.GUILD_STATE NOT IN(4, 5) OR a.GUILD_CLOSURE_DATE IS NULL OR now() < a.GUILD_CLOSURE_DATE);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetGuildInfoNew` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetGuildInfoNew`(
	__GUILD_UID INT
)
BEGIN

	SELECT
         a.GUILD_UID, 
         a.GUILD_NAME, 
         a.GUILD_LEADER AS GUILD_MASTER, 
		 (SELECT NICK FROM pangya.account WHERE UID = a.GUILD_LEADER) AS GUILD_MASTER_NICKNAME,
		 a.GUILD_CONDITION_LEVEL,
		 a.GUILD_STATE,
		 a.GUILD_FLAG,
		 a.GUILD_PERMITION_JOIN,
		 (SELECT count(GUILD_UID) FROM pangya.pangya_guild_member WHERE GUILD_UID = a.GUILD_UID AND MEMBER_STATE_FLAG < 9) AS GUILD_MEMBERS,
         CAST(a.GUILD_REG_DATE AS NCHAR(10)) AS GUILD_REG_DATE
      FROM 
	  pangya.pangya_guild a
      WHERE a.GUILD_UID = __GUILD_UID
		AND (a.GUILD_STATE NOT IN(4, 5) OR a.GUILD_CLOSURE_DATE IS NULL OR now() < a.GUILD_CLOSURE_DATE) LIMIT 1;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetGuildMatchList` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetGuildMatchList`(
	__GUILD_UID INT,
	__PAGE INT
)
BEGIN

	IF __GUILD_UID > 0 AND __PAGE >= 0 THEN
	BEGIN

		DECLARE __OTHER_GUILD INT DEFAULT (
			SELECT
				b.GUILD_UID
			FROM
				pangya.pangya_guild b
			WHERE b.GUILD_UID = __GUILD_UID
				AND (b.GUILD_STATE NOT IN(4, 5) OR b.GUILD_CLOSURE_DATE IS NULL OR now() < b.GUILD_CLOSURE_DATE)
		);
        
        DECLARE __PAGE_OFFSET BIGINT DEFAULT (__PAGE * 13);

		-- Está em uma Guild válida
		IF __OTHER_GUILD IS NOT NULL THEN
		BEGIN

			DECLARE __LINHAS BIGINT DEFAULT

			-- Total de linhas da consulta
			(SELECT
				COUNT(a.`index`) AS LINHAS
			FROM
				pangya.pangya_guild_match a
			WHERE a.GUILD_1_UID = __GUILD_UID OR a.guild_2_uid = __GUILD_UID);

			SELECT
				__LINHAS AS LINHAS,
				a.GUILD_1_UID,
				(SELECT GUILD_NAME FROM pangya.pangya_guild WHERE GUILD_UID = a.GUILD_1_UID) AS GUILD_1_NAME,
				(SELECT GUILD_MARK_IMG_IDX FROM pangya.pangya_guild WHERE GUILD_UID = a.GUILD_1_UID) AS GUILD_1_MARK_INDEX,
				a.GUILD_1_POINT,
				a.GUILD_1_PANG,
				a.GUILD_2_UID,
				(SELECT GUILD_NAME FROM pangya.pangya_guild WHERE GUILD_UID = a.GUILD_2_UID) AS GUILD_2_NAME,
				(SELECT GUILD_MARK_IMG_IDX FROM pangya.pangya_guild WHERE GUILD_UID = a.GUILD_2_UID) AS GUILD_2_MARK_INDEX,
				a.GUILD_2_POINT,
				a.GUILD_2_PANG,
				CAST(a.REG_DATE AS NCHAR(16)) AS REG_DATE
			FROM
				pangya.pangya_guild_match a
			WHERE a.GUILD_1_UID = __GUILD_UID OR a.guild_2_uid = __GUILD_UID
			ORDER BY a.reg_date DESC
			LIMIT __PAGE_OFFSET, 13;

		END;
		ELSE
			SELECT 0 AS LINHAS;	-- ERROR
		END IF;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetGuildMemberInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetGuildMemberInfo`(
	__UID_GUILD int
)
BEGIN

	IF __UID_GUILD > 0 THEN
	BEGIN

      SELECT 
         a.GUILD_UID, 
         a.GUILD_NAME, 
         b.GUILD_PANG, 
         b.GUILD_POINT, 
         b.MEMBER_STATE_FLAG AS GUILD_MEMBER_IDENTITY, 
         b.MEMBER_UID AS GUILD_MEMBER_UID, 
         b.MEMBER_MSG AS GUILD_MEMBER_MSG, 
         c.NICK AS GUILD_MEMBER_NICK, 
         c.Logon AS GUILD_MEMBER_ON
      FROM 
		pangya.pangya_guild AS a
		INNER JOIN
		pangya.pangya_guild_member AS b
		ON a.GUILD_UID = b.GUILD_UID
		INNER JOIN
		pangya.account AS c
		ON b.MEMBER_UID = c.UID
      WHERE 
         a.GUILD_UID = __UID_GUILD
		 AND (b.MEMBER_STATE_FLAG < 9)
		 AND (a.GUILD_STATE NOT IN(4, 5) OR a.GUILD_CLOSURE_DATE IS NULL OR now() < a.GUILD_CLOSURE_DATE);

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetGuildMemberList` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetGuildMemberList`(
	__UID INT,
	__PAGE INT,
	__OPT INT,
	__MAX_LINE_PAGE INT
)
BEGIN

	IF __MAX_LINE_PAGE <= 0 THEN
		SET __MAX_LINE_PAGE = 14;
	END IF;
	
	IF __UID > 0 AND __PAGE >= 0 THEN
	BEGIN

		DECLARE __OTHER_GUILD INT DEFAULT (
			SELECT
				b.GUILD_UID
			FROM
				pangya.pangya_guild b
			WHERE b.GUILD_UID = __UID
				AND (b.GUILD_STATE NOT IN(4, 5) OR b.GUILD_CLOSURE_DATE IS NULL OR now() < b.GUILD_CLOSURE_DATE)
		);

		-- Está em uma Guild válida
		IF __OTHER_GUILD IS NOT NULL THEN
		BEGIN

			DECLARE __LINHAS BIGINT DEFAULT 

			-- Total de linhas da consulta
			(SELECT 
				COUNT(b.MEMBER_UID) AS LINHAS
			FROM 
				pangya.pangya_guild a
				INNER JOIN
				pangya.pangya_guild_member b
				ON a.GUILD_UID = b.GUILD_UID
			WHERE a.GUILD_UID = __UID
				AND (__OPT = 0 OR (__OPT = 1 AND b.MEMBER_STATE_FLAG = 9) OR (__OPT = 2 AND b.MEMBER_STATE_FLAG < 9)));
                
			DECLARE __PAGE_OFFSET BIGINT DEFAULT (__PAGE * __MAX_LINE_PAGE);

			SELECT 
				__LINHAS as LINHAS,
				b.MEMBER_UID,
				b.MEMBER_STATE_FLAG,
				(SELECT nick FROM pangya.account WHERE uid = b.MEMBER_UID) AS NICKNAME,
				CAST(b.REG_DATE AS NCHAR(10)) AS REG_DATE
			FROM 
				pangya.pangya_guild a
				INNER JOIN
				pangya.pangya_guild_member b
				ON a.GUILD_UID = b.GUILD_UID
			WHERE a.GUILD_UID = __UID
				AND (__OPT = 0 OR (__OPT = 1 AND b.MEMBER_STATE_FLAG = 9) OR (__OPT = 2 AND b.MEMBER_STATE_FLAG < 9))
			ORDER BY b.MEMBER_STATE_FLAG, b.REG_DATE
			LIMIT __PAGE_OFFSET, __MAX_LINE_PAGE;

		END;
		ELSE
			SELECT 0 AS LINHAS; -- Erro
		END IF;
	
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetGuildNewsCreate` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetGuildNewsCreate`(
)
BEGIN

	SELECT 
		GUILD_UID, 
		GUILD_NAME, 
		GUILD_INFO, 
		GUILD_MARK_IMG_IDX, 
		CAST(GUILD_REG_DATE AS DATE) AS GUILD_REG_DATE 
	FROM 
		pangya.pangya_guild 
	WHERE GUILD_ACCEPT_DATE IS NOT NULL AND CAST(now() AS DATE) = CAST(GUILD_ACCEPT_DATE AS DATE) AND GUILD_STATE >= 1 AND GUILD_MARK_IMG_IDX > 0
		AND (GUILD_STATE NOT IN(4, 5) OR GUILD_CLOSURE_DATE IS NULL OR now() < GUILD_CLOSURE_DATE)
	ORDER BY GUILD_REG_DATE DESC;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetGuildNoticeInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetGuildNoticeInfo`(
	__NOTICE_SEQ BIGINT
)
BEGIN

	IF __NOTICE_SEQ > 0 THEN
	BEGIN

		DECLARE __OTHER_GUILD INT DEFAULT (
			SELECT
				a.GUILD_UID
			FROM
				pangya.pangya_guild_notice a
				INNER JOIN
				pangya.pangya_guild b
				ON a.GUILD_UID = b.GUILD_UID
			WHERE a.SEQ = __NOTICE_SEQ
				AND (b.GUILD_STATE NOT IN(4, 5) OR b.GUILD_CLOSURE_DATE IS NULL OR now() < b.GUILD_CLOSURE_DATE)
		);

		-- Está em uma Guild válida
		IF __OTHER_GUILD IS NOT NULL THEN
		BEGIN

			-- Update VIEWS BBS
			UPDATE pangya.pangya_guild_notice SET VIEWS = VIEWS + 1 WHERE SEQ = __NOTICE_SEQ AND STATE = 1;
		
			-- BBS
			SELECT
				a.SEQ,
				a.TITLE,
				a.`TEXT`,
				a.OWNER_UID,
				(SELECT nick FROM pangya.account WHERE UID = a.OWNER_UID) AS NICKNAME,
				a.VIEWS,
				CAST(a.REG_DATE AS NCHAR(19)) AS REG_DATE
			FROM
				pangya.pangya_guild_notice a
			WHERE a.SEQ = __NOTICE_SEQ AND a.STATE = 1;

		END;
        END IF;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetGuildNoticeList` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetGuildNoticeList`(
	__UID INT,
	__PAGE INT
)
BEGIN

	IF __PAGE >= 0 AND __UID > 0 THEN
	BEGIN

		DECLARE __OTHER_GUILD INT DEFAULT (
			SELECT
				b.GUILD_UID
			FROM
				pangya.pangya_guild b
			WHERE b.GUILD_UID = __UID
				AND (b.GUILD_STATE NOT IN(4, 5) OR b.GUILD_CLOSURE_DATE IS NULL OR now() < b.GUILD_CLOSURE_DATE)
		);

		-- Está em uma Guild válida
		IF __OTHER_GUILD IS NOT NULL THEN
		BEGIN

			DECLARE __LINHAS BIGINT DEFAULT 

			-- Total de linhas da consulta
			(SELECT 
				COUNT(b.SEQ) AS LINHAS
			FROM 
				pangya.pangya_guild a
				INNER JOIN
				pangya.pangya_guild_notice b
				ON a.GUILD_UID = b.GUILD_UID
			WHERE a.GUILD_UID = __UID AND b.STATE = 1);
            
            DECLARE __PAGE_OFFSET BIGINT DEFAULT (__PAGE * 12);
		
			SELECT 
				__LINHAS as LINHAS,
				b.SEQ,
				b.TITLE,
				(SELECT nick FROM pangya.account WHERE uid = b.OWNER_UID) AS NICKNAME,
				CAST(b.REG_DATE AS NCHAR(10)) AS REG_DATE
			FROM 
				pangya.pangya_guild a
				INNER JOIN
				pangya.pangya_guild_notice b
				ON a.GUILD_UID = b.GUILD_UID
			WHERE a.GUILD_UID = __UID AND b.STATE = 1
			ORDER BY b.REG_DATE DESC
			LIMIT __PAGE_OFFSET, 12;

		END;
		ELSE
			SELECT 0 AS LINHAS; -- Erro
		END IF;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetGuildPrivateBBSInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetGuildPrivateBBSInfo`(
	__BBS_SEQ BIGINT
)
BEGIN

	IF __BBS_SEQ > 0 THEN
	BEGIN

		DECLARE __OTHER_GUILD INT DEFAULT (
			SELECT
				a.GUILD_UID
			FROM
				pangya.pangya_guild_private_bbs a
				INNER JOIN
				pangya.pangya_guild b
				ON a.GUILD_UID = b.GUILD_UID
			WHERE a.SEQ = __BBS_SEQ
				AND (b.GUILD_STATE NOT IN(4, 5) OR b.GUILD_CLOSURE_DATE IS NULL OR now() < b.GUILD_CLOSURE_DATE)
		);

		-- Está em uma Guild válida
		IF __OTHER_GUILD IS NOT NULL THEN
		BEGIN

			-- Update VIEWS BBS
			UPDATE pangya.pangya_guild_private_bbs SET VIEWS = VIEWS + 1 WHERE SEQ = __BBS_SEQ AND STATE = 1;
		
			-- BBS
			SELECT
				a.SEQ,
				a.TITLE,
				a.`TEXT`,
				a.OWNER_UID,
				(SELECT nick FROM pangya.account WHERE UID = a.OWNER_UID) AS NICKNAME,
				a.VIEWS,
				CAST(a.REG_DATE AS NCHAR(19)) AS REG_DATE
			FROM
				pangya.pangya_guild_private_bbs a
			WHERE a.SEQ = __BBS_SEQ AND a.STATE = 1;

			-- Reply
			SELECT
				b.SEQ,
				b.`TEXT`,
				b.OWNER_UID,
				(SELECT nick FROM pangya.account WHERE UID = b.OWNER_UID) AS NICKNAME,
				CAST(b.REG_DATE AS NCHAR(19)) AS REG_DATE
			FROM
				pangya.pangya_guild_private_bbs a
				INNER JOIN
				pangya.pangya_guild_private_bbs_res b
				ON a.SEQ = b.GUILD_BBS_SEQ
			WHERE a.SEQ = __BBS_SEQ AND a.STATE = 1 AND b.STATE = 1
			ORDER BY b.REG_DATE;

		END;
        END IF;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetGuildPrivateBBSList` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetGuildPrivateBBSList`(
	__UID INT,
	__PAGE INT
)
BEGIN

	IF __UID > 0 AND __PAGE >= 0 THEN
	BEGIN

		DECLARE __OTHER_GUILD INT DEFAULT (
			SELECT
				b.GUILD_UID
			FROM
				pangya.pangya_guild b
			WHERE b.GUILD_UID = __UID
				AND (b.GUILD_STATE NOT IN(4, 5) OR b.GUILD_CLOSURE_DATE IS NULL OR now() < b.GUILD_CLOSURE_DATE)
		);

		-- Está em uma Guild válida
		IF __OTHER_GUILD IS NOT NULL THEN
		BEGIN

			DECLARE __LINHAS BIGINT DEFAULT 

			-- Total de linhas da consulta
			(SELECT 
				COUNT(b.SEQ) AS LINHAS
			FROM 
				pangya.pangya_guild a
				INNER JOIN
				pangya.pangya_guild_private_bbs b
				ON a.GUILD_UID = b.GUILD_UID
			WHERE a.GUILD_UID = __UID AND b.STATE = 1);
            
            DECLARE __PAGE_OFFSET BIGINT DEFAULT (__PAGE * 15);

			SELECT 
				__LINHAS as LINHAS,
				b.SEQ,
				(SELECT COUNT(SEQ) FROM pangya.pangya_guild_private_bbs_res WHERE GUILD_BBS_SEQ = b.SEQ AND STATE = 1) AS RES_COUNT,
				b.TITLE,
				(SELECT nick FROM pangya.account WHERE uid = b.OWNER_UID) AS NICKNAME,
				CAST(b.REG_DATE AS NCHAR(10)) AS REG_DATE
			FROM 
				pangya.pangya_guild a
				INNER JOIN
				pangya.pangya_guild_private_bbs b
				ON a.GUILD_UID = b.GUILD_UID
			WHERE a.GUILD_UID = __UID AND b.STATE = 1
			ORDER BY b.REG_DATE DESC
			LIMIT __PAGE_OFFSET, 15;

		END;
		ELSE
			SELECT 0 AS LINHAS; -- Erro
		END IF;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetGuildPrivateBBSReplyInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetGuildPrivateBBSReplyInfo`(
	__BBS_SEQ BIGINT
)
BEGIN

	IF __BBS_SEQ > 0 THEN
	BEGIN

		DECLARE __OTHER_GUILD INT DEFAULT (
			SELECT
				a.GUILD_UID
			FROM
				pangya.pangya_guild_private_bbs a
				INNER JOIN
				pangya.pangya_guild b
				ON a.GUILD_UID = b.GUILD_UID
			WHERE a.SEQ = __BBS_SEQ
				AND (b.GUILD_STATE NOT IN(4, 5) OR b.GUILD_CLOSURE_DATE IS NULL OR now() < b.GUILD_CLOSURE_DATE)
		);

		-- Está em uma Guild válida
		IF __OTHER_GUILD IS NOT NULL THEN
		BEGIN

			-- Reply
			SELECT
				b.SEQ,
				b.`TEXT`,
				b.OWNER_UID,
				(SELECT nick FROM pangya.account WHERE UID = b.OWNER_UID) AS NICKNAME,
				CAST(b.REG_DATE AS NCHAR(19)) AS REG_DATE
			FROM
				pangya.pangya_guild_private_bbs a
				INNER JOIN
				pangya.pangya_guild_private_bbs_res b
				ON a.SEQ = b.GUILD_BBS_SEQ
			WHERE a.SEQ = __BBS_SEQ AND a.STATE = 1 AND b.STATE = 1
			ORDER BY b.REG_DATE;

		END;
        END IF;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetGuildRanking` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetGuildRanking`(
	__PAGE INT,
	__SEARCH NVARCHAR(100)
)
BEGIN

	IF __PAGE >= 0 THEN
	BEGIN

		DECLARE __LINHAS BIGINT DEFAULT 0;
		DECLARE __REG_DATE NVARCHAR(10);
        DECLARE __PAGE_OFFSET BIGINT DEFAULT (__PAGE * 10);

		-- Total de linhas da consulta
		SELECT COUNT(a.GUILD_UID), CAST(MAX(b.REG_DATE) AS DATE) INTO __LINHAS, __REG_DATE
		FROM 
			pangya.pangya_guild a
			INNER JOIN
			pangya.pangya_guild_ranking b
			ON a.GUILD_UID = b.GUILD_UID
		WHERE 
			a.GUILD_NAME LIKE CONCAT('%', __SEARCH, '%')
			AND (a.GUILD_STATE NOT IN(4, 5) OR a.GUILD_CLOSURE_DATE IS NULL OR now() < a.GUILD_CLOSURE_DATE);

		SELECT 
			__LINHAS as LINHAS,
			__REG_DATE as REG_DATE,
			a.`RANK`,
			a.GUILD_UID,
			a.GUILD_NAME,
			a.GUILD_WIN,
			a.GUILD_LOSE,
			a.GUILD_DRAW,
			a.GUILD_POINT,
			a.GUILD_PANG,
			a.LAST_RANK,
			a.GUILD_MARK_IMG_IDX
		FROM
			(
				SELECT	
					b.`RANK`,
					b.LAST_RANK,
					a.GUILD_UID,
					a.GUILD_NAME,
					a.GUILD_WIN,
					a.GUILD_LOSE,
					a.GUILD_DRAW,
					a.GUILD_POINT,
					a.GUILD_PANG,
					a.GUILD_MARK_IMG_IDX,
					b.REG_DATE
				FROM 
					pangya.pangya_guild a
					INNER JOIN
					pangya.pangya_guild_ranking b
					ON a.GUILD_UID = b.GUILD_UID
				WHERE 
					a.GUILD_NAME LIKE CONCAT('%', __SEARCH, '%')
					AND (a.GUILD_STATE NOT IN(4, 5) OR a.GUILD_CLOSURE_DATE IS NULL OR now() < a.GUILD_CLOSURE_DATE)
			) a
		ORDER BY a.`RANK`
			LIMIT __PAGE_OFFSET, 10;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetGuildRankingUpdateTime` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetGuildRankingUpdateTime`()
BEGIN
	
    SELECT 
		CAST(MAX(REG_DATE) AS NCHAR(19)) AS REG_DATE
	FROM 
		pangya.pangya_guild_ranking;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetGuildRSSInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetGuildRSSInfo`(
	__PLAYER_UID INT
)
BEGIN

	IF __PLAYER_UID > 0 THEN
	BEGIN

		DECLARE __OTHER_GUILD INT DEFAULT (
			SELECT
				a.Guild_UID
			FROM
				pangya.account a
				INNER JOIN
				pangya.pangya_guild b
				ON a.Guild_UID = b.GUILD_UID
			WHERE a.UID = __PLAYER_UID AND 
				(b.GUILD_STATE NOT IN(4, 5) OR b.GUILD_CLOSURE_DATE IS NULL OR now() < b.GUILD_CLOSURE_DATE)
		);

		-- Player está em uma guild válida
		IF __OTHER_GUILD IS NOT NULL THEN
		BEGIN

			DECLARE __GUILD_UID INT DEFAULT 0;

			SET __GUILD_UID = (SELECT Guild_UID FROM pangya.account WHERE UID = __PLAYER_UID);

			IF __GUILD_UID IS NOT NULL AND __GUILD_UID > 0 THEN
			BEGIN
				
				DECLARE __RSS_VER BIGINT DEFAULT 

				-- RSS Version is last sequence id Notice
				(SELECT
					b.SEQ AS RSS_VER
				FROM
					pangya.pangya_guild a
					INNER JOIN
					pangya.pangya_guild_notice b
					ON a.GUILD_UID = b.GUILD_UID
				WHERE a.GUILD_UID = __GUILD_UID AND b.STATE = 1
				ORDER BY b.REG_DATE DESC LIMIT 1);

				-- Last 5 Notice
				SELECT 
					__RSS_VER as RSS_VER,
					b.TITLE,
					b.`TEXT`,
					(SELECT nick FROM pangya.account WHERE uid = b.OWNER_UID) AS NICKNAME,
					CAST(b.REG_DATE AS NCHAR(19)) AS REG_DATE
				FROM 
					pangya.pangya_guild a
					INNER JOIN
					pangya.pangya_guild_notice b
					ON a.GUILD_UID = b.GUILD_UID
				WHERE a.GUILD_UID = __GUILD_UID AND b.STATE = 1
				ORDER BY b.REG_DATE DESC
				LIMIT 0, 5;

			END;
			ELSE
				SELECT 0 AS RSS_VER;
			END IF;

		END;
		ELSE
			SELECT 0 AS RSS_VER;
		END IF;

	END;
	ELSE
		SELECT 0 AS RSS_VER;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetGuildUpdateActivity` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetGuildUpdateActivity`(
	__GUILD_UID INT,
	__MEMBER_UID INT
)
BEGIN

	IF __GUILD_UID > 0 THEN
	BEGIN

		SELECT
			`INDEX`,
			GUILD_UID,
			OWNER_UPDATE,	-- Quem fez a Ação
			PLAYER_UID,
			TYPE_UPDATE,
			REG_DATE
		FROM
			pangya.pangya_guild_update_activity
		WHERE
			GUILD_UID = __GUILD_UID 
			AND OWNER_UPDATE = __MEMBER_UID
			AND STATE = 0
		ORDER BY REG_DATE;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetInfoPlayerToWeb` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetInfoPlayerToWeb`(
	__TYPE INT
)
BEGIN

	IF __TYPE = 0 THEN -- Default Todas as contas que já fizeram logon pelo menos uma vez
	BEGIN
		
		SELECT 
				a.uid, 
				a.id, 
				a.nick, 
				c.`level`, 
				a.idstate, 
				a.capability as cap, 
				c.pang, 
				c.cookie, 
				d.`channel`, 
				d.lobby, 
				d.room, 
				d.place, 
				a.logonCount, 
				e.counter,
				a.userip,
				CAST(a.LastLogonTime AS NCHAR(16)) AS LastLogonTime, 
				a.logon, 
				a.game_server_id, 
				b.`name` 
		FROM pangya.account a, pangya.user_info c, pangya.pangya_server_list b, pangya.pangya_player_location d, pangya.pangya_attendance_reward e
		WHERE a.game_server_id = b.uid  AND a.uid = c.uid AND a.uid = d.uid AND a.UID = e.UID;

	END;
	ELSEIF __TYPE = 1 THEN -- Todas as contas que não fizeram login
	BEGIN

		SELECT 
				a.uid, 
				a.id, 
				a.nick, 
				c.`level`, 
				a.idstate, 
				a.capability as cap, 
				c.pang, 
				c.cookie, 
				d.`channel`, 
				d.lobby, 
				d.room, 
				d.place, 
				a.logonCount,
				e.counter,
				a.userip,
				CAST(a.LastLogonTime AS NCHAR(16)) AS LastLogonTime, 
				a.logon, 
				a.game_server_id, 
				'unknown' as `name` 
		FROM pangya.account a, pangya.user_info c, pangya.pangya_player_location d, pangya.pangya_attendance_reward e
		WHERE  a.uid = c.uid AND a.uid = d.uid AND a.UID = e.UID AND (a.first_login = 0 OR a.first_set = 0);

	END;
	ELSEIF __TYPE = 2 THEN -- Todas as contas online no momento
	BEGIN
		
		SELECT 
				a.uid, 
				a.id, 
				a.nick, 
				c.`level`, 
				a.idstate, 
				a.capability as cap, 
				c.pang, c.cookie, 
				d.`channel`, 
				d.lobby, 
				d.room, 
				d.place, 
				a.logonCount, 
				e.counter,
				a.userip,
				CAST(a.LastLogonTime AS NCHAR(16)) AS LastLogonTime,
				a.logon, 
				a.game_server_id, 
				b.`name` 
		FROM pangya.account a, pangya.user_info c, pangya.pangya_server_list b, pangya.pangya_player_location d, pangya.pangya_attendance_reward e
		WHERE a.logon = 1 AND a.game_server_id = b.uid AND a.uid = c.uid AND a.uid = d.uid AND a.UID = e.UID;

	END;
	ELSEIF __TYPE = 4 THEN -- Todas as contas banidas
	BEGIN
		
		SELECT 
				a.uid, 
				a.id, 
				a.nick, 
				c.`level`, 
				a.idstate, 
				a.capability as cap, 
				c.pang, 
				c.cookie, 
				d.`channel`, 
				d.lobby, 
				d.room, 
				d.place, 
				a.logonCount,
				e.counter,
				a.userip,
				CAST(a.LastLogonTime AS NCHAR(16)) AS LastLogonTime, 
				a.logon, 
				a.game_server_id, 
				IFNULL(b.`Name`, 'unknown') as `name` 
		FROM 
			pangya.account a
			INNER JOIN
			pangya.user_info c
			ON a.uid = c.uid
			INNER JOIN
			pangya.pangya_player_location d
			ON a.uid = d.uid
			INNER JOIN
			pangya.pangya_attendance_reward e
			ON a.UID = e.UID
			LEFT OUTER JOIN
			pangya_server_list b
			ON b.UID = a.game_server_id
		WHERE 
			(a.IDState = 1 AND IFNULL(TIMESTAMPADD(MINUTE, a.BlockTime, a.BlockRegDate), now()) > now() OR a.IDState > 1);
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetInformationEmail` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetInformationEmail`(
	__IDUSER int,
	__IDMSG int
)
BEGIN

	UPDATE pangya.pangya_gift_table
         SET 
            Lida_YN = 1,
			Contador_Vista = Contador_Vista + 1
      WHERE pangya_gift_table.UID = __IDUSER AND pangya_gift_table.Msg_ID = __IDMSG;
      
      SELECT 
         X.Msg_ID, 
         X.fromid, 
         X.giftdate, 
         X.message, 
         X.Lida_YN, 
         (CASE 
            WHEN X.item_id IS NULL THEN 0
            ELSE X.item_id
         END) AS ITEM_ID, 
         (CASE 
            WHEN X.item_typeid IS NULL THEN 0
            ELSE X.item_typeid
         END) AS ITEM_TYPEID, 
         (CASE 
            WHEN X.Flag IS NULL THEN 0
            ELSE X.Flag
         END) AS FLAG, 
         (CASE 
            WHEN X.Quantidade_item IS NULL THEN 0
            ELSE X.Quantidade_item
         END) AS QUANTIDADE_ITEM, 
         (CASE 
            WHEN X.Quantidade_Dia IS NULL THEN 0
            ELSE X.Quantidade_Dia
         END) AS QUANTIDADE_DIA, 
         (CASE 
            WHEN X.Pang IS NULL THEN 0
            ELSE X.Pang
         END) AS PANG, 
         (CASE 
            WHEN X.Cookie IS NULL THEN 0
            ELSE X.Cookie
         END) AS COOKIE, 
         (CASE 
            WHEN X.GM_ID IS NULL THEN 0
            ELSE X.GM_ID
         END) AS GM_ID, 
         (CASE 
            WHEN X.Flag_Gift IS NULL THEN 0
            ELSE X.Flag_Gift
         END) AS FLAG_GIFT, 
         (CASE 
            WHEN X.UCC_IMG_MARK IS NULL THEN '0'
            ELSE X.UCC_IMG_MARK
         END) AS UCC_IMG_MARK, 
         (CASE 
            WHEN X.`Type` IS NULL THEN 0
            ELSE X.`Type`
         END) AS `TYPE`
      FROM 
         (
            SELECT 
               A.UID, 
               A.Msg_ID, 
               A.fromid, 
               A.message, 
               A.giftdate, 
               A.Contador_Vista, 
               A.Lida_YN, 
               A.Flag AS Flag_MSG, 
               B.ID_MSG, 
               B.item_id, 
               B.item_typeid, 
               B.Flag, 
               B.Quantidade_item, 
               B.Quantidade_Dia, 
               B.GET_DATE, 
               B.Pang, 
               B.Cookie, 
               B.GM_ID, 
               B.Flag_Gift, 
               /*B.UCC_IMG_MARK*/
			   IFNULL((SELECT UCCIDX FROM pangya.tu_ucc WHERE item_id = B.item_id), '0') AS UCC_IMG_MARK, 
               B.`Type`
            FROM 
               (
                  SELECT 
                     pangya_gift_table.UID, 
                     pangya_gift_table.Msg_ID, 
                     pangya_gift_table.fromid, 
                     pangya_gift_table.message, 
                     pangya_gift_table.giftdate, 
                     pangya_gift_table.Flag, 
                     pangya_gift_table.Contador_Vista, 
                     pangya_gift_table.Lida_YN
                  FROM pangya.pangya_gift_table
                  WHERE pangya_gift_table.valid = 1
               )  AS A 
                  LEFT OUTER JOIN 
                  (
                     SELECT 
                        pangya_item_mail.Msg_ID AS ID_MSG, 
                        pangya_item_mail.item_id, 
                        pangya_item_mail.item_typeid, 
                        pangya_item_mail.Flag, 
                        pangya_item_mail.Quantidade_item, 
                        pangya_item_mail.Quantidade_Dia, 
                        pangya_item_mail.GET_DATE, 
                        pangya_item_mail.Pang, 
                        pangya_item_mail.Cookie, 
                        pangya_item_mail.GM_ID, 
                        pangya_item_mail.Flag_Gift, 
                        pangya_item_mail.UCC_IMG_MARK, 
                        pangya_item_mail.`Type`
                     FROM pangya.pangya_item_mail
                     WHERE pangya_item_mail.valid = 1
                  )  AS B 
                  ON A.Msg_ID = B.ID_MSG
         )  AS X
      WHERE X.UID = __IDUSER AND X.Msg_ID = __IDMSG;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetInformationEmail2` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetInformationEmail2`(
	__IDUSER int,
	__IDMSG int
)
BEGIN

	IF __IDUSER > 0 AND __IDMSG > 0 THEN
	BEGIN

		SELECT 
            A.Msg_ID, 
            A.fromid,  
			A.giftdate, 
            A.`message`, 
            A.Contador_Vista, 
            A.Lida_YN, 
            IFNULL(B.item_id, 0) AS ITEM_ID,
            IFNULL(B.item_typeid, 0) AS ITEM_TYPEID, 
            IFNULL(B.Flag, 0) AS FLAG, 
			IFNULL(B.Quantidade_item, 0) AS QUANTIDADE_ITEM, 
			IFNULL(B.Quantidade_Dia, 0) AS QUANTIDADE_DIA, 
            IFNULL(B.Pang, 0) AS PANG, 
			IFNULL(B.Cookie, 0) AS COOKIE, 
			IFNULL(B.GM_ID, 0) AS GM_ID, 
			IFNULL(B.Flag_Gift, 0) AS FLAG_GIFT,  
			IFNULL((SELECT UCCIDX FROM pangya.tu_ucc WHERE item_id = B.item_id), '0') AS UCC_IMG_MARK, 
            IFNULL(B.`Type`, 0) AS `TYPE`
        FROM 
        (
            SELECT 
				UID, 
				Msg_ID, 
				fromid, 
				`message`, 
				giftdate, 
				Flag, 
				Contador_Vista, 
				Lida_YN
            FROM pangya.pangya_gift_table
            WHERE valid = 1
        )  AS A 
        LEFT OUTER JOIN 
        (
            SELECT 
				Msg_ID AS ID_MSG, 
				item_id, 
				item_typeid, 
				Flag, 
				Quantidade_item, 
				Quantidade_Dia, 
				Pang, 
				Cookie, 
				GM_ID, 
				Flag_Gift, 
				UCC_IMG_MARK, 
				`Type`
            FROM pangya.pangya_item_mail
            WHERE valid = 1
        )  AS B 
        ON A.Msg_ID = B.ID_MSG
		WHERE UID = __IDUSER AND Msg_ID = __IDMSG;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetIPTable` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetIPTable`(
)
BEGIN

	SELECT 
		ip, mask, `date`, `index` 
	FROM 
		pangya.pangya_ip_table
	ORDER BY `date`;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetItemBoostPangFlag` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetItemBoostPangFlag`(
	__IDUSER int
)
BEGIN

	DECLARE __FLAG_RET int DEFAULT 0;

      IF 
         (
            SELECT pangya_item_warehouse.typeid
            FROM pangya.pangya_item_warehouse
            WHERE 
               pangya_item_warehouse.UID = __IDUSER AND 
               pangya_item_warehouse.valid = 1 AND 
               pangya_item_warehouse.C0 > 0 AND 
               pangya_item_warehouse.typeid = 436207617
         ) IS NOT NULL THEN
			SET __FLAG_RET = __FLAG_RET | 1;
	END IF;

      IF 
         (
            

            SELECT pangya_item_warehouse.typeid
            FROM pangya.pangya_item_warehouse
            WHERE 
               pangya_item_warehouse.UID = __IDUSER AND 
               pangya_item_warehouse.valid = 1 AND 
               pangya_item_warehouse.C0 > 0 AND 
               pangya_item_warehouse.typeid = 436207618
         ) IS NOT NULL THEN
			SET __FLAG_RET = __FLAG_RET | 1;
	END IF;

      IF 
         (
            SELECT pangya_item_warehouse.typeid
            FROM pangya.pangya_item_warehouse
            WHERE 
               pangya_item_warehouse.UID = __IDUSER AND 
               pangya_item_warehouse.valid = 1 AND 
               pangya_item_warehouse.C0 > 0 AND 
               pangya_item_warehouse.typeid = 436207621
         ) IS NOT NULL THEN
			SET __FLAG_RET = __FLAG_RET | 2;
	END IF;

      SELECT __FLAG_RET;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetItemBuff` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetItemBuff`(
	__IDUSER INT
)
BEGIN
	
	SELECT `index`, typeid, reg_date, end_date, tipo, `percent`, use_yn
	FROM pangya.pangya_item_buff
	WHERE UID = __IDUSER AND use_yn = 1 AND timestampdiff(SECOND, now(), end_date) > 0;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetItemInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetItemInfo`(
	__IDUSER int,
	__IDITEM int
)
BEGIN

      IF __IDITEM < 0 THEN
         SELECT __IDITEM = pangya_user_equip.club_id
         FROM pangya.pangya_user_equip
         WHERE pangya_user_equip.UID = __IDUSER;
	END IF;

      SELECT 
         pangya_item_warehouse.item_id, 
         pangya_item_warehouse.UID, 
         pangya_item_warehouse.typeid, 
         pangya_item_warehouse.C0, 
         pangya_item_warehouse.C1, 
         pangya_item_warehouse.C2, 
         pangya_item_warehouse.C3, 
         pangya_item_warehouse.C4, 
         pangya_item_warehouse.Purchase
      FROM pangya.pangya_item_warehouse
      WHERE 
         pangya_item_warehouse.UID = __IDUSER AND 
         pangya_item_warehouse.valid = 1 AND 
         pangya_item_warehouse.item_id = __IDITEM;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetItensPangRate` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetItensPangRate`(
	__IDUSER int
)
BEGIN

	DECLARE __qntd int DEFAULT 0;

      SET __qntd = __qntd + pangya.GetCardPangRate(__IDUSER);

      SET __qntd = __qntd + pangya.GetItensPangRate(__IDUSER);

      /*
      *   SSMA informational messages:
      *   M2SS0134: Conversion of following Comment(s) is not supported :  Aqui vai as roupas (Parts) que equipada da % de Exp rate
      *   mascot Pang - DESABILITADO que no mascot.iff tem o rate lá
      *   SET __mascot := (SELECT mascot_id FROM pangya_user_equip WHERE UID = IDUSER);
      *       
      *       SET __TYPEID_MASC := (SELECT typeid FROM pangya_mascot_info WHERE UID = IDUSER AND item_id = __mascot AND EndDate > NOW());
      *       
      *       CASE __TYPEID_MASC
      *   		WHEN 0x40000002 THEN	# Cocoa
      *   			SET qntd = qntd + 20;
      *   		WHEN 0x40000027 THEN	# Pangya Ninja Kun
      *   			SET qntd = qntd + 10;
      *   		WHEN 0x4000003B THEN	# Tricks Pets
      *   			SET qntd = qntd + 10; # +20 em tempo de Halloween
      *   		ELSE
      *           BEGIN
      *           END;
      *       END CASE;
      *
      */

      SELECT __qntd AS PANG_RATE_ITEM;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetItensSameTypeidDiffID` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetItensSameTypeidDiffID`(
	__IDUSER int,
	___typeid int,
	___limit int
)
BEGIN

	SELECT pangya_item_warehouse.item_id, pangya_item_warehouse.typeid
      FROM pangya.pangya_item_warehouse
      WHERE 
         pangya_item_warehouse.UID = __IDUSER AND 
         pangya_item_warehouse.valid = 1 AND 
         pangya_item_warehouse.Gift_flag <> 1 AND 
         pangya_item_warehouse.typeid = ___typeid AND 
         pangya_item_warehouse.item_id NOT IN 
         (
            SELECT td_char_equip_s4.ITEMID
            FROM pangya.td_char_equip_s4
            WHERE 
               td_char_equip_s4.UID = __IDUSER AND 
               td_char_equip_s4.USE_YN = 'Y' AND 
               td_char_equip_s4.EQUIP_TYPE = ___typeid
         )
         ORDER BY pangya_item_warehouse.item_id LIMIT ___limit;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetLastPlayerGame` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetLastPlayerGame`(
	__IDUSER INT
)
BEGIN
	
	SELECT 
         pangya_last_players_user.SEX_0, 
         pangya_last_players_user.NICK_0, 
         pangya_last_players_user.ID_0, 
         pangya_last_players_user.UID_0, 
         pangya_last_players_user.SEX_1, 
         pangya_last_players_user.NICK_1, 
         pangya_last_players_user.ID_1, 
         pangya_last_players_user.UID_1, 
         pangya_last_players_user.SEX_2, 
         pangya_last_players_user.NICK_2, 
         pangya_last_players_user.ID_2, 
         pangya_last_players_user.UID_2, 
         pangya_last_players_user.SEX_3, 
         pangya_last_players_user.NICK_3, 
         pangya_last_players_user.ID_3, 
         pangya_last_players_user.UID_3, 
         pangya_last_players_user.SEX_4, 
         pangya_last_players_user.NICK_4, 
         pangya_last_players_user.ID_4, 
         pangya_last_players_user.UID_4
      FROM pangya.pangya_last_players_user
      WHERE pangya_last_players_user.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetLegacyTikiShopInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetLegacyTikiShopInfo`(
	__UID BIGINT
)
BEGIN
	
	SELECT `Tiki_Points` FROM pangya.pangya_tiki_points WHERE UID = __UID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetLevelMemorial` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetLevelMemorial`(
	__IDUSER int
)
BEGIN

	SELECT pangya.GetLevelMemorial(__IDUSER) AS `LEVEL`, pangya.GetAchievementPoint(__IDUSER) AS ACHIVEMENT_POINT;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetListGachaSystemPlayerItens` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetListGachaSystemPlayerItens`(
	__UID INT,
	__PAGE INT,
	__TYPE INT,
	__TYPE_ITEM INT
)
BEGIN

	IF __UID > 0 AND __PAGE >= 0 THEN
	BEGIN

		DECLARE __LINHAS BIGINT DEFAULT 

		-- Total de linhas da consulta
		(SELECT 
			COUNT(a.`index`) AS LINHAS
		FROM 
			pangya.pangya_gacha_jp_player_win a
			INNER JOIN
			pangya.pangya_gacha_jp_all_item_list b
			ON a.typeid = b.typeid
		WHERE a.UID = __UID AND a.valid = 1 AND a.send_mail = 0
			AND (__TYPE = 1 -- Type 1 retorna todos os itens
			OR (__TYPE = 2 AND a.rarity_type = 0 AND ((__TYPE_ITEM = 100 AND b.char_type > 10/*Spika*/) OR __TYPE_ITEM = b.char_type)) -- Type 2 só retorna os raros, com o seu char_type
			OR (__TYPE = 3 AND a.rarity_type != 0 AND ((__TYPE_ITEM = 1 AND b.char_type = 11/*Aztec*/) OR (__TYPE_ITEM = 2 AND b.char_type != 11/*Aztec*/))))); -- Itens e Aztec

		DECLARE __PAGE_OFFSET BIGINT DEFAULT (__PAGE * 50);

		SELECT 
			__LINHAS as LINHAS,
			a.`index` AS ID,
			a.typeid AS TYPEID,
			a.qnty AS QNTD,
			b.`name` AS `NAME`
		FROM 
			pangya.pangya_gacha_jp_player_win a
			INNER JOIN
			pangya.pangya_gacha_jp_all_item_list b
			ON a.typeid = b.typeid
		WHERE a.UID = __UID AND a.valid = 1 AND a.send_mail = 0
			AND (__TYPE = 1 -- Type 1 retorna todos os itens
			OR (__TYPE = 2 AND a.rarity_type = 0 AND ((__TYPE_ITEM = 100 AND b.char_type > 10/*Spika*/) OR __TYPE_ITEM = b.char_type)) -- Type 2 só retorna os raros, com o seu char_type
			OR (__TYPE = 3 AND a.rarity_type != 0 AND ((__TYPE_ITEM = 1 AND b.char_type = 11/*Aztec*/) OR (__TYPE_ITEM = 2 AND b.char_type != 11/*Aztec*/)))) -- Itens e Aztec
		ORDER BY b.REG_DATE DESC
		LIMIT __PAGE_OFFSET, 50;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetListGuild` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetListGuild`(
	__PAGE INT,
	__CATEGORY INT,
	__SEARCH NVARCHAR(22),
	__SORT INT
)
BEGIN

	DECLARE __PAGE_OFFSET BIGINT DEFAULT (__PAGE * 12);

	IF __PAGE >= 0 THEN
	BEGIN

		DECLARE __LINHAS BIGINT DEFAULT 0;

		IF __CATEGORY = 0 THEN	-- GUILD NAME
		BEGIN

			SET __LINHAS = 

			-- Total de linhas da consulta
			(SELECT COUNT(a.GUILD_UID) AS LINHAS 
			FROM 
			pangya.pangya_guild a
			INNER JOIN
			pangya.account b
			ON a.GUILD_LEADER = b.uid
			WHERE 
				a.GUILD_NAME LIKE CONCAT('%', __SEARCH, '%')
				AND (a.GUILD_STATE NOT IN(4, 5) OR a.GUILD_CLOSURE_DATE IS NULL OR now() < a.GUILD_CLOSURE_DATE));

			SELECT 
				__LINHAS as LINHAS,
				a.GUILD_UID,
				a.GUILD_NAME,
				a.GUILD_MASTER,
				a.MEMBERS,
				a.GUILD_CONDITION_LEVEL,
				a.GUILD_STATE,
				a.GUILD_FLAG,
				a.GUILD_MARK_IMG_IDX,
				CAST(a.GUILD_REG_DATE as NCHAR(10)) as GUILD_REG_DATE
			FROM
				(
					SELECT	a.*,
							(SELECT COUNT(GUILD_UID) FROM pangya.pangya_guild_member WHERE GUILD_UID = a.GUILD_UID AND MEMBER_STATE_FLAG < 9) as MEMBERS,
							b.NICK as GUILD_MASTER
					FROM 
					pangya.pangya_guild a
					INNER JOIN
					pangya.account b
					ON a.GUILD_LEADER = b.uid
					WHERE 
						a.GUILD_NAME LIKE CONCAT('%', __SEARCH, '%')
						AND (a.GUILD_STATE NOT IN(4, 5) OR a.GUILD_CLOSURE_DATE IS NULL OR now() < a.GUILD_CLOSURE_DATE)
				) a
			ORDER BY
				CASE WHEN __SORT = 0 THEN a.GUILD_NAME ELSE null END,
				CASE WHEN __SORT = 1 THEN a.GUILD_MASTER ELSE null END,
				CASE WHEN __SORT = 2 THEN a.MEMBERS ELSE null END DESC,
				CASE WHEN __SORT = 3 THEN a.GUILD_CONDITION_LEVEL ELSE null END,
				CASE WHEN __SORT = 4 THEN a.GUILD_STATE ELSE null END,
				CASE WHEN __SORT = 5 THEN a.GUILD_FLAG ELSE null END,
				CASE WHEN __SORT = 6 THEN a.GUILD_REG_DATE ELSE a.GUILD_REG_DATE END DESC
				LIMIT __PAGE_OFFSET, 12;

		END;
		ELSE	-- GUILD MASTER NICKNAME
		BEGIN

			SET __LINHAS = 

			-- Total de linhas da consulta
			(SELECT COUNT(a.GUILD_UID) AS LINHAS 
			FROM 
			pangya.pangya_guild a
			INNER JOIN
			pangya.account b
			ON a.GUILD_LEADER = b.uid
			WHERE 
				b.NICK LIKE CONCAT('%', __SEARCH, '%')
				AND (a.GUILD_STATE NOT IN(4, 5) OR a.GUILD_CLOSURE_DATE IS NULL OR now() < a.GUILD_CLOSURE_DATE));
			
			SELECT 
				__LINHAS as LINHAS,
				a.GUILD_UID,
				a.GUILD_NAME,
				a.GUILD_MASTER,
				a.MEMBERS,
				a.GUILD_CONDITION_LEVEL,
				a.GUILD_STATE,
				a.GUILD_FLAG,
				a.GUILD_MARK_IMG_IDX,
				CAST(a.GUILD_REG_DATE as NCHAR(10)) as GUILD_REG_DATE
			FROM
				(
					SELECT	a.*,
							(SELECT COUNT(GUILD_UID) FROM pangya.pangya_guild_member WHERE GUILD_UID = a.GUILD_UID AND MEMBER_STATE_FLAG < 9) as MEMBERS,
							b.NICK as GUILD_MASTER
					FROM 
					pangya.pangya_guild a
					INNER JOIN
					pangya.account b
					ON a.GUILD_LEADER = b.uid
					WHERE 
						b.NICK LIKE CONCAT('%', __SEARCH, '%')
						AND (a.GUILD_STATE NOT IN(4, 5) OR a.GUILD_CLOSURE_DATE IS NULL OR now() < a.GUILD_CLOSURE_DATE)
				) a
			ORDER BY
				CASE WHEN __SORT = 0 THEN a.GUILD_NAME ELSE null END,
				CASE WHEN __SORT = 1 THEN a.GUILD_MASTER ELSE null END,
				CASE WHEN __SORT = 2 THEN a.MEMBERS ELSE null END DESC,
				CASE WHEN __SORT = 3 THEN a.GUILD_CONDITION_LEVEL ELSE null END,
				CASE WHEN __SORT = 4 THEN a.GUILD_STATE ELSE null END,
				CASE WHEN __SORT = 5 THEN a.GUILD_FLAG ELSE null END,
				CASE WHEN __SORT = 6 THEN a.GUILD_REG_DATE ELSE a.GUILD_REG_DATE END DESC
				LIMIT __PAGE_OFFSET, 12;

		END;	-- ELSE IFF CATEGORY
        END IF;

	END; -- CHECK PAGE
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetListGuildBBS` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetListGuildBBS`(
	__PAGE INT,
	__CATEGORY INT,
	__SEARCH NVARCHAR(22),
	__SORT INT
)
BEGIN

	IF __PAGE >= 0 THEN
	BEGIN

		DECLARE __LINHAS BIGINT DEFAULT 

		-- Total de linhas da consulta
		(SELECT 
			COUNT(a.SEQ) AS LINHAS
		FROM 
			pangya.pangya_guild_bbs a
		WHERE 
			STATE = 1 AND (__CATEGORY = 10 OR a.`TYPE` = __CATEGORY)
			AND a.TITLE LIKE CONCAT('%', __SEARCH, '%'));
            
		DECLARE __PAGE_OFFSET BIGINT DEFAULT (__PAGE * 14);

		SELECT
			__LINHAS as LINHAS,
			a.SEQ,
			a.`TYPE`,
			a.TITLE,
			a.RES_COUNT,
			a.NICKNAME,
			CAST(a.REG_DATE AS NCHAR(10)) AS REG_DATE
		FROM
			(
				SELECT 
					a.SEQ,
					a.`TYPE`,
					a.TITLE,
					(SELECT COUNT(SEQ) FROM pangya.pangya_guild_bbs_res WHERE BBS_SEQ = a.SEQ AND STATE = 1) AS RES_COUNT,
					(SELECT nick FROM pangya.account WHERE UID = a.OWNER_UID) AS NICKNAME,
					a.REG_DATE
				FROM 
					pangya.pangya_guild_bbs a
				WHERE 
					STATE = 1 AND (__CATEGORY = 10 OR a.`TYPE` = __CATEGORY)
					AND a.TITLE LIKE CONCAT('%', __SEARCH, '%')
			) a
		ORDER BY
			CASE WHEN __SORT = 0 THEN (SELECT MAX(REG_DATE) FROM pangya.pangya_guild_bbs_res WHERE BBS_SEQ = a.SEQ AND STATE = 1) ELSE null END DESC,
			CASE WHEN __SORT = 6 THEN a.REG_DATE ELSE a.REG_DATE END DESC,
			a.SEQ DESC
			LIMIT __PAGE_OFFSET, 14;

	END; -- CHECK PAGE
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetListGuildWeb` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetListGuildWeb`(
	__OPT INT
)
BEGIN

	SELECT
		a.GUILD_INTRO_IMG,
		a.GUILD_UID,
		a.GUILD_NAME,
		a.GUILD_MARK_IMG_IDX,
		a.GUILD_NEW_MARK_IDX,
		IFNULL((SELECT NICK FROM pangya.account WHERE UID = a.GUILD_LEADER), '') AS GUILD_MASTER,
		IFNULL((SELECT NICK FROM pangya.account WHERE UID = a.GUILD_SUB_MASTER), '') AS GUILD_SUB_MASTER,
		(SELECT COUNT(GUILD_UID) FROM pangya.pangya_guild_member WHERE GUILD_UID = a.GUILD_UID AND MEMBER_STATE_FLAG < 9) as MEMBERS,
		a.GUILD_CONDITION_LEVEL,
		a.GUILD_STATE,
		a.GUILD_FLAG,
		a.GUILD_PERMITION_JOIN,
		a.GUILD_POINT,
		a.GUILD_PANG,
		a.GUILD_INFO,
		a.GUILD_NOTICE,
		CAST(a.GUILD_REG_DATE AS NCHAR(19)) AS GUILD_REG_DATE,
		CAST(a.GUILD_ACCEPT_DATE AS NCHAR(19)) AS GUILD_ACCEPT_DATE,
		CAST(a.GUILD_CLOSURE_DATE AS NCHAR(19)) AS GUILD_CLOSURE_DATE
	FROM
		pangya.pangya_guild a
	WHERE
		__OPT = 0 OR (a.GUILD_STATE = 0/*pending*/ AND a.GUILD_MARK_IMG_IDX = 0 AND a.GUILD_NEW_MARK_IDX > 0
				 OR (a.GUILD_STATE < 3/*3 pra cima é guild bloqueado ou fechada*/ AND  a.GUILD_NEW_MARK_IDX > 0))
	ORDER BY a.GUILD_REG_DATE;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetMacrosUser` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetMacrosUser`(
	_IDUSER int
)
BEGIN
	
	SELECT 
         pangya_user_macro.Macro1, 
         pangya_user_macro.Macro2, 
         pangya_user_macro.Macro3, 
         pangya_user_macro.Macro4, 
         pangya_user_macro.Macro5, 
         pangya_user_macro.Macro6, 
         pangya_user_macro.Macro7, 
         pangya_user_macro.Macro8, 
         pangya_user_macro.Macro9
      FROM pangya.pangya_user_macro
      WHERE pangya_user_macro.UID = _IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetMACTable` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetMACTable`(
)
BEGIN

	SELECT 
		mac, `date`, `index` 
	FROM 
		pangya.pangya_mac_table
	ORDER BY `date`;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetMapStatistics` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetMapStatistics`(
	__IDUSER int,
	__tipo_in int
)
BEGIN
	
	IF __tipo_in < 10 THEN	-- Seta para zero por que está pedindo a season, aqui não implementei por que nao tem season anterior e o 5 é season atual
		SET __tipo_in = 0;
	ELSEIF __tipo_in = 10 THEN
		SET __tipo_in = 51;
	ELSEIF __tipo_in = 11 THEN
		SET __tipo_in = 52;

		SELECT 
			pangya_record.UID, 
			pangya_record.tipo, 
			pangya_record.course, 
			pangya_record.tacada, 
			pangya_record.putt, 
			pangya_record.hole, 
			pangya_record.fairway, 
			pangya_record.holein, 
			pangya_record.puttin, 
			pangya_record.total_score, 
			pangya_record.best_score, 
			pangya_record.best_pang, 
			pangya_record.character_typeid, 
			pangya_record.event_score
		FROM pangya.pangya_record
		WHERE 
			pangya_record.UID = __IDUSER AND 
			(pangya_record.tipo = __tipo_in AND pangya_record.course < 22) AND 
			pangya_record.assist = 0
			ORDER BY pangya_record.course;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetMapStatisticsAssist` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetMapStatisticsAssist`(
	__IDUSER int,
	__tipo_in int
)
BEGIN
	
	IF __tipo_in < 10 THEN	-- Seta para zero por que está pedindo a season, aqui não implementei por que nao tem season anterior e o 5 é season atual
		SET __tipo_in = 0;
	ELSEIF __tipo_in = 10 THEN
		SET __tipo_in = 51;
	ELSEIF __tipo_in = 11 THEN
		SET __tipo_in = 52;

		SELECT 
			pangya_record.UID, 
			pangya_record.tipo, 
			pangya_record.course, 
			pangya_record.tacada, 
			pangya_record.putt, 
			pangya_record.hole, 
			pangya_record.fairway, 
			pangya_record.holein, 
			pangya_record.puttin, 
			pangya_record.total_score, 
			pangya_record.best_score, 
			pangya_record.best_pang, 
			pangya_record.character_typeid, 
			pangya_record.event_score
		FROM pangya.pangya_record
		WHERE 
			pangya_record.UID = __IDUSER AND 
			(pangya_record.tipo = __tipo_in AND pangya_record.course < 22) AND 
			pangya_record.assist = 1
			ORDER BY pangya_record.course;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetMapStatisticsAssistOne` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetMapStatisticsAssistOne`(
	__IDUSER int,
	__tipo_in int,
	__course_in int
)
BEGIN
	
	IF __tipo_in < 10 THEN	-- Seta para zero por que está pedindo a season, aqui não implementei por que nao tem season anterior e o 5 é season atual
		SET __tipo_in = 0;
	ELSEIF __tipo_in = 10 THEN
		SET __tipo_in = 51;
	ELSEIF __tipo_in = 11 THEN
		SET __tipo_in = 52;
	END IF;

	SELECT 
		pangya_record.UID, 
		pangya_record.tipo, 
		pangya_record.course, 
		pangya_record.tacada, 
		pangya_record.putt, 
		pangya_record.hole, 
		pangya_record.fairway, 
		pangya_record.holein, 
		pangya_record.puttin, 
		pangya_record.total_score, 
		pangya_record.best_score, 
		pangya_record.best_pang, 
		pangya_record.character_typeid, 
		pangya_record.event_score
	FROM pangya.pangya_record
	WHERE 
		pangya_record.UID = __IDUSER AND 
		(pangya_record.tipo = __tipo_in AND pangya_record.course < 22) AND 
		pangya_record.assist = 1 AND 
		pangya_record.course = __course_in
		ORDER BY pangya_record.course;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetMapStatisticsOne` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetMapStatisticsOne`(
	__IDUSER int,
	__tipo_in int,
	__course_in int
)
BEGIN
	
	IF __tipo_in < 10 THEN	-- Seta para zero por que está pedindo a season, aqui não implementei por que nao tem season anterior e o 5 é season atual
		SET __tipo_in = 0;
	ELSEIF __tipo_in = 10 THEN
		SET __tipo_in = 51;
	ELSEIF __tipo_in = 11 THEN
		SET __tipo_in = 52;
	END IF;

	SELECT 
		pangya_record.UID, 
		pangya_record.tipo, 
		pangya_record.course, 
		pangya_record.tacada, 
		pangya_record.putt, 
		pangya_record.hole, 
		pangya_record.fairway, 
		pangya_record.holein, 
		pangya_record.puttin, 
		pangya_record.total_score, 
		pangya_record.best_score, 
		pangya_record.best_pang, 
		pangya_record.character_typeid, 
		pangya_record.event_score
	FROM pangya.pangya_record
	WHERE 
		pangya_record.UID = __IDUSER AND 
		(pangya_record.tipo = __tipo_in AND pangya_record.course < 22) AND 
		pangya_record.assist = 0 AND 
		pangya_record.course = __course_in
		ORDER BY pangya_record.course;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetMascotInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetMascotInfo`(
	__IDUSER int
)
BEGIN
	
	SELECT 
         pangya_mascot_info.item_id, 
         pangya_mascot_info.UID, 
         pangya_mascot_info.typeid, 
         pangya_mascot_info.mLevel, 
         pangya_mascot_info.mExp, 
         pangya_mascot_info.Flag, 
         pangya_mascot_info.Message, 
         pangya_mascot_info.Tipo, 
         pangya_mascot_info.IsCash, 
         pangya_mascot_info.EndDate
      FROM pangya.pangya_mascot_info
      WHERE 
         pangya_mascot_info.UID = __IDUSER AND 
         (
         CASE 
            WHEN Tipo = 1 THEN 
               CASE 
                  WHEN (pangya_mascot_info.EndDate >= now()) THEN 1
                  ELSE 0
               END
            ELSE 
               1
         END <> 0) AND 
         pangya_mascot_info.Valid = 1;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetMascotInfo_One` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetMascotInfo_One`(
	__IDUSER int,
	__IDITEM int
)
BEGIN
	
	IF __IDITEM < 0 THEN
         SELECT pangya_user_equip.mascot_id INTO __IDITEM
         FROM pangya.pangya_user_equip
         WHERE pangya_user_equip.UID = __IDUSER;
	END IF;

      SELECT 
         pangya_mascot_info.item_id, 
         pangya_mascot_info.UID, 
         pangya_mascot_info.typeid, 
         pangya_mascot_info.mLevel, 
         pangya_mascot_info.mExp, 
         pangya_mascot_info.Flag, 
         pangya_mascot_info.Message, 
         pangya_mascot_info.Tipo, 
         pangya_mascot_info.IsCash, 
         pangya_mascot_info.EndDate
      FROM pangya.pangya_mascot_info
      WHERE 
         pangya_mascot_info.UID = __IDUSER AND 
         pangya_mascot_info.item_id = __IDITEM AND 
         (
         CASE 
            WHEN Tipo = 1 THEN 
               CASE 
                  WHEN (pangya_mascot_info.EndDate >= now()) THEN 1
                  ELSE 0
               END
            ELSE 
               1
         END <> 0) AND 
         pangya_mascot_info.Valid = 1;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetMemberInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetMemberInfo`(
	__IDUSER int
)
BEGIN
	
	SELECT account.ID, account.`PASSWORD`, account.NICK
      FROM pangya.account
      WHERE account.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetMemorialNormalItemInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetMemorialNormalItemInfo`()
BEGIN
	
	SELECT 
		a.typeid
	   ,a.tipo
	   ,CASE WHEN b.typeid IS NULL THEN a.typeid ELSE b.typeid END as item_typeid
	   ,CASE WHEN b.qntd IS NULL THEN a.qntd ELSE b.qntd END as item_qntd 
	FROM pangya.pangya_new_memorial_normal_item a
	LEFT OUTER JOIN
	pangya.pangya_new_memorial_lucky_set b
	ON a.typeid = b.set_id
	WHERE a.active = 1;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetMemorialShopRate` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetMemorialShopRate`(
	__COIN_TYPEID int
)
BEGIN
	
	SELECT 
         CASE 
            WHEN (b.tipo = 1 AND a.tipo = 1) THEN a.probabilidade + 400
            ELSE a.probabilidade
         END AS prob, a.tipo
      FROM pangya.pangya_memorial_shop_rate  AS a, pangya.pangya_memorial_shop_coin_item  AS b
      WHERE b.typeid = __COIN_TYPEID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetMoedas` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetMoedas`(
	__IDUSER int
)
BEGIN
	
	SELECT user_info.Pang, user_info.Cookie
      FROM pangya.user_info
      WHERE user_info.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetMsgOff` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetMsgOff`(
	__IDUSER INT
)
BEGIN
	
	SELECT 
         a.msg_idx, 
         a.uid_from AS uid, 
         b.NICK, 
         a.msg, 
         a.reg_date
      FROM pangya.pangya_msg_user  AS a, pangya.account  AS b
      WHERE 
         a.uid_from = b.UID AND 
         a.uid = __IDUSER AND 
         a.valid = 1;

      UPDATE pangya.pangya_msg_user
         SET 
            valid = 0
      WHERE pangya_msg_user.uid = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetMyRoom_One` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetMyRoom_One`(
	__IDUSER INT,
	__ITEMID INT
)
BEGIN
	
	SELECT 
         td_room_data.MYROOM_ID, 
         td_room_data.UID, 
         td_room_data.TYPEID, 
         td_room_data.ROOM_NO, 
         td_room_data.POS_X, 
         td_room_data.POS_Y, 
         td_room_data.POS_Z, 
         td_room_data.POS_R, 
         (CASE 
            WHEN td_room_data.DISPLAY_YN = 'Y' THEN 1
            ELSE 0
         END) AS USE_YN
      FROM pangya.td_room_data
      WHERE td_room_data.UID = __IDUSER AND valid = 1 AND MYROOM_ID = __ITEMID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetNewAchievement` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetNewAchievement`(
	__IDUSER int
)
BEGIN
	
	SELECT
		a.active,
		a.TypeID,
		a.ID_ACHIEVEMENT,
		a.`status`,
		b.id,
		b.typeid as Quest_TypeID,
		IFNULL(d.TypeID, 0) as Counter_TypeID,
		IFNULL(c.counter_item_id, 0) as Counter_ID,
		IFNULL(d.Count_Num_Item, 0) as Count_Num_item,
		IF(b.`Date` IS NULL, 0, CAST(UNIX_TIMESTAMP(b.`Date`) as signed)) as Data_Sec
	FROM
		pangya.pangya_achievement a
		INNER JOIN
		pangya.pangya_quest b
		ON a.ID_ACHIEVEMENT = b.achievement_id
		LEFT OUTER JOIN
		(
			SELECT qs.id, 
				IF(qs.counter_item_id <> 0, qs.counter_item_id, IFNULL(MIN(sub_qs.counter_item_id), 0)) as counter_item_id
			FROM pangya.pangya_quest qs
			INNER JOIN
			pangya.pangya_achievement a
			ON qs.achievement_id = a.ID_ACHIEVEMENT
			LEFT JOIN
			(
				SELECT b.ID_ACHIEVEMENT, MIN(a.counter_item_id) as counter_item_id
				FROM pangya.pangya_quest a
				INNER JOIN
				pangya.pangya_achievement b
				ON a.achievement_id = b.ID_ACHIEVEMENT
				WHERE a.uid = __IDUSER AND a.counter_item_id <> 0
				GROUP BY b.ID_ACHIEVEMENT
			) sub_qs
			ON a.ID_ACHIEVEMENT = sub_qs.ID_ACHIEVEMENT
			WHERE qs.uid = __IDUSER
			GROUP BY qs.id, qs.counter_item_id
		) c
		ON b.id = c.id
		LEFT JOIN
		pangya.pangya_counter_item d
		ON c.counter_item_id = d.Count_ID
	WHERE a.UID = __IDUSER
	ORDER BY b.id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetNewAuthServerKey` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetNewAuthServerKey`(
	_SERVER_UID INT
)
BEGIN
	
    IF _SERVER_UID > 0 THEN
	BEGIN
		DECLARE AUTH_KEY NVARCHAR(16);

		SELECT upper(left(md5(rand()), 16)) INTO AUTH_KEY;

		IF NOT EXISTS(SELECT * FROM pangya.pangya_auth_key WHERE SERVER_UID = _SERVER_UID) THEN
		BEGIN
			-- Make New Line
			INSERT INTO pangya.pangya_auth_key(SERVER_UID, `KEY`, VALID) VALUES(_SERVER_UID, AUTH_KEY, 1);
		END;
		ELSE
		BEGIN
			UPDATE pangya.pangya_auth_key SET `KEY` = AUTH_KEY, valid = 1
			WHERE SERVER_UID = _SERVER_UID;
		END;
        END IF;

		SELECT AUTH_KEY AS NEW_AUTH_SERVER;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetNewCounterItem` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetNewCounterItem`(
	__IDUSER int
)
BEGIN
	
	SELECT active, TypeID, Count_ID, Count_Num_Item FROM pangya.pangya_counter_item WHERE UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetNotice` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetNotice`(
	__ID INT
)
BEGIN
	
	DECLARE __NOTICE_ID INT DEFAULT 0;
	DECLARE __REFRESH_TIME INT DEFAULT 0;

	-- Get Notice
    SET __NOTICE_ID = (SELECT arg1 FROM pangya.pangya_command WHERE /*command_id = 0 AND*/ idx = __ID);
    
    UPDATE pangya_notice_list SET replayCount = replayCount - 1 WHERE notice_id = __NOTICE_ID;
    
    IF (SELECT replayCount FROM pangya_notice_list WHERE notice_id = __NOTICE_ID) <= 0 THEN
		UPDATE pangya_command SET valid = 0 WHERE /*command_id = 0 AND*/ idx = __ID;
	ELSE
	BEGIN
		SET __REFRESH_TIME = (SELECT refreshTime FROM pangya_notice_list WHERE notice_id = __NOTICE_ID);
        
		UPDATE pangya_command SET reserveDate = timestampadd(MINUTE, __REFRESH_TIME, now()) WHERE /*command_id = 0 AND*/ idx = __ID;
    END;
    END IF;
    
	SELECT message FROM pangya_notice_list WHERE notice_id = __NOTICE_ID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetPlayerAsaState` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetPlayerAsaState`(
	__IDUSER int
)
BEGIN
	
	DECLARE __ANGEL int DEFAULT 0; 
	DECLARE __ASA int DEFAULT 0;

      DECLARE __ASA_STATE float(24) DEFAULT 0.0;

      SET __ASA_STATE = 
         (
            SELECT CASE WHEN user_info.Quitado > 0 THEN user_info.Quitado * 1.0 / user_info.Jogado * 100 ELSE 0.0 END as rate
            FROM pangya.user_info
            WHERE user_info.UID = __IDUSER
         );



      IF __ASA_STATE < 3.0 THEN
         BEGIN

            SET __ASA = 
               (

                  SELECT a.EQUIP_TYPE
                  FROM pangya.td_char_equip_s4  AS a, pangya.pangya_user_equip  AS b
                  WHERE 
                     a.UID = __IDUSER AND 
                     a.CHAR_ITEMID = b.character_id AND 
                     a.EQUIP_TYPE IN ( 
                     134309888, 
                     134580224, 
                     134842368, 
                     135120896, 
                     135366656, 
                     135661568, 
                     135858176, 
                     136194048, 
                     136398848, 
                     136660992, 
                     137185294, 
                     137447424, 
                     138004480 )
               );

            IF __ASA <> 0 THEN
               SET __ANGEL = 1;
			END IF;

         END;
         END IF;

      SELECT 
         __ASA_STATE, 
         __ANGEL, 
         a.Sex, 
         b.`level` AS `LEVEL`, 
         b.Jogado AS GAME_COUNT
      FROM pangya.account  AS a, pangya.user_info  AS b
      WHERE a.UID = __IDUSER AND a.UID = b.UID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetPlayerCanWinGachaJPItens` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetPlayerCanWinGachaJPItens`(
	__UID INT
)
BEGIN
	
	IF __UID > 0 THEN
	BEGIN

		DECLARE __GACHA_NUM INT DEFAULT IFNULL((SELECT gacha_num FROM pangya.pangya_gacha_jp_rate), 1);

		SELECT
			a.`index`,
			a.gacha_num,
			a.rarity_type,
			a.typeid_1,
			a.qnty_1,
			(SELECT `name` FROM pangya.pangya_gacha_jp_all_item_list WHERE typeid = a.typeid_1) AS name_1,
			(SELECT char_type FROM pangya.pangya_gacha_jp_all_item_list WHERE typeid = a.typeid_1) AS char_type_1,
			a.typeid_2,
			a.qnty_2,
			(SELECT `name` FROM pangya.pangya_gacha_jp_all_item_list WHERE typeid = a.typeid_2) AS name_2,
			(SELECT char_type FROM pangya.pangya_gacha_jp_all_item_list WHERE typeid = a.typeid_2) AS char_type_2
		FROM
			pangya.pangya_gacha_jp_item_list a
		WHERE
			a.`active` = 1 AND (a.gacha_num = __GACHA_NUM OR a.gacha_num = -1)
			AND (a.rarity_type != 0 OR a.typeid_1 NOT IN(SELECT typeid FROM pangya.pangya_gacha_jp_player_win WHERE UID = __UID AND rarity_type = 0));

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetPlayerGachaSystemInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetPlayerGachaSystemInfo`(
	__UID INT
)
BEGIN
	
	IF __UID > 0 THEN
	BEGIN
		SELECT 
			a.UID,
			a.ID,
			a.NICK AS NICKNAME,
			b.`LEVEL`,
			a.capability,
			a.IDState,
			IFNULL((SELECT c0 FROM pangya.pangya_item_warehouse WHERE UID = a.UID AND valid = 1 AND typeid = 0x1A000080 LIMIT 1), 0) AS TICKET,
			IFNULL((SELECT item_id FROM pangya.pangya_item_warehouse WHERE UID = a.UID AND valid = 1 AND typeid = 0x1A000080 LIMIT 1), -1) AS TICKET_ID,
			IFNULL((SELECT c0 FROM pangya.pangya_item_warehouse WHERE UID = a.UID AND valid = 1 AND typeid = 0x1A000083 LIMIT 1), 0) AS TICKET_SUB,
			IFNULL((SELECT item_id FROM pangya.pangya_item_warehouse WHERE UID = a.UID AND valid = 1 AND typeid = 0x1A000083 LIMIT 1), -1) AS TICKET_SUB_ID
		FROM 
			pangya.account a
			INNER JOIN
			pangya.user_info b
			ON a.UID = b.UID
		WHERE
			a.UID = __UID;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetPlayerGuildAtividade` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetPlayerGuildAtividade`(
	__IDUSER int
)
BEGIN
	
	IF __IDUSER > 0 THEN
	BEGIN
		
		SELECT
			IFNULL(c.GUILD_NAME, 'Unknown') AS GUILD_NAME,
			b.FLAG,
			CAST(b.REG_DATE AS NCHAR(10)) AS REG_DATE
		FROM
			pangya.account a
			INNER JOIN
			pangya.pangya_guild_atividade_player b
			ON a.UID = b.UID
			LEFT OUTER JOIN
			pangya.pangya_guild c
			ON c.Guild_UID = b.GUILD_UID
		WHERE a.UID = __IDUSER
		ORDER BY b.REG_DATE DESC
        LIMIT 8;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetPlayerGuildInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetPlayerGuildInfo`(
	__UID INT
)
BEGIN
	
	IF __UID > 0 THEN
	BEGIN

		SELECT 
			a.UID,
			a.ID,
			a.NICK AS NICKNAME,
			b.`LEVEL`,
			a.capability,
			a.IDState,
			IFNULL(d.Guild_UID, 0) AS GUILD_UID,
			IFNULL(c.MEMBER_STATE_FLAG, -1) AS MEMBER_STATE_FLAG
		FROM 
			pangya.account a
			INNER JOIN
			pangya.user_info b
			ON a.UID = b.UID
			LEFT OUTER JOIN
			pangya.pangya_guild_member c
			ON a.Guild_UID = c.GUILD_UID AND a.UID = c.MEMBER_UID
			LEFT OUTER JOIN
			pangya.pangya_guild d
			ON d.GUILD_UID = a.Guild_UID AND (d.GUILD_STATE NOT IN(4, 5) OR d.GUILD_CLOSURE_DATE IS NULL OR now() < d.GUILD_CLOSURE_DATE)
		WHERE
			a.UID = __UID;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetPlayerInfoGame` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetPlayerInfoGame`(
	__IDUSER int
)
BEGIN
	
	SELECT a.uid, a.id, a.nick, a.`password`, a.capability, b.`level`, a.IDState, IFNULL(TIMESTAMPDIFF(SECOND, now(), TIMESTAMPADD(MINUTE, a.BlockTime, a.BlockRegDate)), -1 ) as BlockTime
	FROM pangya.account a, pangya.user_info b WHERE a.uid = b.uid AND a.uid = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetPlayerInfoLogin` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetPlayerInfoLogin`(
	_IDUSER INT
)
BEGIN
	
    SELECT a.uid, a.id, a.nick, a.`password`, a.capability, b.`level`, a.IDState, IFNULL(TIMESTAMPDIFF(SECOND, now(), TIMESTAMPADD(MINUTE, a.BlockTime, a.BlockRegDate)), -1 ) as BlockTime 
	FROM pangya.account a, pangya.user_info b 
	WHERE a.uid = b.uid AND a.uid = _IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetPlayerInfoMessage` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetPlayerInfoMessage`(
	__UID BIGINT
)
BEGIN
	
    SELECT 
		a.UID,
		a.id,
		a.nick,
		a.capability,
		IFNULL(c.guild_uid, 0) as guild_uid,
		IFNULL(c.GUILD_NAME, '') as guild_name,
		a.sex,
		b.`level`,
		a.game_server_id,
		a.IDState,
		IFNULL(TIMESTAMPDIFF(SECOND, now(), TIMESTAMPADD(MINUTE, a.BlockTime, a.BlockRegDate)), -1 ) as BlockTime
	FROM
		pangya.account a
		INNER JOIN
		pangya.user_info b
		ON a.UID = b.UID
		LEFT OUTER JOIN
		(
			SELECT
				a.GUILD_UID,
				a.GUILD_NAME,
				b.MEMBER_UID
			FROM
				pangya.pangya_guild a
				INNER JOIN
				pangya.pangya_guild_member b
				ON a.GUILD_UID = b.GUILD_UID
			WHERE
				b.MEMBER_STATE_FLAG < 9
				AND (a.GUILD_STATE NOT IN(4, 5) OR a.GUILD_CLOSURE_DATE IS NULL OR now() < a.GUILD_CLOSURE_DATE)
		) c
		ON c.GUILD_UID = a.GUILD_UID AND c.MEMBER_UID = a.UID
	WHERE a.UID = __UID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetPlayerInfoRank` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetPlayerInfoRank`(
	__UID BIGINT
)
BEGIN
	
	SELECT a.uid, a.id, a.nick, a.capability, a.game_server_id, b.`level`, a.IDState, IFNULL(TIMESTAMPDIFF(SECOND, now(), TIMESTAMPADD(MINUTE, a.BlockTime, a.BlockRegDate)), -1 ) as BlockTime
	FROM pangya.account a, pangya.user_info b WHERE a.uid = b.uid AND a.uid = __UID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetPlayerLoginDados` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetPlayerLoginDados`(
	__IDUSER int
)
BEGIN
	
	SELECT 
         a.cap, 
         a.NICK, 
         a.IDState, 
         a.BlockTime, 
         b.`level`, 
         IFNULL(c.ip, '') AS ip
      FROM 
         (
               SELECT uid, account.capability AS cap, account.NICK, account.IDState, IFNULL(UNIX_TIMESTAMP(TIMESTAMPADD(MINUTE, BlockTime, BlockRegDate)), -1) AS BlockTime
               FROM pangya.account
               WHERE account.UID = __IDUSER
            )  AS a 
			INNER JOIN
            (
               SELECT uid, user_info.`level`
               FROM pangya.user_info
               WHERE user_info.`UID` = __IDUSER
            )  AS b
			ON a.uid = b.uid 
            LEFT OUTER JOIN 
            (
               SELECT pangya_player_ip.uid, pangya_player_ip.ip
               FROM pangya.pangya_player_ip
               WHERE pangya_player_ip.uid = __IDUSER
            )  AS c 
            ON c.uid = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetPlayerLuciaAttendanceInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetPlayerLuciaAttendanceInfo`(
	__UID INT
)
BEGIN
	
	IF __UID > 0 THEN
	BEGIN
		
		-- Verifica se o player já está cadastrado no sistema da lucia attendance, 
		-- se não tiver cria o cadastro ele liberado o ultimo dia
		IF (SELECT UID FROM pangya.pangya_lucia_attendance WHERE UID = __UID) IS NULL THEN
			INSERT INTO pangya.pangya_lucia_attendance(UID, count_day) VALUES(__UID, 6);
		END IF;

		SELECT
			a.UID,
			a.ID,
			a.NICK as NICKNAME,
			a.IDState,
			b.count_day,
			b.last_day_attendance,
			b.last_day_get_item,
			b.try_hacking_count,
			b.block_type,
			b.block_end_date
		FROM
			pangya.account a
			INNER JOIN
			pangya.pangya_lucia_attendance b
			ON a.UID = b.UID
		WHERE a.UID = __UID;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetPlayerMotionItem` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetPlayerMotionItem`(
	__IDUSER int
)
BEGIN
	
	DECLARE __MOTION_ITEM int DEFAULT 0;

      SET __MOTION_ITEM = 
         (

            SELECT a.EQUIP_TYPE
            FROM pangya.td_char_equip_s4  AS a, pangya.pangya_user_equip  AS b
            WHERE 
               a.UID = __IDUSER AND 
               a.CHAR_ITEMID = b.character_id AND 
               a.EQUIP_TYPE IN ( 
               134375424, 
               134375425, 
               134375426, 
               134629376, 
               134629377, 
               134629378, 
               134629379, 
               134883328, 
               134883329, 
               134883330, 
               135153664, 
               135153665, 
               135153666, 
               135407616, 
               135407617, 
               135407618, 
               135718913, 
               135718914, 
               135718915, 
               135718917, 
               135940096, 
               135940097, 
               136226816, 
               136480768, 
               136480769, 
               136480770, 
               136480771, 
               136742912, 
               136996864, 
               137250816, 
               137250817, 
               137496576, 
               137496577, 
               137496578, 
               138037248, 
               138037249, 
               138037250 )
         );

      SET __MOTION_ITEM = 
         CASE 
            WHEN __MOTION_ITEM IS NULL THEN 0
            ELSE 1
         END;

      SELECT __MOTION_ITEM;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetPremiumTicket` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetPremiumTicket`(
	__IDUSER int
)
BEGIN
	
	SELECT item_id, typeid, UNIX_TIMESTAMP(ENDDATE) as unix_end_date, timestampdiff(SECOND, CURRENT_TIMESTAMP, ENDDATE) as unix_sec_date FROM pangya.pangya_item_warehouse
					WHERE (typeid = 0x1A100002 OR typeid = 0x1A100003) AND valid = 1 AND APPLYTIME != ENDDATE AND uid = __IDUSER LIMIT 1;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetQuestsClear` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetQuestsClear`(
	__IDUSER int
)
BEGIN
	
	SELECT a.TypeID AS achievement_typeid, b.TypeID_ACHIEVE AS quest_typeid
      FROM pangya.achievement_tipo  AS a, pangya.achievement_quest  AS b
      WHERE 
         a.UID = b.UID AND 
         a.ID_ACHIEVEMENT = b.ID_ACHIEVEMENT AND 
         b.IDX IN 
         (
            SELECT pangya_quest_clear.quest_id
            FROM pangya.pangya_quest_clear
            WHERE pangya_quest_clear.uid = __IDUSER AND pangya_quest_clear.`option` = 1
         );
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetRankRegistryCharacterInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetRankRegistryCharacterInfo`(
)
BEGIN
	
	SELECT
		b.UID,
		a.ID,
		a.NICK,
		IFNULL((SELECT valor FROM pangya.pangya_rank_atual WHERE tipo_rank = 2 AND tipo_rank_seq = 3 AND UID = a.UID LIMIT 1), 0) AS `level`,
		b.item_id, 
        b.typeid, 
        b.ITEMID_PARTS_1, 
        b.ITEMID_PARTS_2, 
        b.ITEMID_PARTS_3, 
        b.ITEMID_PARTS_4, 
        b.ITEMID_PARTS_5, 
        b.ITEMID_PARTS_6, 
        b.ITEMID_PARTS_7, 
        b.ITEMID_PARTS_8, 
        b.ITEMID_PARTS_9, 
        b.ITEMID_PARTS_10, 
        b.ITEMID_PARTS_11, 
        b.ITEMID_PARTS_12, 
        b.ITEMID_PARTS_13, 
        b.ITEMID_PARTS_14, 
        b.ITEMID_PARTS_15, 
        b.ITEMID_PARTS_16, 
        b.ITEMID_PARTS_17, 
        b.ITEMID_PARTS_18, 
        b.ITEMID_PARTS_19, 
        b.ITEMID_PARTS_20, 
        b.ITEMID_PARTS_21, 
        b.ITEMID_PARTS_22, 
        b.ITEMID_PARTS_23, 
        b.ITEMID_PARTS_24, 
        b.parts_1, 
        b.parts_2, 
        b.parts_3, 
        b.parts_4, 
        b.parts_5, 
        b.parts_6, 
        b.parts_7, 
        b.parts_8, 
        b.parts_9, 
        b.parts_10, 
        b.parts_11, 
        b.parts_12, 
        b.parts_13, 
        b.parts_14, 
        b.parts_15, 
        b.parts_16, 
        b.parts_17, 
        b.parts_18, 
        b.parts_19, 
        b.parts_20, 
        b.parts_21, 
        b.parts_22, 
        b.parts_23, 
        b.parts_24, 
        b.default_hair, 
        b.default_shirts, 
        b.gift_flag, 
        b.PCL0, 
        b.PCL1, 
        b.PCL2, 
        b.PCL3, 
        b.PCL4, 
        b.Purchase, 
        b.auxparts_1, 
        b.auxparts_2, 
        b.auxparts_3, 
        b.auxparts_4, 
        b.auxparts_5, 
        b.CutIn_1, 
        b.CutIn_2, 
        b.CutIn_3, 
        b.CutIn_4, 
        b.Mastery, 
        b.CARD_CHARACTER_1, 
        b.CARD_CHARACTER_2, 
        b.CARD_CHARACTER_3, 
        b.CARD_CHARACTER_4, 
        b.CARD_CADDIE_1, 
        b.CARD_CADDIE_2, 
        b.CARD_CADDIE_3, 
        b.CARD_CADDIE_4, 
        b.CARD_NPC_1, 
        b.CARD_NPC_2, 
        b.CARD_NPC_3, 
        b.CARD_NPC_4
	FROM
		pangya.account a
		INNER JOIN
		pangya.pangya_rank_atual_character b
		ON a.UID = b.UID
	ORDER BY a.UID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetRankRegistryInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetRankRegistryInfo`(
)
BEGIN
	
	SELECT
		a.UID,
		a.position AS CURRENT_POSITION,
		IFNULL((SELECT position FROM pangya.pangya_rank_antes WHERE tipo_rank = a.tipo_rank AND tipo_rank_seq = a.tipo_rank_seq AND UID = a.UID LIMIT 1), 0) as LAST_POSITION,
		a.valor,
		a.tipo_rank,
		a.tipo_rank_seq
	FROM
		pangya.pangya_rank_atual a
	ORDER BY a.tipo_rank, a.tipo_rank_seq;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetRateConfigInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetRateConfigInfo`(
	_SERVER_UID INT
)
BEGIN
	
	IF _SERVER_UID > 0 AND (SELECT UID FROM pangya.pangya_config WHERE UID = _SERVER_UID) IS NOT NULL THEN
	BEGIN
		SELECT	GrandZodiacEventTime,
				ScratchyPorPointRate,
				PapelShopRareItemRate,
				PapelShopCookieItemRate,
				TreasureRate,
				PangRate,
				ExpRate,
				ClubMasteryRate,
				ChuvaRate,
				MemorialShopRate,
				AngelEvent,
				GrandPrixEvent,
				GoldenTimeEvent,
				LoginRewardEvent,
				BotGMEvent,
				SmartCalculator
		FROM pangya.pangya_config WHERE UID = _SERVER_UID;
	END;
	ELSE
		SELECT	-1 AS ERROR,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0,
				0;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetRecordPlayerCourse` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetRecordPlayerCourse`(
	__IDUSER int,
	__mapa_in int,
	__tipo_in int
)
BEGIN
	
	IF 
         (
            SELECT pangya_record.course
            FROM pangya.pangya_record
            WHERE 
               pangya_record.UID = __IDUSER AND 
               pangya_record.course = __mapa_in AND 
               pangya_record.tipo = __tipo_in
         ) IS NOT NULL THEN
         SELECT 
            pangya_record.tipo, 
            pangya_record.course, 
            pangya_record.tacada, 
            pangya_record.putt, 
            pangya_record.hole, 
            pangya_record.fairway, 
            pangya_record.holein, 
            pangya_record.puttin, 
            pangya_record.total_score, 
            pangya_record.best_score, 
            pangya_record.best_pang, 
            pangya_record.character_typeid, 
            pangya_record.event_score
         FROM pangya.pangya_record
         WHERE 
            pangya_record.UID = __IDUSER AND 
            pangya_record.course = __mapa_in AND 
            pangya_record.tipo = __tipo_in;
      ELSE 
         SELECT 
            0 AS tipo, 
            0 AS course, 
            0 AS tacada, 
            0 AS putt, 
            0 AS hole, 
            0 AS fairway, 
            0 AS holein, 
            0 AS puttin, 
            0 AS total_score, 
            127 AS best_score, 
            0 AS best_pang, 
            0 AS character_typeid, 
            0 AS event_score;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetRoom` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetRoom`(
	__IDUSER int
)
BEGIN
	
	SELECT 
         td_room_data.MYROOM_ID, 
         td_room_data.UID, 
         td_room_data.TYPEID, 
         td_room_data.ROOM_NO, 
         td_room_data.POS_X, 
         td_room_data.POS_Y, 
         td_room_data.POS_Z, 
         td_room_data.POS_R, 
         (CASE 
            WHEN td_room_data.DISPLAY_YN = 'Y' THEN 1
            ELSE 0
         END) AS USE_YN
      FROM pangya.td_room_data
      WHERE td_room_data.UID = __IDUSER AND valid = 1;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetServerList` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetServerList`(
	OPT int
)
BEGIN
	
    IF OPT = 0 THEN -- Game Server
	BEGIN

		SELECT 
			pangya_server_list.Name, 
			pangya_server_list.UID, 
			pangya_server_list.IP, 
			pangya_server_list.Port, 
			pangya_server_list.MaxUser, 
			pangya_server_list.CurrUser, 
			pangya_server_list.property, 
			pangya_server_list.AngelicWingsNum, 
			pangya_server_list.EventFlag, 
			pangya_server_list.EventMap, 
			pangya_server_list.ImgNo, 
			pangya_server_list.AppRate, 
			pangya_server_list.ScratchRate
		FROM pangya.pangya_server_list
		WHERE 
		pangya_server_list.Type = 1 AND 
		pangya_server_list.UpdateTime > timestampadd(second, -8, now()) AND 
		pangya_server_list.State = 1;

	END;
	ELSEIF OPT = 1 THEN -- Message Server
	BEGIN

		SELECT 
			pangya_server_list.Name, 
			pangya_server_list.UID, 
			pangya_server_list.IP, 
			pangya_server_list.Port, 
			pangya_server_list.MaxUser, 
			pangya_server_list.CurrUser, 
			pangya_server_list.property, 
			pangya_server_list.AngelicWingsNum, 
			pangya_server_list.EventFlag, 
			pangya_server_list.EventMap, 
			pangya_server_list.ImgNo, 
			pangya_server_list.AppRate, 
			pangya_server_list.ScratchRate
		FROM pangya.pangya_server_list
		WHERE 
			pangya_server_list.Type = 3 AND 
			pangya_server_list.UpdateTime > timestampadd(second, -8, now()) AND 
			pangya_server_list.State = 1;
	END;
	ELSEIF OPT = 2 THEN -- Login Server 
	BEGIN

		SELECT 
			pangya_server_list.Name, 
			pangya_server_list.UID, 
			pangya_server_list.IP, 
			pangya_server_list.Port, 
			pangya_server_list.MaxUser, 
			pangya_server_list.CurrUser, 
			pangya_server_list.property, 
			pangya_server_list.AngelicWingsNum, 
			pangya_server_list.EventFlag, 
			pangya_server_list.EventMap, 
			pangya_server_list.ImgNo, 
			pangya_server_list.AppRate, 
			pangya_server_list.ScratchRate
		FROM pangya.pangya_server_list
		WHERE 
			pangya_server_list.Type = 0 AND 
			pangya_server_list.UpdateTime > timestampadd(second, -11, now()) AND 
			pangya_server_list.State = 1;
	END;
	ELSEIF OPT = 3 THEN -- Rank Server
	BEGIN
		
		SELECT 
			pangya_server_list.Name, 
			pangya_server_list.UID, 
			pangya_server_list.IP, 
			pangya_server_list.Port, 
			pangya_server_list.MaxUser, 
			pangya_server_list.CurrUser, 
			pangya_server_list.property, 
			pangya_server_list.AngelicWingsNum, 
			pangya_server_list.EventFlag, 
			pangya_server_list.EventMap, 
			pangya_server_list.ImgNo, 
			pangya_server_list.AppRate, 
			pangya_server_list.ScratchRate
		FROM pangya.pangya_server_list
		WHERE 
			pangya_server_list.Type = 4 AND 
			pangya_server_list.UpdateTime > timestampadd(second, -11, now()) AND 
			pangya_server_list.State = 1;
	END;
	ELSEIF OPT = 4 THEN -- Auth Server
	BEGIN

		SELECT 
			pangya_server_list.Name, 
			pangya_server_list.UID, 
			pangya_server_list.IP, 
			pangya_server_list.Port, 
			pangya_server_list.MaxUser, 
			pangya_server_list.CurrUser, 
			pangya_server_list.property, 
			pangya_server_list.AngelicWingsNum, 
			pangya_server_list.EventFlag, 
			pangya_server_list.EventMap, 
			pangya_server_list.ImgNo, 
			pangya_server_list.AppRate, 
			pangya_server_list.ScratchRate
		FROM pangya.pangya_server_list
		WHERE 
			pangya_server_list.Type = 5 AND 
			pangya_server_list.UpdateTime > timestampadd(second, -11, now()) AND 
			pangya_server_list.State = 1;
	END;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetShutdownServer` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetShutdownServer`(
	__ID INT
)
BEGIN
	
	-- Get Shutdown Server
	DECLARE __SHUTDOWN_ID INT DEFAULT 0;
	DECLARE __REFRESH_TIME INT DEFAULT 0;

    SET __SHUTDOWN_ID = (SELECT arg1 FROM pangya_command WHERE command_id = 3 AND idx = __ID);
    
    UPDATE pangya_shutdown_list SET replayCount = replayCount - 1 WHERE id = __SHUTDOWN_ID;
    
    IF (SELECT replayCount FROM pangya_shutdown_list WHERE id = __SHUTDOWN_ID) <= 0 THEN
		UPDATE pangya_command SET valid = 0 WHERE command_id = 3 AND idx = __ID;
	ELSE
	BEGIN
		SET __REFRESH_TIME = (SELECT refreshTime FROM pangya_shutdown_list WHERE id = __SHUTDOWN_ID);
        
		UPDATE pangya_command SET reserveDate = timestampadd(MINUTE, __REFRESH_TIME, now()) WHERE command_id = 3 AND idx = __ID;
    END;
    END IF;
    
	SELECT 
        timestampdiff(SECOND, now(), date_shutdown) as sec
    FROM pangya_shutdown_list WHERE id = __SHUTDOWN_ID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetTempUpLevelClubSet` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetTempUpLevelClubSet`(
	__IDUSER int
)
BEGIN
	
	SELECT pangya_last_up_clubset.item_id, pangya_last_up_clubset.State, pangya_last_up_clubset.item_usado AS ITEM_TYPEID_USADO, pangya_last_up_clubset.Quantidade
      FROM pangya.pangya_last_up_clubset
      WHERE pangya_last_up_clubset.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetTicker` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetTicker`(
	__ID INT
)
BEGIN
	
	DECLARE __TICKER_ID INT DEFAULT 0;
	DECLARE __REFRESH_TIME INT DEFAULT 0;

	-- #Pega o Ticker do pangya_command e pangya_ticker_list
    SET __TICKER_ID = (SELECT arg1 FROM pangya_command WHERE command_id = 1 AND idx = __ID);
    
    UPDATE pangya_ticker_list SET replayCount = replayCount - 1 WHERE ticker_id = __TICKER_ID;
    
    IF (SELECT replayCount FROM pangya_ticker_list WHERE ticker_id = __TICKER_ID) <= 0 THEN
		UPDATE pangya_command SET valid = 0 WHERE command_id = 1 AND idx = __ID;
	ELSE
	BEGIN
		SET __REFRESH_TIME = (SELECT refreshTime FROM pangya_ticker_list WHERE ticker_id = __TICKER_ID);
        
		UPDATE pangya_command SET reserveDate = TIMESTAMPADD(MINUTE, __REFRESH_TIME, now()) WHERE command_id = 1 AND idx = __ID;
    END;
    END IF;
	
	SELECT message, nick  FROM pangya_ticker_list WHERE ticker_id = __TICKER_ID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetTicketReportDados` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetTicketReportDados`(
	__ticket_report_id int
)
BEGIN
	
	IF __ticket_report_id > 0 THEN
	BEGIN

		SELECT 
			A.idx,
			A.tipo, 
			A.trofel_typeid,
			A.reg_date,
			B.player_uid, 
			B.player_score, 
			B.player_medalha, 
			B.player_trofel, 
			B.player_pang, 
			B.player_bonus_pang, 
			B.player_exp, 
			B.player_mascot_typeid, 
			B.player_state, 
			B.flag_item_pang, 
			B.flag_premium_user, 
			D.`level`, 
			C.ID, 
			C.NICK, 
			C.Guild_UID, 
			IFNULL(E.GUILD_MARK_IMG, 'guild_mark') as GUILD_MARK_IMG,
			IFNULL(E.GUILD_MARK_IMG_IDX, 0) AS GUILD_MARK_IMG_IDX,
			B.finish_date
		FROM 
			pangya.pangya_ticket_report A
			INNER JOIN 
			pangya.pangya_ticket_report_dados B
			ON A.idx = B.report_id
			INNER JOIN
			pangya.account C
			ON B.player_uid = C.UID
			INNER JOIN
			pangya.user_info D
			ON C.UID = D.UID
			LEFT OUTER JOIN
			pangya.pangya_guild E
			ON C.Guild_UID = E.GUILD_UID
		WHERE 
			A.idx = __ticket_report_id;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetTikiPoints` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetTikiPoints`(
	__IDUSER int
)
BEGIN
	
	DECLARE __TIKI_PTS int;

      SELECT pangya_tiki_points.Tiki_Points INTO __TIKI_PTS
      FROM pangya.pangya_tiki_points
      WHERE pangya_tiki_points.UID = __IDUSER;

      IF __TIKI_PTS IS NULL THEN
         BEGIN

            INSERT pangya.pangya_tiki_points(pangya.pangya_tiki_points.UID, pangya.pangya_tiki_points.Tiki_Points, pangya.pangya_tiki_points.REG_DATE, pangya.pangya_tiki_points.MOD_DATE)
               VALUES (__IDUSER, 0, ifnull(now(), now()), ifnull(now(), now()));

            SELECT pangya_tiki_points.Tiki_Points AS TIKI_POINTS
            FROM pangya.pangya_tiki_points
            WHERE pangya_tiki_points.UID = __IDUSER;

         END;
      ELSE 
         SELECT __TIKI_PTS AS TIKI_POINTS;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetTrofel` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetTrofel`(
	__IDUSER int,
	__OPT_IN int
)
BEGIN
	
	IF __OPT_IN = 5 THEN
         SELECT 
            trofel_stat.AMA_6_G, 
            trofel_stat.AMA_6_S, 
            trofel_stat.AMA_6_B, 
            trofel_stat.AMA_5_G, 
            trofel_stat.AMA_5_S, 
            trofel_stat.AMA_5_B, 
            trofel_stat.AMA_4_G, 
            trofel_stat.AMA_4_S, 
            trofel_stat.AMA_4_B, 
            trofel_stat.AMA_3_G, 
            trofel_stat.AMA_3_S, 
            trofel_stat.AMA_3_B, 
            trofel_stat.AMA_2_G, 
            trofel_stat.AMA_2_S, 
            trofel_stat.AMA_2_B, 
            trofel_stat.AMA_1_G, 
            trofel_stat.AMA_1_S, 
            trofel_stat.AMA_1_B, 
            trofel_stat.PRO_1_G, 
            trofel_stat.PRO_1_S, 
            trofel_stat.PRO_1_B, 
            trofel_stat.PRO_2_G, 
            trofel_stat.PRO_2_S, 
            trofel_stat.PRO_2_B, 
            trofel_stat.PRO_3_G, 
            trofel_stat.PRO_3_S, 
            trofel_stat.PRO_3_B, 
            trofel_stat.PRO_4_G, 
            trofel_stat.PRO_4_S, 
            trofel_stat.PRO_4_B, 
            trofel_stat.PRO_5_G, 
            trofel_stat.PRO_5_S, 
            trofel_stat.PRO_5_B, 
            trofel_stat.PRO_6_G, 
            trofel_stat.PRO_6_S, 
            trofel_stat.PRO_6_B, 
            trofel_stat.PRO_7_G, 
            trofel_stat.PRO_7_S, 
            trofel_stat.PRO_7_B
         FROM pangya.trofel_stat
         WHERE trofel_stat.UID = __IDUSER;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetTrofelGrandPrix` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetTrofelGrandPrix`(
	__IDUSER int,
	__OPT_IN int
)
BEGIN
	
	IF __OPT_IN = 5 THEN
         SELECT pangya_trofel_grandprix.item_id, pangya_trofel_grandprix.typeid, pangya_trofel_grandprix.qntd
         FROM pangya.pangya_trofel_grandprix
         WHERE pangya_trofel_grandprix.UID = __IDUSER
            ORDER BY pangya_trofel_grandprix.typeid;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetTrofelGrandPrixInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetTrofelGrandPrixInfo`(
	__IDUSER int,
	__OPT_IN int
)
BEGIN
	
	IF __OPT_IN = 5 THEN
         SELECT pangya_trofel_grandprix.item_id, pangya_trofel_grandprix.typeid, pangya_trofel_grandprix.qntd
         FROM pangya.pangya_trofel_grandprix
         WHERE pangya_trofel_grandprix.UID = __IDUSER
            ORDER BY pangya_trofel_grandprix.typeid DESC;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetTrofelSpecial` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetTrofelSpecial`(
	__IDUSER int,
	__OPT_IN int
)
BEGIN
	
	IF __OPT_IN = 5 THEN
         SELECT pangya_trofel_especial.item_id, pangya_trofel_especial.typeid, pangya_trofel_especial.qntd
         FROM pangya.pangya_trofel_especial
         WHERE pangya_trofel_especial.UID = __IDUSER
            ORDER BY pangya_trofel_especial.typeid;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetTrofelSpecialInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetTrofelSpecialInfo`(
	__IDUSER int,
	__OPT_IN int
)
BEGIN
	
	IF __OPT_IN = 5 THEN
         SELECT pangya_trofel_especial.item_id, pangya_trofel_especial.typeid, pangya_trofel_especial.qntd
         FROM pangya.pangya_trofel_especial
         WHERE pangya_trofel_especial.UID = __IDUSER
            ORDER BY pangya_trofel_especial.typeid DESC;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetUserInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetUserInfo`(
	__IDUSER int
)
BEGIN
	
	IF __IDUSER > 0 THEN
	BEGIN

		SELECT 
			A.ID, 
			A.UID, 
			A.Sex, 
			A.doTutorial, 
			A.NICK, 
			A.School, 
			A.capability, 
			A.Logon, 
			A.ServerID, 
			A.MannerFlag, 
			(CASE WHEN A.LastLeaveTime IS NULL THEN 0 ELSE timestampdiff(minute, A.LastLeaveTime, now()) END) AS TIMEVAL, 
			IFNULL(C.GUILD_NAME, N'') AS GUILD_NAME,
			IFNULL(C.GUILD_UID, 0) AS GUILD_UID,
			IFNULL(C.GUILD_PANG, 0) AS GUILD_PANG, 
			IFNULL(C.GUILD_POINT, 0) AS GUILD_POINT,
			IFNULL(C.GUILD_MARK_IMG_IDX, 0) AS GUILD_MARK_IMG_IDX, 
			A.`Event`, 
			A.Event2, 
			D.limit_cnt, 
			A.IDState, 
			(CASE WHEN A.domainid IS NULL THEN 0 ELSE A.domainid END) AS DOMAINID, 
			A.ChannelFlag, 
			D.current_cnt, 
			D.remain_cnt, 
			D.last_update,
			B.`level`,
			IF(C.GUILD_MARK_IMG IS NULL OR C.MEMBER_STATE_FLAG > 3, N'', C.GUILD_MARK_IMG) AS GUILD_MARK_IMG,
			0 AS EMBLERVER
		FROM 
			pangya.account AS A 
		INNER JOIN
			pangya.pangya_papel_shop_info AS D
		ON A.UID = D.UID
		INNER JOIN
			pangya.user_info AS B 
		ON D.UID = B.UID
		INNER JOIN 
		(
			SELECT 
				E.GUILD_MARK_IMG_IDX,
				E.GUILD_MARK_IMG, 
				E.GUILD_UID, 
				E.GUILD_NAME, 
				E.MEMBER_STATE_FLAG, 
				E.GUILD_PANG, 
				E.GUILD_POINT, 
				D.UID
			FROM 
			pangya.account D 
			LEFT OUTER JOIN 
			(
				SELECT 
				x.GUILD_MARK_IMG_IDX,
				x.GUILD_MARK_IMG, 
				x.GUILD_UID, 
				x.GUILD_NAME, 
				y.MEMBER_STATE_FLAG, 
				y.GUILD_PANG, 
				y.GUILD_POINT
				FROM 
					pangya.pangya_guild AS x, 
					pangya.pangya_guild_member AS y
				WHERE 
					y.MEMBER_UID = __IDUSER
					AND y.MEMBER_STATE_FLAG < 9
					AND (x.GUILD_STATE NOT IN(4, 5) OR x.GUILD_CLOSURE_DATE IS NULL OR now() < x.GUILD_CLOSURE_DATE)
			) AS E 
			ON D.Guild_UID = E.GUILD_UID
		) AS C 
		ON C.UID = __IDUSER
		WHERE 
			A.UID = __IDUSER;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetWareHouseItem` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetWareHouseItem`(
	__IDUSER int
)
BEGIN
	
	SELECT A.item_id, A.UID, A.typeid, A.Ano, A.C0, A.C1, A.C2, A.C3, A.C4, A.Purchase, A.Gift_flag, A.Flag, A.APPLY_DATE, A.END_DATE
         				,A.ItemType, B.CARD_CHARACTER_1, B.CARD_CHARACTER_2, B.CARD_CHARACTER_3, B.CARD_CHARACTER_4, B.CARD_CADDIE_1
         				,B.CARD_CADDIE_2, B.CARD_CADDIE_3, B.CARD_CADDIE_4, B.CARD_NPC_1, B.CARD_NPC_2, B.CARD_NPC_3, B.CARD_NPC_4
         				,A.ClubSet_WorkShop_Flag
         				,A.ClubSet_WorkShop_C0
         				,A.ClubSet_WorkShop_C1
         				,A.ClubSet_WorkShop_C2
         				,A.ClubSet_WorkShop_C3
         				,A.ClubSet_WorkShop_C4
         				,A.Mastery_Pts
         				,A.Recovery_Pts
         				,A.`Level`
         				,A.Up
         				,A.SD_NAME 
         				,A.SD_IDX
         				,A.SD_SEQ
         				,A.SD_COPIER_NICK
         				,A.SD_COPIER
         				,A.SD_TRADE
         				,A.SD_FLAG
         				,A.SD_STATUS
         	FROM
         		(
         			SELECT R.*,  CASE WHEN L.UCC_NAME IS NULL THEN '' ELSE L.UCC_NAME END AS SD_NAME
         						     , CASE WHEN L.UCCIDX IS NULL THEN '' ELSE L.UCCIDX END AS SD_IDX
         						     , CASE WHEN L.SEQ IS NULL THEN 0 ELSE L.SEQ END AS SD_SEQ
         						     , CASE WHEN L.COPIER_NICK IS NULL THEN '' ELSE L.COPIER_NICK END AS SD_COPIER_NICK
         						     , CASE WHEN L.COPIER IS NULL THEN 0 ELSE L.COPIER END AS SD_COPIER
         						     , CASE WHEN L.TRADE IS NULL THEN 0 ELSE L.TRADE END AS SD_TRADE
         						     , CASE WHEN L.FLAG IS NULL THEN 0 ELSE L.FLAG END AS SD_FLAG
         						     , CASE WHEN L.STATUS IS NULL THEN 0 ELSE L.STATUS END AS SD_STATUS
         			FROM 
         			(
         				SELECT d.item_id
         				,d.UID
         				,d.typeid
         				, (CASE WHEN timestampdiff(MINUTE, (CASE WHEN d.EndDate = d.Applytime THEN d.Applytime ELSE CURRENT_TIMESTAMP END), d.EndDate) > 0 THEN timestampdiff(HOUR, CURRENT_TIMESTAMP, d.ENDDATE) ELSE -1 END) AS Ano
         				,/*ISNULL(E.c0,*/ D.c0 -- ) AS C0
         				,/*ISNULL(E.c1,*/ D.c1 -- ) AS C1
         				,/*ISNULL(E.c2,*/ D.c2 -- ) AS C2
         				,/*ISNULL(E.c3,*/ D.c3 -- ) AS C3
         				,/*ISNULL(E.c4,*/ D.c4 -- ) AS C4
         				,(CASE WHEN timestampdiff(MINUTE, d.applytime, d.ENDDATE) > 0 THEN UNIX_TIMESTAMP(d.applytime) ELSE 0 END) AS APPLY_DATE
         				,(CASE WHEN timestampdiff(MINUTE, d.applytime, d.ENDDATE) > 0 THEN UNIX_TIMESTAMP(d.ENDDATE) ELSE 0 END) AS END_DATE -- DATEDIFF(CURRENT_TIMESTAMP, regdate) as Date_Diff
         				,d.Gift_flag
         				,(CASE WHEN d.ENDDATE <= CURRENT_TIMESTAMP AND d.ApplyTime != d.ENDDATE THEN d.flag + 2 ELSE d.flag END) AS flag
         				,d.Purchase
         				,d.ItemType
         				,d.ClubSet_WorkShop_Flag
         				,d.ClubSet_WorkShop_C0
         				,d.ClubSet_WorkShop_C1
         				,d.ClubSet_WorkShop_C2
         				,d.ClubSet_WorkShop_C3
         				,d.ClubSet_WorkShop_C4
         				,d.Mastery_Pts
         				,d.Recovery_Pts
         				,d.`Level`
         				,d.Up
         				FROM 
         				(
         					SELECT * FROM pangya_item_warehouse 
         					WHERE UID = __IDUSER AND valid = 1 AND Gift_Flag = 0
         					AND (flag = 96 OR applytime = enddate OR typeid = 0x1A000042/*TICKET REPORT*/ OR enddate > CURRENT_TIMESTAMP)
         				)D
         				-- LEFT OUTER JOIN
         				-- (
         				-- SELECT * FROM pangya_clubset_enchant
         				-- WHERE UID = __IDUSER
         				-- )E
         				-- ON D.item_id = E.item_id
         			)R
         			INNER JOIN
         			(
         				SELECT  F.*,  G.UCC_NAME, G.UCCIDX, G.SEQ, G.COPIER, G.COPIER_NICK, G.TRADE, G.FLAG, G.STATUS
         				FROM 
         				(
         					SELECT item_id
         					FROM pangya_item_warehouse WHERE UID = __IDUSER AND valid = 1 AND Gift_Flag = 0
         				)F
         				LEFT OUTER JOIN
         				(
         					SELECT UCC_NAME, ITEM_ID, UCCIDX, SEQ, COPIER, COPIER_NICK, TRADE, Flag, STATUS
         					FROM TU_UCC
         				)G
         				ON F.item_id = G.item_id
         				-- GROUP BY F.item_id
         			)L
         			ON R.item_id = L.item_id
         			-- GROUP BY R.item_id
         		)A
         		INNER JOIN
         		(
         			SELECT 	item_id
         					, 0 AS CARD_CHARACTER_1
         					, 0 AS CARD_CHARACTER_2
         					, 0 AS CARD_CHARACTER_3
         					, 0 AS CARD_CHARACTER_4
         					, 0 AS CARD_CADDIE_1
         					, 0 AS CARD_CADDIE_2
         					, 0 AS CARD_CADDIE_3
         					, 0 AS CARD_CADDIE_4
         					, 0 AS CARD_NPC_1
         					, 0 AS CARD_NPC_2
         					, 0 AS CARD_NPC_3
         					, 0 AS CARD_NPC_4
         			FROM
         			(
         				SELECT item_id
         				FROM pangya_item_warehouse
         				WHERE UID = __IDUSER AND valid = 1 AND Gift_Flag = 0
         			)X
         			LEFT OUTER JOIN
         			(
         				SELECT TIPO, Slot, card_typeid, parts_id
         				FROM pangya_card_equip
         				WHERE UID = __IDUSER AND USE_YN = 1
         			)Y
         			ON Y.parts_id = X.item_id
         			GROUP BY item_id
         		) AS B
         	ON A.item_id = B.item_id
         	ORDER BY A.typeid;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGetWareHouseItem_One` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGetWareHouseItem_One`(
	__IDUSER int,
	__IDITEM int
)
BEGIN
	
   IF __IDITEM < 0 THEN
         SELECT pangya_user_equip.club_id INTO __IDITEM
         FROM pangya.pangya_user_equip
         WHERE pangya_user_equip.UID = __IDUSER;
	END IF;

      SELECT 
         A.item_id, 
         A.UID, 
         A.typeid, 
         A.Ano, 
         A.C0, 
         A.C1, 
         A.C2, 
         A.C3, 
         A.C4, 
         A.Purchase, 
         A.Gift_flag, 
         A.Flag, 
         A.APPLY_DATE, 
         A.END_DATE, 
         A.ItemType, 
         B.CARD_CHARACTER_1, 
         B.CARD_CHARACTER_2, 
         B.CARD_CHARACTER_3, 
         B.CARD_CHARACTER_4, 
         B.CARD_CADDIE_1, 
         B.CARD_CADDIE_2, 
         B.CARD_CADDIE_3, 
         B.CARD_CADDIE_4, 
         B.CARD_NPC_1, 
         B.CARD_NPC_2, 
         B.CARD_NPC_3, 
         B.CARD_NPC_4, 
         A.ClubSet_WorkShop_Flag, 
         A.ClubSet_WorkShop_C0, 
         A.ClubSet_WorkShop_C1, 
         A.ClubSet_WorkShop_C2, 
         A.ClubSet_WorkShop_C3, 
         A.ClubSet_WorkShop_C4, 
         A.Mastery_Pts, 
         A.Recovery_Pts, 
         A.`Level`, 
         A.Up, 
         A.SD_NAME, 
         A.SD_IDX, 
         A.SD_SEQ, 
         A.SD_COPIER_NICK, 
         A.SD_COPIER, 
         A.SD_TRADE, 
         A.SD_FLAG, 
         A.SD_STATUS
      FROM 
         (
            SELECT 
               R.item_id, 
               R.UID, 
               R.typeid, 
               R.Ano, 
               R.C0, 
               R.C1, 
               R.C2, 
               R.C3, 
               R.C4, 
               R.APPLY_DATE, 
               R.END_DATE, 
               R.Gift_flag, 
               R.flag, 
               R.Purchase, 
               R.ItemType, 
               R.ClubSet_WorkShop_Flag, 
               R.ClubSet_WorkShop_C0, 
               R.ClubSet_WorkShop_C1, 
               R.ClubSet_WorkShop_C2, 
               R.ClubSet_WorkShop_C3, 
               R.ClubSet_WorkShop_C4, 
               R.Mastery_Pts, 
               R.Recovery_Pts, 
               R.`Level`, 
               R.Up, 
               CASE 
                  WHEN L.UCC_NAME IS NULL THEN ''
                  ELSE L.UCC_NAME
               END AS SD_NAME, 
                CASE 
                  WHEN L.UCCIDX IS NULL THEN ''
                  ELSE L.UCCIDX
               END AS SD_IDX, 
                CASE 
                  WHEN L.SEQ IS NULL THEN 0
                  ELSE L.SEQ
               END AS SD_SEQ, 
                CASE 
                  WHEN L.COPIER_NICK IS NULL THEN ''
                  ELSE L.COPIER_NICK
               END AS SD_COPIER_NICK, 
                CASE 
                  WHEN L.COPIER IS NULL THEN 0
                  ELSE L.COPIER
               END AS SD_COPIER, 
                CASE 
                  WHEN L.TRADE IS NULL THEN 0
                  ELSE L.TRADE
               END AS SD_TRADE, 
                CASE 
                  WHEN L.Flag IS NULL THEN 0
                  ELSE L.Flag
               END AS SD_FLAG, 
                CASE 
                  WHEN L.`STATUS` IS NULL THEN 0
                  ELSE L.`STATUS`
               END AS SD_STATUS
            FROM 
               (
                  SELECT 
                     D.item_id, 
                     D.UID, 
                     D.typeid, 
                      (CASE 
                        WHEN timestampdiff(minute, 
                           CASE 
                              WHEN (D.EndDate = D.Applytime) THEN D.Applytime
                              ELSE now()
                           END, D.EndDate) <> 0 THEN timestampdiff(hour, now(), D.EndDate)
                        ELSE -1
                     END) AS Ano, 
                      /*ISNULL(E.c0,*/ D.C0/*) AS C0*/, 
                      /*ISNULL(E.c1,*/ D.C1/*) AS C1*/, 
                      /*ISNULL(E.c2,*/ D.C2/*) AS C2*/, 
                      /*ISNULL(E.c3,*/ D.C3/*) AS C3*/, 
                      /*ISNULL(E.c4,*/ D.C4/*) AS C4*/, 
                      (CASE 
                        WHEN timestampdiff(minute, D.Applytime, D.EndDate) > 0 THEN UNIX_TIMESTAMP(CURRENT_TIMESTAMP)
                        ELSE 0
                     END) AS APPLY_DATE, 
                      (CASE 
                        WHEN timestampdiff(minute, D.Applytime, D.EndDate) > 0 THEN UNIX_TIMESTAMP(CURRENT_TIMESTAMP)
                        ELSE 0
                     END) AS END_DATE, 
                     D.Gift_flag, 
                      CASE 
                        WHEN (D.EndDate <= now() AND D.Applytime <> D.EndDate) THEN D.flag + 2
                        ELSE D.flag
                     END AS flag, 
                     D.Purchase, 
                     D.ItemType, 
                     D.ClubSet_WorkShop_Flag, 
                     D.ClubSet_WorkShop_C0, 
                     D.ClubSet_WorkShop_C1, 
                     D.ClubSet_WorkShop_C2, 
                     D.ClubSet_WorkShop_C3, 
                     D.ClubSet_WorkShop_C4, 
                     D.Mastery_Pts, 
                     D.Recovery_Pts, 
                     D.`Level`, 
                     D.Up
                  FROM 
                     (
                        SELECT 
                           pangya_item_warehouse.item_id, 
                           pangya_item_warehouse.UID, 
                           pangya_item_warehouse.typeid, 
                           pangya_item_warehouse.valid, 
                           pangya_item_warehouse.regdate, 
                           pangya_item_warehouse.Gift_flag, 
                           pangya_item_warehouse.flag, 
                           pangya_item_warehouse.Applytime, 
                           pangya_item_warehouse.EndDate, 
                           pangya_item_warehouse.C0, 
                           pangya_item_warehouse.C1, 
                           pangya_item_warehouse.C2, 
                           pangya_item_warehouse.C3, 
                           pangya_item_warehouse.C4, 
                           pangya_item_warehouse.Purchase, 
                           pangya_item_warehouse.ItemType, 
                           pangya_item_warehouse.ClubSet_WorkShop_Flag, 
                           pangya_item_warehouse.ClubSet_WorkShop_C0, 
                           pangya_item_warehouse.ClubSet_WorkShop_C1, 
                           pangya_item_warehouse.ClubSet_WorkShop_C2, 
                           pangya_item_warehouse.ClubSet_WorkShop_C3, 
                           pangya_item_warehouse.ClubSet_WorkShop_C4, 
                           pangya_item_warehouse.Mastery_Pts, 
                           pangya_item_warehouse.Recovery_Pts, 
                           pangya_item_warehouse.`Level`, 
                           pangya_item_warehouse.Up, 
                           pangya_item_warehouse.Total_Mastery_Pts, 
                           pangya_item_warehouse.Mastery_Gasto
                        FROM pangya.pangya_item_warehouse
                        WHERE pangya_item_warehouse.UID = __IDUSER AND pangya_item_warehouse.Gift_flag = 0
                     )  AS D 
                        -- LEFT OUTER JOIN 
                        -- (
                        --   SELECT 
                        --      pangya_clubset_enchant.uid, 
                        --      pangya_clubset_enchant.item_id, 
                        --      pangya_clubset_enchant.pang, 
                        --      pangya_clubset_enchant.c0, 
                        --      pangya_clubset_enchant.c1, 
                        --      pangya_clubset_enchant.c2, 
                        --      pangya_clubset_enchant.c3, 
                        --      pangya_clubset_enchant.c4
                        --   FROM pangya.pangya_clubset_enchant
                        --   WHERE pangya_clubset_enchant.uid = __IDUSER
                        -- )  AS E 
                        -- ON D.item_id = E.item_id                  
               )  AS R 
                  INNER JOIN 
                  (
                     SELECT 
                        F.item_id, 
                        G.UCC_NAME, 
                        G.UCCIDX, 
                        G.SEQ, 
                        G.COPIER, 
                        G.COPIER_NICK, 
                        G.TRADE, 
                        G.Flag, 
                        G.`STATUS`
                     FROM 
                        (
                           SELECT pangya_item_warehouse.item_id
                           FROM pangya.pangya_item_warehouse
                           WHERE pangya_item_warehouse.UID = __IDUSER AND pangya_item_warehouse.Gift_flag = 0
                        )  AS F 
                           LEFT OUTER JOIN 
                           (
                              SELECT 
                                 tu_ucc.UID, 
                                 tu_ucc.TYPEID, 
                                 tu_ucc.UCCIDX, 
                                 tu_ucc.SEQ, 
                                 tu_ucc.UCC_NAME, 
                                 tu_ucc.USE_YN, 
                                 tu_ucc.IN_DATE, 
                                 tu_ucc.COPIER, 
                                 tu_ucc.ITEM_ID, 
                                 tu_ucc.COPIER_NICK, 
                                 tu_ucc.DRAW_DT, 
                                 tu_ucc.`STATUS`, 
                                 tu_ucc.Flag, 
                                 tu_ucc.SKEY, 
                                 tu_ucc.TRADE
                              FROM pangya.tu_ucc
                           )  AS G 
                           ON F.item_id = G.ITEM_ID
                     -- GROUP BY F.item_id
                  )  AS L 
                  ON R.item_id = L.ITEM_ID
            -- GROUP BY R.item_id
         )  AS A 
            INNER JOIN 
            (
               SELECT 
                  X.item_id, 
                   0 AS CARD_CHARACTER_1, 
                   0 AS CARD_CHARACTER_2, 
                   0 AS CARD_CHARACTER_3, 
                   0 AS CARD_CHARACTER_4, 
                   0 AS CARD_CADDIE_1, 
                   0 AS CARD_CADDIE_2, 
                   0 AS CARD_CADDIE_3, 
                   0 AS CARD_CADDIE_4, 
                   0 AS CARD_NPC_1, 
                   0 AS CARD_NPC_2, 
                   0 AS CARD_NPC_3, 
                   0 AS CARD_NPC_4
               FROM 
                  (
                     SELECT pangya_item_warehouse.item_id
                     FROM pangya.pangya_item_warehouse
                     WHERE 
                        pangya_item_warehouse.UID = __IDUSER AND 
                        pangya_item_warehouse.Gift_flag = 0 AND 
                        pangya_item_warehouse.item_id = __IDITEM
                  )  AS X 
                     LEFT OUTER JOIN 
                     (
                        SELECT pangya_card_equip.Tipo, pangya_card_equip.Slot, pangya_card_equip.card_typeid, pangya_card_equip.parts_id
                        FROM pangya.pangya_card_equip
                        WHERE pangya_card_equip.UID = __IDUSER AND pangya_card_equip.USE_YN = 1
                     )  AS Y 
                     ON Y.parts_id = X.item_id
              -- GROUP BY X.item_id               
            )  AS B 
            ON A.item_id = B.item_id
         ORDER BY A.typeid;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGrandPrixClearPlayer` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGrandPrixClearPlayer`(
	__IDUSER int,
	__typeid_in int,
	__flag_in int
)
BEGIN
	
	DECLARE __PLACE int DEFAULT 0;

      IF 
         (
            SELECT pangya_grandprix_clear.typeid
            FROM pangya.pangya_grandprix_clear
            WHERE pangya_grandprix_clear.uid = __IDUSER AND pangya_grandprix_clear.typeid = __typeid_in
         ) IS NULL THEN
         BEGIN

            INSERT pangya.pangya_grandprix_clear(pangya.pangya_grandprix_clear.uid, pangya.pangya_grandprix_clear.typeid, pangya.pangya_grandprix_clear.flag)
               VALUES (__IDUSER, __TYPEID_IN, __FLAG_IN);

            SET __PLACE = __FLAG_IN;

         END;
      ELSE 
         BEGIN
            IF 
               (
                  SELECT pangya_grandprix_clear.flag
                  FROM pangya.pangya_grandprix_clear
                  WHERE pangya_grandprix_clear.uid = __IDUSER AND pangya_grandprix_clear.typeid = __typeid_in
               ) > __flag_in THEN
               BEGIN

                  UPDATE pangya.pangya_grandprix_clear
                     SET 
                        FLAG = __FLAG_IN
                  WHERE pangya_grandprix_clear.uid = __IDUSER AND pangya_grandprix_clear.typeid = __TYPEID_IN;

                  SET __PLACE = __FLAG_IN;

               END;
			   END IF;
         END;
         END IF;

      SELECT __PLACE;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGuildAcceptMark` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGuildAcceptMark`(
	__GUILD_UID INT
)
BEGIN
	
	DECLARE __RET INT DEFAULT -1;
	
	IF __GUILD_UID > 0 THEN
	BEGIN
		
		DECLARE __GUILD_MASTER INT DEFAULT (SELECT GUILD_LEADER FROM pangya.pangya_guild WHERE GUILD_UID = __GUILD_UID);
		DECLARE __GUILD_NEW_MARK INT DEFAULT (SELECT GUILD_NEW_MARK_IDX FROM pangya.pangya_guild WHERE GUILD_UID = __GUILD_UID);

		IF __GUILD_NEW_MARK IS NOT NULL AND __GUILD_NEW_MARK > 0 THEN
		BEGIN
			
			IF __GUILD_MASTER IS NOT NULL THEN
			BEGIN
			
				UPDATE
					pangya.pangya_guild
						SET GUILD_ACCEPT_DATE = IF(GUILD_MARK_IMG_IDX = 0 AND GUILD_STATE = 0/*pending*/, now()/*Accept Guild*/, GUILD_ACCEPT_DATE),
							GUILD_STATE = IF(GUILD_MARK_IMG_IDX = 0 AND GUILD_STATE = 0/*pending*/, 1/*Now Open*/, GUILD_STATE),
							GUILD_MARK_IMG = CONCAT(GUILD_UID, '_', __GUILD_NEW_MARK),	-- Guild Mark Img, a string montada já
							GUILD_MARK_IMG_IDX = __GUILD_NEW_MARK,
							GUILD_NEW_MARK_IDX = 0
				WHERE GUILD_UID = __GUILD_UID;

				-- Insert Activity Player
				INSERT INTO pangya.pangya_guild_atividade_player(GUILD_UID, UID, FLAG)
				VALUES(__GUILD_UID, __GUILD_MASTER, 15);

				-- Sucesso
				SET __RET = 1;
			
			END;
            END IF;

		END;
		ELSE
			SET __RET = -2;	-- Não tem um new mark para ser aceito
		END IF;
	END;
    END IF;

	SELECT __RET AS RET;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGuildAceitaPedido` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGuildAceitaPedido`(
	__OWNER_UID INT,	-- Quem fez a Ação
	__IDUSER int,
	__UID_GUILD int
)
BEGIN
	
	UPDATE pangya.pangya_guild_member
		SET 
		MEMBER_STATE_FLAG = 3
	WHERE GUILD_UID = __UID_GUILD AND MEMBER_UID = __IDUSER;

	INSERT pangya.pangya_guild_atividade_player(UID, GUILD_UID, FLAG)
		VALUES (__IDUSER, __UID_GUILD, 3);

	-- Cria log de update para o Game Server verificar e pedir para o Message Server Atualize os Membros do Club
	INSERT INTO pangya_guild_update_activity(GUILD_UID, OWNER_UPDATE, PLAYER_UID, TYPE_UPDATE) VALUES(__UID_GUILD, __OWNER_UID, __IDUSER, 0/*Accept Member*/);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGuildBlock` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGuildBlock`(
	__GUILD_UID INT
)
BEGIN
	
	DECLARE __RET INT DEFAULT -1;

	IF __GUILD_UID > 0 THEN
	BEGIN

		IF (SELECT GUILD_UID FROM pangya.pangya_guild WHERE GUILD_UID = __GUILD_UID AND GUILD_STATE IN(0, 1, 2)) IS NOT NULL THEN
		BEGIN
			
			DECLARE __GUILD_MASTER INT DEFAULT (SELECT GUILD_LEADER FROM pangya.pangya_guild WHERE GUILD_UID = __GUILD_UID);

			IF __GUILD_MASTER IS NOT NULL THEN
			BEGIN

				UPDATE
					pangya.pangya_guild
						SET GUILD_STATE = 3 -- GM bloqueou a Guild
				WHERE GUILD_UID = __GUILD_UID;

				-- Insert Activity
				INSERT INTO pangya.pangya_guild_atividade_player(GUILD_UID, UID, FLAG)
				VALUES(__GUILD_UID, __GUILD_MASTER, 16);

				-- Sucesso
				SET __RET = 1;

			END;
            END IF;

		END;
		ELSE
			SET __RET = -2;	-- A guild já está bloqueada
		END IF;

	END;
    END IF;

	SELECT __RET AS RET;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGuildCancelaPedido` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGuildCancelaPedido`(
	__IDUSER int,
	__UID_GUILD int
)
BEGIN
	
	UPDATE pangya.account
         SET 
            GUILD_UID = 0
      WHERE UID = __IDUSER;

      DELETE 
      FROM pangya.pangya_guild_member
      WHERE GUILD_UID = __UID_GUILD AND MEMBER_UID = __IDUSER;

      INSERT pangya.pangya_guild_atividade_player(UID, GUILD_UID, FLAG)
         VALUES (__IDUSER, __UID_GUILD, 2);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGuildChangeAuthorityMember` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGuildChangeAuthorityMember`(
	__GUILD_UID INT,
	__MEMBER_UID INT,
	__MEMBER_AUTHORITY INT
)
BEGIN
	
	-- Ret value
	DECLARE __RET INT DEFAULT -1;
	
	IF __GUILD_UID > 0 AND __MEMBER_UID > 0 AND __MEMBER_AUTHORITY >= 0 THEN
	BEGIN

		DECLARE __FLAG INT DEFAULT (SELECT MEMBER_STATE_FLAG FROM pangya.pangya_guild_member WHERE GUILD_UID = __GUILD_UID AND MEMBER_UID = __MEMBER_UID);
		
		IF __FLAG IS NOT NULL THEN
		BEGIN

			IF __FLAG != __MEMBER_AUTHORITY THEN
			BEGIN

				DECLARE __OLD_SUB_MASTER INT DEFAULT (SELECT GUILD_SUB_MASTER FROM pangya.pangya_guild WHERE GUILD_UID = __GUILD_UID);
			
				IF __OLD_SUB_MASTER IS NOT NULL THEN
				BEGIN
					
					IF __MEMBER_AUTHORITY = 2 THEN -- SUB MASTER
					BEGIN

						-- Update Member Authority
						UPDATE
							pangya.pangya_guild_member
								SET MEMBER_STATE_FLAG = __MEMBER_AUTHORITY
						WHERE 
							GUILD_UID = __GUILD_UID AND MEMBER_UID = __MEMBER_UID;

						-- Update Guild Sub Master
						UPDATE
							pangya.pangya_guild
								SET GUILD_SUB_MASTER = __MEMBER_UID
						WHERE GUILD_UID = __GUILD_UID;

						-- Activity member new Sub Master
						INSERT INTO pangya.pangya_guild_atividade_player(GUILD_UID, UID, FLAG)
						VALUES(__GUILD_UID, __MEMBER_UID, 12/*Promovido a subMaster*/);

						-- Verifica se tinha um Sub Master para atualizar o state dele
						IF __OLD_SUB_MASTER > 0 THEN
						BEGIN
							
							UPDATE
								pangya.pangya_guild_member
									SET MEMBER_STATE_FLAG = 3 -- Member
							WHERE GUILD_UID = __GUILD_UID AND MEMBER_UID = __OLD_SUB_MASTER;

							-- Activity old Sub Master to member
							INSERT INTO pangya.pangya_guild_atividade_player(GUILD_UID, UID, FLAG)
							VALUES(__GUILD_UID, __OLD_SUB_MASTER, 13/*Despromovido*/);
						END;
                        END IF;

					END;
					ELSE	-- Membro
					BEGIN
						
						-- Update Member Authority
						UPDATE
							pangya.pangya_guild_member
								SET MEMBER_STATE_FLAG = __MEMBER_AUTHORITY
						WHERE 
							GUILD_UID = __GUILD_UID AND MEMBER_UID = __MEMBER_UID;

						-- Update Guild Sub Master
						UPDATE
							pangya.pangya_guild
								SET GUILD_SUB_MASTER = 0	-- Nenhum Master
						WHERE GUILD_UID = __GUILD_UID;

						-- Activity member new Sub Master
						INSERT INTO pangya.pangya_guild_atividade_player(GUILD_UID, UID, FLAG)
						VALUES(__GUILD_UID, __MEMBER_UID, 13/*Despromovido*/);

					END;
                    END IF;

					SET __RET = 1;	-- Trocou autoridade do membro com sucesso

				END;
                END IF;

			END;
			ELSE
				SET __RET = -2;	-- Ele já é subMaster ou Membro
			END IF;
		END;
        END IF;
	END;
    END IF;

	SELECT __RET AS RET;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGuildClosure` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGuildClosure`(
	__GUILD_UID INT,
	__MASTER_UID INT
)
BEGIN
	
	DECLARE __RET INT DEFAULT -1;

	IF __GUILD_UID > 0 AND __MASTER_UID >= 0 THEN
	BEGIN

		IF (SELECT GUILD_UID FROM pangya.pangya_guild WHERE GUILD_UID = __GUILD_UID AND ((__MASTER_UID = 0 AND GUILD_STATE IN(0, 1, 2, 3)) OR (__MASTER_UID > 0 AND GUILD_STATE IN(0, 1, 2)))) IS NOT NULL THEN
		BEGIN

			-- Dias que a guild vai ficar em estado de fechamento antes de fechar
			DECLARE __DIAS INT DEFAULT 7;

			IF __MASTER_UID = 0 THEN	-- GM Fechou a guild
			BEGIN

				DECLARE __GUILD_MASTER INT DEFAULT (SELECT GUILD_LEADER FROM pangya.pangya_guild WHERE GUILD_UID = __GUILD_UID);
			
				IF __GUILD_MASTER IS NOT NULL THEN
				BEGIN

					UPDATE
						pangya.pangya_guild
							SET GUILD_STATE = 5, -- GM FECHOU A GUILD
								GUILD_CLOSURE_DATE = TIMESTAMPADD(DAY, __DIAS, now())
					WHERE GUILD_UID = __GUILD_UID;

					-- Insert Activity Player
					INSERT INTO pangya.pangya_guild_atividade_player(GUILD_UID, UID, FLAG)
					VALUES(__GUILD_UID, __GUILD_MASTER, 17);

					-- Sucesso
					SET __RET = 1;

				END;
                END IF;

			END;
			ELSE
			BEGIN
			
				UPDATE
					pangya.pangya_guild
						SET GUILD_STATE = 4,	-- Player fechou a guild
							GUILD_CLOSURE_DATE = TIMESTAMPADD(DAY, __DIAS, now())
				WHERE GUILD_UID = __GUILD_UID AND GUILD_LEADER = __MASTER_UID;

				-- Insert Activity Player
				INSERT INTO pangya.pangya_guild_atividade_player(GUILD_UID, UID, FLAG)
				VALUES(__GUILD_UID, __MASTER_UID, 9);

				-- Sucesso
				SET __RET = 1;
					
			END;
            END IF;
		END;
		ELSE
			SET __RET = -2;	-- A guild já está fechada
		END IF;

	END;
    END IF;

	SELECT __RET AS RET;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGuildKickMember` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGuildKickMember`(
	__OWNER_UID INT,	-- Quem fez a Ação
	__MEMBER_UID INT,
	__GUILD_UID INT
)
BEGIN
	
	IF __GUILD_UID > 0 AND __MEMBER_UID > 0 THEN
	BEGIN

		DECLARE __FLAG INT DEFAULT (SELECT MEMBER_STATE_FLAG FROM pangya.pangya_guild_member WHERE GUILD_UID = __GUILD_UID AND MEMBER_UID = __MEMBER_UID);

		IF __FLAG IS NOT NULL THEN
		BEGIN

			IF __FLAG = 2 THEN -- SUB MASTER
				UPDATE pangya.pangya_guild SET GUILD_SUB_MASTER = 0 WHERE GUILD_UID = __GUILD_UID;
			END IF;

			IF __FLAG = 9 THEN
				SET __FLAG = 4; -- Rejeita pedido para entrar na guild
			ELSE
				SET __FLAG = 6; -- Kick Member (Expulsa)
			END IF;
		
			-- Delete from table members of guild
			DELETE FROM
				pangya.pangya_guild_member
			WHERE 
				GUILD_UID = __GUILD_UID AND MEMBER_UID = __MEMBER_UID;

			-- Update Guild of player in table account
			UPDATE
				pangya.account
					SET Guild_UID = 0
			WHERE UID = __MEMBER_UID;

			-- Insert Ativity of player in table guild atividade
			INSERT INTO pangya.pangya_guild_atividade_player(GUILD_UID, UID, FLAG)
			VALUES(__GUILD_UID, __MEMBER_UID, __FLAG);

			IF __FLAG = 6 THEN -- Kick Member (Expulsa)
			BEGIN
				-- Cria log de update para o Game Server verificar e pedir para o Message Server Atualize os Membros do Club
				INSERT INTO pangya_guild_update_activity(GUILD_UID, OWNER_UPDATE, PLAYER_UID, TYPE_UPDATE) VALUES(__GUILD_UID, __OWNER_UID, __MEMBER_UID, 2/*Kick Member*/);
			END;
            END IF;
		END;
        END IF;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGuildMoveMaster` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGuildMoveMaster`(
	__GUILD_UID INT,
	__MEMBER_UID INT
)
BEGIN
	
	DECLARE __RET INT DEFAULT -1;
	
	IF __GUILD_UID > 0 AND __MEMBER_UID > 0 THEN
	BEGIN

		-- Verifica se o membro que vai virar master da guild tem o level de Rookie E pra cima
		DECLARE __LEVEL INT DEFAULT (SELECT `level` FROM pangya.user_info WHERE UID = __MEMBER_UID);

		IF __LEVEL IS NOT NULL AND __LEVEL > 0 THEN
		BEGIN

			DECLARE __OLD_MASTER INT DEFAULT (SELECT GUILD_LEADER FROM pangya.pangya_guild WHERE GUILD_UID = __GUILD_UID);
			DECLARE __OLD_SUB_MASTER INT DEFAULT (SELECT GUILD_SUB_MASTER FROM pangya.pangya_guild WHERE GUILD_UID = __GUILD_UID);

			IF __OLD_MASTER IS NOT NULL AND __OLD_SUB_MASTER IS NOT NULL THEN
			BEGIN

				-- Update Master of Guild
				UPDATE
					pangya.pangya_guild
						SET GUILD_LEADER = __MEMBER_UID
					WHERE
						GUILD_UID = __GUILD_UID;

				-- Update Member state flag to Master
				UPDATE
					pangya.pangya_guild_member
						SET MEMBER_STATE_FLAG = 1 -- Master
				WHERE
					GUILD_UID = __GUILD_UID AND MEMBER_UID = __MEMBER_UID;

				-- Update Old Master to member
				UPDATE
					pangya.pangya_guild_member
						SET MEMBER_STATE_FLAG = 3 -- Member
				WHERE
					GUILD_UID = __GUILD_UID AND MEMBER_UID = __OLD_MASTER;

				-- Verifica se o membro que virou Master era Sub Master e tira o Sub Master da Guild
				IF __OLD_SUB_MASTER = __MEMBER_UID THEN
				BEGIN

					UPDATE
						pangya.pangya_guild
							SET GUILD_SUB_MASTER = 0	-- Zera, não tem mais sub master, só master já que o master virou membro comun
					WHERE GUILD_UID = __GUILD_UID;

				END;
                END IF;

				-- Insert Activity of New Master
				INSERT INTO pangya.pangya_guild_atividade_player(GUILD_UID, UID, FLAG)
				VALUES(__GUILD_UID, __MEMBER_UID, 11/*Promovido a master*/);

				-- Insert Activity of Old Master to member
				INSERT INTO pangya.pangya_guild_atividade_player(GUILD_UID, UID, FLAG)
				VALUES(__GUILD_UID, __OLD_MASTER, 5/*Promote*/);

				-- Passou o master
				INSERT INTO pangya.pangya_guild_atividade_player(GUILD_UID, UID, FLAG)
				VALUES(__GUILD_UID, __OLD_MASTER, 10/*Passou o master*/);

				-- Sucesso
				SET __RET = 1;

			END;
            END IF;

		END;
		ELSE
			SET __RET = -2;
		END IF;

	END;
    END IF;

	SELECT __RET AS RET;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGuildRejectMark` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGuildRejectMark`(
	__GUILD_UID INT
)
BEGIN
	
	DECLARE __RET INT DEFAULT -1;
	
	IF __GUILD_UID > 0 THEN
	BEGIN

		-- GM Rejeito o Guild Mark
		DECLARE __GUILD_MASTER INT DEFAULT (SELECT GUILD_LEADER FROM pangya.pangya_guild WHERE GUILD_UID = __GUILD_UID);

		IF __GUILD_MASTER IS NOT NULL THEN
		BEGIN

			UPDATE
				pangya.pangya_guild
					SET GUILD_NEW_MARK_IDX = 0
			WHERE GUILD_UID = __GUILD_UID;

			-- Insert Activity Player
			INSERT INTO pangya.pangya_guild_atividade_player(GUILD_UID, UID, FLAG)
			VALUES(__GUILD_UID, __GUILD_MASTER, 14);

			-- Sucesso
			SET __RET = 1;

		END;
        END IF;
	END;
    END IF;

	SELECT __RET AS RET;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGuildReOpen` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGuildReOpen`(
	__GUILD_UID INT,
	__MASTER_UID INT
)
BEGIN
	
	DECLARE __RET INT DEFAULT -1;
	
	IF __GUILD_UID > 0 AND __MASTER_UID >= 0 THEN
	BEGIN

		IF (SELECT GUILD_UID FROM pangya.pangya_guild WHERE GUILD_UID = __GUILD_UID 
			AND ((__MASTER_UID = 0 AND GUILD_STATE IN(4,5)) OR (__MASTER_UID > 0 AND GUILD_STATE = 4)) 
			AND (GUILD_CLOSURE_DATE IS NULL OR now() < GUILD_CLOSURE_DATE)) IS NOT NULL THEN
		BEGIN

			IF __MASTER_UID = 0 THEN -- GM reabriu a guild do player
			BEGIN
			
				DECLARE __GUILD_MASTER INT DEFAULT (SELECT GUILD_LEADER FROM pangya.pangya_guild WHERE GUILD_UID = __GUILD_UID);

				IF __GUILD_MASTER IS NOT NULL THEN
				BEGIN

					UPDATE
						pangya.pangya_guild
							SET GUILD_STATE = IF(GUILD_MARK_IMG_IDX = 0, 0 /*Pending*/, 1/*Now Open*/),
								GUILD_CLOSURE_DATE = NULL
					WHERE GUILD_UID = __GUILD_UID;

					-- Insert Activity Player
					INSERT INTO pangya.pangya_guild_atividade_player(GUILD_UID, UID, FLAG)
					VALUES(__GUILD_UID, __GUILD_MASTER, 20);

					-- Sucesso
					SET __RET = 1;

				END;
                END IF;

			END;
			ELSE
			BEGIN
			
				UPDATE
					pangya.pangya_guild
						SET GUILD_STATE = IF(GUILD_MARK_IMG_IDX = 0, 0 /*Pending*/, 1/*Now Open*/),
							GUILD_CLOSURE_DATE = NULL
				WHERE GUILD_UID = __GUILD_UID AND GUILD_LEADER = __MASTER_UID;

				-- Insert Activity Player
				INSERT INTO pangya.pangya_guild_atividade_player(GUILD_UID, UID, FLAG)
				VALUES(__GUILD_UID, __MASTER_UID, 19);

				-- Sucesso
				SET __RET = 1;

			END;
            END IF;

		END;
		ELSE
			SET __RET = -2;	-- a guild não está fechada
		END IF;
	END;
    END IF;

	SELECT __RET AS RET;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcGuildUnblock` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcGuildUnblock`(
	__GUILD_UID INT
)
BEGIN
	
	DECLARE __RET INT DEFAULT -1;

	IF __GUILD_UID > 0 THEN
	BEGIN

		IF (SELECT GUILD_UID FROM pangya.pangya_guild WHERE GUILD_UID = __GUILD_UID AND GUILD_STATE = 3) IS NOT NULL THEN
		BEGIN

			DECLARE __GUILD_MASTER INT DEFAULT (SELECT GUILD_LEADER FROM pangya.pangya_guild WHERE GUILD_UID = __GUILD_UID);

			IF __GUILD_MASTER IS NOT NULL THEN
			BEGIN

				UPDATE
					pangya.pangya_guild
						SET GUILD_STATE = IF(GUILD_MARK_IMG_IDX = 0, 0 /*Pending*/, 1/*Now Open*/)
				WHERE GUILD_UID = __GUILD_UID;

				-- Insert Activity Player
				INSERT INTO pangya.pangya_guild_atividade_player(GUILD_UID, UID, FLAG)
				VALUES(__GUILD_UID, __GUILD_MASTER, 18);

				-- Sucesso
				SET __RET = 1;

			END;
            END IF;

		END;
		ELSE
			SET __RET = -2;	-- A guild não está bloqueada pra desbloquear
		END IF;

	END;
    END IF;

	SELECT __RET AS RET;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertAchievementAll` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertAchievementAll`(
	__TYPEID_ACHIEVE int,
	__TYPEID_QUEST int,
	__OBJECTIVO int,
	__OPT int
)
BEGIN
	
	DECLARE
         __IDUSER int;

      DECLARE
         __ID_ACHIEVE int;

      DECLARE
         __ID_COUNTER int;

      DECLARE
         __FINISHED BOOL DEFAULT TRUE;

      DECLARE
          UID_CURSOR CURSOR FOR 
            SELECT account.UID
            FROM pangya.account;
            
	DECLARE CONTINUE HANDLER FOR NOT FOUND SET __FINISHED = FALSE;

      OPEN UID_CURSOR;

      FETCH UID_CURSOR INTO __IDUSER;

      WHILE (__FINISHED) DO
         BEGIN

            INSERT pangya.achievement_tipo(pangya.achievement_tipo.UID, pangya.achievement_tipo.TypeID, pangya.achievement_tipo.TIPO, pangya.achievement_tipo.`Option`)
               VALUES (__IDUSER, __TYPEID_ACHIEVE, 1, __OPT);

            SELECT max(achievement_tipo.ID_ACHIEVEMENT) INTO __ID_ACHIEVE
            FROM pangya.achievement_tipo
            WHERE achievement_tipo.UID = __IDUSER;

            INSERT pangya.achievement_quest(
               pangya.achievement_quest.UID, 
               pangya.achievement_quest.ID_ACHIEVEMENT, 
               pangya.achievement_quest.TypeID_ACHIEVE, 
               pangya.achievement_quest.Count_ID, 
               pangya.achievement_quest.Data_Sec, 
               pangya.achievement_quest.Objetivo_Quest)
               VALUES (
                  __IDUSER, 
                  __ID_ACHIEVE, 
                  __TYPEID_QUEST, 
                  0, 
                  0, 
                  __OBJECTIVO);

         END;
         END WHILE;

      CLOSE UID_CURSOR;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertAchievementOneUser` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertAchievementOneUser`(
	__IDUSER int,
	__TYPEID_ACHIEVE int,
	__TYPEID_QUEST int,
	__OBJECTIVO int,
	__OPT int
)
BEGIN
	
	DECLARE
         __ID_ACHIEVE int DEFAULT 0;

      INSERT pangya.achievement_tipo(pangya.achievement_tipo.UID, pangya.achievement_tipo.TypeID, pangya.achievement_tipo.TIPO, pangya.achievement_tipo.`Option`)
         VALUES (__IDUSER, __TYPEID_ACHIEVE, 1, __OPT);

      SELECT max(achievement_tipo.ID_ACHIEVEMENT) INTO __ID_ACHIEVE
      FROM pangya.achievement_tipo
      WHERE achievement_tipo.UID = __IDUSER;

      INSERT pangya.achievement_quest(
         pangya.achievement_quest.UID, 
         pangya.achievement_quest.ID_ACHIEVEMENT, 
         pangya.achievement_quest.TypeID_ACHIEVE, 
         pangya.achievement_quest.Count_ID, 
         pangya.achievement_quest.Data_Sec, 
         pangya.achievement_quest.Objetivo_Quest)
         VALUES (
            __IDUSER, 
            __ID_ACHIEVE, 
            __TYPEID_QUEST, 
            0, 
            0, 
            __OBJECTIVO);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertAchievementQuest` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertAchievementQuest`(
	__IDUSER int,
	__ACHIEVEMENT_TYPEID int,
	__ACHIEVEMENT_QUEST_TYPEID int,
	__COUNTER_ITEM_TYPEID int,
	__OBJECTIVE int
)
BEGIN
	
	DECLARE __IDACHIEVE int; 
	DECLARE __COUNT_ITEM_ID int;

      SELECT achievement_tipo.ID_ACHIEVEMENT INTO __IDACHIEVE
      FROM pangya.achievement_tipo
      WHERE 
         achievement_tipo.UID = __IDUSER AND 
         achievement_tipo.TypeID = __ACHIEVEMENT_TYPEID AND 
         achievement_tipo.TIPO <> 2;

      IF 
         (
            SELECT max(count_item.Count_ID)
            FROM pangya.count_item
            WHERE count_item.UID = __IDUSER AND count_item.TypeID = __COUNTER_ITEM_TYPEID
         ) IS NULL THEN
         INSERT pangya.count_item(pangya.count_item.UID, pangya.count_item.TypeID, pangya.count_item.TIPO)
            VALUES (__IDUSER, __COUNTER_ITEM_TYPEID, 1);
	END IF;

      SELECT max(count_item.Count_ID) INTO __COUNT_ITEM_ID
      FROM pangya.count_item
      WHERE count_item.UID = __IDUSER AND count_item.TypeID = __COUNTER_ITEM_TYPEID;

      INSERT pangya.achievement_quest(
         pangya.achievement_quest.UID, 
         pangya.achievement_quest.ID_ACHIEVEMENT, 
         pangya.achievement_quest.TypeID_ACHIEVE, 
         pangya.achievement_quest.Count_ID, 
         pangya.achievement_quest.Data_Sec, 
         pangya.achievement_quest.Objetivo_Quest)
         VALUES (
            __IDUSER, 
            __IDACHIEVE, 
            __ACHIEVEMENT_QUEST_TYPEID, 
            __COUNT_ITEM_ID, 
            0, 
            __Objective);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertBlockIP` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertBlockIP`(
	__IP VARCHAR(40),
	__MASK VARCHAR(18)
)
BEGIN
	
	IF __IP != '' AND __MASK != '' THEN
	BEGIN

		IF (SELECT `index` FROM pangya.pangya_ip_table WHERE ip = __IP AND mask = __MASK) IS NULL THEN
			INSERT INTO pangya.pangya_ip_table(ip, mask) VALUES(__IP, __MASK);
		END IF;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertBlockMAC` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertBlockMAC`(
	__MAC VARCHAR(20)
)
BEGIN
	
	IF __MAC != '' THEN
		INSERT INTO pangya.pangya_mac_table(mac) VALUES(__MAC);
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertBotGMEventReward` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertBotGMEventReward`(
	__TYPEID INT,
	__QNTD INT,
	__QNTD_TIME INT,
	__RATE INT,
	__VALID TINYINT
)
BEGIN
	
	IF __TYPEID > 0 THEN
	BEGIN

		INSERT INTO pangya.pangya_bot_gm_event_reward(typeid, qntd, qntd_time, rate, valid)
		VALUES(__TYPEID, __QNTD, __QNTD_TIME, __RATE, __VALID);

		SELECT last_insert_id() AS ID;

	END;
	ELSE
		SELECT -1 AS ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertBotGMEventTime` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertBotGMEventTime`(
	__INICIO_TIME TIME,
	__FIM_TIME TIME,
	__CHANNEL_ID TINYINT,
	__VALID TINYINT
)
BEGIN
	
	IF __INICIO_TIME IS NOT NULL AND __FIM_TIME IS NOT NULL THEN
	BEGIN

		INSERT INTO pangya.pangya_bot_gm_event_time(inicio_time, fim_time, channel_id, valid)
		VALUES(__INICIO_TIME, __FIM_TIME, __CHANNEL_ID, __VALID);

		SELECT last_insert_id() AS ID;

	END;
	ELSE
		SELECT -1 AS ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertBoxRareWinLog` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertBoxRareWinLog`(
	__IDUSER INT,
	__BOX_TYPEID INT,
	__ITEM_TYPEID INT,
	__QNTD INT,
	__RARIDADE TINYINT
)
BEGIN
	
	IF __IDUSER > 0 AND __BOX_TYPEID > 0 AND __ITEM_TYPEID> 0 THEN
	BEGIN
		INSERT INTO pangya.pangya_new_box_rare_win_log(UID, box_typeid, item_typeid, qntd, raridade, win_date)
			VALUES(__IDUSER, __BOX_TYPEID, __ITEM_TYPEID, __QNTD, __RARIDADE, now());
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertCard` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertCard`(
	__IDUSER INT,
	__ITEMTYPEID INT,
	__QNTD INT,
	__CARDTYPE TINYINT	-- Esse aqui eu colocou ele como 1 sempre
)
BEGIN
	
	DECLARE __ITEM_ID INT DEFAULT -1;

    IF __ITEMTYPEID > 0 AND (SELECT UID FROM pangya.account WHERE UID = __IDUSER) IS NOT NULL THEN
	BEGIN
		SET __ITEM_ID = IFNULL((SELECT card_itemid FROM pangya.pangya_card WHERE UID = __IDUSER AND card_typeid = __ITEMTYPEID LIMIT 1), -1);

		IF __ITEM_ID > 0 AND __ITEM_ID IS NOT NULL THEN
		BEGIN
			UPDATE pangya.pangya_card SET QNTD = QNTD + __QNTD, USE_YN = 'N' WHERE UID = __IDUSER AND card_typeid = __ITEMTYPEID;
		END;
		ELSE
		BEGIN
			INSERT INTO pangya.pangya_card(UID, card_typeid, card_type, QNTD, GET_DT, USE_YN)
				VALUES(__IDUSER, __ITEMTYPEID, __CARDTYPE, __QNTD, now(), 'N');

			SET __ITEM_ID = last_insert_id();
		END;
		END IF;
	END;
    END IF;

	SELECT __ITEM_ID AS ITEM_ID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertClubSet` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertClubSet`(
	__IDUSER INT,
	__GIFTFLAG TINYINT,
	__PURCHASE TINYINT,
	__ITEMTYPEID INT,
	__FLAG TINYINT,
	__TEMPO INT,
	__WORKSHOP_LEVEL INT
)
BEGIN
	
	DECLARE __ITEM_ID INT DEFAULT -1;

    -- Insert statements for procedure here
	IF __ITEMTYPEID > 0 AND (SELECT UID FROM pangya.account WHERE UID = __IDUSER) IS NOT NULL THEN
	BEGIN
		IF __TEMPO > 0 THEN
		BEGIN
			INSERT INTO pangya.pangya_item_warehouse(UID, typeid, valid, regdate, EndDate, Gift_flag, flag, Purchase, ItemType, `Level`)
				VALUES(__IDUSER, __ITEMTYPEID, 1, now(), TIMESTAMPADD(DAY, __TEMPO, now()), __GIFTFLAG, __FLAG, __PURCHASE, 2, __WORKSHOP_LEVEL);
		END;
		ELSE
		BEGIN
			INSERT INTO pangya.pangya_item_warehouse(UID, typeid, valid, regdate, Gift_flag, flag, Purchase, ItemType, `Level`)
				VALUES(__IDUSER, __ITEMTYPEID, 1, now(), __GIFTFLAG, __FLAG, __PURCHASE, 2, __WORKSHOP_LEVEL);
		END;
        END IF;

		SET __ITEM_ID = last_insert_id();

		INSERT INTO pangya.pangya_clubset_enchant(UID, item_id) VALUES(__IDUSER, __ITEM_ID);
	END;
    END IF;

	SELECT __ITEM_ID AS ITEM_ID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertCoinCubeLocation` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertCoinCubeLocation`(
	___COURSE TINYINT,
	___HOLE TINYINT,
	___TIPO TINYINT,
	___TIPO_LOCATION TINYINT,
	___RATE BIGINT,
	___X FLOAT,
	___Y FLOAT,
	___Z FLOAT
)
BEGIN
	
	INSERT INTO pangya.pangya_coin_cube_location(course, hole, tipo, tipo_location, rate, x, y, z)
	VALUES(___COURSE, ___HOLE, ___TIPO, ___TIPO_LOCATION, ___RATE, ___X, ___Y, ___Z);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertCommand` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertCommand`(
	__COMMAND_ID INT,
	__ARG1 INT,
	__ARG2 INT,
	__ARG3 INT,
	__ARG4 INT,
	__ARG5 INT,
	__TARGET INT,
	__FLAG SMALLINT,
	__VALID SMALLINT,
	__RESERVEDATE DATETIME
)
BEGIN

	INSERT INTO pangya.pangya_command(command_id, arg1, arg2, arg3, arg4, arg5, `target`, flag, valid, reserveDate)
		VALUES(__COMMAND_ID, __ARG1, __ARG2, __ARG3, __ARG4, __ARG5, __TARGET, __FLAG, __VALID, __RESERVEDATE);

	SELECT LAST_INSERT_ID() AS IDX;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertCPLog` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertCPLog`(
	__IDUSER INT,
	__TYPE TINYINT,
	__MAIL_ID INT,
	__COOKIE BIGINT,
	__ITEM_QNTY INT
)
BEGIN
	
	DECLARE __LOG_ID BIGINT DEFAULT -1;

	IF __IDUSER > 0 THEN
	BEGIN
		INSERT INTO pangya.pangya_cookie_point_log(UID, `type`, mail_id, cookie, item_qnty)
			VALUES(__IDUSER, __TYPE, __MAIL_ID, __COOKIE, __ITEM_QNTY);

		SET __LOG_ID = last_insert_id();
	END;
    END IF;

	SELECT __LOG_ID as id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertCPLogItem` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertCPLogItem`(
	__CP_LOG_ID BIGINT,
	__TYPEID INT,
	__QNTY INT,
	__PRICE BIGINT
)
BEGIN
	
	DECLARE __INDEX BIGINT DEFAULT -1;

    -- Insert statements for procedure here
	IF __CP_LOG_ID > 0 THEN
	BEGIN
		INSERT INTO pangya.pangya_cookie_point_item_log(cp_id_log, typeid, qnty, price)
			VALUES(__CP_LOG_ID, __TYPEID, __QNTY, __PRICE);

		SET __INDEX = last_insert_id();
	END;
    END IF;

	SELECT __INDEX AS `index`;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertDailyQuest_New` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertDailyQuest_New`(
	__IDUSER int,
	__quest_nome nvarchar(64),
	__quest_typeid int,
	___tipo int,
	___option int,
	__stuff_typeid int,
	__count_objective int
)
BEGIN

	DECLARE __ID_ACHIEVE BIGINT DEFAULT -1;
	
	INSERT pangya.achievement_tipo(
         pangya.achievement_tipo.UID, 
         pangya.achievement_tipo.Nome, 
         pangya.achievement_tipo.TypeID, 
         pangya.achievement_tipo.TIPO, 
         pangya.achievement_tipo.`Option`)
         VALUES (
            __IDUSER, 
            __quest_nome, 
            __quest_typeid, 
            ___tipo, 
            ___option);

      SET __ID_ACHIEVE = last_insert_id();     

      INSERT pangya.achievement_quest(
         pangya.achievement_quest.UID, 
         pangya.achievement_quest.ID_ACHIEVEMENT, 
         pangya.achievement_quest.TypeID_ACHIEVE, 
         pangya.achievement_quest.Count_ID, 
         pangya.achievement_quest.Data_Sec, 
         pangya.achievement_quest.Objetivo_Quest)
         VALUES (
            __IDUSER, 
            __ID_ACHIEVE, 
            __stuff_typeid, 
            0, 
            0, 
            __count_objective);

      SELECT __ID_ACHIEVE AS ID_ACHIEVEMENT;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertDonationNew` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertDonationNew`(
	__UID INT,
	__PLATAFORMA TINYINT,
	__EMAIL NVARCHAR(200),
	__DATE DATETIME,
	__UPDATE DATETIME,
	__CODE NVARCHAR(50),
	__TYPE TINYINT,
	__STATUS TINYINT,
	__REFERENCE NVARCHAR(200),
	__GROSS_AMOUNT FLOAT,
	__NET_AMOUNT FLOAT,
	__ESCROW DATETIME
)
BEGIN

	IF __CODE != '' AND __EMAIL != '' AND __DATE IS NOT NULL AND __REFERENCE != '' THEN
	BEGIN

		INSERT INTO pangya.pangya_donation_new(UID, PLATAFORMA, EMAIL, `DATE`, `UPDATE`, `CODE`, `TYPE`, `STATUS`, `REFERENCE`, GROSS_AMOUNT, NET_AMOUNT, ESCROW)
		VALUES(__UID, __PLATAFORMA, __EMAIL, __DATE, __UPDATE, __CODE, __TYPE, __STATUS, __REFERENCE, __GROSS_AMOUNT, __NET_AMOUNT, __ESCROW);

		SELECT last_insert_id() AS ID;

	END;
	ELSE
		SELECT -1 AS ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertGoldenTimeEvent` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertGoldenTimeEvent`(
	__TYPE TINYINT,
	__BEGIN DATE,
	__END DATE,
	__RATE INT,
	__IS_END TINYINT
)
BEGIN

	IF __BEGIN IS NOT NULL THEN
	BEGIN

		INSERT INTO pangya.pangya_golden_time_info(`type`, `begin`, `end`, rate, is_end)
		VALUES(__TYPE, __BEGIN, __END, __RATE, __IS_END);

		SELECT last_insert_id() AS ID;

	END;
	ELSE
		SELECT -1 AS ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertGoldenTimeItem` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertGoldenTimeItem`(
	__GOLDEN_TIME_ID BIGINT,
	__TYPEID INT,
	__QNTD INT,
	__QNTD_TIME INT,
	__RATE INT
)
BEGIN

	IF __GOLDEN_TIME_ID > 0 AND __TYPEID > 0 THEN
	BEGIN

		INSERT INTO pangya.pangya_golden_time_item(golden_time_id, typeid, qntd, qntd_time, rate)
		VALUES(__GOLDEN_TIME_ID, __TYPEID, __QNTD, __QNTD_TIME, __RATE);

		SELECT last_insert_id() AS ID;
	END;
	ELSE
		SELECT -1 AS ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertGoldenTimeRound` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertGoldenTimeRound`(
	__GOLDEN_TIME_ID BIGINT,
	__TIME TIME
)
BEGIN

	IF __GOLDEN_TIME_ID > 0 AND __TIME IS NOT NULL THEN
	BEGIN

		INSERT INTO pangya.pangya_golden_time_round(golden_time_id, `time`)
		VALUES(__GOLDEN_TIME_ID, __TIME);

		SELECT last_insert_id() AS ID;

	END;
	ELSE
		SELECT -1 AS ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertItemNoEmail` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertItemNoEmail`(
	__From_UID int,
	__To_UID int,
	__IDMSG int,
	__IDITEM int,
	__TYPEIDITEM int,
	__OPT smallint,
	__QNTD int,
	__QNTD_DIA int
)
BEGIN

	-- Coloca Item no Item Mail
	DECLARE __GRUPO INT;
	DECLARE __UCC_IDX VARCHAR(8) DEFAULT '0';

	-- IF __IDITEM > 0
	-- BEGIN
	-- SET __GRUPO = dbo.GroupID(__TYPEIDITEM)

	-- IF __GRUPO = 0x08 OR __GRUPO = 0x10
	-- BEGIN
	-- UPDATE pangya.pangya_item_warehouse SET [UID] = __To_UID, Gift_flag = 1 WHERE [UID] = __From_UID AND item_id = __IDITEM;
			
	--  	--UCC
	-- 		IF (SELECT item_id FROM pangya.tu_ucc WHERE [UID] = __From_UID AND item_id = __IDITEM) IS NOT NULL
	-- 		BEGIN
	-- 			UPDATE pangya.tu_ucc SET [UID] = __To_UID WHERE [UID] = __From_UID AND ITEM_ID = __IDITEM;

	-- 			SET __UCC_IDX = (SELECT UCCIDX FROM pangya.tu_ucc WHERE [UID] = __To_UID AND ITEM_ID = __IDITEM)
	-- 		END
	-- 	END
	-- 	ELSE
	-- 		SET __IDITEM = -1;
	-- END

	INSERT INTO pangya_item_mail(MSG_ID, ITEM_ID, ITEM_TYPEID, FLAG, GET_DATE, QUANTIDADE_ITEM, QUANTIDADE_DIA, VALID, UCC_IMG_MARK)
					VALUES(__IDMSG, __IDITEM, __TYPEIDITEM, __OPT, now(), __QNTD, __QNTD_DIA, 1, __UCC_IDX);

	SELECT __IDMSG as MSG_ID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertLoginRewardEvent` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertLoginRewardEvent`(
	__NAME NVARCHAR(50),
	__TYPE TINYINT,
	__DAYS_TO_GIFT INT,
	__N_TIMES_GIFT INT,
	__ITEM_TYPEID INT,
	__ITEM_QNTD INT,
	__ITEM_QNTD_TIME INT,
	__IS_END TINYINT,
	__END_DATE DATETIME
)
BEGIN

	IF __NAME != '' THEN
	BEGIN

		INSERT INTO pangya.pangya_login_reward(`name`, `type`, days_to_gift, n_times_gift, item_typeid, item_qntd, item_qntd_time, is_end, end_date)
		VALUES(__NAME, __TYPE, __DAYS_TO_GIFT, __N_TIMES_GIFT, __ITEM_TYPEID, __ITEM_QNTD, __ITEM_QNTD_TIME, __IS_END, __END_DATE);

		SELECT last_insert_id() AS ID;

	END;
	ELSE
		SELECT -1 AS ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `procInsertLoginRewardPlayer` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `procInsertLoginRewardPlayer`(
	__ID BIGINT,
	__UID INT,
	__COUNT_DAYS INT,
	__COUNT_SEQ INT,
	__IS_CLEAR TINYINT,
	__UPDATE_DATE DATETIME
)
BEGIN

	IF __ID > 0 AND __UID > 0 THEN
	BEGIN

		IF (SELECT `index` FROM pangya.pangya_login_reward WHERE `index` = __ID) IS NOT NULL THEN
		BEGIN
			INSERT INTO pangya.pangya_login_reward_player(UID, LOGIN_REWARD_ID, COUNT_DAYS, COUNT_SEQ, IS_CLEAR, UPDATE_DATE)
			VALUES(__UID, __ID, __COUNT_DAYS, __COUNT_SEQ, __IS_CLEAR, __UPDATE_DATE);

			SELECT last_insert_id() AS IDX;
		END;
        END IF;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertMascot` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertMascot`(
	__IDUSER INT,
	__ITEMTYPEID INT,
	__TIPO TINYINT,
	__ISCASH TINYINT,
	__TEMPO INT,
	__MESSAGE NVARCHAR(100),
	__PRICE INT
)
BEGIN

	DECLARE __ITEM_ID INT DEFAULT -1;

	IF __ITEMTYPEID > 0 AND (SELECT UID FROM pangya.account WHERE UID = __IDUSER) IS NOT NULL THEN
	BEGIN
		DECLARE __regDT datetime DEFAULT now();
		DECLARE __endDT datetime DEFAULT __regDT;

		SET __ITEM_ID = (SELECT item_id FROM pangya.pangya_mascot_info WHERE UID = __IDUSER AND typeid = __ITEMTYPEID AND valid = 1);

		IF __ITEM_ID > 0 AND __ITEM_ID IS NOT NULL THEN
		BEGIN
			DECLARE __diff INT DEFAULT 0;
			
			SELECT __diff = case when TIMESTAMPDIFF(SECOND, now(), EndDate) > 0 THEN 1 ELSE 0 END FROM pangya.pangya_mascot_info WHERE UID = __IDUSER AND item_id = __ITEM_ID;
			 
			UPDATE pangya.pangya_mascot_info SET Message = __MESSAGE, EndDate = TIMESTAMPADD(DAY, __TEMPO, (CASE WHEN __diff = 1 THEN EndDate ELSE now() END))
			WHERE UID = __IDUSER AND item_id = __ITEM_ID;
		END;
		ELSE
		BEGIN

			IF __TEMPO > 0 THEN
				SET __endDT = TIMESTAMPADD(DAY, __TEMPO, __regDT);
			END IF;

			INSERT INTO pangya.pangya_mascot_info(UID, typeid, valid, tipo, IsCash, RegDate, EndDate, Period, Message, Price)
				VALUES(__IDUSER, __ITEMTYPEID, 1, __TIPO, __ISCASH, __regDT, __endDT, __TEMPO, __MESSAGE, __PRICE);

			SET __ITEM_ID = last_insert_id();
		END;
		END IF;
	END;
    END IF;

	SELECT __ITEM_ID AS ITEM_ID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertMemorialRareWinLog` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertMemorialRareWinLog`(
	__IDUSER INT,
	__COIN_TYPEID INT,
	__ITEM_TYPEID INT,
	__ITEM_QNTD INT,
	__ITEM_RARIDADE INT,
	__ITEM_PROBABILIDADE INT
)
BEGIN

	IF __IDUSER > 0 AND __COIN_TYPEID > 0 AND __ITEM_TYPEID > 0 THEN
	BEGIN
		INSERT INTO pangya.pangya_new_memorial_rare_win_log(UID, coin_typeid, item_typeid, item_qntd, item_raridade, item_probabilidade, win_date)
			VALUES(__IDUSER, __COIN_TYPEID, __ITEM_TYPEID, __ITEM_QNTD, __ITEM_RARIDADE, __ITEM_PROBABILIDADE, now());
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertMemorialShopItemRareWin` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertMemorialShopItemRareWin`(
	__IDUSER int,
	__ITEMTYPEID int
)
BEGIN

	INSERT pangya.memorialshopitemrarewin(pangya.memorialshopitemrarewin.UID, pangya.memorialshopitemrarewin.TYPEID, pangya.memorialshopitemrarewin.REG_DATE)
         VALUES (__IDUSER, __ITEMTYPEID, ifnull(now(), now()));
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertNewAchievement` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertNewAchievement`(
	__IDUSER INT,
	__NOME BINARY(200),
	__TYPEID INT,
	/*__QUEST_TYPEID INT,
	__COUNTERITEM_TYPEID INT,*/
	__ACTIVE INT,
	__STATUS INT
)
BEGIN

	IF __TYPEID != 0 THEN
	BEGIN
		INSERT INTO pangya.pangya_achievement(UID, Nome, TypeID, `active`, `status`) VALUES(__IDUSER, __NOME, __TYPEID, /*__QUEST_TYPEID, __COUNTERITEM_ID,*/ __ACTIVE, __STATUS);

		SELECT last_insert_id() AS ID_ACHIEVEMENT;
	END;
	ELSE
		SELECT -1 AS ID_ACHIEVEMENT;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertNewQuest` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertNewQuest`(
	__IDUSER int,
	__NOME BINARY(200),
	__ID_ACHIEVEMENT int,
	__QUEST_TYPEID int,
	__COUNTERITEM_TYPEID int
)
BEGIN

	IF __ID_ACHIEVEMENT != 0 AND __QUEST_TYPEID != 0 THEN
	BEGIN
		DECLARE __COUNTERITEM_ID int DEFAULT 0;

		IF __COUNTERITEM_TYPEID != 0 THEN
		BEGIN
			INSERT INTO pangya.pangya_counter_item(UID, TypeID, `active`, Count_Num_Item) VALUES(__IDUSER, __COUNTERITEM_TYPEID, 1, 0);

			SET __COUNTERITEM_ID = last_insert_id();
		END;
        END IF;

		INSERT INTO pangya.pangya_quest(achievement_id, uid, `name`, typeid, counter_item_id, `Date`) VALUES(__ID_ACHIEVEMENT, __IDUSER, __NOME, __QUEST_TYPEID, __COUNTERITEM_ID, NULL);

		SELECT id, counter_item_id FROM pangya.pangya_quest WHERE id = last_insert_id();
	END;
	ELSE
		SELECT -1 AS ID, 0 AS COUNTER_ITEM_ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertNewTicketReport` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertNewTicketReport`(
	__typeid_trofel int,
	__tipo_ticker_report int
)
BEGIN

	INSERT pangya.pangya_ticket_report(trofel_typeid, flag, reg_date, tipo)
         VALUES (__typeid_trofel, 0, now(), __tipo_ticker_report);

      SELECT last_insert_id() AS ticket_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertPapelShopRareWinLog` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertPapelShopRareWinLog`(
	__IDUSER INT,
	__ITEM_TYPEID INT,
	__ITEM_QNTD INT,
	__COLOR INT,
	__PROBABILIDADE INT
)
BEGIN

	IF __IDUSER > 0 THEN
	BEGIN
		INSERT INTO pangya_papel_shop_rare_win_log(UID, typeid, qntd, ball_color, probabilidade)
			VALUES(__IDUSER, __ITEM_TYPEID, __ITEM_QNTD, __COLOR, __PROBABILIDADE);
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertPersonalShopLog` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertPersonalShopLog`(
	__UID_SELL INT,
	__UID_BUY INT,
	__ITEM_TYPEID INT,
	__ITEM_ID_SELL INT,
	__ITEM_ID_BUY INT,
	__ITEM_QNTD INT,
	__ITEM_PANG BIGINT,
	__TOTAL_PANG BIGINT
)
BEGIN

	IF __UID_SELL > 0 AND __UID_BUY > 0 THEN
	BEGIN
		INSERT INTO pangya.pangya_personal_shop_log(player_sell_uid, player_buy_uid, item_typeid, item_id_sell, item_id_buy, item_qntd, item_pang, total_pang, reg_date)
			VALUES(__UID_SELL, __UID_BUY, __ITEM_TYPEID, __ITEM_ID_SELL, __ITEM_ID_BUY, __ITEM_QNTD, __ITEM_PANG, __TOTAL_PANG, now());
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertRecordPlayerCourse` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertRecordPlayerCourse`(
	__IDUSER int,
	__tipo_in int,
	__course_in int,
	__tacada_in int,
	__putt_in int,
	__hole_in int,
	__fairway_in int,
	__holein_in int,
	__puttin_in int,
	__best_score_in int,
	__best_pang_in bigint,
	__character_typeid_in int,
	__assist_in smallint,
	__event_score_in int,
	__flag int
)
BEGIN

	DECLARE
         __TipoRet int DEFAULT 0;

      IF 
         (
            SELECT pangya_record.course
            FROM pangya.pangya_record
            WHERE 
               pangya_record.UID = __IDUSER AND 
               pangya_record.course = __course_in AND 
               pangya_record.tipo = __tipo_in AND 
               pangya_record.assist = __assist_in
         ) IS NULL THEN
         INSERT pangya.pangya_record(pangya.pangya_record.UID, pangya.pangya_record.course, pangya.pangya_record.tipo, pangya.pangya_record.assist)
            VALUES (__IDUSER, __course_in, __tipo_in, __assist_in);
	END IF;

      IF __flag = 1 THEN
         BEGIN

            SET __TipoRet = 
               (
                  SELECT 
                     CASE 
                        WHEN (pangya_record.best_score = 127 OR pangya_record.best_score > __best_score_in) OR pangya_record.best_pang < __best_pang_in THEN 1
                        ELSE 0
                     END
                  FROM pangya.pangya_record
                  WHERE 
                     pangya_record.UID = __IDUSER AND 
                     pangya_record.course = __course_in AND 
                     pangya_record.tipo = __tipo_in AND 
                     pangya_record.assist = __assist_in
               );

            IF __TipoRet = 1 THEN
               UPDATE pangya.user_info
                  SET 
                     pang = user_info.Pang + 1000
               WHERE user_info.UID = __IDUSER;
			END IF;

            UPDATE pangya.pangya_record
               SET 
                  best_score = 
                     CASE 
                        WHEN (pangya_record.best_score = 127 OR pangya_record.best_score > __best_score_in) THEN __best_score_in
                        ELSE pangya_record.best_score
                     END, 
                  best_pang = 
                     CASE 
                        WHEN pangya_record.best_pang < __best_pang_in THEN __best_pang_in
                        ELSE pangya_record.best_pang
                     END, 
                  character_typeid = 
                     CASE 
                        WHEN __TipoRet = 1 THEN __character_typeid_in
                        ELSE pangya_record.character_typeid
                     END
            WHERE 
               pangya_record.UID = __IDUSER AND 
               pangya_record.course = __course_in AND 
               pangya_record.tipo = __tipo_in AND 
               pangya_record.assist = __assist_in;

         END;
         END IF;

      UPDATE pangya.pangya_record
         SET 
            tacada = pangya_record.tacada + __tacada_in, 
            putt = pangya_record.putt + __putt_in, 
            hole = pangya_record.hole + __hole_in, 
            fairway = pangya_record.fairway + __fairway_in, 
            holein = pangya_record.holein + __holein_in, 
            puttin = pangya_record.puttin + __puttin_in, 
            total_score = pangya_record.total_score + __best_score_in, 
            event_score = __event_score_in
      WHERE 
         pangya_record.UID = __IDUSER AND 
         pangya_record.course = __course_in AND 
         pangya_record.tipo = __tipo_in AND 
         pangya_record.assist = __assist_in;

      SELECT __TipoRet AS record;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertRewardToDonate` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertRewardToDonate`(
	__IDUSER INT,
	__CP INT
)
BEGIN

	DECLARE __MSGID INT DEFAULT 0;

	INSERT INTO pangya.pangya_gift_table(UID, fromid, message, giftdate, Lida_YN, valid, Flag, Contador_Vista)
		VALUES(__IDUSER, '@SUPERSS', CONCAT('Obrigado pela sua docao(donate), aqui vai uns premios para voce. E mais ', __CP, 'CP'),
			now(), 0, 1, 0, 0);

	SET __MSGID = last_insert_id();

	IF __MSGID > 0 THEN
	BEGIN

		DECLARE __item_id int DEFAULT -1;

		CALL pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, __item_id, 2080374803, 0, 1, 0);
		CALL pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, __item_id, 2084569107, 0, 1, 0);
		CALL pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, __item_id, 2084569113, 0, 1, 0);
		CALL pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, __item_id, 1879113856, 0, 1, 0);
		CALL pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, __item_id, 268435541, 0, 1, 0);

		CALL pangya.ProcInsertCommand(4, __IDUSER, __MSGID, 0, 0, 0, 1, 0, 1, null);

		UPDATE pangya.user_info SET Cookie = Cookie + __CP WHERE UID = __IDUSER;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertSkin` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertSkin`(
	__IDUSER INT,
	__ITEMTYPEID INT,
	__FLAG TINYINT,
	__GIFTFLAG TINYINT,
	__PURCHASE TINYINT,
	__TEMPO INT
)
BEGIN

	DECLARE __ITEM_ID INT DEFAULT -1;

	IF __ITEMTYPEID > 0 AND (SELECT UID FROM pangya.account WHERE UID = __IDUSER) IS NOT NULL THEN
	BEGIN

		DECLARE __regDT datetime DEFAULT now();
		DECLARE __endDT datetime DEFAULT __regDT;
        
        SET __ITEM_ID = IFNULL((SELECT item_id FROM pangya.pangya_item_warehouse WHERE UID = __IDUSER AND typeid = __ITEMTYPEID AND valid = 1), -1);

		IF __ITEM_ID > 0 AND __ITEM_ID IS NOT NULL THEN
		BEGIN
			DECLARE __diff INT DEFAULT 0;

			SELECT __diff = case when TIMESTAMPDIFF(SECOND, now(), EndDate) > 0 THEN 1 ELSE 0 END FROM pangya.pangya_item_warehouse WHERE UID = __IDUSER AND item_id = __ITEM_ID;

			UPDATE pangya.pangya_item_warehouse SET EndDate = TIMESTAMPADD(DAY, __TEMPO, (case when __diff = 1 THEN EndDate ELSE now() END)), C3 = C3 + __TEMPO
			WHERE UID = __IDUSER AND item_id = __ITEM_ID ;
		END;
		ELSE
		BEGIN
			IF __TEMPO > 0 THEN
				SET __endDT = TIMESTAMPADD(DAY, __TEMPO, now());
			END IF;

			INSERT INTO pangya_item_warehouse(UID, typeid, valid, flag, Gift_flag, Purchase, ItemType, c3, regdate, EndDate)
				VALUES(__IDUSER, __ITEMTYPEID, 1, __FLAG, __GIFTFLAG, __PURCHASE, 2, __TEMPO, __regDT, __endDT);

			SET __ITEM_ID = last_insert_id();
		END;
        END IF;
	END;
    END IF;

	SELECT __ITEM_ID AS ITEM_ID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertSpinningCubeSuperRareWinBroadcast` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertSpinningCubeSuperRareWinBroadcast`(
	__MSG NVARCHAR(200),
	__OPT TINYINT
)
BEGIN

	DECLARE __NOTICE_ID INT DEFAULT -1;

	INSERT pangya.pangya_notice_list(message) VALUES(__MSG);

    SET __NOTICE_ID = last_insert_id();

    INSERT pangya.pangya_command(command_id, arg1, arg2, target)
        VALUES (2, __NOTICE_ID, __OPT, 1);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcInsertTicketReportDados` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcInsertTicketReportDados`(
	__ticker_id int,
	__player_uid_in int,
	__player_score_in smallint,
	__player_medalha_in smallint,
	__player_trofel_in smallint,
	__player_pang_in bigint,
	__player_bonus_pang_in bigint,
	__player_exp_in int,
	__player_mascot_typeid_in int,
	__flag_item_pang_in smallint,
	__flag_premium_user_in smallint,
	__player_state_in smallint,
	__player_finish_date datetime
)
BEGIN

	INSERT pangya.pangya_ticket_report_dados(report_id, player_uid, player_score, player_medalha, player_trofel, player_pang, 
         player_bonus_pang, player_exp, player_mascot_typeid, player_state, flag_item_pang, flag_premium_user, finish_date)
      VALUES (__ticker_id, __player_uid_in, __player_score_in, __player_medalha_in, __player_trofel_in, __player_pang_in, __player_bonus_pang_in, 
            __player_exp_in, __player_mascot_typeid_in, __player_state_in, __flag_item_pang_in, __flag_premium_user_in, __player_finish_date);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcMakeEmailKey` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcMakeEmailKey`(
	__NOME NVARCHAR(50),
	__SOBRENOME NVARCHAR(100),
	__EMAIL NVARCHAR(100),
	__IP NVARCHAR(20)
)
BEGIN

	IF __NOME IS NOT NULL AND __SOBRENOME IS NOT NULL AND __EMAIL IS NOT NULL THEN
	BEGIN

		DECLARE __id BIGINT DEFAULT -1;

		INSERT INTO pangya.contas_beta(nome, sobre_nome, email, ip_register, key_uniq) VALUES(__NOME, __SOBRENOME, __EMAIL, __IP, uuid());
		
		SET __id = last_insert_id();

		SELECT `index`, key_uniq FROM pangya.contas_beta WHERE `index` = __id;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcMakeGuild` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcMakeGuild`(
	__NAME NVARCHAR(20),
	__MASTER INT,
	__CONDITION_LEVEL SMALLINT,
	__INTRO NVARCHAR(50),
	__MASTER_COMMENT NVARCHAR(50)
)
BEGIN

	DECLARE __GUILD_UID INT DEFAULT -1;
	
	IF __NAME != '' AND __MASTER != 0 THEN
	BEGIN

		DECLARE __OTHER_GUILD INT DEFAULT (
			SELECT
				a.Guild_UID
			FROM
				pangya.account a
				INNER JOIN
				pangya.pangya_guild b
				ON a.Guild_UID = b.GUILD_UID
			WHERE a.UID = __MASTER AND 
				(b.GUILD_STATE NOT IN(4, 5) OR b.GUILD_CLOSURE_DATE IS NULL OR now() < b.GUILD_CLOSURE_DATE)
		);

		IF __OTHER_GUILD IS NULL THEN
		BEGIN

			IF TIMESTAMPDIFF(HOUR, IFNULL((SELECT MAX(REG_DATE) FROM pangya.pangya_guild_atividade_player WHERE UID = __MASTER AND FLAG = 8/*Create*/), TIMESTAMPADD(DAY, -1, now())), now()) >= 24/*1 Dia*/ THEN
			BEGIN

				DECLARE __PANG BIGINT DEFAULT (SELECT pang FROM pangya.user_info WHERE UID = __MASTER);
		
				-- Verifica se o player tem os 5k de pangs para criar a guild
				IF __PANG IS NOT NULL AND __PANG >= 5000 THEN
				BEGIN

					-- Delete ele de qualquer membro de guild que ele esteja, que o OTHER_GUILD é null, se ele estava em uma guild, ela já está fechada
					DELETE FROM pangya.pangya_guild_member WHERE MEMBER_UID = __MASTER;

					-- Cria a Guild
					INSERT INTO pangya.pangya_guild(GUILD_NAME, GUILD_LEADER, GUILD_CONDITION_LEVEL, GUILD_INFO, GUILD_NOTICE, GUILD_NEW_MARK_IDX) 
					VALUES(__NAME, __MASTER, __CONDITION_LEVEL, __INTRO, __MASTER_COMMENT, 1);

					SET __GUILD_UID = last_insert_id();

					-- Insert Member of guild
					INSERT INTO pangya.pangya_guild_member(GUILD_UID, MEMBER_UID, MEMBER_STATE_FLAG) VALUES(__GUILD_UID, __MASTER, 1/*Master*/);

					-- Update player account  GUILD_UID
					UPDATE
						pangya.account
							SET Guild_UID = __GUILD_UID
					WHERE UID = __MASTER;

					-- Insert Log Activety of player guild
					INSERT INTO pangya.pangya_guild_atividade_player(GUILD_UID, UID, FLAG) VALUES(__GUILD_UID, __MASTER, 8/*Criou uma Guild*/);

					-- Tira os 5k de pang que gastou para criar a guild
					UPDATE
						pangya.user_info
							SET pang = __PANG - 5000
					WHERE UID = __MASTER;

					-- Sucesso
					SELECT GUILD_UID, GUILD_NEW_MARK_IDX FROM pangya.pangya_guild WHERE GUILD_UID = __GUILD_UID;

				END;
				ELSE
					SET __GUILD_UID = -3;	-- Não tem pangs suficiente para criar a guild
				END IF;

			END;
			ELSE
				SET __GUILD_UID = -2;	-- Não pode criar a guild, faz menos de 24 horas que ele criou outra guild
			END IF;

		END;
		ELSE
			SET __GUILD_UID = -4;	-- Player já é membro de outra guild, saia dela para poder criar outra guild
		END IF;

	END;
    END IF;

	SELECT __GUILD_UID AS GUILD_UID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcMakeUserBeta` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcMakeUserBeta`(
	__nome_in nvarchar(45),
	__sobre_nome_in nvarchar(100),
	__email_in nvarchar(100),
	__id_in nvarchar(30),
	__pass_in nvarchar(40),
	__ip_in nvarchar(20)
)
BEGIN

	DECLARE __IDUSER int DEFAULT 0;

      CALL pangya.ProcNewUser(__id_in, __pass_in, __ip_in, 0);

      SELECT account.UID INTO __IDUSER
      FROM pangya.account
      WHERE account.ID = __id_in;

      INSERT pangya.contas_beta(pangya.contas_beta.uid, pangya.contas_beta.nome, pangya.contas_beta.sobre_nome, pangya.contas_beta.email, key_uniq)
         VALUES (__IDUSER, __nome_in, __sobre_nome_in, __email_in, uuid());

      INSERT pangya.pangya_player_ip(pangya.pangya_player_ip.uid, pangya.pangya_player_ip.ip)
         VALUES (__IDUSER, __ip_in);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcMakeUserBetaWithMD5` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcMakeUserBetaWithMD5`(
	__id_in nvarchar(30),
	__pass_in nvarchar(40),
	__index nvarchar(100),
	__sex tinyint,
	__ip_in nvarchar(20)
)
BEGIN

	DECLARE __IDUSER int DEFAULT 0;

	IF (SELECT key_uniq FROM pangya.contas_beta WHERE `index` = __index AND finish_reg = 0) IS NOT NULL THEN
	BEGIN

		CALL pangya.ProcNewUserWithMD5(__id_in, __pass_in, __sex, __ip_in, 0);

		SELECT account.UID INTO __IDUSER
		FROM pangya.account
		WHERE account.ID = __id_in;

		UPDATE pangya.contas_beta SET UID = __IDUSER, ip_register = __ip_in, finish_reg = 1 WHERE `index` = __index;

		INSERT pangya.pangya_player_ip(pangya.pangya_player_ip.uid, pangya.pangya_player_ip.ip)
			VALUES (__IDUSER, __ip_in);

		SELECT __IDUSER AS UID;
	END;
	ELSE
		SELECT -1 AS UID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcMoveItemDolfiniLocker` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcMoveItemDolfiniLocker`(
	__IDUSER INT,
	__IDX_LOCKER BIGINT
)
BEGIN

	UPDATE pangya.pangya_item_warehouse a
		INNER JOIN pangya.pangya_dolfini_locker_item b
		ON a.item_id = b.item_id AND b.idx = __IDX_LOCKER
			SET a.valid = 1
	WHERE a.UID = __IDUSER;

	UPDATE pangya.pangya_dolfini_locker_item SET flag = 0 WHERE UID = __IDUSER AND idx = __IDX_LOCKER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcMoveItemFromMailToArmario` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcMoveItemFromMailToArmario`(
	__IDUSER int,
	__IDMSG int
)
BEGIN

	SELECT pangya_item_mail.item_id AS ITEM_ID, pangya_item_mail.item_typeid AS TYPEID, pangya_item_mail.Quantidade_item AS QUANTIDADE, pangya_item_mail.Quantidade_Dia AS QNTD_DIA
      FROM pangya.pangya_item_mail
      WHERE pangya_item_mail.Msg_ID = __IDMSG AND pangya_item_mail.valid = 1;

      UPDATE pangya.pangya_gift_table
         SET 
            Lida_YN = 1
      WHERE pangya_gift_table.UID = __IDUSER AND pangya_gift_table.Msg_ID = __IDMSG;

      UPDATE pangya.pangya_item_mail
         SET 
            valid = 0
      WHERE pangya_item_mail.Msg_ID = __IDMSG;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcNewUser` */;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcNewUser`(
	__userID NVARCHAR(22),
	__pass VARCHAR(32),
	__IPaddr VARCHAR(20),
	__serverUID INT
)
BEGIN

	DECLARE __IDUSER INT DEFAULT 0;
	DECLARE __PASSWORD_MD5 NVARCHAR(32);

	SET __PASSWORD_MD5 = upper(md5(__pass));
	
	INSERT INTO account(ID, `PASSWORD`, LastLogonTime, RegDate, NICK, UserName, UserIp, ServerID, LogonCount)
	VALUES(__userID, __PASSWORD_MD5, now(), now(), __userID, __userID, __IPaddr, __serverUID, 1);
	
    SET __IDUSER = last_insert_id(); -- #novo e melhor modo de pegar o uid do player adicionado
    -- #SELECT UID INTO IDUSER FROM account WHERE ID = userID;
    
    INSERT INTO user_info(UID) VALUES(__IDUSER);

	INSERT INTO pangya_player_location(UID) VALUES(__IDUSER);

	INSERT INTO pangya_user_equip(UID) VALUES(__IDUSER);

	INSERT INTO pangya_last_players_user(UID) VALUES(__IDUSER);

	INSERT INTO trofel_stat(UID) VALUES(__IDUSER);

	INSERT INTO tutorial(UID) VALUES(__IDUSER);

	INSERT INTO pangya_user_macro(UID) VALUES(__IDUSER);

	INSERT INTO pangya_attendance_reward(UID) VALUES(__IDUSER);

	INSERT INTO pangya_scratchy_prob_sec(UID) VALUES(__IDUSER);

	INSERT INTO black_papel_prob_sec(UID) VALUES(__IDUSER);

	INSERT INTO pangya_tiki_points(UID) VALUES(__IDUSER);

	INSERT INTO pangya_myroom(UID) VALUES(__IDUSER);

	INSERT INTO pangya_dolfini_locker(UID) VALUES(__IDUSER);
    
    INSERT INTO pangya_assistente(UID) VALUES(__IDUSER);
    
    INSERT INTO pangya_grand_zodiac_pontos(UID) VALUES(__IDUSER);
    
    INSERT INTO pangya_daily_quest_player(UID, LAST_QUEST_ACCEPT, TODAY_QUEST) VALUES(__IDUSER, NULL, NULL);

	INSERT INTO pangya_papel_shop_info(UID, remain_cnt, limit_cnt) VALUES(__IDUSER, 100, 100);

	INSERT INTO td_room_data(UID, TYPEID, POS_X, POS_Y, POS_Z, POS_R)
	VALUES(__IDUSER, 1207986208, 15.2, 0, 12.5, 152);
	
	INSERT INTO td_room_data(UID, TYPEID, POS_X, POS_Y, POS_Z, POS_R)
	VALUES(__IDUSER, 1207980061, 14.125, 1.0, 0.041, 0);
	
	-- Cria Achievement Dados do usuario Não mais
	-- exec pangya.USP_CreateAchievementUser __IDUSER;

	SELECT __IDUSER as UID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcNewUserWithMD5` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcNewUserWithMD5`(
	__userID VARCHAR(22),
	__pass VARCHAR(32),
	__sex tinyint,
	__IPaddr VARCHAR(20),
	__serverUID INT
)
BEGIN

	DECLARE __IDUSER INT DEFAULT 0;
	DECLARE __PASSWORD_MD5 NVARCHAR(32);

	-- SET __PASSWORD_MD5 = upper(md5(rand()));
	
	INSERT INTO account(ID, `PASSWORD`, Sex, LastLogonTime, RegDate, NICK, UserName, UserIp, ServerID, LogonCount)
	VALUES(__userID, __pass, __sex, now(), now(), __userID, __userID, __IPaddr, __serverUID, 1);
	
    SET __IDUSER = last_insert_id(); -- #novo e melhor modo de pegar o uid do player adicionado
    -- #SELECT UID INTO IDUSER FROM account WHERE ID = userID;
    
    INSERT INTO user_info(UID) VALUES(__IDUSER);

	INSERT INTO pangya_player_location(UID) VALUES(__IDUSER);

	INSERT INTO pangya_user_equip(UID) VALUES(__IDUSER);

	INSERT INTO pangya_last_players_user(UID) VALUES(__IDUSER);

	INSERT INTO trofel_stat(UID) VALUES(__IDUSER);

	INSERT INTO tutorial(UID) VALUES(__IDUSER);

	INSERT INTO pangya_user_macro(UID) VALUES(__IDUSER);

	INSERT INTO pangya_attendance_reward(UID) VALUES(__IDUSER);

	INSERT INTO pangya_scratchy_prob_sec(UID) VALUES(__IDUSER);

	INSERT INTO black_papel_prob_sec(UID) VALUES(__IDUSER);

	INSERT INTO pangya_tiki_points(UID) VALUES(__IDUSER);

	INSERT INTO pangya_myroom(UID) VALUES(__IDUSER);

	INSERT INTO pangya_dolfini_locker(UID) VALUES(__IDUSER);
    
    INSERT INTO pangya_assistente(UID) VALUES(__IDUSER);
    
    INSERT INTO pangya_grand_zodiac_pontos(UID) VALUES(__IDUSER);
    
    INSERT INTO pangya_daily_quest_player(UID, LAST_QUEST_ACCEPT, TODAY_QUEST) VALUES(__IDUSER, NULL, NULL);

	INSERT INTO pangya_papel_shop_info(UID, remain_cnt, limit_cnt) VALUES(__IDUSER, 100, 100);

	INSERT INTO td_room_data(UID, TYPEID, POS_X, POS_Y, POS_Z, POS_R)
	VALUES(__IDUSER, 1207986208, 15.2, 0, 12.5, 152);
	
	INSERT INTO td_room_data(UID, TYPEID, POS_X, POS_Y, POS_Z, POS_R)
	VALUES(__IDUSER, 1207980061, 14.125, 1.0, 0.041, 0);
	
	-- Cria Achievement Dados do usuario Não mais
	-- exec pangya.USP_CreateAchievementUser __IDUSER;

	SELECT __IDUSER as UID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcPedeParaEntraGuild` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcPedeParaEntraGuild`(
	__IDUSER int,
	__UID_GUILD int,
	__MSG nvarchar(50)
)
BEGIN

	IF (1 <> 1) THEN
         BEGIN

            INSERT pangya.pangya_guild_member(
               pangya.pangya_guild_member.GUILD_UID, 
               pangya.pangya_guild_member.MEMBER_UID, 
               pangya.pangya_guild_member.MEMBER_MSG, 
               pangya.pangya_guild_member.MEMBER_STATE_FLAG, 
               pangya.pangya_guild_member.GUILD_PANG, 
               pangya.pangya_guild_member.GUILD_POINT)
               VALUES (
                  __UID_GUILD, 
                  __IDUSER, 
                  __MSG, 
                  9, 
                  0, 
                  0);

            INSERT pangya.pangya_guild_atividade_player(pangya.pangya_guild_atividade_player.UID, pangya.pangya_guild_atividade_player.GUILD_UID, pangya.pangya_guild_atividade_player.FLAG)
               VALUES (__IDUSER, __UID_GUILD, 1);

            UPDATE pangya.account
               SET 
                  GUILD_UID = __UID_GUILD
            WHERE account.UID = __IDUSER;

         END;
      ELSE 
         SET __UID_GUILD = -1;
	END IF;

      SELECT __UID_GUILD AS GUILD_UID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcRecoveryClubSet` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcRecoveryClubSet`(
	__IDUSER int,
	__taqueira_id int
)
BEGIN

	UPDATE pangya.pangya_item_warehouse
         SET 
            Recovery_Pts = 0
      WHERE pangya_item_warehouse.UID = __IDUSER AND pangya_item_warehouse.item_id = __taqueira_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcRegisterDonation` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcRegisterDonation`(
	__ADM_UID INT,
	__IDUSER INT,
	__PLATAFORMA TINYINT,
	__CASH INT,
	__EMAIL NVARCHAR(100),
	__OBS NVARCHAR(500),
	__ITEM_TYPEID_1 INT,
	__ITEM_TYPEID_2 INT,
	__ITEM_TYPEID_3 INT,
	__ITEM_TYPEID_4 INT,
	__ITEM_TYPEID_5 INT,
	__ITEM_QNTD_1 INT,
	__ITEM_QNTD_2 INT,
	__ITEM_QNTD_3 INT,
	__ITEM_QNTD_4 INT,
	__ITEM_QNTD_5 INT
)
BEGIN

	IF __IDUSER > 0 AND __CASH > 0 THEN
	BEGIN
		
		DECLARE __CP INT DEFAULT __CASH * 10;
		DECLARE __DONATION_ID INT;
		DECLARE __MSGID INT;

		INSERT INTO pangya.pangya_donation_log(ADM_UID, UID, plataforma, cash, cookie_point, email, obs)
			VALUES(__ADM_UID, __IDUSER, __PLATAFORMA, __CASH, __CP, __EMAIL, __OBS);

		SET __DONATION_ID = last_insert_id();

		-- UPDATE COOKIE POINT
		UPDATE pangya.user_info SET Cookie = Cookie + __CP WHERE UID = __IDUSER;

		IF (__ITEM_TYPEID_1 != 0 AND __ITEM_QNTD_1 > 0) 
			OR (__ITEM_TYPEID_2 != 0 AND __ITEM_QNTD_2 > 0) 
			OR (__ITEM_TYPEID_3 != 0 AND __ITEM_QNTD_3 > 0) 
			OR (__ITEM_TYPEID_4 != 0 AND __ITEM_QNTD_4 > 0) 
			OR (__ITEM_TYPEID_5 != 0 AND __ITEM_QNTD_5 > 0) THEN
		BEGIN
			
			INSERT INTO pangya.pangya_gift_table(UID, fromid, message, giftdate, Lida_YN, valid, Flag, Contador_Vista)
			VALUES(__IDUSER, '@SUPERSS', CONCAT('\\cFF09A02A,t\\cObrigado pela sua docao(donate), aqui vai uns premios para voce. E mais ', __CP, 'CP'),
				now(), 0, 1, 0, 0);

			SET __MSGID = last_insert_id();

			IF __MSGID > 0 THEN
			BEGIN

				DECLARE __item_id int DEFAULT -1;

				IF (__ITEM_TYPEID_1 != 0 AND __ITEM_QNTD_1 > 0) THEN
				BEGIN
					INSERT INTO pangya.pangya_donation_item_log(donation_id, item_typeid, item_qntd) VALUES(__DONATION_ID, __ITEM_TYPEID_1, __ITEM_QNTD_1);

					CALL pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, __item_id, __ITEM_TYPEID_1, 0, __ITEM_QNTD_1, 0);
				END;
                END IF;

				IF (__ITEM_TYPEID_2 != 0 AND __ITEM_QNTD_2 > 0) THEN
				BEGIN
					INSERT INTO pangya.pangya_donation_item_log(donation_id, item_typeid, item_qntd) VALUES(__DONATION_ID, __ITEM_TYPEID_2, __ITEM_QNTD_2);

					CALL pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, __item_id, __ITEM_TYPEID_2, 0, __ITEM_QNTD_2, 0);
				END;
                END IF;

				IF (__ITEM_TYPEID_3 != 0 AND __ITEM_QNTD_3 > 0) THEN
				BEGIN
					INSERT INTO pangya.pangya_donation_item_log(donation_id, item_typeid, item_qntd) VALUES(__DONATION_ID, __ITEM_TYPEID_3, __ITEM_QNTD_3);

					CALL pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, __item_id, __ITEM_TYPEID_3, 0, __ITEM_QNTD_3, 0);
				END;
                END IF;

				IF (__ITEM_TYPEID_4 != 0 AND __ITEM_QNTD_4 > 0) THEN
				BEGIN
					INSERT INTO pangya.pangya_donation_item_log(donation_id, item_typeid, item_qntd) VALUES(__DONATION_ID, __ITEM_TYPEID_4, __ITEM_QNTD_4);

					CALL pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, __item_id, __ITEM_TYPEID_4, 0, __ITEM_QNTD_4, 0);
				END;
                END IF;

				IF (__ITEM_TYPEID_5 != 0 AND __ITEM_QNTD_5 > 0) THEN
				BEGIN
					INSERT INTO pangya.pangya_donation_item_log(donation_id, item_typeid, item_qntd) VALUES(__DONATION_ID, __ITEM_TYPEID_5, __ITEM_QNTD_5);

					CALL pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, __item_id, __ITEM_TYPEID_5, 0, __ITEM_QNTD_5, 0);
				END;
                END IF;

				-- Comando para mostrar no jogo que o player recebeu um presente
				CALL pangya.ProcInsertCommand(4, __IDUSER, __MSGID, 0, 0, 0, 1, 0, 1, null);

			END; -- IF MSG IS IS OK
            END IF;
		
		END; -- IF CHECK ITENS IS OK TO SEND
		ELSE
		BEGIN
			
			-- Não tem itens para enviar só invia uma mensagem
			INSERT INTO pangya.pangya_gift_table(UID, fromid, message, giftdate, Lida_YN, valid, Flag, Contador_Vista)
			VALUES(__IDUSER, '@SUPERSS', CONCAT(N'\\cFF09A02A,t\\cObrigado pela sua docao(donate) foi adiconado a sua conta ', __CP, 'CP'),
				now(), 0, 1, 0, 0);

			SET __MSGID = last_insert_id();

			IF __MSGID > 0 THEN
			BEGIN
				-- Comando para mostrar no jogo que o player recebeu um presente
				CALL pangya.ProcInsertCommand(4, __IDUSER, __MSGID, 0, 0, 0, 1, 0, 1, null);
			END;
            END IF;

		END;	-- ELSE CHECK ITENS IS OK TO SEND
        END IF;

	END; -- IFF CHECK UID AND CASH
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcRegisterDonationEpin` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcRegisterDonationEpin`(
	__DONATION_ID BIGINT,
	__UID INT,
	__VALUE BIGINT
)
BEGIN

	IF __DONATION_ID > 0 AND __UID > 0 THEN
	BEGIN
    
		DECLARE __ID BIGINT DEFAULT -1;

		INSERT INTO pangya.pangya_donation_epin(donation_id, uid, qntd, valid, epin)
		VALUES(__DONATION_ID, __UID, __VALUE, 1, uuid());

		SET __ID = last_insert_id();

		SELECT 
			a.`index` AS ID, 
			a.epin,
			b.email
		FROM
			pangya.pangya_donation_epin a
			INNER JOIN
			pangya.contas_beta b
			ON a.UID = b.UID
		WHERE
			a.`index` = __ID;

	END;
	ELSE
		SELECT -1 AS ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcRegisterGachaJPPlayerWin` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcRegisterGachaJPPlayerWin`(
	__UID INT,
	__COUNT_ITEM INT,
	__STR VARCHAR(8000)
)
BEGIN

	IF __UID > 0 AND __COUNT_ITEM > 0 AND __STR IS NOT NULL AND __STR != '' THEN
	BEGIN
		
		DECLARE __FIRSTID BIGINT DEFAULT -1;
		DECLARE __ITEM VARCHAR(500);
		DECLARE __ITEM_TYPEID INT;
		DECLARE __ITEM_QNTD INT;
		DECLARE __ITEM_RARITY INT;
		DECLARE __ITEM_GACHA_NUM INT;
		DECLARE __ITEM_COUNT INT DEFAULT 0;
		DECLARE __ITEM_ID INT DEFAULT -1;
        DECLARE __FINISHED BOOL DEFAULT TRUE;
        
        DECLARE CCI INT Default 0;
                
		lpItens: LOOP
			
			SET CCI = CCI + 1;
			
			SET __ITEM = SPLIT_STR(__STR, "|", CCI);
			
			IF __ITEM = '' THEN
				LEAVE lpItens;
			END IF;
            
            SET __ITEM_TYPEID = SUBSTRING_INDEX(SUBSTRING_INDEX(__ITEM,';', 1), ';',-1);
			SET __ITEM_QNTD = SUBSTRING_INDEX(SUBSTRING_INDEX(__ITEM,';', 2), ';',-1);
			SET __ITEM_RARITY = SUBSTRING_INDEX(SUBSTRING_INDEX(__ITEM,';', 3), ';',-1);
			SET __ITEM_GACHA_NUM = SUBSTRING_INDEX(SUBSTRING_INDEX(__ITEM,';', 4), ';',-1);

			IF __ITEM_TYPEID IS NOT NULL AND __ITEM_QNTD IS NOT NULL AND __ITEM_RARITY IS NOT NULL AND __ITEM_GACHA_NUM IS NOT NULL THEN
			BEGIN
						
				INSERT INTO pangya.pangya_gacha_jp_player_win(UID, typeid, qnty, rarity_type, gacha_num, valid, send_mail)
				VALUES(__UID, __ITEM_TYPEID, __ITEM_QNTD, __ITEM_RARITY, __ITEM_GACHA_NUM, 0, 0); -- Ativo depois se der tudo certo
				
				IF __FIRSTID = -1 THEN
					SET __FIRSTID = last_insert_id();
				END IF;

				-- Itens inseridos no mail
				SET __ITEM_COUNT = __ITEM_COUNT + 1;
			END;
			END IF;
			
		END LOOP lpItens;

		-- Verifica se foi os itens tudo OK
		IF __COUNT_ITEM = __ITEM_COUNT AND __COUNT_ITEM = (SELECT COUNT(`index`) FROM pangya.pangya_gacha_jp_player_win WHERE UID = __UID AND `index` >= __FIRSTID) THEN
		BEGIN
			
			-- Tudo ok adiciona libera os itens
			UPDATE pangya.pangya_gacha_jp_player_win SET valid = 1 WHERE UID = __UID AND valid = 0 AND `index` >= __FIRSTID;

			-- Retorna o primeiro ID do ITEM
			SELECT __FIRSTID AS FIRST_ID;

		END;
		ELSE
		BEGIN

			-- Deleta todos os que adicionou que não conseguiu adicionar o itens do player
			DELETE FROM pangya.pangya_gacha_jp_player_win 
			WHERE UID = __UID AND valid = 0 AND `index` >= __FIRSTID;
		END;
        END IF;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcRegisterGMGiftWeb` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcRegisterGMGiftWeb`(
	__ADM_UID INT,
	__IDUSER INT,
	__MSG NVARCHAR(500),
	__ITEM_TYPEID_1 INT,
	__ITEM_TYPEID_2 INT,
	__ITEM_TYPEID_3 INT,
	__ITEM_TYPEID_4 INT,
	__ITEM_TYPEID_5 INT,
	__ITEM_QNTD_1 INT,
	__ITEM_QNTD_2 INT,
	__ITEM_QNTD_3 INT,
	__ITEM_QNTD_4 INT,
	__ITEM_QNTD_5 INT
)
BEGIN

	IF __IDUSER > 0 THEN
	BEGIN
		
		DECLARE __MSGID INT;

		IF (__ITEM_TYPEID_1 != 0 AND __ITEM_QNTD_1 > 0) 
			OR (__ITEM_TYPEID_2 != 0 AND __ITEM_QNTD_2 > 0) 
			OR (__ITEM_TYPEID_3 != 0 AND __ITEM_QNTD_3 > 0) 
			OR (__ITEM_TYPEID_4 != 0 AND __ITEM_QNTD_4 > 0) 
			OR (__ITEM_TYPEID_5 != 0 AND __ITEM_QNTD_5 > 0) THEN
		BEGIN
			
			INSERT INTO pangya.pangya_gift_table(UID, fromid, message, giftdate, Lida_YN, valid, Flag, Contador_Vista)
			VALUES(__IDUSER, '@SUPERSS', __MSG, now(), 0, 1, 0, 0);

			SET __MSGID = last_insert_id();

			IF __MSGID > 0 THEN
			BEGIN

				DECLARE __item_id int DEFAULT -1;

				-- Log
				INSERT INTO pangya.pangya_gm_gift_web_log(GM_UID, PLAYER_UID, MSG_ID) VALUES(__ADM_UID, __IDUSER, __MSGID);

				IF (__ITEM_TYPEID_1 != 0 AND __ITEM_QNTD_1 > 0) THEN
				BEGIN
					CALL pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, __item_id, __ITEM_TYPEID_1, 0, __ITEM_QNTD_1, 0);
				END;
                END IF;

				IF (__ITEM_TYPEID_2 != 0 AND __ITEM_QNTD_2 > 0) THEN
				BEGIN
					CALL pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, __item_id, __ITEM_TYPEID_2, 0, __ITEM_QNTD_2, 0);
				END;
                END IF;

				IF (__ITEM_TYPEID_3 != 0 AND __ITEM_QNTD_3 > 0) THEN
				BEGIN
					CALL pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, __item_id, __ITEM_TYPEID_3, 0, __ITEM_QNTD_3, 0);
				END;
                END IF;

				IF (__ITEM_TYPEID_4 != 0 AND __ITEM_QNTD_4 > 0) THEN
				BEGIN
					CALL pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, __item_id, __ITEM_TYPEID_4, 0, __ITEM_QNTD_4, 0);
				END;
                END IF;

				IF (__ITEM_TYPEID_5 != 0 AND __ITEM_QNTD_5 > 0) THEN
				BEGIN
					CALL pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, __item_id, __ITEM_TYPEID_5, 0, __ITEM_QNTD_5, 0);
				END;
                END IF;

				-- Comando para mostrar no jogo que o player recebeu um presente
				CALL pangya.ProcInsertCommand(4, __IDUSER, __MSGID, 0, 0, 0, 1, 0, 1, null);

			END; -- IF MSG IS IS OK
            END IF;
		
		END; -- IF CHECK ITENS IS OK TO SEND
		ELSE
		BEGIN
			
			-- Não tem itens para enviar só invia uma mensagem
			INSERT INTO pangya.pangya_gift_table(UID, fromid, message, giftdate, Lida_YN, valid, Flag, Contador_Vista)
			VALUES(__IDUSER, '@SUPERSS', __MSG, now(), 0, 1, 0, 0);

			SET __MSGID = last_insert_id();

			IF __MSGID > 0 THEN
			BEGIN
				-- Log
				INSERT INTO pangya.pangya_gm_gift_web_log(GM_UID, PLAYER_UID, MSG_ID) VALUES(__ADM_UID, __IDUSER, __MSGID);

				-- Comando para mostrar no jogo que o player recebeu um presente
				CALL pangya.ProcInsertCommand(4, __IDUSER, __MSGID, 0, 0, 0, 1, 0, 1, null);
			END;
            END IF;

		END;	-- ELSE CHECK ITENS IS OK TO SEND
        END IF;

	END; -- IFF CHECK UID
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcRegisterGrandZodiacEventWebPlayerWin` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcRegisterGrandZodiacEventWebPlayerWin`(
	__UID INT,
	__ITEM_TYPEID INT,
	__ITEM_QNTD INT,
	__ITEM_TYPE TINYINT
)
BEGIN

	IF __UID > 0 AND __ITEM_TYPEID > 0 AND __ITEM_QNTD > 0 THEN
	BEGIN

		DECLARE __MSGID INT DEFAULT 0;

		-- Make Mail in gift table
		INSERT INTO pangya.pangya_gift_table(UID, fromid, message, giftdate, Lida_YN, valid, Flag, Contador_Vista)
		VALUES(__UID, '@SUPERSS', 'Grand Zodiac HIO Event', now(), 0, 0/*Não válido, depois eu libero ele se estiver tudo certo*/, 0, 0);

		SET __MSGID = last_insert_id();

		IF __MSGID > 0 THEN
		BEGIN
			DECLARE __ITEM_ID INT DEFAULT -1;

			-- ADD Item
			CALL pangya.ProcInsertItemNoEmail(0, __UID, __MSGID, __ITEM_ID, __ITEM_TYPEID, 0, __ITEM_QNTD, 0);

			-- Verifica se adicionou
			IF (SELECT COUNT(Msg_ID) FROM pangya.pangya_item_mail WHERE Msg_ID = __MSGID) = 1 THEN
			BEGIN
					
				IF __ITEM_TYPE = 1 THEN
				BEGIN
					INSERT INTO pangya.pangya_gz_event_2016121600_rare_win(UID, ITEM_TYPEID) VALUES(__UID, __ITEM_TYPEID);
				END;
                END IF;

				UPDATE pangya.pangya_gift_table SET valid = 1 WHERE Msg_ID = __MSGID;

				-- Comando para mostrar no jogo que o player recebeu um presente
				CALL pangya.ProcInsertCommand(4, __UID, __MSGID, 0, 0, 0, 1, 0, 1, null);

				-- Retorna a MSG ID e o LOG ID
				SELECT __MSGID AS MSG_ID;

			END;
			ELSE
			BEGIN
				-- Error ao salvar os itens, excluí ele e o mail
				DELETE FROM pangya.pangya_item_mail WHERE Msg_ID = __MSGID;

				DELETE FROM pangya.pangya_gift_table WHERE Msg_ID = __MSGID;
			END;
            END IF;
		END;
        END IF;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcRegisterGuildMatch` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcRegisterGuildMatch`(
	__GUILD_1_UID INT,
	__GUILD_1_POINT INT,
	__GUILD_1_PANG INT,
	__GUILD_2_UID INT,
	__GUILD_2_POINT INT,
	__GUILD_2_PANG INT
)
BEGIN

	IF __GUILD_1_UID > 0 AND __GUILD_2_UID > 0 THEN
	BEGIN

		INSERT INTO pangya.pangya_guild_match(guild_1_uid, guild_1_point, guild_1_pang, guild_2_uid, guild_2_point, guild_2_pang)
		VALUES(__GUILD_1_UID, __GUILD_1_POINT, __GUILD_1_PANG, __GUILD_2_UID, __GUILD_2_POINT, __GUILD_2_PANG);

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcRegisterKickPlayerCommand` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcRegisterKickPlayerCommand`(
	__player_uid_in int,
	__server_uid_in int
)
BEGIN

	INSERT pangya.pangya_command(pangya.pangya_command.command_id, pangya.pangya_command.arg1, pangya.pangya_command.target)
         VALUES (6, __player_uid_in, __server_uid_in);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcRegisterLogin` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcRegisterLogin`(
	_IDUSER int,
	_IP nvarchar(20),
	_SrvID nvarchar(20)
)
BEGIN
	
	UPDATE pangya.account
         SET 
            LastLogonTime = now(), 
            UserIp = _IP, 
            ServerID = _SrvID, 
            LogonCount = account.LogonCount + 1
      WHERE account.UID = _IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcRegisterLogon` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcRegisterLogon`(
	__IDUSER int,
	__OPTION int
)
BEGIN
	
	IF __OPTION = 0 THEN
	BEGIN

		UPDATE pangya.account
			SET 
				Logon = 1
		WHERE account.UID = __IDUSER;

	END;
	ELSE 
	BEGIN
		UPDATE pangya.account
			SET 
				Logon = 0, 
				LastLeaveTime = now()
		WHERE account.UID = __IDUSER;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcRegisterLogonServer` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcRegisterLogonServer`(
	__IDUSER int,
	__gameserver_id nvarchar(20)
)
BEGIN
	
	IF __IDUSER >= 0 THEN
		UPDATE pangya.account
			SET 
			   game_server_id = __gameserver_id
		WHERE account.UID = __IDUSER;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcRegisterLuciaAttendanceReward` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcRegisterLuciaAttendanceReward`(
	__UID INT,
	__COUNT_ITEM INT,
	__STR VARCHAR(8000)
)
BEGIN

	IF __UID > 0 AND __COUNT_ITEM > 0 AND __STR IS NOT NULL AND __STR != '' THEN
	BEGIN
		
		DECLARE __MSGID INT DEFAULT 0;
		DECLARE __LOGID INT DEFAULT 0;
		DECLARE __ITEM VARCHAR(500);
		DECLARE __ITEM_TYPEID INT;
		DECLARE __ITEM_QNTD INT;
		DECLARE __ITEM_COUNT INT DEFAULT 0;
		DECLARE __ITEM_ID INT DEFAULT -1;

		-- Make Mail in gift table
		INSERT INTO pangya.pangya_gift_table(UID, fromid, message, giftdate, Lida_YN, valid, Flag, Contador_Vista)
		VALUES(__UID, '@SUPERSS', 'Lucia Attendance reward', now(), 0, 0/*Não válido, depois eu libero ele se estiver tudo certo*/, 0, 0);

		SET __MSGID = last_insert_id();

		IF __MSGID > 0 THEN
		BEGIN

			-- Make Log
			INSERT INTO pangya.pangya_lucia_attendance_reward_log(UID, MSG_ID) VALUES(__UID, __MSGID);

			SET __LOGID = last_insert_id();

			IF __LOGID > 0 THEN
			BEGIN

				DECLARE CCI INT Default 0;
                
				lpItens: LOOP
					
                    SET CCI = CCI + 1;
                    
					SET __ITEM = SPLIT_STR(__STR, "|", CCI);
					
                    IF __ITEM = '' THEN
						LEAVE lpItens;
					END IF;
                    
                    SET __ITEM_TYPEID = SUBSTRING_INDEX(SUBSTRING_INDEX(__ITEM,';', 1), ';',-1);
					SET __ITEM_QNTD = SUBSTRING_INDEX(SUBSTRING_INDEX(__ITEM,';', 2), ';',-1);

					IF __ITEM_TYPEID IS NOT NULL AND __ITEM_QNTD IS NOT NULL THEN
					BEGIN
						
						CALL pangya.ProcInsertItemNoEmail(0, __UID, __MSGID, __ITEM_ID, __ITEM_TYPEID, 0, __ITEM_QNTD, 0);
					
						-- Itens inseridos no mail
						SET __ITEM_COUNT = __ITEM_COUNT + 1;
					END;
					END IF;
                    
				END LOOP lpItens;

				-- Verifica se foi os itens tudo OK
				IF __COUNT_ITEM = __ITEM_COUNT AND __COUNT_ITEM = (SELECT COUNT(Msg_ID) FROM pangya.pangya_item_mail WHERE Msg_ID = __MSGID) THEN
				BEGIN
			
					-- Tudo ok adiciona os 50CP para o player e libera o mail e envia a msg que um mail foi enserido
					UPDATE pangya.user_info SET Cookie = Cookie + 50 WHERE UID = __UID;

					UPDATE pangya.pangya_gift_table SET valid = 1 WHERE Msg_ID = __MSGID;

					-- Comando para mostrar no jogo que o player recebeu um presente
					CALL pangya.ProcInsertCommand(4, __UID, __MSGID, 0, 0, 0, 1, 0, 1, null);

					-- Retorna a MSG ID e o LOG ID
					SELECT __MSGID AS MSG_ID, __LOGID AS LOG_ID;

				END;
				ELSE
				BEGIN
					-- Error ao salvar os itens, excluí ele e o mail e registra no log do lucia attendance que deu erro
					DELETE FROM pangya.pangya_item_mail WHERE Msg_ID = __MSGID;

					DELETE FROM pangya.pangya_gift_table WHERE Msg_ID = __MSGID;

					UPDATE pangya.pangya_lucia_attendance_reward_log SET `ERROR` = 'FAIL TO INSERT ITENS' WHERE `index` = __LOGID;

					-- PRINT '-UM-'
				END;
                END IF;

			END;
			ELSE
			BEGIN
				-- Erro ao criar o log, deleta o mail criado
				DELETE FROM pangya.pangya_gift_table WHERE Msg_ID = __MSGID;

				-- PRINT '-DOIS-'
			END;
            END IF;
		END;
        END IF;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcRegisterNewRateServer` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcRegisterNewRateServer`(
	__tipo_rate int,
	__quantidade int,
	__target_in int,
	__reserveDate_in datetime
)
BEGIN

/*
*        * 0 - Pang
*        * 1 - Exp
*        * 2 - Mastery
*        * 3 - Chuva
*        * 4 - Treasure Points
*        * 5 - Scratchy
*        * 6 - Papel Shop Rare Item
*        * 7 - Papel Shop Cookie Item
*        * 8 - Memórial Shop
*
*		Events
*		* 9  - Grand Zodiac Time Event
*       * 10 - Angel Event (Reduce Quit Rate)
*
*/

	INSERT pangya.pangya_command(
         pangya.pangya_command.command_id, 
         pangya.pangya_command.arg1, 
         pangya.pangya_command.arg2, 
         pangya.pangya_command.target, 
         pangya.pangya_command.reserveDate)
         VALUES (
            5, 
            __tipo_rate, 
            __quantidade, 
            __target_in, 
            __reserveDate_in);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcRegisterNoticeBroadcast` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcRegisterNoticeBroadcast`(
	__msg_in nvarchar(1024),
	__replay_count_in int,
	__refresh_time_min_in int,
	__target_in int,
	__reserveDate_in datetime
)
BEGIN
	
		DECLARE __NOTICE_ID INT DEFAULT -1;
    
    INSERT pangya.pangya_notice_list(pangya.pangya_notice_list.message, pangya.pangya_notice_list.replayCount, pangya.pangya_notice_list.refreshTime)
         VALUES (__msg_in, __replay_count_in, __refresh_time_min_in);

      SET __NOTICE_ID = last_insert_id();

      INSERT pangya.pangya_command(pangya.pangya_command.command_id, pangya.pangya_command.arg1, pangya.pangya_command.target, pangya.pangya_command.reserveDate)
         VALUES (0, __NOTICE_ID, __target_in, __reserveDate_in);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcRegisterReloadSystemServer` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcRegisterReloadSystemServer`(
	__SISTEMA INT,
	__TARGET_IN INT,
	__RESERVEDATE_IN DATETIME
)
BEGIN
	
	INSERT INTO pangya.pangya_command(command_id, arg1, target, reserveDate)
		VALUES(7, __SISTEMA, __TARGET_IN, __RESERVEDATE_IN);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcRegisterShutdownServer` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcRegisterShutdownServer`(
	__date_shutdown_in datetime,
	__target_in int,
	__reserveDate_in datetime
)
BEGIN

	  DECLARE __SHUTDOWN_ID INT DEFAULT -1;
    
	INSERT pangya.pangya_shutdown_list(pangya.pangya_shutdown_list.date_shutdown)
         VALUES (__date_shutdown_in);

      SET __SHUTDOWN_ID = last_insert_id();

      INSERT pangya.pangya_command(pangya.pangya_command.command_id, pangya.pangya_command.arg1, target, pangya.pangya_command.reserveDate)
         VALUES (3, __SHUTDOWN_ID, __target_in, __reserveDate_in);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcRegisterTicker` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcRegisterTicker`(
	__IDUSER INT,
	__SERVER_OWNER INT,
	__MSG NVARCHAR(500)
)
BEGIN

	IF __IDUSER > 0 THEN
	BEGIN
		-- Register Ticker on pangya_command
		DECLARE __TICKER_ID INT DEFAULT 0;

		INSERT INTO pangya_ticker_list(MESSAGE, NICK) VALUES(__MSG, (SELECT nick FROM account WHERE UID = __IDUSER));

		SET __TICKER_ID = last_insert_id();
			
		-- Envia para todos game server exceto o server que enviou para DB que ele mesmo coloca na fila de ticker dele
		INSERT INTO pangya_command(command_id, arg1, arg2, target) VALUES(1, __TICKER_ID, __SERVER_OWNER, 1/*Tipo 1 - Todos Game Server*/);
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcRegisterWinBox` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcRegisterWinBox`(
	__IDUSER int,
	__box_typeid int,
	__item_typeid int,
	__QNTD int
)
BEGIN

	DECLARE __OPT INT DEFAULT 1;
	DECLARE __NOTICE_ID INT DEFAULT -1;

    IF __item_typeid = 436207632 THEN
	BEGIN
        SET __OPT = 2;
	END;
    END IF;

	INSERT pangya.pangya_notice_list(pangya.pangya_notice_list.message)
		SELECT 
		'<PARAMS><BOX_TYPEID>'
			+ 
		CAST(__box_typeid AS char(50))
			+ 
		'</BOX_TYPEID><NICKNAME>'
			+ 
		account.NICK
			+ 
		'</NICKNAME><TYPEID>'
			+ 
		CAST(__item_typeid AS char(50))
			+ 
		'</TYPEID><QTY>'
			+ 
		CAST(__QNTD AS char(50))
			+ 
		'</QTY></PARAMS>'
		FROM pangya.account
		WHERE account.UID = __IDUSER;

      SET __NOTICE_ID = last_insert_id();

      INSERT pangya.pangya_command(pangya.pangya_command.command_id, pangya.pangya_command.arg1, pangya.pangya_command.arg2, pangya.pangya_command.target)
         VALUES (2, __NOTICE_ID, __OPT, 1);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcRegServer_New` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcRegServer_New`(
	IDUSER int,
	NOME nvarchar(32),
	ipaddres nvarchar(20),
	porta smallint,
	tipo smallint,
	maxusuario int,
	currusuario int,
	PangRat int,
	ServerVersao nvarchar(40),
	ClienteVersao nvarchar(20),
	propriedade int,
	AngelicWingsNumber int,
	EventoFlag smallint,
	ExpRat int,
	ImgNumber smallint,
	ScratchRat smallint,
	MasteryRat smallint,
	TreasureRat smallint,
	RareItemRat smallint,
	CookieItemRat smallint,
	ChuvaRat smallint
)
BEGIN
	
    DECLARE RegType int;

	SELECT pangya_server_list.UID INTO RegType
	FROM pangya.pangya_server_list
	WHERE pangya_server_list.UID = IDUSER;

	IF RegType <> 0 THEN
	BEGIN

		UPDATE pangya.pangya_server_list
			SET 
				`Name` = NOME, 
				IP = ipaddres, 
				`Port` = porta, 
				`Type` = tipo, 
				MaxUser = maxusuario, 
				PangRate = PangRat, 
				CurrUser = currusuario, 
				State = 1, 
				UpdateTime = ifnull(now(), now()), 
				ScratchRate = ScratchRat, 
				ServerVersion = ServerVersao, 
				ClientVersion = ClienteVersao, 
				property = propriedade, 
				AngelicWingsNum = AngelicWingsNumber, 
				EventFlag = EventoFlag, 
				ExpRate = ExpRat, 
				ImgNo = ImgNumber, 
				MasteryRate = MasteryRat, 
				TreasureRate = TreasureRat, 
				ChuvaRate = ChuvaRat, 
				RareItemRate = RareItemRat, 
				CookieItemRate = CookieItemRat
		WHERE pangya_server_list.UID = IDUSER;
	END;
	ELSE 
	BEGIN

		INSERT pangya.pangya_server_list(
			pangya.pangya_server_list.Name, 
			pangya.pangya_server_list.UID, 
			pangya.pangya_server_list.IP, 
			pangya.pangya_server_list.Port, 
			pangya.pangya_server_list.MaxUser, 
			pangya.pangya_server_list.CurrUser, 
			pangya.pangya_server_list.Type, 
			pangya.pangya_server_list.UpdateTime, 
			pangya.pangya_server_list.State, 
			pangya.pangya_server_list.PangRate, 
			pangya.pangya_server_list.ServerVersion, 
			pangya.pangya_server_list.ClientVersion, 
			pangya.pangya_server_list.property, 
			pangya.pangya_server_list.AngelicWingsNum, 
			pangya.pangya_server_list.EventFlag, 
			pangya.pangya_server_list.ExpRate, 
			pangya.pangya_server_list.ImgNo, 
			pangya.pangya_server_list.ScratchRate, 
			pangya.pangya_server_list.MasteryRate, 
			pangya.pangya_server_list.TreasureRate, 
			pangya.pangya_server_list.RareItemRate, 
			pangya.pangya_server_list.CookieItemRate, 
			pangya.pangya_server_list.ChuvaRate, 
			pangya.pangya_server_list.PCBangUser, 
			pangya.pangya_server_list.ServiceControl, 
			pangya.pangya_server_list.AppRate, 
			pangya.pangya_server_list.EventMap, 
			pangya.pangya_server_list.EventDropRate, 
			pangya.pangya_server_list.HanbitUser, 
			pangya.pangya_server_list.ParanUser, 
			pangya.pangya_server_list.AuthState)
		VALUES (
			NOME, 
			IDUSER, 
			ipaddres, 
			porta, 
			maxusuario, 
			currusuario, 
			tipo, 
			ifnull(now(), now()), 
			1, 
			PangRat, 
			ServerVersao, 
			ClienteVersao, 
			propriedade, 
			AngelicWingsNumber, 
			EventoFlag, 
			ExpRat, 
			ImgNumber, 
			ScratchRat, 
			MasteryRat, 
			TreasureRat, 
			RareItemRat, 
			CookieItemRat, 
			ChuvaRat, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0, 
			0);
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcRemoveEquipedCard` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcRemoveEquipedCard`(
	__IDUSER INT,
	__PART_ID INT,
	__PART_TYPEID INT,
	__CARD_TYPEID INT,
	__CARD_SLOT INT
)
BEGIN

	IF __IDUSER > 0 AND __PART_ID > 0 AND __PART_TYPEID > 0 AND __CARD_TYPEID > 0 THEN
	  BEGIN
		UPDATE pangya.pangya_card_equip SET USE_YN = 0
		WHERE UID = __IDUSER AND parts_id = __PART_ID AND parts_typeid = __PART_TYPEID
			AND card_typeid = __CARD_TYPEID AND Slot = __CARD_SLOT;
	  END;
      END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcRemoveOldAndAddNewDailyQuestPlayer` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcRemoveOldAndAddNewDailyQuestPlayer`(
	__IDUSER int
)
BEGIN

	DELETE 
      FROM pangya.achievement_quest
      WHERE achievement_quest.UID = __IDUSER AND achievement_quest.ID_ACHIEVEMENT IN 
         (
            SELECT achievement_tipo.ID_ACHIEVEMENT
            FROM pangya.achievement_tipo
            WHERE achievement_tipo.UID = __IDUSER AND achievement_tipo.`Option` = 1
         );

      DELETE 
      FROM pangya.achievement_tipo
      WHERE achievement_tipo.UID = __IDUSER AND achievement_tipo.`Option` = 1;

      INSERT pangya.achievement_tipo(
         pangya.achievement_tipo.UID, 
         pangya.achievement_tipo.Nome, 
         pangya.achievement_tipo.TypeID, 
         pangya.achievement_tipo.TIPO, 
         pangya.achievement_tipo.`Option`)
         SELECT 
            __IDUSER, 
            b.nome, 
            a.achieve_quest_1, 
            1, 
            1
         FROM pangya.pangya_daily_quest  AS a, pangya.quest_items  AS b
         WHERE a.achieve_quest_1 = b.typeid;

      INSERT pangya.achievement_tipo(
         pangya.achievement_tipo.UID, 
         pangya.achievement_tipo.Nome, 
         pangya.achievement_tipo.TypeID, 
         pangya.achievement_tipo.TIPO, 
         pangya.achievement_tipo.`Option`)
         SELECT 
            __IDUSER, 
            b.nome, 
            a.achieve_quest_2, 
            1, 
            1
         FROM pangya.pangya_daily_quest  AS a, pangya.quest_items  AS b
         WHERE a.achieve_quest_2 = b.typeid;

      INSERT pangya.achievement_tipo(
         pangya.achievement_tipo.UID, 
         pangya.achievement_tipo.Nome, 
         pangya.achievement_tipo.TypeID, 
         pangya.achievement_tipo.TIPO, 
         pangya.achievement_tipo.`Option`)
         SELECT 
            __IDUSER, 
            b.nome, 
            a.achieve_quest_3, 
            1, 
            1
         FROM pangya.pangya_daily_quest  AS a, pangya.quest_items  AS b
         WHERE a.achieve_quest_3 = b.typeid;

      IF 
         (
            SELECT pangya_daily_quest_player.uid
            FROM pangya.pangya_daily_quest_player
            WHERE pangya_daily_quest_player.uid = __IDUSER
         ) IS NULL THEN
         INSERT pangya.pangya_daily_quest_player(pangya.pangya_daily_quest_player.uid, pangya.pangya_daily_quest_player.last_quest_accept, pangya.pangya_daily_quest_player.today_quest)
            VALUES (__IDUSER, NULL, now());
      ELSE 
         UPDATE pangya.pangya_daily_quest_player
            SET 
               today_quest = now()
         WHERE pangya_daily_quest_player.uid = __IDUSER;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcRequestJoinGuild` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcRequestJoinGuild`(
	__PLAYER_UID INT,
	__GUILD_UID INT
)
BEGIN

	DECLARE __RET INT DEFAULT -1;
	
	IF __PLAYER_UID > 0 AND __GUILD_UID > 0 THEN
	BEGIN
		
		DECLARE __OTHER_GUILD INT DEFAULT (
			SELECT
				a.Guild_UID
			FROM
				pangya.account a
				INNER JOIN
				pangya.pangya_guild b
				ON a.Guild_UID = b.GUILD_UID
			WHERE a.UID = __PLAYER_UID AND 
				(b.GUILD_STATE NOT IN(4, 5) OR b.GUILD_CLOSURE_DATE IS NULL OR now() < b.GUILD_CLOSURE_DATE)
		);

		IF __OTHER_GUILD IS NULL OR __OTHER_GUILD = __GUILD_UID THEN
		BEGIN

			IF (SELECT GUILD_UID FROM pangya.pangya_guild WHERE GUILD_UID = __GUILD_UID AND GUILD_PERMITION_JOIN = 1 AND GUILD_STATE IN(0, 1) AND GUILD_CLOSURE_DATE IS NULL) IS NOT NULL THEN
			BEGIN

				IF (SELECT MEMBER_UID FROM pangya.pangya_guild_member WHERE GUILD_UID = __GUILD_UID AND MEMBER_UID = __PLAYER_UID) IS NULL THEN
				BEGIN

					-- Delete ele de qualquer membro de guild que ele esteja, que o OTHER_GUILD é null, se ele estava em uma guild, ela já está fechada
					DELETE FROM pangya.pangya_guild_member WHERE MEMBER_UID = __PLAYER_UID;

					-- Adiciona ele para a nova Guild
					INSERT pangya.pangya_guild_member(GUILD_UID, MEMBER_UID, MEMBER_MSG, MEMBER_STATE_FLAG, GUILD_PANG, GUILD_POINT)
					VALUES (__GUILD_UID, __PLAYER_UID, '', 9, 0, 0);

					INSERT pangya.pangya_guild_atividade_player(UID, GUILD_UID, FLAG)
					VALUES (__PLAYER_UID, __GUILD_UID, 1);

					UPDATE pangya.account
						SET 
							GUILD_UID = __GUILD_UID
					WHERE account.UID = __PLAYER_UID;

					SET __RET = 1;

				END;
				ELSE
					SET __RET = -2;	-- Já fez o pedido para entrar nessa guild
				END IF;
			
            END;
			ELSE
				SET __RET = -3;	-- A guild que ele quer entrar está fechada ou bloqueada
			END IF;

		END;
		ELSE
			SET __RET = -4;	-- Player já está em outra guild
		END IF;

	END;
    END IF;

	SELECT __RET AS RET;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcRescueID` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcRescueID`(
	__EMAIL NVARCHAR(100)
)
BEGIN

	DECLARE __RET INT DEFAULT -1;
	DECLARE __KEY NVARCHAR(100) DEFAULT '';
	DECLARE __INDEX BIGINT DEFAULT 0;
	DECLARE __UID INT DEFAULT 0;

	IF __EMAIL != '' THEN
	BEGIN

		SET __UID = (SELECT UID FROM pangya.contas_beta WHERE email = __EMAIL);

		IF __UID IS NOT NULL AND __UID > 0 THEN
		BEGIN
			
			IF (SELECT UID FROM pangya.pangya_rescue_pwd_log WHERE UID = __UID AND tipo = 2 AND state = 0 AND TIMESTAMPADD(HOUR, 1, send_date) >= now() LIMIT 1) IS NULL THEN
			BEGIN

				INSERT INTO pangya.pangya_rescue_pwd_log(UID, tipo, key_uniq) VALUES(__UID, 2/*ID*/, uuid());

				SET __INDEX = last_insert_id();

				SELECT key_uniq INTO __KEY FROM pangya.pangya_rescue_pwd_log WHERE `index` = __INDEX AND `UID` = __UID;
				
				-- Sucesso ao criar o log e a chave
				SET __RET = 1;

			END;
			ELSE
				SET __RET = -4;	-- Já enviou um email com as instruções para recuperar a senha
			END IF;

		END;
		ELSE
			SET __RET = -3;	-- Email invalido
		END IF;

	END;
    END IF;

	SELECT __RET AS RET, __UID AS UID, __INDEX AS `INDEX`, __KEY AS `KEY`, __EMAIL as EMAIL;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcRescuePassword` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcRescuePassword`(
	__ID VARCHAR(25)
)
BEGIN

	DECLARE __RET INT DEFAULT -1;
	DECLARE __KEY NVARCHAR(100) DEFAULT '';
	DECLARE __INDEX BIGINT DEFAULT 0;
	DECLARE __EMAIL NVARCHAR(100) DEFAULT NULL;
	DECLARE __UID INT DEFAULT 0;

	IF __ID != '' THEN
	BEGIN

		SET __UID = (SELECT UID FROM pangya.account WHERE ID = __ID);

		IF __UID IS NOT NULL THEN
		BEGIN

			SET __EMAIL = (SELECT email FROM pangya.contas_beta WHERE UID = __UID);

			IF __EMAIL IS NOT NULL THEN
			BEGIN

				IF (SELECT UID FROM pangya.pangya_rescue_pwd_log WHERE UID = __UID AND tipo = 1 AND state = 0 AND TIMESTAMPADD(HOUR, 1, send_date) >= now() LIMIT 1) IS NULL THEN
				BEGIN

					INSERT INTO pangya.pangya_rescue_pwd_log(UID, tipo, key_uniq) VALUES(__UID, 1/*Password*/, uuid());

					SET __INDEX = last_insert_id();

					SELECT key_uniq INTO __KEY FROM pangya.pangya_rescue_pwd_log WHERE `index` = __INDEX AND `UID` = __UID;

					-- Sucesso ao criar o log e a chave
					SET __RET = 1;

				END;
				ELSE
					SET __RET = -4;	-- Já enviou um email com as instruções para recuperar a senha
				END IF;

			END;
			ELSE
				SET __RET = -3;	-- Email invalido
			END IF;

		END;
		ELSE
			SET __RET = -2;	-- ID invalido
		END IF;

	END;
    END IF;

	SELECT __RET AS RET, __UID AS UID, __INDEX AS `INDEX`, __KEY AS `KEY`, __EMAIL AS EMAIL;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcSaiGuild` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcSaiGuild`(
	__IDUSER int,
	__UID_GUILD int
)
BEGIN

	UPDATE pangya.account
		SET 
		GUILD_UID = 0
	WHERE UID = __IDUSER;

	DELETE 
	FROM pangya.pangya_guild_member
	WHERE GUILD_UID = __UID_GUILD AND MEMBER_UID = __IDUSER;

	INSERT pangya.pangya_guild_atividade_player(UID, GUILD_UID, FLAG)
		VALUES (__IDUSER, __UID_GUILD, 7);

	-- Cria log de update para o Game Server verificar e pedir para o Message Server Atualize os Membros do Club
	INSERT INTO pangya_guild_update_activity(GUILD_UID, OWNER_UPDATE, PLAYER_UID, TYPE_UPDATE) VALUES(__UID_GUILD, __IDUSER/*O próprio player que saiu da Guild*/, __IDUSER, 1/*Sai Club*/);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcSalvaDadosPlayerGuild` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcSalvaDadosPlayerGuild`(
	__IDUSER int,
	__UID_GUILD int,
	__POINT_GUILD int,
	__PANG_GUILD int
)
BEGIN

	UPDATE pangya.pangya_guild
         SET 
            GUILD_POINT = pangya_guild.GUILD_POINT + __POINT_GUILD, 
            GUILD_PANG = pangya_guild.GUILD_PANG + __PANG_GUILD
      WHERE pangya_guild.GUILD_UID = __UID_GUILD;

      UPDATE pangya.pangya_guild_member
         SET 
            GUILD_POINT = pangya_guild_member.GUILD_POINT + __POINT_GUILD, 
            GUILD_PANG = pangya_guild_member.GUILD_PANG + __PANG_GUILD
      WHERE pangya_guild_member.GUILD_UID = __UID_GUILD AND pangya_guild_member.MEMBER_UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcSaveNickname` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcSaveNickname`(
	__UID INT,
	__NICKNAME NVARCHAR(50)
)
BEGIN

	IF __UID > 0 AND __NICKNAME != '' THEN
		UPDATE pangya.account SET nick = __NICKNAME WHERE UID = __UID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcSendGachaJPPlayerItemToMail` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcSendGachaJPPlayerItemToMail`(
	__UID INT,
	__ID BIGINT
)
BEGIN

	IF __UID > 0 AND __ID > 0 THEN
	BEGIN

		IF (SELECT `index` FROM pangya.pangya_gacha_jp_player_win WHERE UID = __UID AND `index` = __ID AND valid = 1 AND send_mail = 0 LIMIT 1) IS NOT NULL THEN
		BEGIN

			DECLARE __MSGID INT DEFAULT 0;

			-- Make Mail in gift table
			INSERT INTO pangya.pangya_gift_table(UID, fromid, message, giftdate, Lida_YN, valid, Flag, Contador_Vista)
			VALUES(__UID, '@SUPERSS', 'Gacha Item', now(), 0, 0/*Não válido, depois eu libero ele se estiver tudo certo*/, 0, 0);

			SET __MSGID = last_insert_id();

			IF __MSGID > 0 THEN
			BEGIN
				DECLARE __ITEM_ID INT DEFAULT -1;
				DECLARE __ITEM_TYPEID INT DEFAULT 0;
				DECLARE __ITEM_QNTD INT DEFAULT 0;
				
				SELECT typeid, qnty INTO __ITEM_TYPEID, __ITEM_QNTD
				FROM pangya.pangya_gacha_jp_player_win 
				WHERE UID = __UID AND `index` = __ID AND valid = 1 AND send_mail = 0 LIMIT 1;

				-- ADD Item
				CALL pangya.ProcInsertItemNoEmail(0, __UID, __MSGID, __ITEM_ID, __ITEM_TYPEID, 0, __ITEM_QNTD, 0);

				-- Verifica se adicionou
				IF (SELECT COUNT(Msg_ID) FROM pangya.pangya_item_mail WHERE Msg_ID = __MSGID) = 1 THEN
				BEGIN
					
					UPDATE pangya.pangya_gacha_jp_player_win SET send_mail = 1 WHERE UID = __UID AND `index` = __ID;

					UPDATE pangya.pangya_gift_table SET valid = 1 WHERE Msg_ID = __MSGID;

					-- Comando para mostrar no jogo que o player recebeu um presente
					CALL pangya.ProcInsertCommand(4, __UID, __MSGID, 0, 0, 0, 1, 0, 1, null);

					-- Retorna a MSG ID e o LOG ID
					SELECT __MSGID AS MSG_ID;

				END;
				ELSE
				BEGIN
					-- Error ao salvar os itens, excluí ele e o mail
					DELETE FROM pangya.pangya_item_mail WHERE Msg_ID = __MSGID;

					DELETE FROM pangya.pangya_gift_table WHERE Msg_ID = __MSGID;
				END;
                END IF;
			END;
            END IF;
		END;
        END IF;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcSetAssist` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcSetAssist`(
	__IDUSER int
)
BEGIN

	DECLARE
         __ASSISTENTE int DEFAULT 0;

      IF 
         (
            SELECT pangya_assistente.UID
            FROM pangya.pangya_assistente
            WHERE pangya_assistente.UID = __IDUSER
         ) IS NULL THEN
         BEGIN

            INSERT pangya.pangya_assistente(pangya.pangya_assistente.UID)
               VALUES (__IDUSER);

            SET __ASSISTENTE = 1;

         END;
      ELSEIF 
            (
               SELECT pangya_assistente.Assist
               FROM pangya.pangya_assistente
               WHERE pangya_assistente.UID = __IDUSER
            ) = 1 THEN
            BEGIN

               UPDATE pangya.pangya_assistente
                  SET 
                     assist = 0
               WHERE pangya_assistente.UID = __IDUSER;

               SET __ASSISTENTE = 0;

            END;
         ELSE 
            BEGIN

               UPDATE pangya.pangya_assistente
                  SET 
                     assist = 1
               WHERE pangya_assistente.UID = __IDUSER;

               SET __ASSISTENTE = 1;

            END;
            END IF;

      SELECT __ASSISTENTE AS ASSISTENTE;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcTempUpLevelClubSet` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcTempUpLevelClubSet`(
	__IDUSER int,
	__Taqueira_ID int,
	__Estado int,
	__TYPEID_ITEM_USADO int,
	__QNTD int
)
BEGIN

	DECLARE
         __COUNT int DEFAULT 0;

      SELECT count(*) INTO __COUNT
      FROM pangya.pangya_last_up_clubset
      WHERE pangya_last_up_clubset.UID = __IDUSER;

      IF __COUNT = 0 THEN
         INSERT pangya.pangya_last_up_clubset(
            pangya.pangya_last_up_clubset.item_id, 
            pangya.pangya_last_up_clubset.UID, 
            pangya.pangya_last_up_clubset.State, 
            pangya.pangya_last_up_clubset.item_usado, 
            pangya.pangya_last_up_clubset.Quantidade)
            VALUES (
               __Taqueira_ID, 
               __IDUSER, 
               __Estado, 
               __TYPEID_ITEM_USADO, 
               __QNTD);
      ELSE 
         UPDATE pangya.pangya_last_up_clubset
            SET 
               item_id = __Taqueira_ID, 
               State = __Estado, 
               item_usado = __TYPEID_ITEM_USADO, 
               Quantidade = __QNTD
         WHERE pangya_last_up_clubset.UID = __IDUSER;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcTransfereMasteryPts` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcTransfereMasteryPts`(
	__IDUSER int,
	__From_Taqueira_ID int,
	__To_Taqueira_ID int,
	__Quantidade int
)
BEGIN

	DECLARE __MASTERY int;
	DECLARE __MASTERY_TOTAL int;
	DECLARE __CALC int;

      SELECT pangya_item_warehouse.Mastery_Pts INTO __MASTERY
      FROM pangya.pangya_item_warehouse
      WHERE pangya_item_warehouse.UID = __IDUSER AND pangya_item_warehouse.item_id = __From_Taqueira_ID;

      SELECT pangya_item_warehouse.Total_Mastery_Pts INTO __MASTERY_TOTAL
      FROM pangya.pangya_item_warehouse
      WHERE pangya_item_warehouse.UID = __IDUSER AND pangya_item_warehouse.item_id = __From_Taqueira_ID;

      SET __CALC = __MASTERY - (300 * __Quantidade);

      SET __MASTERY_TOTAL = 
         CASE 
            WHEN __CALC < 0 THEN __MASTERY
            ELSE (300 * __Quantidade)
         END;

      IF __CALC < 0 THEN
         BEGIN

            UPDATE pangya.pangya_item_warehouse
               SET 
                  Mastery_Pts = 0, 
                  Total_Mastery_Pts = pangya_item_warehouse.Total_Mastery_Pts - __MASTERY_TOTAL
            WHERE pangya_item_warehouse.UID = __IDUSER AND pangya_item_warehouse.item_id = __From_Taqueira_ID;

            UPDATE pangya.pangya_item_warehouse
               SET 
                  Mastery_Pts = pangya_item_warehouse.Mastery_Pts + __MASTERY_TOTAL, 
                  Total_Mastery_Pts = pangya_item_warehouse.Total_Mastery_Pts + __MASTERY_TOTAL
            WHERE pangya_item_warehouse.UID = __IDUSER AND pangya_item_warehouse.item_id = __To_Taqueira_ID;

         END;
      ELSE 
         BEGIN

            UPDATE pangya.pangya_item_warehouse
               SET 
                  Mastery_Pts = __CALC, 
                  Total_Mastery_Pts = pangya_item_warehouse.Total_Mastery_Pts - __MASTERY_TOTAL
            WHERE pangya_item_warehouse.UID = __IDUSER AND pangya_item_warehouse.item_id = __From_Taqueira_ID;

            UPDATE pangya.pangya_item_warehouse
               SET 
                  Mastery_Pts = pangya_item_warehouse.Mastery_Pts + __MASTERY_TOTAL, 
                  Total_Mastery_Pts = pangya_item_warehouse.Total_Mastery_Pts + __MASTERY_TOTAL
            WHERE pangya_item_warehouse.UID = __IDUSER AND pangya_item_warehouse.item_id = __To_Taqueira_ID;

         END;
         END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcTransferPart` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcTransferPart`(
	__UID_SELL INT,
	__UID_BUY INT,
	__ITEM_ID INT,
	__ITEM_TYPE_IFF TINYINT
)
BEGIN

	IF __UID_SELL > 0 AND __UID_BUY > 0 AND __ITEM_ID > 0 THEN
	BEGIN
		UPDATE pangya.pangya_item_warehouse SET UID = __UID_BUY WHERE UID = __UID_SELL AND item_id = __ITEM_ID;

		-- UCC
		IF __ITEM_TYPE_IFF = 8 OR __ITEM_TYPE_IFF = 9 THEN
		BEGIN
			UPDATE pangya.tu_ucc SET UID = __UID_BUY WHERE UID = __UID_SELL AND item_id = __ITEM_ID;
		END;
        END IF;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcTransformeClubSetTemp` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcTransformeClubSetTemp`(
	__IDUSER int,
	__taqueiraid int,
	__state_in int,
	__mastery_in int,
	__state2_in int,
	__card_typeid_in int,
	__card_qntd_in int,
	__taqueira_trans_typeid_in int
)
BEGIN

	INSERT pangya.pangya_transforme_clubset_temp(
         pangya.pangya_transforme_clubset_temp.UID, 
         pangya.pangya_transforme_clubset_temp.TAQUEIRA_ID, 
         pangya.pangya_transforme_clubset_temp.STATE, 
         pangya.pangya_transforme_clubset_temp.MASTERY, 
         pangya.pangya_transforme_clubset_temp.STATE2, 
         pangya.pangya_transforme_clubset_temp.FLAG, 
         pangya.pangya_transforme_clubset_temp.CARD_TYPEID, 
         pangya.pangya_transforme_clubset_temp.CARD_QNTD, 
         pangya.pangya_transforme_clubset_temp.TAQUEIRA_TRANS_TYPEID)
         VALUES (
            __IDUSER, 
            __taqueiraid, 
            __state_in, 
            __mastery_in, 
            __state2_in, 
            0, 
            __card_typeid_in, 
            __card_qntd_in, 
            __taqueira_trans_typeid_in);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcTrocaNickName` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcTrocaNickName`(
	__IDUSER int,
	__nickname nvarchar(22)
)
BEGIN

	DECLARE
         __RET int DEFAULT 0;

      IF __nickname IS NOT NULL THEN
         BEGIN

            UPDATE pangya.account
               SET 
                  nick = __nickname, 
                  CHANGE_NICK = now()
            WHERE account.UID = __IDUSER;

            SET __RET = 1;

         END;
      ELSE 
         SET __RET = 0;
	END IF;

      SELECT __RET;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateAttendanceReward` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateAttendanceReward`(
	__IDUSER INT,
	__COUNTER INT,
	__ITEM_TYPEID_NOW INT,
	__ITEM_QNTD_NOW INT,
	__ITEM_TYPEID_AFTER INT,
	__ITEM_QNTD_AFTER INT,
	__LAST_LOGIN datetime
)
BEGIN
	
   IF __IDUSER > 0 THEN
   BEGIN
		UPDATE pangya.pangya_attendance_reward
			SET `counter` = __COUNTER,
				item_typeid_now = __ITEM_TYPEID_NOW,
				item_qntd_now = __ITEM_QNTD_NOW,
				item_typeid_after = __ITEM_TYPEID_AFTER,
				item_qntd_after = __ITEM_QNTD_AFTER,
				last_login = __LAST_LOGIN
		WHERE UID = __IDUSER;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateAuthServerKey` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateAuthServerKey`(
	_SERVER_UID INT,
	_KEY NVARCHAR(16),
	VALID TINYINT
)
BEGIN
	
    IF _SERVER_UID > 0 THEN
	BEGIN
		UPDATE pangya.pangya_auth_key
			SET `key` = _KEY,
				valid = VALID
		WHERE Server_UID = _SERVER_UID;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateBotGMEventReward` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateBotGMEventReward`(
	__ID BIGINT,
	__TYPEID INT,
	__QNTD INT,
	__QNTD_TIME INT,
	__RATE INT,
	__VALID TINYINT
)
BEGIN

	IF __ID > 0 AND __TYPEID > 0 THEN
	BEGIN

		UPDATE pangya.pangya_bot_gm_event_reward
			SET
				typeid = __TYPEID,
				qntd = __QNTD,
				qntd_time = __QNTD_TIME,
				rate = __RATE,
				valid = __VALID
		WHERE
			`index` = __ID;

		SELECT __ID AS ID;

	END;
	ELSE
		SELECT -1 AS ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateBotGMEventTime` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateBotGMEventTime`(
	__ID BIGINT,
	__INICIO_TIME TIME,
	__FIM_TIME TIME,
	__CHANNEL_ID TINYINT,
	__VALID TINYINT
)
BEGIN

	IF __ID > 0 AND __INICIO_TIME IS NOT NULL AND __FIM_TIME IS NOT NULL THEN
	BEGIN

		UPDATE pangya.pangya_bot_gm_event_time
			SET
				inicio_time = __INICIO_TIME,
				fim_time = __FIM_TIME,
				channel_id = __CHANNEL_ID,
				valid = __VALID
		WHERE
			`index` = __ID;

		SELECT __ID AS ID;

	END;
	ELSE
		SELECT -1 AS ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateCaddieHolyDay` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateCaddieHolyDay`(
	__IDUSER INT,
	__IDITEM INT,
	__END_DATE DATETIME
)
BEGIN

	UPDATE pangya.pangya_caddie_information SET EndDate = __END_DATE WHERE UID = __IDUSER AND item_id = __IDITEM;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateCaddieInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateCaddieInfo`(
	__IDUSER INT,
	__ID INT,
	__TYPEID INT,
	__PARTS_TYPEID INT,
	__LEVEL TINYINT,
	__EXP INT,
	__RENT_FLAG TINYINT,
	__PURCHASE TINYINT,
	__CHECK_END SMALLINT,
	__END_DT DATETIME,
	__PARTS_END_DT DATETIME
)
BEGIN

	IF __IDUSER > 0 THEN
	BEGIN
		UPDATE pangya.pangya_caddie_information
			SET parts_typeid = __PARTS_TYPEID,
				cLevel = __LEVEL,
				Exp = __EXP,
				RentFlag = __RENT_FLAG,
				Purchase = __PURCHASE,
				CheckEnd = __CHECK_END,
				EndDate = __END_DT,
				parts_EndDate = __PARTS_END_DT
		WHERE UID = __IDUSER AND item_id = __ID AND typeid = __TYPEID;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateCaddieItem` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateCaddieItem`(
	__IDUSER INT,
	__IDITEM INT,
	__TYPEID INT,
	__END_DATE DATETIME
)
BEGIN

	UPDATE pangya.pangya_caddie_information SET parts_typeid = __TYPEID, parts_enddate = __END_DATE WHERE UID = __IDUSER AND item_id = __IDITEM;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateCardSpecialTime` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateCardSpecialTime`(
	__IDUSER INT,
	__INDEX BIGINT,
	__ITEM_TYPEID INT,
	__EFEITO_TYPE INT,
	__EFEITO_QNTD INT,
	__TIPO INT,
	__END_DATE datetime
)
BEGIN

	IF __IDUSER > 0 AND __INDEX > 0 THEN
	BEGIN
		UPDATE pangya.pangya_card_equip 
			SET card_typeid = __ITEM_TYPEID,
				Efeito = __EFEITO_TYPE,
				Efeito_Qntd = __EFEITO_QNTD,
				Tipo = __TIPO,
				END_DT = IFNULL(__END_DATE, now())
		WHERE UID = __IDUSER AND `index` = __INDEX  AND use_yn = 1;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateCharacterPCL` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateCharacterPCL`(
	__IDUSER INT,
	__ITEM_ID INT,
	__C0 SMALLINT,
	__C1 SMALLINT,
	__C2 SMALLINT,
	__C3 SMALLINT,
	__C4 SMALLINT
)
BEGIN

	IF __IDUSER > 0 AND __ITEM_ID > 0 THEN
	BEGIN
		UPDATE pangya.pangya_character_information SET PCL0 = __C0, PCL1 = __C1, PCL2 = __C2, PCL3 = __C3, PCL4 = __C4
		WHERE UID = __IDUSER AND item_id = __ITEM_ID;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateChatMacroUser` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateChatMacroUser`(
	__IDUSER INT,
	__M1 NVARCHAR(500),
	__M2 NVARCHAR(500),
	__M3 NVARCHAR(500),
	__M4 NVARCHAR(500),
	__M5 NVARCHAR(500),
	__M6 NVARCHAR(500),
	__M7 NVARCHAR(500),
	__M8 NVARCHAR(500),
	__M9 NVARCHAR(500)
)
BEGIN

	IF __IDUSER > 0 THEN
	BEGIN
		UPDATE pangya.pangya_user_macro 
			SET  Macro1 = __M1
				,Macro2 = __M2
				,Macro3 = __M3
				,Macro4 = __M4
				,Macro5 = __M5
				,Macro6 = __M6
				,Macro7 = __M7
				,Macro8 = __M8
				,Macro9 = __M9
		WHERE UID = __IDUSER;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateClubSetStats` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateClubSetStats`(
	__IDUSER INT,
	__ITEM_ID INT,
	__PANG BIGINT,
	__C0 SMALLINT,
	__C1 SMALLINT,
	__C2 SMALLINT,
	__C3 SMALLINT,
	__C4 SMALLINT
)
BEGIN

	IF __IDUSER > 0 AND __ITEM_ID > 0 THEN
	BEGIN
		UPDATE pangya.pangya_item_warehouse SET C0 = __C0, C1 = __C1, C2 = __C2, C3 = __C3, C4 = __C4
		WHERE UID = __IDUSER AND item_id = __ITEM_ID;

		IF __PANG > 0 THEN
		BEGIN
			IF (SELECT UID FROM pangya.pangya_clubset_enchant WHERE UID = __IDUSER AND item_id = __ITEM_ID LIMIT 1) IS NOT NULL THEN
			BEGIN
				INSERT INTO pangya.pangya_clubset_enchant(UID, item_id) VALUES(__IDUSER, __ITEM_ID);
			END;
            END IF;

			UPDATE pangya.pangya_clubset_enchant SET pang = pang + pang WHERE UID = __IDUSER AND item_id = __ITEM_ID;
		END;
        END IF;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateClubSetTime` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateClubSetTime`(
	__IDUSER INT,
	__IDITEM INT,
	__ITEMTYPEID INT,
	__END_DATE DATETIME
)
BEGIN

	UPDATE pangya.pangya_item_warehouse SET EndDate = __END_DATE WHERE UID = __IDUSER AND item_id = __IDITEM AND typeid = __ITEMTYPEID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateClubSetWorkshop` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateClubSetWorkshop`(
	__IDUSER INT,
	__ITEM_ID INT,
	__LEVEL INT,
	__C0 SMALLINT,
	__C1 SMALLINT,
	__C2 SMALLINT,
	__C3 SMALLINT,
	__C4 SMALLINT,
	__MASTERY INT,
	__RANK INT,
	__RECOVERY INT,
	__FLAG INT
)
BEGIN

	IF __IDUSER > 0 AND __ITEM_ID > 0 THEN
	BEGIN
		
		IF __FLAG = 4 THEN	-- UP RANK CLUBSET tira Mastery e add aos mastery GASTO
		BEGIN
			UPDATE pangya.pangya_item_warehouse
			SET Mastery_Gasto = Mastery_Gasto + (Mastery_Pts - __MASTERY)	-- Aqui tem que add, diminui o Mastery, mas tem que aumentar no Mastery Gasto
			WHERE UID = __IDUSER AND item_id = __ITEM_ID;
		END;
		ELSEIF __FLAG = 0 THEN	-- TRANSFER MASTERY POINTS
		BEGIN
			UPDATE pangya.pangya_item_warehouse
			SET Total_Mastery_Pts = Total_Mastery_Pts + (__MASTERY - Mastery_Pts) -- ATT o TOTAL de Mastery Pts
			WHERE UID = __IDUSER AND item_id = __ITEM_ID;
		END;
        END IF;

		UPDATE pangya.pangya_item_warehouse 
		SET ClubSet_WorkShop_C0 = __C0,
			ClubSet_WorkShop_C1 = __C1,
			ClubSet_WorkShop_C2 = __C2,
			ClubSet_WorkShop_C3 = __C3,
			ClubSet_WorkShop_C4 = __C4,
			`Level` = __LEVEL,
			Mastery_Pts = __MASTERY,
			Up = __RANK,	-- UP é o RANK
			Recovery_Pts = __RECOVERY
		WHERE UID = __IDUSER AND item_id = __ITEM_ID;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateCoinCubeLocation` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateCoinCubeLocation`(
	___ID BIGINT,
	___COURSE TINYINT,
	___HOLE TINYINT,
	___TIPO TINYINT,
	___TIPO_LOCATION TINYINT,
	___RATE BIGINT,
	___X FLOAT,
	___Y FLOAT,
	___Z FLOAT
)
BEGIN

	IF ___ID > 0 THEN
	BEGIN

		-- Update
		UPDATE
			pangya.pangya_coin_cube_location
		SET
			course = ___COURSE,
			hole = ___HOLE,
			tipo = ___TIPO,
			tipo_location = ___TIPO_LOCATION,
			rate = ___RATE,
			x = ___X,
			y = ___Y,
			z = ___z,
			reg_date = now()
		WHERE
			`index` = ___ID;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateCommand` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateCommand`(
	__IDX INT,
	__COMMAND_ID INT,
	__ARG1 INT,
	__ARG2 INT,
	__ARG3 INT,
	__ARG4 INT,
	__ARG5 INT,
	__TARGET INT,
	__FLAG SMALLINT,
	__VALID SMALLINT,
	__RESERVEDATE DATETIME
)
BEGIN

	IF __IDX > 0 THEN
	BEGIN

		UPDATE pangya.pangya_command
			SET command_id = __COMMAND_ID,
				arg1 = __ARG1,
				arg2 = __ARG2,
				arg3 = __ARG3,
				arg4 = __ARG4,
				arg5 = __ARG5,
				`target` = __TARGET,
				flag = __FLAG,
				valid = __VALID,
				reserveDate = __RESERVEDATE
		WHERE idx = __IDX;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateCountDayLuciaAttendance` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateCountDayLuciaAttendance`(
	__UID INT,
	__COUNT_DAY INT
)
BEGIN

	IF __UID > 0 THEN
	BEGIN

		UPDATE pangya.pangya_lucia_attendance
			SET count_day = __COUNT_DAY,
				last_day_attendance = now()
		WHERE UID = __UID;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateDailyQuest` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateDailyQuest`(
	__achieve_quest_1_in int,
	__achieve_quest_2_in int,
	__achieve_quest_3_in int,
	__REG_DT DATETIME
)
BEGIN
	
	-- Block TABLE
	START TRANSACTION;

	IF (SELECT count(*) FROM pangya.pangya_daily_quest FOR UPDATE) > 0 THEN

		UPDATE pangya.pangya_daily_quest
		SET 
			achieve_quest_1 = __achieve_quest_1_in, 
			achieve_quest_2 = __achieve_quest_2_in, 
			achieve_quest_3 = __achieve_quest_3_in, 
			Reg_Date = __REG_DT
		WHERE Reg_Date IS NULL OR TIMESTAMPDIFF(DAY, CAST(Reg_Date AS DATE), CAST(now() AS DATE)) >= 1;

	ELSE
		INSERT pangya.pangya_daily_quest(achieve_quest_1, achieve_quest_2, achieve_quest_3, Reg_Date)
		VALUES (__achieve_quest_1_in, __achieve_quest_2_in, __achieve_quest_3_in, __REG_DT);
	END IF;

	IF (SELECT ROW_COUNT()) >= 1 THEN
		SELECT 1 AS OK, 0, 0, 0, null;
	ELSE
	BEGIN
		SELECT 0 AS OK, a.* FROM pangya.pangya_daily_quest a;
	END;
    END IF;

	COMMIT;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateDailyQuestUser` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateDailyQuestUser`(
	__UID BIGINT,
	__ACCEPT DATETIME,
	__TODAY DATETIME
)
BEGIN

	UPDATE pangya.pangya_daily_quest_player SET last_quest_accept = __ACCEPT, today_quest = __TODAY WHERE UID = __UID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateDonationNew` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateDonationNew`(
	__CODE NVARCHAR(50),
	__PLATAFORMA TINYINT,
	__UID INT,
	__STATUS TINYINT,
	__UPDATE DATETIME,
	__EPIN_ID BIGINT,
	__GROSS_AMOUNT FLOAT,
	__NET_AMOUNT FLOAT,
	__ESCROW_DATE DATETIME
)
BEGIN

	DECLARE __ID BIGINT DEFAULT -1;

	SELECT `index` INTO __ID FROM pangya.pangya_donation_new WHERE `code` = __CODE AND plataforma = __PLATAFORMA;
	
	IF __CODE != '' AND __UPDATE IS NOT NULL AND __ID != -1 THEN
	BEGIN

		UPDATE pangya.pangya_donation_new
			SET
				UID = __UID,
				`status` = __STATUS,
				`update` = __UPDATE,
				epin_id = __EPIN_ID,
				gross_amount = __GROSS_AMOUNT,
				net_amount = __NET_AMOUNT,
				escrow = __ESCROW_DATE
		WHERE
			`index` = __ID;

		SELECT __ID AS ID;

	END;
    ELSE
		SELECT -1 AS ID;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateDonationNewByGM` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateDonationNewByGM`(
	__ID BIGINT,
	__CODE NVARCHAR(50),
	__PLATAFORMA TINYINT,
	__UID INT,
	__STATUS TINYINT,
	__UPDATE DATETIME,
	__EPIN_ID BIGINT,
	__GROSS_AMOUNT FLOAT,
	__NET_AMOUNT FLOAT,
	__ESCROW_DATE DATETIME,
	__EMAIL NVARCHAR(200),
	__DATE DATETIME,
	__TYPE TINYINT,
	__REFERENCE NVARCHAR(200)
)
BEGIN

	IF __CODE != '' AND __UPDATE IS NOT NULL AND __ID != -1 THEN
	BEGIN

		UPDATE pangya.pangya_donation_new
			SET
				`code` = __CODE,
				plataforma = __PLATAFORMA,
				UID = __UID,
				`status` = __STATUS,
				`update` = __UPDATE,
				epin_id = __EPIN_ID,
				gross_amount = __GROSS_AMOUNT,
				net_amount = __NET_AMOUNT,
				escrow = __ESCROW_DATE,
				`reference` = __REFERENCE,
				`date` = __DATE,
				email = __EMAIL,
				`type` = __TYPE
		WHERE
			`index` = __ID;

		SELECT __ID AS ID;

	END;
    ELSE
		SELECT -1 AS ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateFriendInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateFriendInfo`(
	__IDUSER INT,
	__FRIEND_UID INT,
	__FRIEND_APELIDO NVARCHAR(15),
	__FRIEND_UNK1 INT,
	__FRIEND_UNK2 INT,
	__FRIEND_UNK3 INT,
	__FRIEND_UNK4 INT,
	__FRIEND_UNK5 INT,
	__FRIEND_UNK6 INT,
	__FRIEND_FLAG1 SMALLINT,
	__FRIEND_STATE TINYINT
)
BEGIN

	IF __IDUSER > 0 AND __FRIEND_UID > 0 THEN
	BEGIN
		UPDATE pangya.pangya_friend_list 
			SET  apelido = __FRIEND_APELIDO
				,unknown1 = __FRIEND_UNK1
				,unknown2 = __FRIEND_UNK2
				,unknown3 = __FRIEND_UNK3
				,unknown4 = __FRIEND_UNK4
				,unknown5 = __FRIEND_UNK5
				,unknown6 = __FRIEND_UNK6
				,flag1 = __FRIEND_FLAG1
				,state_flag = __FRIEND_STATE
		WHERE UID = __IDUSER AND uid_friend = __FRIEND_UID;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateGachaJPTicketPlayer` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateGachaJPTicketPlayer`(
	__UID INT,
	__TICKET SMALLINT,
	__TICKET_ID INT,
	__TICKET_SUB SMALLINT,
	__TICKET_SUB_ID INT
)
BEGIN

	IF __UID > 0 THEN
	BEGIN
		-- Ticket
		UPDATE pangya.pangya_item_warehouse
			SET
				c0 = __TICKET
		WHERE UID = __UID AND item_id = __TICKET_ID;

		-- Ticket Sub
		UPDATE pangya.pangya_item_warehouse
			SET
				c0 = __TICKET_SUB
		WHERE UID = __UID AND item_id = __TICKET_SUB_ID;
        
        SELECT 1 AS OK;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateGoldenTimeEvent` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateGoldenTimeEvent`(
	__ID BIGINT,
	__TYPE TINYINT,
	__BEGIN DATE,
	__END DATE,
	__RATE INT,
	__IS_END TINYINT
)
BEGIN

	IF __ID > 0 AND __BEGIN IS NOT NULL THEN
	BEGIN

		UPDATE pangya.pangya_golden_time_info
			SET
				`type` = __TYPE,
				`begin` = __BEGIN,
				`end` = __END,
				rate = __RATE,
				is_end = __IS_END
		WHERE
			`index` = __ID;

		SELECT __ID AS ID;

	END;
	ELSE
		SELECT -1 AS ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateGoldenTimeItem` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateGoldenTimeItem`(
	__ID BIGINT,
	__TYPEID INT,
	__QNTD INT,
	__QNTD_TIME INT,
	__RATE INT
)
BEGIN

	IF __ID > 0 AND __TYPEID > 0 THEN
	BEGIN

		UPDATE pangya.pangya_golden_time_item
			SET
				typeid = __TYPEID,
				qntd = __QNTD,
				qntd_time = __QNTD_TIME,
				rate = __RATE
		WHERE
			`index` = __ID;

		SELECT __ID AS ID;

	END;
	ELSE
		SELECT -1 AS ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateGoldenTimeRound` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateGoldenTimeRound`(
	__ID BIGINT,
	__TIME TIME
)
BEGIN

	IF __ID > 0 AND __TIME IS NOT NULL THEN
	BEGIN

		UPDATE pangya.pangya_golden_time_round
			SET
				`time` = __TIME
		WHERE
			`index` = __ID;

		SELECT __ID AS ID;

	END;
	ELSE
		SELECT -1 AS ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateGuildInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateGuildInfo`(
	__GUILD_UID INT,
	__CONDITION_LEVEL SMALLINT,
	__PERMITION_JOIN TINYINT,
	__MASTER_COMMENT NVARCHAR(50)
)
BEGIN

	IF __GUILD_UID > 0 THEN -- AND __MASTER_COMMENT != N''
	BEGIN

		UPDATE
			pangya.pangya_guild
				SET GUILD_CONDITION_LEVEL = __CONDITION_LEVEL,
					GUILD_PERMITION_JOIN = __PERMITION_JOIN,
					GUILD_NOTICE = __MASTER_COMMENT
		WHERE GUILD_UID = __GUILD_UID;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateGuildIntroImg` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateGuildIntroImg`(
	__GUILD_UID INT,
	__INTRO_IMG NVARCHAR(50)
)
BEGIN

	IF __GUILD_UID > 0 AND __INTRO_IMG != '' THEN
	BEGIN
		
		UPDATE
			pangya.pangya_guild
				SET GUILD_INTRO_IMG = __INTRO_IMG
		WHERE GUILD_UID = __GUILD_UID;

		-- Insert Log
		INSERT INTO pangya.pangya_guild_intro_img_log(intro_img) VALUES(__INTRO_IMG);

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateGuildMemberPoints` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateGuildMemberPoints`(
	__GUILD_UID INT,
	__MEMBER_UID INT,
	__POINT INT,
	__PANG INT
)
BEGIN

	IF __GUILD_UID > 0 AND __MEMBER_UID > 0 THEN
	BEGIN

		UPDATE pangya_guild_member
			SET GUILD_POINT = GUILD_POINT + __POINT,
				GUILD_PANG = GUILD_PANG + __PANG
		WHERE GUILD_UID = __GUILD_UID AND MEMBER_UID = __MEMBER_UID;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateGuildMessageIntro` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateGuildMessageIntro`(
	__GUILD_UID INT,
	__MSG_INTRO NVARCHAR(50)
)
BEGIN

	IF __GUILD_UID > 0 THEN -- AND __MSG_INTRO != N''
	BEGIN

		UPDATE
			pangya.pangya_guild
				SET GUILD_INFO = __MSG_INTRO
		WHERE GUILD_UID = __GUILD_UID;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateGuildNewMarkIdx` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateGuildNewMarkIdx`(
	__GUILD_UID INT,
	__MASTER INT,
	__NEW_MARK_IDX INT
)
BEGIN

	DECLARE __RET INT DEFAULT -1;
	
	IF __GUILD_UID > 0 AND __NEW_MARK_IDX > 0 AND __MASTER > 0 THEN
	BEGIN

		IF (SELECT GUILD_UID FROM pangya.pangya_guild WHERE GUILD_UID = __GUILD_UID AND GUILD_LEADER = __MASTER) IS NOT NULL THEN
		BEGIN

			DECLARE __PANG BIGINT DEFAULT (SELECT pang FROM pangya.user_info WHERE UID = __MASTER);

			-- Verifica se ele tem os 5k de pangs para fazer o pedido para trocar de guild mark
			IF __PANG IS NOT NULL AND __PANG >= 5000 THEN
			BEGIN

				UPDATE
					pangya.pangya_guild
						SET GUILD_NEW_MARK_IDX = __NEW_MARK_IDX
				WHERE GUILD_UID = __GUILD_UID;

				-- Tira os 5k de pangs é o valor para trocar o guild mark
				UPDATE
					pangya.user_info
						SET Pang = __PANG - 5000
				WHERE UID = __MASTER;

				-- Sucesso
				SET __RET = 1;

			END;
			ELSE
				SET __RET = -2;	-- Não tem pangs suficiente para trocar o guild mark
			END IF;

		END;
		ELSE
			SET __RET = -3;	-- Player não é o master da Guild
		END IF;

	END;
    END IF;

	SELECT __RET AS RET;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateGuildPoints` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateGuildPoints`(
	__UID INT,
	__POINT BIGINT,
	__PANG BIGINT,
	__FLAG_WIN TINYINT
)
BEGIN

	IF __UID > 0 THEN
	BEGIN

		UPDATE pangya.pangya_guild
			SET GUILD_POINT = GUILD_POINT + __POINT,
				GUILD_PANG = GUILD_PANG + __PANG,
				GUILD_WIN = IF(__FLAG_WIN = 0/*WIN*/, GUILD_WIN + 1, GUILD_WIN),
				GUILD_LOSE = IF(__FLAG_WIN = 1/*LOSE*/, GUILD_LOSE + 1, GUILD_LOSE),
				GUILD_DRAW = IF(__FLAG_WIN = 2/*DRAW*/, GUILD_DRAW + 1, GUILD_DRAW)
		WHERE GUILD_UID = __UID;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateItemBuffTime` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateItemBuffTime`(
	__IDUSER INT,
	__INDEX BIGINT,
	__ITEM_TYPEID INT,
	__TIPO INT,
	__END_DT datetime
)
BEGIN

	IF __IDUSER > 0 AND __INDEX > 0 THEN
	BEGIN
		UPDATE pangya.pangya_item_buff 
			SET typeid = __ITEM_TYPEID,
				tipo = __TIPO,
				end_date = IFNULL(__END_DT, now())
		WHERE UID = __IDUSER AND `index` = __INDEX  AND use_yn = 1;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateLast5PlayerGame` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateLast5PlayerGame`(
	__IDUSER INT,
	__UID_0 INT,
	__SEX_0 INT,
	__ID_0 NVARCHAR(22),
	__NICK_0 NVARCHAR(22),
	__UID_1 INT,
	__SEX_1 INT,
	__ID_1 NVARCHAR(22),
	__NICK_1 NVARCHAR(22),
	__UID_2 INT,
	__SEX_2 INT,
	__ID_2 NVARCHAR(22),
	__NICK_2 NVARCHAR(22),
	__UID_3 INT,
	__SEX_3 INT,
	__ID_3 NVARCHAR(22),
	__NICK_3 NVARCHAR(22),
	__UID_4 INT,
	__SEX_4 INT,
	__ID_4 NVARCHAR(22),
	__NICK_4 NVARCHAR(22)
)
BEGIN

	IF __IDUSER > 0 THEN
	BEGIN
		UPDATE pangya.pangya_last_players_user
			SET UID_0 = __UID_0, SEX_0 = __SEX_0, ID_0 = __ID_0, NICK_0 = __NICK_0,
				UID_1 = __UID_1, SEX_1 = __SEX_1, ID_1 = __ID_1, NICK_1 = __NICK_1,
				UID_2 = __UID_2, SEX_2 = __SEX_0, ID_2 = __ID_2, NICK_2 = __NICK_2,
				UID_3 = __UID_3, SEX_3 = __SEX_3, ID_3 = __ID_3, NICK_3 = __NICK_3,
				UID_4 = __UID_4, SEX_4 = __SEX_4, ID_4 = __ID_4, NICK_4 = __NICK_4
		WHERE UID = __IDUSER;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateLoginRewardEvent` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateLoginRewardEvent`(
	__ID BIGINT,
	__NAME NVARCHAR(50),
	__TYPE TINYINT,
	__DAYS_TO_GIFT INT,
	__N_TIMES_GIFT INT,
	__ITEM_TYPEID INT,
	__ITEM_QNTD INT,
	__ITEM_QNTD_TIME INT,
	__IS_END TINYINT,
	__END_DATE DATETIME
)
BEGIN

	IF __ID > 0 AND __NAME != '' THEN
	BEGIN

		UPDATE pangya.pangya_login_reward
			SET
				`name` = __NAME,
				`type` = __TYPE,
				days_to_gift = __DAYS_TO_GIFT,
				n_times_gift = __N_TIMES_GIFT,
				item_typeid = __ITEM_TYPEID,
				item_qntd = __ITEM_QNTD,
				item_qntd_time = __ITEM_QNTD_TIME,
				is_end = __IS_END,
				end_date = __END_DATE
		WHERE
			`index` = __ID;

		SELECT __ID AS ID;

	END;
	ELSE
		SELECT -1 AS ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `procUpdateLoginRewardPlayer` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `procUpdateLoginRewardPlayer`(
	__ID BIGINT,
	__UID INT,
	__COUNT_DAYS INT,
	__COUNT_SEQ INT,
	__IS_CLEAR TINYINT,
	__UPDATE_DATE DATETIME
)
BEGIN

	IF __ID > 0 AND __UID > 0 THEN
	BEGIN
		
		UPDATE pangya.pangya_login_reward_player
			SET
				COUNT_DAYS = __COUNT_DAYS,
				COUNT_SEQ = __COUNT_SEQ,
				IS_CLEAR = __IS_CLEAR,
				UPDATE_DATE = __UPDATE_DATE
		WHERE
			`index` = __ID AND UID = __UID;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateMapStatistics` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateMapStatistics`(
	__IDUSER INT,
	__TIPO TINYINT,
	__COURSE TINYINT,
	__TACADA INT,
	__PUTT INT,
	__HOLE INT,
	__FAIRWAY INT,
	__HOLEIN INT,
	__PUTTIN INT,
	__TOTAL_SCORE INT,
	__BEST_SCORE SMALLINT,
	__BEST_PANG BIGINT,
	__CHARACTER_TYPEID INT,
	__EVENT_SCORE TINYINT,
	__ASSIST TINYINT
)
BEGIN

	IF __IDUSER > 0 THEN
	BEGIN
		IF (SELECT tacada FROM pangya.pangya_record WHERE UID = __IDUSER AND tipo = __TIPO AND course = __COURSE AND assist = __ASSIST) IS NULL THEN
		BEGIN
			INSERT INTO pangya.pangya_record(uid, tipo, course, tacada, putt, hole, fairway, holein, puttin, total_score, best_score, best_pang, character_typeid, event_score, assist)
				VALUES(__IDUSER, __TIPO, __COURSE, __TACADA, __PUTT, __HOLE, __FAIRWAY, __HOLEIN, __PUTTIN, __TOTAL_SCORE, __BEST_SCORE, __BEST_PANG, __CHARACTER_TYPEID, __EVENT_SCORE, __ASSIST);
		END;
		ELSE
		BEGIN
			UPDATE pangya.pangya_record 
				SET tacada = __TACADA,
					putt = __PUTT,
					hole = __HOLE,
					fairway = __FAIRWAY,
					holein = __HOLEIN,
					puttin = __PUTTIN,
					total_score = __TOTAL_SCORE,
					best_score = __BEST_SCORE,
					best_pang = __BEST_PANG,
					character_typeid = __CHARACTER_TYPEID,
					event_score = __EVENT_SCORE
				WHERE UID = __IDUSER AND tipo = __TIPO AND course = __COURSE AND assist = __ASSIST;

		END;
        END IF;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateMascotInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateMascotInfo`(
	__IDUSER INT,
	__ID INT,
	__TYPEID INT,
	__LEVEL TINYINT,
	__EXP INT,
	__FLAG TINYINT,
	__TIPO SMALLINT,
	__IS_CASH TINYINT,
	__PRICE INT,
	__MESSAGE NVARCHAR(30),
	__END_DT DATETIME
)
BEGIN

	IF __IDUSER > 0 THEN
	BEGIN
		UPDATE pangya.pangya_mascot_info
			SET mLevel = __LEVEL,
				mExp = __EXP,
				Flag = __FLAG,
				Tipo = __TIPO,
				IsCash = __IS_CASH,
				Price = __PRICE,
				Message = __MESSAGE,
				EndDate = __END_DT
		WHERE UID = __IDUSER AND item_id = __ID AND typeid = __TYPEID;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateMascotTime` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateMascotTime`(
	__IDUSER INT,
	__IDITEM INT,
	__END_DATE DATETIME
)
BEGIN

	UPDATE pangya.pangya_mascot_info SET EndDate = __END_DATE WHERE UID = __IDUSER AND item_id = __IDITEM;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdatePapelShopConfig` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdatePapelShopConfig`(
	__NUMERO INT,
	__PRICE_NORMAL BIGINT,
	__PRICE_BIG BIGINT,
	__LIMITTED_PER_DAY TINYINT,
	__UPDATE_DATE DATETIME
)
BEGIN
	
	-- Block TABLE
	START TRANSACTION;

	IF (SELECT count(*) FROM pangya.pangya_papel_shop_config FOR UPDATE) > 0 THEN
	BEGIN
		
		UPDATE pangya.pangya_papel_shop_config
			SET Numero = __NUMERO,
				Price_Normal = __PRICE_NORMAL,
				Price_Big = __PRICE_BIG,
				Limitted_YN = __LIMITTED_PER_DAY,
				Update_Date = __UPDATE_DATE
		WHERE Update_Date IS NULL OR TIMESTAMPDIFF(DAY, CAST(Update_Date AS DATE), CAST(now() AS DATE)) >= 1;

	END;
	ELSE
		INSERT INTO pangya.pangya_papel_shop_config(Numero, Price_Normal, Price_Big, Limitted_YN, Update_Date)
			VALUES(__NUMERO, __PRICE_NORMAL, __PRICE_BIG, __LIMITTED_PER_DAY, __UPDATE_DATE);
	END IF;

	IF (SELECT row_count()) >= 1 THEN
		SELECT 1 AS OK, 0, 0, 0, 0, null;
	ELSE
		SELECT 0 AS OK, a.* FROM pangya.pangya_papel_shop_config a;
	END IF;

	COMMIT;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdatePapelShopInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdatePapelShopInfo`(
	__IDUSER INT,
	__CURRENT_CNT SMALLINT,
	__REMAIN_CNT SMALLINT,
	__LIMIT_CNT SMALLINT,
	__LAST_UPDATE DATETIME
)
BEGIN
	
	IF __IDUSER > 0 THEN
	BEGIN
		UPDATE pangya.pangya_papel_shop_info 
			SET current_cnt = __CURRENT_CNT, 
				remain_cnt = __REMAIN_CNT,
				limit_cnt = __LIMIT_CNT,
				last_update = __LAST_UPDATE
		WHERE UID = __IDUSER;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdatePlayerLocation` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdatePlayerLocation`(
	__IDUSER INT,
	__CHANNEL SMALLINT,
	__LOBBY SMALLINT,
	__ROOM SMALLINT,
	__PLACE SMALLINT
)
BEGIN
	
	IF __IDUSER > 0 THEN
   BEGIN
		UPDATE pangya.pangya_player_location
			SET channel = __CHANNEL,
				lobby = __LOBBY,
				room = __ROOM,
				place = __PLACE
		WHERE UID = __IDUSER;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdatePremiumTicketTime` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdatePremiumTicketTime`(
	__IDUSER INT,
	__IDITEM int,
	__TEMPO INT,
	__C_0 smallint,
	__C_1 smallint,
	__C_2 smallint,
	__C_3 smallint,
	__C_4 smallint
)
BEGIN

	IF __IDUSER > 0 AND __IDITEM > 0 THEN
	BEGIN
		UPDATE pangya.pangya_item_warehouse
			SET
				EndDate = TIMESTAMPADD(DAY, __TEMPO, now()),
				C0 = __C_0,
				C1 = __C_1,
				C2 = __C_2,
				C3 = __C_3,
				C4 = __C_4
		WHERE
			UID = __IDUSER AND item_id = __IDITEM;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateQuestUser` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateQuestUser`(
	__IDUSER BIGINT,
	__QUEST_ID INT,
	__COUNTERT_ITEM_ID INT,
	__DATE DATETIME
)
BEGIN

	UPDATE pangya.pangya_quest SET counter_item_id = __COUNTERT_ITEM_ID, `date` = __DATE  WHERE UID = __IDUSER AND id = __QUEST_ID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateRateConfigInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateRateConfigInfo`(
	_SERVER_UID INT,
	_GRAND_ZODIAC_EVENT SMALLINT,
	_SCRATCHY SMALLINT,
	_PAPEL_SHOP_RARE_ITEM SMALLINT,
	_PAPEL_SHOP_COOKIE_ITEM SMALLINT,
	_TREASURE SMALLINT,
	_PANG SMALLINT,
	_EXP SMALLINT,
	_CLUB_MASTERY SMALLINT,
	_CHUVA SMALLINT,
	_MEMORIAL_SHOP SMALLINT,
	_ANGEL_EVENT SMALLINT,
	_GRAND_PRIX_EVENT SMALLINT,
	_GOLDEN_TIME_EVENT SMALLINT,
	_LOGIN_REWARD_EVENT SMALLINT,
	_BOT_GM_EVENT SMALLINT,
	_SMART_CALCULATOR SMALLINT
)
BEGIN
	
	IF _SERVER_UID > 0 THEN
	BEGIN

		IF (SELECT UID FROM pangya.pangya_config WHERE UID = _SERVER_UID) IS NOT NULL THEN
		BEGIN	-- Update
			UPDATE pangya.pangya_config
				SET GrandZodiacEventTime = _GRAND_ZODIAC_EVENT,
					ScratchyPorPointRate = _SCRATCHY,
					PapelShopRareItemRate = _PAPEL_SHOP_RARE_ITEM,
					PapelShopCookieItemRate = _PAPEL_SHOP_COOKIE_ITEM,
					TreasureRate = _TREASURE,
					PangRate = _PANG,
					ExpRate = _EXP,
					ClubMasteryRate = _CLUB_MASTERY,
					ChuvaRate = _CHUVA,
					MemorialShopRate = _MEMORIAL_SHOP,
					AngelEvent = _ANGEL_EVENT,
					GrandPrixEvent = _GRAND_PRIX_EVENT,
					GoldenTimeEvent = _GOLDEN_TIME_EVENT,
					LoginRewardEvent = _LOGIN_REWARD_EVENT,
					BotGMEvent = _BOT_GM_EVENT,
					SmartCalculator = _SMART_CALCULATOR
			WHERE UID = _SERVER_UID;
		END;
		ELSE
		BEGIN
			-- Cria um novo server config rate
			INSERT INTO pangya.pangya_config(UID, GrandZodiacEventTime, ScratchyPorPointRate, PapelShopRareItemRate, PapelShopCookieItemRate, TreasureRate, PangRate, ExpRate, ClubMasteryRate, ChuvaRate, MemorialShopRate, AngelEvent, GrandPrixEvent, GoldenTimeEvent, LoginRewardEvent, BotGMEvent, SmartCalculator)
				VALUES(_SERVER_UID, _GRAND_ZODIAC_EVENT, _SCRATCHY, _PAPEL_SHOP_RARE_ITEM, _PAPEL_SHOP_COOKIE_ITEM, _TREASURE, _PANG, _EXP, _CLUB_MASTERY, _CHUVA, _MEMORIAL_SHOP, _ANGEL_EVENT, _GRAND_PRIX_EVENT, _GOLDEN_TIME_EVENT, _LOGIN_REWARD_EVENT, _BOT_GM_EVENT, _SMART_CALCULATOR);
		END;
        END IF;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateRescuePasswordAndID` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateRescuePasswordAndID`(
	__UID INT,
	__INDEX BIGINT
)
BEGIN

	IF __UID > 0 AND __INDEX > 0 THEN
	BEGIN
		
		UPDATE pangya.pangya_rescue_pwd_log SET state = 1 WHERE `index` = __INDEX AND UID = __UID;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateTrofelNormal` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateTrofelNormal`(
	__IDUSER INT,
	__AMA_1_G SMALLINT,
	__AMA_1_S SMALLINT,
	__AMA_1_B SMALLINT,
	__AMA_2_G SMALLINT,
	__AMA_2_S SMALLINT,
	__AMA_2_B SMALLINT,
	__AMA_3_G SMALLINT,
	__AMA_3_S SMALLINT,
	__AMA_3_B SMALLINT,
	__AMA_4_G SMALLINT,
	__AMA_4_S SMALLINT,
	__AMA_4_B SMALLINT,
	__AMA_5_G SMALLINT,
	__AMA_5_S SMALLINT,
	__AMA_5_B SMALLINT,
	__AMA_6_G SMALLINT,
	__AMA_6_S SMALLINT,
	__AMA_6_B SMALLINT,
	__PRO_1_G SMALLINT,
	__PRO_1_S SMALLINT,
	__PRO_1_B SMALLINT,
	__PRO_2_G SMALLINT,
	__PRO_2_S SMALLINT,
	__PRO_2_B SMALLINT,
	__PRO_3_G SMALLINT,
	__PRO_3_S SMALLINT,
	__PRO_3_B SMALLINT,
	__PRO_4_G SMALLINT,
	__PRO_4_S SMALLINT,
	__PRO_4_B SMALLINT,
	__PRO_5_G SMALLINT,
	__PRO_5_S SMALLINT,
	__PRO_5_B SMALLINT,
	__PRO_6_G SMALLINT,
	__PRO_6_S SMALLINT,
	__PRO_6_B SMALLINT,
	__PRO_7_G SMALLINT,
	__PRO_7_S SMALLINT,
	__PRO_7_B SMALLINT
)
BEGIN

	IF __IDUSER > 0 THEN
	BEGIN
		UPDATE pangya.trofel_stat
			SET AMA_1_G = __AMA_1_G,
				AMA_1_S = __AMA_1_S,
				AMA_1_B = __AMA_1_B,
				AMA_2_G = __AMA_2_G,
				AMA_2_S = __AMA_2_S,
				AMA_2_B = __AMA_2_B,
				AMA_3_G = __AMA_3_G,
				AMA_3_S = __AMA_3_S,
				AMA_3_B = __AMA_3_B,
				AMA_4_G = __AMA_4_G,
				AMA_4_S = __AMA_4_S,
				AMA_4_B = __AMA_4_B,
				AMA_5_G = __AMA_5_G,
				AMA_5_S = __AMA_5_S,
				AMA_5_B = __AMA_5_B,
				AMA_6_G = __AMA_6_G,
				AMA_6_S = __AMA_6_S,
				AMA_6_B = __AMA_6_B,
				PRO_1_G = __PRO_1_G,
				PRO_1_S = __PRO_1_S,
				PRO_1_B = __PRO_1_B,
				PRO_2_G = __PRO_2_G,
				PRO_2_S = __PRO_2_S,
				PRO_2_B = __PRO_2_B,
				PRO_3_G = __PRO_3_G,
				PRO_3_S = __PRO_3_S,
				PRO_3_B = __PRO_3_B,
				PRO_4_G = __PRO_4_G,
				PRO_4_S = __PRO_4_S,
				PRO_4_B = __PRO_4_B,
				PRO_5_G = __PRO_5_G,
				PRO_5_S = __PRO_5_S,
				PRO_5_B = __PRO_5_B,
				PRO_6_G = __PRO_6_G,
				PRO_6_S = __PRO_6_S,
				PRO_6_B = __PRO_6_B,
				PRO_7_G = __PRO_7_G,
				PRO_7_S = __PRO_7_S,
				PRO_7_B = __PRO_7_B
		WHERE UID = __IDUSER;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateTryHackingPlayerLuciaAttendance` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateTryHackingPlayerLuciaAttendance`(
	__UID INT,
	__TRY_HACKING INT
)
BEGIN

	IF __UID > 0 THEN
	BEGIN

		UPDATE pangya.pangya_lucia_attendance SET try_hacking_count = __TRY_HACKING WHERE UID = __UID;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateUCC` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateUCC`(
	__IDUSER INT,
	__UCC_ID INT,
	__UCC_IDX NVARCHAR(8),
	__UCC_NAME NVARCHAR(40),
	__DT_DRAW datetime,
	__COPIER_NICK NVARCHAR(22),
	__COPIER INT,
	__STATUS TINYINT,
	__USE_YN NVARCHAR(1),
	__TYPE TINYINT
)
BEGIN

	IF __IDUSER > 0 AND __UCC_ID > 0 THEN
	BEGIN
		IF __TYPE = 2/*COPY UCC*/ THEN
		BEGIN
			DECLARE __SEQ INT DEFAULT IFNULL((SELECT COUNT(seq) as COUNT FROM pangya.tu_ucc WHERE UCCIDX = __UCC_IDX), 0);
			
			SET __SEQ = CASE WHEN __SEQ = 0 THEN 1 ELSE __SEQ + 1 END;

			UPDATE pangya.tu_ucc
			SET USE_YN = __USE_YN
				 ,UCC_NAME = __UCC_NAME
				 ,DRAW_DT = __DT_DRAW
				 ,UCCIDX = __UCC_IDX
				 ,COPIER_NICK = __COPIER_NICK
				 ,COPIER = __COPIER
				 ,`STATUS` = __STATUS
				 ,SEQ = __SEQ
			WHERE
				UID = __IDUSER
				AND item_id = __UCC_ID;

			SELECT __SEQ AS SEQ;
		END;
		ELSE /*SAVE TEMPORARIO E DEFINITIVO*/
		BEGIN
			UPDATE pangya.tu_ucc
			SET USE_YN = __USE_YN
				 ,UCC_NAME = __UCC_NAME
				 ,DRAW_DT = __DT_DRAW
				 ,UCCIDX = __UCC_IDX
				 ,COPIER_NICK = __COPIER_NICK
				 ,COPIER = __COPIER
				 ,`STATUS` = __STATUS
			WHERE
				UID = __IDUSER
				AND item_id = __UCC_ID;
	
			SELECT __UCC_ID AS ITEM_ID;
		END;
        END IF;
	END;
	ELSE
		SELECT __UCC_ID AS ITEM_ID;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUpdateUserInfo` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUpdateUserInfo`(
	__IDUSER INT,
	__BEST_DRIVE FLOAT,
	__BEST_LONG_PUTT FLOAT,
	__BEST_CHIPIN FLOAT,
	__COMBO INT,
	__ALL_COMBO INT,
	__TACADA INT,
	__PUTT INT,
	__TEMPO INT,
	__TEMPO_TACADA INT,
	__ACERTO_PANGYA INT,
	__TIMEOUT INT,
	__OB INT,
	__TOTAL_DISTANCIA INT,
	__HOLE INT,
	__HOLEIN INT,
	__HIO INT,
	__BUNKER SMALLINT,
	__FAIRWAY INT,
	__ALBATROSS INT,
	__MAD_CONDUTA INT,
	__PUTTIN INT,
	/*__EXP INT, exp, level e pang, não atualiza aqui, por que ele tem os seus próprios
	__LEVEL TINYINT,
	__PANG BIGINT,*/
	__MEDIA_SCORE INT,
	__BEST_SCORE_0 TINYINT,
	__BEST_SCORE_1 TINYINT,
	__BEST_SCORE_2 TINYINT,
	__BEST_SCORE_3 TINYINT,
	__BEST_SCORE_4 TINYINT,
	__BEST_PANG_0 BIGINT,
	__BEST_PANG_1 BIGINT,
	__BEST_PANG_2 BIGINT,
	__BEST_PANG_3 BIGINT,
	__BEST_PANG_4 BIGINT,
	__SUM_PANG BIGINT,
	__EVENT_FLAG TINYINT,
	__JOGADO INT,
	__TEAM_GAME INT,
	__TEAM_WIN INT,
	__TEAM_HOLE INT,
	__LADDER_POINT INT,
	__LADDER_HOLE INT,
	__LADDER_WIN INT,
	__LADDER_LOSE INT,
	__LADDER_DRAW INT,
	__QUITADO INT,
	__SKIN_PANG BIGINT,
	__SKIN_WIN INT,
	__SKIN_LOSE INT,
	__SKIN_RUN_HOLE INT,
	__SKIN_ALL_IN_COUNT INT,
	__NAO_SEI INT,
	__JOGOS_NAO_SEI INT,
	__EVENT_VALUE SMALLINT,
	__SKIN_STRIKE_POINT INT,
	__MAX_JOGOS_NAO_SEI INT,
	__GAME_COUNT_SEASON INT,
	__TOTAL_PANG_WIN_GAME INT,
	__MEDAL_LUCKY INT,
	__MEDAL_FAST INT,
	__MEDAL_BEST_DRIVE INT,
	__MEDAL_BEST_CHIPIN INT,
	__MEDAL_BEST_PUTTIN INT,
	__MEDAL_BEST_RECOVERY INT,
	___16BIT_NAO_SEI SMALLINT
)
BEGIN

	IF __IDUSER > 0 THEN
	BEGIN
		UPDATE pangya.user_info 
			SET Max_distancia = __BEST_DRIVE
				,`Chip-in` = __BEST_CHIPIN
				,`Long-putt` = __BEST_LONG_PUTT
				,Combos = __COMBO
				,Todos_combos = __ALL_COMBO
				,Tacadas = __TACADA
				,Putt = __PUTT
				,Tempo = __TEMPO
				,`Tempo tacadas` = __TEMPO_TACADA
				,Acerto_pangya = __ACERTO_PANGYA
				,`Timeout` = __TIMEOUT
				,`O.B` = __OB
				,Total_distancia = __TOTAL_DISTANCIA
				,Holes = __HOLE
				,Holein = __HOLEIN
				,HIO = __HIO
				,Bunker = __BUNKER
				,Fairway = __FAIRWAY
				,Albatross = __ALBATROSS
				,MaConduta = __MAD_CONDUTA
				,Acerto_Putt = __PUTTIN
				/*,Xp = __EXP*/				 -- exp, level e pang, não atualiza aqui, por que ele tem os seus próprios
				/*,`level` = __LEVEL*/		 -- Esses aqui não atualiza que pode da erro depois
				/*,Pang = __PANG*/
				,Media_score = __MEDIA_SCORE
				,BestScore0 = __BEST_SCORE_0
				,BestScore1 = __BEST_SCORE_1
				,BestScore2 = __BEST_SCORE_2
				,BestScore3 = __BEST_SCORE_3
				,BestScore4 = __BEST_SCORE_4
				,MaxPang0 = __BEST_PANG_0
				,MaxPang1 = __BEST_PANG_1
				,MaxPang2 = __BEST_PANG_2
				,MaxPang3 = __BEST_PANG_3
				,MaxPang4 = __BEST_PANG_4
				,SumPang = __SUM_PANG
				,EventFlag = __EVENT_FLAG
				,Jogado = __JOGADO
				,TeamGames = __TEAM_GAME
				,TeamWin = __TEAM_WIN
				,Teamhole = __TEAM_HOLE
				,LadderPoint = __LADDER_POINT
				,LadderHole = __LADDER_HOLE
				,LadderWin = __LADDER_WIN
				,LadderLose = __LADDER_LOSE
				,LadderDraw = __LADDER_DRAW
				,Quitado = __QUITADO
				,SkinPang = __SKIN_PANG
				,SkinWin = __SKIN_WIN
				,SkinLose = __SKIN_LOSE
				,SkinRunHole = __SKIN_RUN_HOLE
				,SkinAllinCount = __SKIN_ALL_IN_COUNT
				,NaoSei = __NAO_SEI
				,JogosNaoSei = __JOGOS_NAO_SEI
				,EventValue = __EVENT_VALUE
				,SkinStrikePoint = __SKIN_STRIKE_POINT
				,MaxJogoNaoSei = __MAX_JOGOS_NAO_SEI
				,GameCountSeason = __GAME_COUNT_SEASON
				,total_pang_win_game = __TOTAL_PANG_WIN_GAME
				,lucky_medal = __MEDAL_LUCKY
				,fast_medal = __MEDAL_FAST
				,best_drive_medal = __MEDAL_BEST_DRIVE
				,best_chipin_medal = __MEDAL_BEST_CHIPIN
				,best_puttin_medal = __MEDAL_BEST_PUTTIN
				,best_recovery_medal = __MEDAL_BEST_RECOVERY
				,`16bit_naosei` = ___16BIT_NAO_SEI
		WHERE UID = __IDUSER;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcUseItemBuff` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcUseItemBuff`(
	__IDUSER INT,
	__ITEM_TYPEID INT,
	__TIPO INT,
	__PERCENT INT,
	__TEMPO INT
)
BEGIN

	DECLARE __INDEX BIGINT DEFAULT -1;

    -- Insert statements for procedure here
	IF __IDUSER > 0 AND __ITEM_TYPEID > 0 AND __TEMPO > 0 THEN
	BEGIN
		INSERT INTO pangya.pangya_item_buff(UID, typeid, tipo, percent, reg_date, end_date, use_yn) 
			VALUES(__IDUSER, __ITEM_TYPEID, __TIPO, __PERCENT, now(), timestampadd(MINUTE, __TEMPO, now()), 1);

		SET __INDEX = last_insert_id();
	END;
    END IF;

	SELECT __INDEX AS `INDEX`;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcVerificaAuthKeys` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcVerificaAuthKeys`(
	__IDUSER int,
	__key_in nvarchar(8),
	__OPT_IN smallint
)
BEGIN

	DECLARE
         __RET int DEFAULT 0;

      IF __OPT_IN = 0 THEN
         BEGIN
            IF 
               CASE 
                  WHEN 
                     (
                        SELECT authkey.AuthKey
                        FROM pangya.authkey
                        WHERE authkey.UID = __IDUSER
                     ) = __key_in THEN 0
                  WHEN 
                     (
                        SELECT authkey.AuthKey
                        FROM pangya.authkey
                        WHERE authkey.UID = __IDUSER
                     ) > __key_in THEN 1
                  WHEN 
                     (
                        SELECT authkey.AuthKey
                        FROM pangya.authkey
                        WHERE authkey.UID = __IDUSER
                     ) < __key_in THEN -1
                  ELSE NULL
               END = 0 THEN
				SET __RET = 1;
			END IF;
         END;
      ELSE 
         BEGIN
            IF 
               CASE 
                  WHEN 
                     (
                        SELECT authkey.AuthKey_login
                        FROM pangya.authkey
                        WHERE authkey.UID = __IDUSER
                     ) = __key_in THEN 0
                  WHEN 
                     (
                        SELECT authkey.AuthKey_login
                        FROM pangya.authkey
                        WHERE authkey.UID = __IDUSER
                     ) > __key_in THEN 1
                  WHEN 
                     (
                        SELECT authkey.AuthKey_login
                        FROM pangya.authkey
                        WHERE authkey.UID = __IDUSER
                     ) < __key_in THEN -1
                  ELSE NULL
               END = 0 THEN
				SET __RET = 1;
			END IF;
         END;
		 END IF;

      IF __RET = 1 THEN
         UPDATE pangya.authkey
            SET 
               valid = 1
         WHERE authkey.UID = __IDUSER;
	END IF;

      SELECT __RET;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcVerificaCourseCubeCoin` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcVerificaCourseCubeCoin`(
	__course_in int
)
BEGIN

	SELECT pangya_course_cube_coin_temporada.`active`
      FROM pangya.pangya_course_cube_coin_temporada
      WHERE pangya_course_cube_coin_temporada.course = __course_in;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcVerificaNick` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcVerificaNick`(
	__IDUSER int,
	__NICK_USER nvarchar(30),
	__OPT smallint
)
BEGIN

	IF __OPT = 0 THEN
         SELECT account.UID
         FROM pangya.account
         WHERE account.NICK = __NICK_USER;
      ELSE 
         BEGIN
            IF __OPT = 1 THEN

               IF __NICK_USER LIKE '% %' THEN
                  SELECT -3 AS UID;
               END IF;
			END IF;
         END;
         END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcVerifyID` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcVerifyID`(
	_ID VARCHAR(25)
)
BEGIN
	
    IF _ID != '' THEN
		SELECT uid, id FROM pangya.account WHERE CAST(id as BINARY(25)) = CAST(_ID as BINARY(25));
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcVerifyIP` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcVerifyIP`(
	_UID INT,
	_IP VARCHAR(18)
)
BEGIN
	
    IF _UID > 0 AND _IP != '' THEN
		SELECT uid FROM pangya.pangya_player_ip WHERE ip = _IP AND uid = _UID AND block_beta = 0;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcVerifyNickname` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcVerifyNickname`(
	__NICKNAME NVARCHAR(50)
)
BEGIN

	IF __NICKNAME != '' THEN
		SELECT uid FROM pangya.account WHERE nick = __NICKNAME;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcVerifyPass` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcVerifyPass`(
	_IDUSER INT,
	_PASS VARCHAR(32)
)
BEGIN
	
    SELECT uid FROM pangya.account WHERE UID = _IDUSER AND `PASSWORD` = UPPER(_PASS);
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcWriteGuildBBS` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcWriteGuildBBS`(
	__PLAYER_UID INT,
	__TYPE TINYINT,
	__TITLE NVARCHAR(50),
	__TEXT NVARCHAR(500)
)
BEGIN

	IF __PLAYER_UID > 0 AND __TITLE != '' AND __TEXT != '' THEN
	BEGIN
		
		INSERT INTO pangya.pangya_guild_bbs(OWNER_UID, TITLE, `TEXT`, `TYPE`)
		VALUES(__PLAYER_UID, __TITLE, __TEXT, __TYPE);

		SELECT last_insert_id() AS SEQ;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcWriteGuildBBSReply` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcWriteGuildBBSReply`(
	__OWNER_UID INT,
	__BBS_SEQ BIGINT,
	__TEXT NVARCHAR(500)
)
BEGIN

	IF __OWNER_UID > 0 AND __BBS_SEQ > 0 AND __TEXT != '' THEN
	BEGIN

		INSERT INTO pangya.pangya_guild_bbs_res(OWNER_UID, BBS_SEQ, `TEXT`)
		VALUES(__OWNER_UID, __BBS_SEQ, __TEXT);

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcWriteGuildNotice` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcWriteGuildNotice`(
	__GUILD_UID INT,
	__PLAYER_UID INT,
	__TITLE NVARCHAR(50),
	__TEXT NVARCHAR(500)
)
BEGIN

	IF __GUILD_UID > 0 AND __PLAYER_UID > 0 AND __TITLE != '' AND __TEXT != '' THEN
	BEGIN

		INSERT INTO pangya.pangya_guild_notice(GUILD_UID, OWNER_UID, TITLE, `TEXT`)
		VALUES(__GUILD_UID, __PLAYER_UID, __TITLE, __TEXT);

		SELECT last_insert_id() AS SEQ;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcWriteGuildPrivateBBS` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcWriteGuildPrivateBBS`(
	__GUILD_UID INT,
	__PLAYER_UID INT,
	__TITLE NVARCHAR(50),
	__TEXT NVARCHAR(500)
)
BEGIN

	IF __GUILD_UID > 0 AND __PLAYER_UID > 0 AND __TITLE != '' AND __TEXT != '' THEN
	BEGIN

		INSERT INTO pangya.pangya_guild_private_bbs(GUILD_UID, OWNER_UID, TITLE, `TEXT`)
		VALUES(__GUILD_UID, __PLAYER_UID, __TITLE, __TEXT);

		SELECT last_insert_id() AS SEQ;

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `ProcWriteGuildPrivateBBSReply` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `ProcWriteGuildPrivateBBSReply`(
	__PLAYER_UID INT,
	__BBS_SEQ BIGINT,
	__TEXT NVARCHAR(500)
)
BEGIN

	IF __PLAYER_UID > 0 AND __BBS_SEQ > 0 THEN
	BEGIN
		
		INSERT INTO pangya.pangya_guild_private_bbs_res(GUILD_BBS_SEQ, OWNER_UID, `TEXT`)
		VALUES(__BBS_SEQ, __PLAYER_UID, __TEXT);

	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_ADD_FURNITURE` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_ADD_FURNITURE`(
	__IDUSER int,
	__IDITEM int,
	__ITEMTYPEID int,
	__F_X float(24),
	__F_Y float(24),
	__F_Z float(24),
	__F_R float(24)
)
BEGIN

	IF __IDITEM <= 0 THEN
         SELECT td_room_data.MYROOM_ID INTO __IDITEM
         FROM pangya.td_room_data
         WHERE td_room_data.UID = __IDUSER AND td_room_data.TYPEID = __ITEMTYPEID;
	END IF;

      IF __IDITEM <= 0 THEN
         BEGIN

            INSERT pangya.td_room_data(
               pangya.td_room_data.UID, 
               pangya.td_room_data.TYPEID, 
               pangya.td_room_data.POS_X, 
               pangya.td_room_data.POS_Y, 
               pangya.td_room_data.POS_Z, 
               pangya.td_room_data.POS_R)
               VALUES (
                  __IDUSER, 
                  __ITEMTYPEID, 
                  __F_X, 
                  __F_Y, 
                  __F_Z, 
                  __F_R);

            SELECT max(td_room_data.MYROOM_ID) INTO __IDITEM
            FROM pangya.td_room_data
            WHERE td_room_data.UID = __IDUSER;

         END;
         END IF;

      SELECT __IDITEM AS ITEM_ID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_ADD_ITEM` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_ADD_ITEM`(
	__IDUSER INT,
	__GIFTFLAG INT,
	__PURCHASE_IN TINYINT,
	__IDITEM int,
	__ITEMTYPEID INT,
	__TYPEFLAG TINYINT,
	__TYPEFLAG_IFF TINYINT,
	__TEMPO INT,
	__C_0 smallint,
	__C_1 smallint,
	__C_2 smallint,
	__C_3 smallint,
	__C_4 smallint,
	__X float,
	__Y float,
	__Z float,
	__R float
)
BEGIN

	DECLARE __NUMERO INT;
	DECLARE __CONTADOR INT;
	DECLARE __CHARACTER INT; 
	DECLARE __PERIODO INT;
	DECLARE __CADDIE_TYPE INT;
	DECLARE __ITEM_TYPE INT; 
	DECLARE __COR_CABELO INT;
	DECLARE __Gift_flg INT;

	SET __NUMERO = GroupID(__ITEMTYPEID);

	IF __NUMERO = 4 THEN  -- #Character
		BEGIN
			IF __IDITEM <= 0 THEN BEGIN
				SET __IDITEM = (SELECT item_id
				FROM pangya.pangya_character_information 
				WHERE UID = __IDUSER AND typeid = __ITEMTYPEID);
			END;
            END IF;

			IF __IDITEM > 0 THEN
				BEGIN
					UPDATE pangya_user_equip SET character_id = __IDITEM WHERE UID = __IDUSER;
				END;
			ELSE
				BEGIN
					call FuncInsertPartsCharacter(__IDUSER, __ITEMTYPEID, 0, 0);

					SET __IDITEM = (SELECT MAX(item_id)FROM pangya_character_information WHERE UID = __IDUSER AND typeid = __ITEMTYPEID);

					SET __CONTADOR = 0;
					WHILE __CONTADOR < 24 DO
						INSERT INTO td_char_equip_s4(UID, CHAR_ITEMID, IN_DATE, EQUIP_NUM, USE_YN)
								VALUES(__IDUSER, __IDITEM, now(), __CONTADOR + 1, 'Y');
						SET __CONTADOR = __CONTADOR + 1;
					END WHILE;

					UPDATE pangya_user_equip SET character_id = __IDITEM WHERE UID = __IDUSER;
				END;
                END IF;

			SELECT __IDITEM AS ITEM_ID;
		END;
	ELSEIF __NUMERO = 8 THEN -- #Parts
		BEGIN

			IF __TYPEFLAG_IFF = 8 OR __TYPEFLAG_IFF = 9 THEN
			BEGIN
				IF __IDITEM <= 0 THEN
					call pangya.USP_ADD_UCC(__IDUSER, __ITEMTYPEID, __GIFTFLAG, __C_0, __C_1, __C_2, __C_3, __C_4, __PURCHASE_IN, __TYPEFLAG_IFF, __TEMPO);
				ELSEIF __IDITEM > 0 AND __C_0 >= 0 THEN
				BEGIN
					UPDATE pangya.pangya_item_warehouse SET valid = 1, Gift_flag = 0 
					WHERE UID = __IDUSER AND item_id = __IDITEM;

					SELECT __IDITEM AS ITEM_ID, 
							(SELECT UCCIDX FROM tu_ucc WHERE UID = __IDUSER AND ITEM_ID = __IDITEM) AS UCCIDX,
							(SELECT SEQ FROM tu_ucc WHERE UID = __IDUSER AND ITEM_ID = __IDITEM) AS SD_SEQ;
				END;
				ELSEIF __IDITEM > 0 AND __C_0 < 0 THEN
				BEGIN
					UPDATE pangya.pangya_item_warehouse SET valid = 0
					WHERE UID = __IDUSER AND item_id = __IDITEM;

					SELECT __IDITEM AS ITEM_ID, 
							(SELECT UCCIDX FROM tu_ucc WHERE UID = __IDUSER AND ITEM_ID = __IDITEM) AS UCCIDX,
							(SELECT SEQ FROM tu_ucc WHERE UID = __IDUSER AND ITEM_ID = __IDITEM) AS SD_SEQ;
				END;
                END IF;
			END;
			ELSE
			BEGIN
				IF __IDITEM > 0 THEN -- #Extender o Rental
					BEGIN
						IF __TEMPO > 0 AND (SELECT flag FROM pangya.pangya_item_warehouse WHERE UID = __IDUSER AND typeid = __ITEMTYPEID LIMIT 1) = 96 THEN
							UPDATE pangya.pangya_item_warehouse SET EndDate = TIMESTAMPADD(DAY, __TEMPO, now()) 
							WHERE UID = __IDUSER AND item_id = __IDITEM;
						ELSEIF __C_0 < 0 THEN
							UPDATE pangya.pangya_item_warehouse SET valid = 0 
							WHERE UID = __IDUSER AND item_id = __IDITEM;
						ELSEIF __C_0 > 0 THEN
							UPDATE pangya.pangya_item_warehouse SET valid = 1, Gift_flag = __GIFTFLAG 
							WHERE UID = __IDUSER AND item_id = __IDITEM;
						END IF;
					END;
				ELSE
					BEGIN						
						IF __TEMPO > 0 THEN
						BEGIN
							INSERT INTO pangya.pangya_item_warehouse(UID, typeid, valid, regdate, Gift_flag, flag, Purchase, ItemType, EndDate, c0, c1, c2, c3, c4)
										VALUES(__IDUSER, __ITEMTYPEID, 1, now(), __GIFTFLAG, __TYPEFLAG, 0, 2, TIMESTAMPADD(DAY, __TEMPO, now()), __C_0, __C_1, __C_2, __C_3, __C_4);
						END;
						ELSE
						BEGIN
							INSERT INTO pangya.pangya_item_warehouse(UID, typeid, valid, regdate, enddate, Gift_flag, flag, Purchase, ItemType, c0, c1, c2, c3, c4)
										VALUES(__IDUSER, __ITEMTYPEID, 1, now(), now(), __GIFTFLAG, __TYPEFLAG, 0, 2, __C_0, __C_1, __C_2, __C_3, __C_4);
						END;
                        END IF;

						SET __IDITEM = (SELECT MAX(ITEM_ID)FROM pangya_item_warehouse WHERE UID = __IDUSER);
					END;
                    END IF;

				SELECT __IDITEM AS ITEM_ID;
			END;
            END IF;
		END;
	ELSEIF __NUMERO = 16 THEN -- #ClubSet
		BEGIN
			IF __IDITEM <= 0 THEN
			BEGIN
				SET __IDITEM = (SELECT item_id
				FROM pangya.pangya_item_warehouse
				WHERE UID = __IDUSER AND typeid = __ITEMTYPEID);
                
				SET __Gift_flg = (SELECT Gift_flag
                FROM pangya_item_warehouse
				WHERE UID = __IDUSER AND typeid = __ITEMTYPEID);
			END;
            END IF;

			IF __IDITEM > 0 THEN
				BEGIN
					IF __C_0 < 0 THEN	-- # excluiu, vendeu ou deu"gift"
					BEGIN
						UPDATE pangya.pangya_item_warehouse 
							SET  valid = 0,
								 ClubSet_WorkShop_Flag = 0,
								 ClubSet_WorkShop_C0 = 0,
								 ClubSet_WorkShop_C1 = 0,
								 ClubSet_WorkShop_C2 = 0,
								 ClubSet_WorkShop_C3 = 0,
								 ClubSet_WorkShop_C4 = 0,
								 Mastery_Pts = 0,
								 Recovery_Pts = 0,
								 `Level` = 0,
								 Up = 0,
								 Total_Mastery_Pts = 0,
								 Mastery_Gasto = 0
						WHERE UID = __IDUSER AND item_id = __IDITEM;
						
						-- # Zera o clubset_enchantment pq excluiu a taquiera
					    IF (SELECT Gift_flag FROM pangya_item_warehouse WHERE UID = __IDUSER AND item_id = __IDITEM) = 0 THEN
							UPDATE pangya_clubset_enchant SET pang = 0, c0 = 0, c1 = 0, c2 = 0, c3 = 0, c4 = 0
								WHERE UID = __IDUSER AND item_id = __IDITEM;
						END IF;
                    END;
					ELSEIF __C_0 > 0 AND __Gift_flg = 1 THEN -- # gift
						UPDATE pangya_item_warehouse SET valid = 1, Gift_flag = __GIFTFLAG
						WHERE UID = __IDUSER AND item_id = __IDITEM;
					ELSEIF __C_0 > 0 THEN	-- # Comprou a taqueira de novo (antes ele excluiu, vendeu ou deu"gift")
					BEGIN
						UPDATE pangya_item_warehouse SET valid = 1, C0 = __C_0, C1 = __C_1, C2 = __C_2, C3 = __C_3, C4 = __C_4
						WHERE UID = __IDUSER AND item_id = __IDITEM;
                        
                        -- # Zera o clubset_enchantment pq comprou a taquiera
                        UPDATE pangya_clubset_enchant SET pang = 0, c0 = 0, c1 = 0, c2 = 0, c3 = 0, c4 = 0
						WHERE UID = __IDUSER AND item_id = __IDITEM;
					END;
                    END IF;
				END;
			ELSE
				BEGIN
					INSERT INTO pangya_item_warehouse(UID, typeid, valid, regdate, Gift_flag, flag, Purchase, ItemType, c0, c1, c2, c3, c4)
								VALUES(__IDUSER, __ITEMTYPEID, 1, now(), __GIFTFLAG, __TYPEFLAG, 0, 2, __C_0, __C_1, __C_2, __C_3, __C_4);

					SET __IDITEM = (SELECT MAX(item_id) FROM pangya_item_warehouse WHERE UID = __IDUSER AND typeid = __ITEMTYPEID);

					INSERT INTO pangya_clubset_enchant(uid, item_id) VALUES(__IDUSER, __IDITEM);
				END;
                END IF;

			SELECT __IDITEM AS ITEM_ID;
		END;
	ELSEIF __NUMERO = 20 THEN -- #Ball
		BEGIN
			IF __IDITEM <= 0 THEN
			BEGIN
				SET __IDITEM = (SELECT item_id
				FROM pangya_item_warehouse
				WHERE UID = __IDUSER AND typeid = __ITEMTYPEID);
			END;
            END IF;

			IF __IDITEM > 0 THEN
				BEGIN
					DECLARE __ATIVO INT;
					DECLARE __C0_QNTD INT;

					SET __ATIVO = (SELECT valid FROM pangya_item_warehouse WHERE UID = __IDUSER AND item_id = __IDITEM);
					IF __ATIVO = 1 THEN
					BEGIN
						UPDATE pangya_item_warehouse SET C0 = C0 + __C_0 WHERE UID = __IDUSER AND item_id = __IDITEM;

						SET __C0_QNTD = (SELECT C0 FROM pangya_item_warehouse WHERE UID = __IDUSER AND item_id = __IDITEM);

						IF __C0_QNTD <= 0 THEN
							UPDATE pangya_item_warehouse SET valid = 0, C0 = 0 WHERE UID = __IDUSER AND item_id = __IDITEM;
						END IF;
						
					END;
					ELSE
					BEGIN
						UPDATE pangya_item_warehouse SET C0 = C0 + __C_0, valid = 1 WHERE UID = __IDUSER AND item_id = __IDITEM;
					END;
                    END IF;
				END;
			ELSE
				BEGIN
					INSERT INTO pangya_item_warehouse(UID, typeid, valid, regdate, Gift_flag, flag, C0, Purchase, ItemType)
							VALUES(__IDUSER, __ITEMTYPEID, 1, now(), __GIFTFLAG, __TYPEFLAG, __C_0, 0, 2);

					SET __IDITEM = (SELECT MAX(ITEM_ID) FROM pangya_item_warehouse WHERE UID = __IDUSER);
				END;
                END IF;

			SELECT __IDITEM AS ITEM_ID;
		END;
	ELSEIF __NUMERO = 24 THEN -- #Item __ATIVO
		BEGIN
			IF __IDITEM <= 0 THEN
			BEGIN
				SET __IDITEM = (SELECT item_id
				FROM pangya_item_warehouse
				WHERE UID = __IDUSER AND typeid = __ITEMTYPEID);
			END;
            END IF;

			IF __IDITEM > 0 THEN
				BEGIN
					DECLARE __ATIVO INT;
					DECLARE __C0_QNTD INT;

					SET __ATIVO = (SELECT valid FROM pangya_item_warehouse WHERE UID = __IDUSER AND item_id = __IDITEM);
					SET __C0_QNTD = (SELECT C0 FROM pangya_item_warehouse WHERE UID = __IDUSER AND item_id = __IDITEM);
                    
					IF __ATIVO = 1 AND __C0_QNTD > 0 THEN
					BEGIN
						UPDATE pangya_item_warehouse SET C0 = C0 + __C_0 WHERE UID = __IDUSER AND item_id = __IDITEM;

						SET __C0_QNTD = (SELECT C0 FROM pangya_item_warehouse WHERE UID = __IDUSER AND item_id = __IDITEM);

						IF __C0_QNTD <= 0 THEN
							UPDATE pangya_item_warehouse SET valid = 0, C0 = 0 WHERE UID = __IDUSER AND item_id = __IDITEM;
						END IF;
					END;
					ELSEIF __C_0 > 0 THEN  -- # ADD um novo item, pq o anterior tinha sido exclui "valid = 0"
					BEGIN
						IF __TEMPO > 0 THEN
							UPDATE pangya_item_warehouse 
								SET C0 = __C_0, C1 = __C_1, C2 = __C_2, C3 = __C_3, C4 = __C_4,
									flag = __TYPEFLAG, valid = 1, EndDate = TIMESTAMPADD(DAY, __TEMPO, now())
							WHERE UID = __IDUSER AND item_id = __IDITEM;
                        ELSE
							UPDATE pangya_item_warehouse SET C0 = __C_0, C1 = __C_1, C2 = __C_2, C3 = __C_3, C4 = __C_4, flag = __TYPEFLAG, valid = 1
							WHERE UID = __IDUSER AND item_id = __IDITEM;
						END IF;
                    END;
					ELSE
						UPDATE pangya_item_warehouse SET valid = 0, C0 = 0 WHERE UID = __IDUSER AND item_id = __IDITEM;
					END IF;
				END;
			ELSE
			BEGIN
				IF __TEMPO > 0 THEN
				BEGIN
					INSERT INTO pangya_item_warehouse(UID, typeid, valid, regdate, EndDate, Gift_flag, flag, C0, C1, C2, C3, C4, Purchase, ItemType)
							VALUES(__IDUSER, __ITEMTYPEID, 1, now(), TIMESTAMPADD(DAY, __TEMPO, now()), __GIFTFLAG, __TYPEFLAG, __C_0, __C_1, __C_2, __C_3, __C_4, 0, 2);
					
					SET __IDITEM = (SELECT MAX(ITEM_ID) FROM pangya_item_warehouse WHERE UID = __IDUSER);
				END;
                ELSE
					INSERT INTO pangya_item_warehouse(UID, typeid, valid, regdate, Gift_flag, flag, C0, C1, C2, C3, C4, Purchase, ItemType)
							VALUES(__IDUSER, __ITEMTYPEID, 1, now(), __GIFTFLAG, __TYPEFLAG, __C_0, __C_1, __C_2, __C_3, __C_4, 0, 2);
				
					SET __IDITEM = (SELECT MAX(ITEM_ID) FROM pangya_item_warehouse WHERE UID = __IDUSER);
				END IF;
			END;
            END IF;

			SELECT __IDITEM AS ITEM_ID;

		END;
	ELSEIF __NUMERO = 26 THEN -- #Item Passivo
		BEGIN
			IF __IDITEM <= 0 AND __ITEMTYPEID != 0x1A000042 THEN /*Ticket Report tem q ser outro item*/
			BEGIN
				SET __IDITEM = (SELECT item_id
				FROM pangya_item_warehouse
				WHERE UID = __IDUSER AND typeid = __ITEMTYPEID);
			END;
            END IF;

			IF __ITEMTYPEID = 0x1A000010 THEN -- # Pouch de Pangya transferi para os pangs do usuario
				UPDATE user_info SET Pang = Pang + __C_0 WHERE UID = __IDUSER;
			ELSEIF __ITEMTYPEID = 0x1A00015D THEN -- # Pouch de EXP tranfere para o User Info
				call pangya.USP_EXP_PLAYER_ATT(__IDUSER, __C_0);
			ELSE

			BEGIN
				IF __IDITEM > 0 THEN
					BEGIN
						DECLARE __ATIVO INT;
						DECLARE __C0_QNTD INT;

						SELECT valid INTO __ATIVO FROM pangya_item_warehouse WHERE UID = __IDUSER AND item_id = __IDITEM;
						SELECT c0 INTO __C0_QNTD FROM pangya_item_warehouse WHERE UID = __IDUSER AND item_id = __IDITEM;
                        
						IF __ATIVO = 1 AND __C0_QNTD > 0 THEN
						BEGIN
							UPDATE pangya_item_warehouse SET C0 = C0 + __C_0 WHERE UID = __IDUSER AND item_id = __IDITEM;

							SELECT C0 INTO __C0_QNTD FROM pangya_item_warehouse WHERE UID = __IDUSER AND item_id = __IDITEM;
							IF __C0_QNTD <= 0 THEN
								UPDATE pangya_item_warehouse SET valid = 0, C0 = 0 WHERE UID = __IDUSER AND item_id = __IDITEM;
							END IF;
						
						END;
						ELSEIF __C_0 > 0 THEN  -- # ADD um novo item, pq o anterior tinha sido exclui "valid = 0"
						BEGIN
							IF __TEMPO > 0 THEN
							BEGIN
								UPDATE pangya_item_warehouse 
									SET C0 = __C_0, C1 = __C_1, C2 = __C_2, C3 = __C_3, C4 = __C_4,
										flag = __TYPEFLAG, valid = 1, EndDate = TIMESTAMPADD(DAY, __TEMPO, now())
								WHERE UID = __IDUSER AND item_id = __IDITEM;
							END;
                            ELSE
								UPDATE pangya_item_warehouse SET C0 = __C_0, C1 = __C_1, C2 = __C_2, C3 = __C_3, C4 = __C_4, flag = __TYPEFLAG, valid = 1
								WHERE UID = __IDUSER AND item_id = __IDITEM;
							END IF;
                        END;
						ELSE
							UPDATE pangya_item_warehouse SET valid = 0, C0 = 0 WHERE UID = __IDUSER AND item_id = __IDITEM;
						END IF;
					END;
				ELSE
					BEGIN
						IF __TEMPO > 0 THEN
						BEGIN
							INSERT INTO pangya_item_warehouse(UID, typeid, valid, regdate, EndDate, Gift_flag, flag, C0, C1, C2, C3, C4, Purchase, ItemType)
									VALUES(__IDUSER, __ITEMTYPEID, 1, now(), TIMESTAMPADD(DAY, __TEMPO, now()), __GIFTFLAG, __TYPEFLAG, __C_0, __C_1, __C_2, __C_3, __C_4, 0, 2);

							SELECT MAX(ITEM_ID) INTO __IDITEM FROM pangya_item_warehouse WHERE UID = __IDUSER;
						END;
                        ELSE
						BEGIN
							INSERT INTO pangya_item_warehouse(UID, typeid, valid, regdate, Gift_flag, flag, C0, C1, C2, C3, C4, Purchase, ItemType)
									VALUES(__IDUSER, __ITEMTYPEID, 1, now(), __GIFTFLAG, __TYPEFLAG, __C_0, __C_1, __C_2, __C_3, __C_4, 0, 2);

							SELECT MAX(ITEM_ID) INTO __IDITEM FROM pangya_item_warehouse WHERE UID = __IDUSER;
						END;
                        END IF;
				END;
                END IF;

				SELECT __IDITEM AS ITEM_ID;
			END;
            END IF;

			SELECT 0 AS ITEM_ID;
		END;
	ELSEIF __NUMERO = 27 THEN -- #Item Passivo
		BEGIN
			IF __IDITEM <= 0 THEN
			BEGIN
				SELECT item_id INTO __IDITEM
				FROM pangya_item_warehouse
				WHERE UID = __IDUSER AND typeid = __ITEMTYPEID;
			END;
            END IF;

			IF __ITEMTYPEID = 0x1A000010 THEN -- # Pouch de Pangya transferi para os pangs do usuario
				UPDATE user_info SET Pang = Pang + __C_0 WHERE UID = __IDUSER;
			ELSEIF __ITEMTYPEID = 0x1A00015D THEN -- # Pouch de EXP tranfere para o User Info
				call pangya.USP_EXP_PLAYER_ATT(__IDUSER, __C_0);
			ELSE

				BEGIN
					IF __IDITEM > 0 THEN
						BEGIN
							DECLARE __ATIVO INT;
							DECLARE __C0_QNTD INT;
						
							SELECT valid INTO __ATIVO FROM pangya_item_warehouse WHERE UID = __IDUSER AND item_id = __IDITEM;
							SELECT C0 INTO __C0_QNTD FROM pangya_item_warehouse WHERE UID = __IDUSER AND item_id = __IDITEM;
                        
							IF __ATIVO = 1 AND __C0_QNTD > 0 THEN
							BEGIN
								UPDATE pangya_item_warehouse SET C0 = C0 + __C_0 WHERE UID = __IDUSER AND item_id = __IDITEM;

								SELECT C0 INTO __C0_QNTD FROM pangya_item_warehouse WHERE UID = __IDUSER AND item_id = __IDITEM;

								IF __C0_QNTD <= 0 THEN
									UPDATE pangya_item_warehouse SET valid = 0, C0 = 0 WHERE UID = __IDUSER AND item_id = __IDITEM;
								END IF;
							END;
							ELSEIF __C_0 > 0 THEN -- # ADD um novo item, pq o anterior tinha sido exclui "valid = 0"
							BEGIN
								IF __TEMPO > 0 THEN
								BEGIN
									UPDATE pangya_item_warehouse 
										SET C0 = __C_0, C1 = __C_1, C2 = __C_2, C3 = __C_3, C4 = __C_4, 
											flag = __TYPEFLAG, valid = 1, EndDate = TIMESTAMPADD(DAY, __TEMPO, now())
									WHERE UID = __IDUSER AND item_id = __IDITEM;
								END;
								ELSE
									UPDATE pangya_item_warehouse SET C0 = __C_0, C1 = __C_1, C2 = __C_2, C3 = __C_3, C4 = __C_4, flag = __TYPEFLAG, valid = 1
									WHERE UID = __IDUSER AND item_id = __IDITEM;
								END IF;
							END;
							ELSE
								UPDATE pangya_item_warehouse SET valid = 0, C0 = 0 WHERE UID = __IDUSER AND item_id = __IDITEM;
							END IF;
						END;
					ELSE
						BEGIN
							IF __TEMPO > 0 THEN
							BEGIN
								INSERT INTO pangya_item_warehouse(UID, typeid, valid, regdate, EndDate, Gift_flag, flag, C0, C1, C2, C3, C4, Purchase, ItemType)
									VALUES(__IDUSER, __ITEMTYPEID, 1, now(), TIMESTAMPADD(DAY, __TEMPO, now()), __GIFTFLAG, __TYPEFLAG, __C_0, __C_1, __C_2, __C_3, __C_4, 0, 2);

								SELECT MAX(ITEM_ID) INTO __IDITEM FROM pangya_item_warehouse WHERE UID = __IDUSER;
							END;
							ELSE
							BEGIN
								INSERT INTO pangya_item_warehouse(UID, typeid, valid, regdate, Gift_flag, flag, C0, C1, C2, C3, C4, Purchase, ItemType)
									VALUES(__IDUSER, __ITEMTYPEID, 1, now(), __GIFTFLAG, __TYPEFLAG, __C_0, __C_1, __C_2, __C_3, __C_4, 0, 2);

								SELECT MAX(ITEM_ID) INTO __IDITEM FROM pangya_item_warehouse WHERE UID = __IDUSER;
							END;
                            END IF;
						END;
                        END IF;

					SELECT __IDITEM AS ITEM_ID;
				END;
                END IF;

				SELECT 0 AS ITEM_ID;
		END;
	ELSEIF __NUMERO = 28 THEN -- #Caddie
		BEGIN
			IF __IDITEM <= 0 THEN
			BEGIN
				SELECT item_id INTO __IDITEM
				FROM pangya_caddie_information
				WHERE UID = __IDUSER AND typeid = __ITEMTYPEID;
			END;
            END IF;

			IF __IDITEM > 0 THEN
				BEGIN
					IF __C_0 < 0 THEN
					BEGIN
						UPDATE pangya_caddie_information SET valid = 0 
						WHERE UID = __IDUSER AND item_id = __IDITEM;
					END;
					ELSEIF __C_0 > 0 THEN
					BEGIN
						UPDATE pangya_caddie_information SET valid = 1
						WHERE UID = __IDUSER AND item_id = __IDITEM;
					END;
                    END IF;
				END;
			ELSE
				BEGIN
					SET __PERIODO = CASE WHEN __TEMPO = 0 THEN 1 ELSE 2 END;

					INSERT INTO pangya_caddie_information(UID, typeid, gift_flag, regDate, Period, EndDate, RentFlag, Purchase, CheckEnd)
								VALUES(__IDUSER, __ITEMTYPEID, __GIFTFLAG, now(), __TEMPO, TIMESTAMPADD(DAY, __TEMPO, now()), __PERIODO, 0, 1);

					SELECT MAX(item_id) INTO __IDITEM FROM pangya_caddie_information WHERE UID = __IDUSER AND typeid = __ITEMTYPEID;
				END;
                END IF;

			SELECT __IDITEM AS ITEM_ID;
		END;
	ELSEIF __NUMERO = 32 THEN -- #Caddie Item Antigos
		BEGIN
			SET __CADDIE_TYPE = ((__ITEMTYPEID & 0x0FFF0000) >> 16) / 32;
			SET __CADDIE_TYPE = (__CADDIE_TYPE + 0x1C000000) + ((__ITEMTYPEID & 0x000F0000) >> 16);

			IF __IDITEM <= 0 THEN
			BEGIN
				SELECT item_id INTO __IDITEM FROM pangya_caddie_information 
				WHERE UID = __IDUSER AND typeid = __CADDIE_TYPE;
			END;
            END IF;
			
			IF __IDITEM > 0 THEN
				BEGIN
					SELECT COUNT(*) INTO __CONTADOR FROM pangya_caddie_information 
					WHERE UID = __IDUSER AND (typeid = __CADDIE_TYPE AND parts_typeid = __ITEMTYPEID);
					
					IF __CONTADOR > 0 THEN
					BEGIN
						UPDATE pangya_caddie_information SET parts_typeid = __ITEMTYPEID, parts_EndDate = CASE WHEN parts_EndDate <= now() THEN TIMESTAMPADD(DAY, __TEMPO, now()) ELSE TIMESTAMPADD(DAY, __TEMPO, parts_EndDate) END
						WHERE UID = __IDUSER AND item_id = __IDITEM;
					END;
					ELSE
					BEGIN
						UPDATE pangya_caddie_information SET parts_typeid = __ITEMTYPEID, parts_EndDate = TIMESTAMPADD(DAY, __TEMPO, now())
						WHERE UID = __IDUSER AND item_id = __IDITEM;
					END;
                    END IF;
				END;
			/*ELSE
				BEGIN
				END*/
			END IF;

			SELECT __IDITEM AS ITEM_ID;
		END;
	ELSEIF __NUMERO = 33 THEN -- #Caddie Item Antigos
		BEGIN
			SET __CADDIE_TYPE = ((__ITEMTYPEID & 0x0FFF0000) >> 16) / 32;
			SET __CADDIE_TYPE = (__CADDIE_TYPE + 0x1C000000) + ((__ITEMTYPEID & 0x000F0000) >> 16);

			IF __IDITEM <= 0 THEN
			BEGIN
				SELECT item_id INTO __IDITEM FROM pangya_caddie_information 
				WHERE UID = __IDUSER AND typeid = __CADDIE_TYPE;
			END;
            END IF;

			IF __IDITEM > 0 THEN
				BEGIN
					SELECT COUNT(*) INTO __CONTADOR FROM pangya_caddie_information 
					WHERE UID = __IDUSER AND (typeid = __CADDIE_TYPE AND parts_typeid = __ITEMTYPEID);

					IF __CONTADOR > 0 THEN
					BEGIN
						UPDATE pangya_caddie_information SET parts_typeid = __ITEMTYPEID, parts_EndDate = CASE WHEN parts_EndDate <= now() THEN TIMESTAMPADD(DAY, __TEMPO, now()) ELSE TIMESTAMPADD(DAY, __TEMPO, parts_EndDate) END
						WHERE UID = __IDUSER AND item_id = __IDITEM;
					END;
					ELSE
					BEGIN
						UPDATE pangya_caddie_information SET parts_typeid = __ITEMTYPEID, parts_EndDate = TIMESTAMPADD(DAY, __TEMPO, now())
						WHERE UID = __IDUSER AND item_id = __IDITEM;
					END;
                    END IF;
				END;
			/*ELSE
				BEGIN
				END;*/
				END IF;

			SELECT __IDITEM AS ITEM_ID;
		END;
	ELSEIF __NUMERO = 34 THEN -- #Caddie Item Novos
		BEGIN
			SET __CADDIE_TYPE = ((__ITEMTYPEID & 0x0FFF0000) >> 16) / 32;
			SET __CADDIE_TYPE = (__CADDIE_TYPE + 0x1C000000) + ((__ITEMTYPEID & 0x000F0000) >> 16);

			IF __IDITEM <= 0 THEN
			BEGIN
				SELECT item_id INTO __IDITEM FROM pangya_caddie_information 
				WHERE UID = __IDUSER AND typeid = __CADDIE_TYPE;
			END;
            END IF;
			
			IF __IDITEM > 0 THEN
				BEGIN
					SELECT COUNT(*) INTO __CONTADOR FROM pangya_caddie_information 
					WHERE UID = __IDUSER AND (typeid = __CADDIE_TYPE AND parts_typeid = __ITEMTYPEID);

					IF __CONTADOR > 0 THEN
					BEGIN
						UPDATE pangya_caddie_information SET parts_typeid = __ITEMTYPEID, parts_EndDate = CASE WHEN parts_EndDate <= now() THEN TIMESTAMPADD(DAY, __TEMPO, now()) ELSE TIMESTAMPADD(DAY, __TEMPO, parts_EndDate) END
						WHERE UID = __IDUSER AND item_id = __IDITEM;
					END;
					ELSE
					BEGIN
						UPDATE pangya_caddie_information SET parts_typeid = __ITEMTYPEID, parts_EndDate = TIMESTAMPADD(DAY, __TEMPO, now())
						WHERE UID = __IDUSER AND item_id = __IDITEM;
					END;
                    END IF;
				END;
			/*ELSE
				BEGIN
				END;*/
                END IF;

			SELECT __IDITEM AS ITEM_ID;
		END;
	ELSEIF __NUMERO = 35 THEN -- #Caddie Item Antigos
		BEGIN
			SET __CADDIE_TYPE = ((__ITEMTYPEID & 0x0FFF0000) >> 16) / 32;
			SET __CADDIE_TYPE = (__CADDIE_TYPE + 0x1C000000) + ((__ITEMTYPEID & 0x000F0000) >> 16);

			IF __IDITEM <= 0 THEN
			BEGIN
				SELECT item_id INTO __IDITEM FROM pangya_caddie_information 
				WHERE UID = __IDUSER AND typeid = __CADDIE_TYPE;
			END;
            END IF;

			IF __IDITEM > 0 THEN
				BEGIN
					SELECT COUNT(*) INTO __CONTADOR FROM pangya_caddie_information 
					WHERE UID = __IDUSER AND (typeid = __CADDIE_TYPE AND parts_typeid = __ITEMTYPEID);

					IF __CONTADOR > 0 THEN
					BEGIN
						UPDATE pangya_caddie_information SET parts_typeid = __ITEMTYPEID, parts_EndDate = CASE WHEN parts_EndDate <= now() THEN TIMESTAMPADD(DAY, __TEMPO, now()) ELSE TIMESTAMPADD(DAY, __TEMPO, parts_EndDate) END
						WHERE UID = __IDUSER AND item_id = __IDITEM;
					END;
					ELSE
					BEGIN
						UPDATE pangya_caddie_information SET parts_typeid = __ITEMTYPEID, parts_EndDate = TIMESTAMPADD(DAY, __TEMPO, now())
						WHERE UID = __IDUSER AND item_id = __IDITEM;
					END;
                    END IF;
				END;
			/*ELSE
				BEGIN
				END;*/
                END IF;

			SELECT __IDITEM AS ITEM_ID;
		END;
	ELSEIF __NUMERO = 45 THEN -- # Trofel Especial
		BEGIN
			IF (SELECT item_id FROM pangya_trofel_especial WHERE UID = __IDUSER AND typeid = __ITEMTYPEID) IS NULL THEN
			BEGIN
				INSERT INTO pangya_trofel_especial(UID, TYPEID, QNTD) VALUES(__IDUSER, __ITEMTYPEID, 1);
			END;
            ELSE
			BEGIN
				UPDATE pangya_trofel_especial SET qntd = qntd + 1 WHERE UID = __IDUSER AND typeid = __ITEMTYPEID;
            END;
            END IF;
            
            SELECT ITEM_ID FROM pangya_trofel_especial WHERE UID = __IDUSER AND typeid = __ITEMTYPEID;
        END;
	ELSEIF __NUMERO = 47 THEN -- # Trofel Grand Prix
		BEGIN
			IF (SELECT item_id FROM pangya_trofel_grandprix WHERE UID = __IDUSER AND typeid = __ITEMTYPEID) IS NULL THEN
			BEGIN
				INSERT INTO pangya_trofel_grandprix(UID, TYPEID, QNTD) VALUES(__IDUSER, __ITEMTYPEID, 1);
			END;
            ELSE
			BEGIN
				UPDATE pangya_trofel_grandprix SET qntd = qntd + 1 WHERE UID = __IDUSER AND typeid = __ITEMTYPEID;
            END;
            END IF;
            
            SELECT ITEM_ID FROM pangya_trofel_grandprix WHERE UID = __IDUSER AND typeid = __ITEMTYPEID;
        END;
	ELSEIF __NUMERO = 60 THEN -- # HairStyle
		BEGIN
			SET __ITEM_TYPE = 0x4000000 | __C_1;

			UPDATE pangya_character_information SET default_hair = __C_0 
			WHERE UID = __IDUSER AND typeid = __ITEM_TYPE;
			
			SELECT 0 AS ITEM_ID;
		END;
	ELSEIF __NUMERO = 62 THEN -- # HairStyle 2
		BEGIN
			SET __ITEM_TYPE = 0x4000000 | __C_1;

			UPDATE pangya_character_information SET default_hair = __C_0 
			WHERE UID = __IDUSER AND typeid = __ITEM_TYPE;

			SELECT 0 AS ITEM_ID;
		END;
	ELSEIF __NUMERO = 64 THEN -- #Mascot
		BEGIN
			IF __IDITEM <= 0 THEN
			BEGIN
				IF (SELECT item_id FROM pangya_mascot_info WHERE UID = __IDUSER AND typeid = __ITEMTYPEID AND valid = 0) IS NOT NULL THEN
				BEGIN
					SELECT item_id INTO __IDITEM
					FROM pangya_mascot_info
					WHERE UID = __IDUSER AND typeid = __ITEMTYPEID AND valid = 0;

					SET __C_0 = 1;
				END;
				ELSE
				BEGIN
					SELECT item_id INTO __IDITEM
					FROM pangya_mascot_info
					WHERE UID = __IDUSER AND typeid = __ITEMTYPEID AND valid = 1;
				END;
                END IF;
			END;
            END IF;

			IF __IDITEM > 0 THEN
				BEGIN
					IF __TEMPO > 0 THEN
					BEGIN
						IF (SELECT EndDate FROM pangya_mascot_info WHERE UID = __IDUSER AND item_id = __IDITEM) <= now() THEN -- # novo mascot, msm que já tinha, mas __TEMPO acabou
						BEGIN
							UPDATE pangya_mascot_info SET Period = Period + __TEMPO, EndDate = TIMESTAMPADD(DAY, __TEMPO, now()), message = 'Pangya'
							WHERE UID = __IDUSER AND item_id = __IDITEM;
						END;
						ELSE
						BEGIN
							UPDATE pangya_mascot_info SET Period = Period + __TEMPO, EndDate = TIMESTAMPADD(DAY, __TEMPO, EndDate)
							WHERE UID = __IDUSER AND item_id = __IDITEM;
						END;
                        END IF;
					END;
					ELSEIF __C_0 < 0 THEN
					BEGIN
						UPDATE pangya_mascot_info SET valid = 0
						WHERE UID = __IDUSER AND item_id = __IDITEM;
					END;
					ELSEIF __C_0 > 0 THEN
					BEGIN
						UPDATE pangya_mascot_info SET valid = 1, message = 'Pangya'
						WHERE UID = __IDUSER AND item_id = __IDITEM;
					END;
                    END IF;
				END;
			ELSE
				BEGIN
					IF __TEMPO = 0 THEN -- # Mascot Sem Limit de __TEMPO
					BEGIN
						INSERT INTO pangya_mascot_info(UID, typeid, Flag, Tipo, RegDate, Period, EndDate, IsCash, Valid)
								VALUES(__IDUSER, __ITEMTYPEID, 0, 0, now(), __TEMPO, TIMESTAMPADD(DAY , __TEMPO, now()), 1, 1);
					END;
					ELSE	-- # Mascot com limit de __TEMPO
					BEGIN
						INSERT INTO pangya_mascot_info(UID, typeid, Flag, Tipo, RegDate, Period, EndDate, IsCash, Valid)
								VALUES(__IDUSER, __ITEMTYPEID, 0, 1, now(), __TEMPO, TIMESTAMPADD(DAY , __TEMPO, now()), 0, 1);
					END;
                    END IF;

					SELECT MAX(item_id) INTO __IDITEM FROM pangya_mascot_info WHERE UID = __IDUSER AND typeid = __ITEMTYPEID;
				END;
                END IF;

			SELECT __IDITEM AS ITEM_ID;
		END;
	ELSEIF __NUMERO = 56 THEN -- # Skiin (Background, Frame, Sticker, Slot)
	BEGIN
		IF __IDITEM <= 0 THEN
		BEGIN
			SELECT item_id INTO __IDITEM FROM pangya_item_warehouse 
			WHERE UID = __IDUSER AND typeid = __ITEMTYPEID;
		END;
        END IF;

		IF __IDITEM > 0 THEN
			BEGIN
				IF __TEMPO > 0 THEN								-- #flag 64 pq os anyigos estava errado isso é só para concerta
				BEGIN
					UPDATE pangya_item_warehouse SET valid = 1, flag = 64, EndDate = CASE WHEN EndDate <= now() THEN TIMESTAMPADD(DAY, __TEMPO, now()) ELSE TIMESTAMPADD(DAY, __TEMPO, EndDate) END
					WHERE UID = __IDUSER AND item_id = __IDITEM;
				END;
				ELSEIF __C_0 < 0 THEN
				BEGIN
					UPDATE pangya_item_warehouse SET valid = 0
					WHERE UID = __IDUSER AND item_id = __IDITEM;
				END;
				ELSEIF __C_0 > 0 THEN
				BEGIN
					UPDATE pangya_item_warehouse SET valid = 1
					WHERE UID = __IDUSER AND item_id = __IDITEM;
				END;
                END IF;
			END;
		ELSE
			BEGIN
				INSERT INTO pangya_item_warehouse(UID, typeid, valid, regdate, Gift_flag, flag, C0, Purchase, ItemType, EndDate)
						VALUES(__IDUSER, __ITEMTYPEID, 1, now(), __GIFTFLAG, __TYPEFLAG, 0, 0, 2, TIMESTAMPADD(DAY, __TEMPO, now()));

				SELECT MAX(ITEM_ID) INTO __IDITEM FROM pangya_item_warehouse WHERE UID = __IDUSER;
			END;
            END IF;

		SELECT __IDITEM AS ITEM_ID;
	END;
	ELSEIF __NUMERO = 57 THEN -- # Cutin e Título
	BEGIN
		IF __IDITEM <= 0 THEN
		BEGIN
			SELECT item_id INTO __IDITEM FROM pangya_item_warehouse 
			WHERE UID = __IDUSER AND typeid = __ITEMTYPEID;
		END;
        END IF;

		IF __IDITEM > 0 THEN
			BEGIN
				IF __TEMPO > 0 THEN								-- #flag 64 pq os anyigos estava errado isso é só para concerta
				BEGIN
					UPDATE pangya_item_warehouse SET valid = 1, flag = 64, EndDate = CASE WHEN EndDate <= now() THEN TIMESTAMPADD(DAY, __TEMPO, now()) ELSE TIMESTAMPADD(DAY, __TEMPO, EndDate) END
					WHERE UID = __IDUSER AND item_id = __IDITEM;
				END;
				ELSEIF __C_0 < 0 THEN
				BEGIN
					UPDATE pangya_item_warehouse SET valid = 0
					WHERE UID = __IDUSER AND item_id = __IDITEM;
				END;
				ELSEIF __C_0 > 0 THEN
				BEGIN
					UPDATE pangya_item_warehouse SET valid = 1
					WHERE UID = __IDUSER AND item_id = __IDITEM;
				END;
                END IF;
			END;
		ELSE
			BEGIN
				INSERT INTO pangya_item_warehouse(UID, typeid, valid, regdate, Gift_flag, flag, C0, Purchase, ItemType)
						VALUES(__IDUSER, __ITEMTYPEID, 1, now(), __GIFTFLAG, __TYPEFLAG, 0, 0, 2);

				SELECT MAX(ITEM_ID) INTO __IDITEM FROM pangya_item_warehouse WHERE UID = __IDUSER;
			END;
            END IF;
		
		SELECT __IDITEM AS ITEM_ID;
	END;
	ELSEIF __NUMERO = 72 THEN -- #Furniture - Chama a procedure do Furniture
		BEGIN
			call USP_ADD_FURNITURE(__IDUSER, __IDITEM, __ITEMTYPEID, __X, __Y, __Z, __R);
		END;
	ELSEIF __NUMERO = 108 THEN -- # 0x6C COUNTER ITEM_TYPE
	BEGIN
		IF __IDITEM > 0 AND __C_0 < 0 AND __C_1 != 0 THEN
		BEGIN
			UPDATE count_item SET count_num_item = 0, Data_Sec = 0 WHERE UID = __IDUSER AND count_id = __IDITEM;
            SELECT __IDITEM as ITEM_ID;
		END;
        ELSEIF __IDITEM > 0 AND __C_0 < 0 AND __C_1 = 0 THEN
		BEGIN
			DELETE FROM count_item WHERE UID = __IDUSER AND count_id = __IDITEM;
            SELECT __IDITEM as ITEM_ID;
		END;
		ELSEIF __IDITEM > 0 AND __C_0 > 0 THEN -- # att o countador do count_item
		BEGIN
            call USP_ATT_COUNTER_ITEM(__IDUSER, __ITEMTYPEID, __IDITEM, __C_0, __C_3, __C_4);
            SELECT __IDITEM as ITEM_ID;
		END;
		ELSEIF __IDITEM > 0 AND __C_0 = 0 AND __C_1 != 0 THEN
		BEGIN
			DELETE FROM count_item WHERE UID = __IDUSER AND count_id = __IDITEM;
            SELECT __IDITEM as ITEM_ID;
		END;
		ELSEIF __IDITEM > 0 AND __C_0 = 0 AND __C_1 = 0 THEN
		BEGIN
			UPDATE count_item SET count_num_item = __C_0, Data_Sec = 0 WHERE UID = __IDUSER AND count_id = __IDITEM;
            SELECT __IDITEM as ITEM_ID;
		END;
        ELSE
		BEGIN
			SELECT count_id AS ITEM_ID FROM count_item WHERE UID = __IDUSER AND TypeID = __ITEMTYPEID;
		END;
        END IF;
	END;
	ELSEIF __NUMERO = 112 THEN -- #Aux Part
		BEGIN
			IF __IDITEM <= 0 THEN
			BEGIN
				SELECT item_id INTO __IDITEM
				FROM pangya_item_warehouse
				WHERE UID = __IDUSER AND typeid = __ITEMTYPEID;
			END;
            END IF;
			
			IF __IDITEM > 0 THEN
				BEGIN
					DECLARE __ATIVO INT;
					DECLARE __C0_QNTD INT;

					SELECT valid INTO __ATIVO FROM pangya_item_warehouse WHERE UID = __IDUSER AND item_id = __IDITEM;
					IF __ATIVO = 1 THEN
					BEGIN
						UPDATE pangya_item_warehouse SET C0 = C0 + __C_0 WHERE UID = __IDUSER AND item_id = __IDITEM;

						SELECT C0 INTO __C0_QNTD FROM pangya_item_warehouse WHERE UID = __IDUSER AND item_id = __IDITEM;
						IF __C0_QNTD <= 0 THEN
						BEGIN
							UPDATE pangya_item_warehouse SET valid = 0, C0 = 0 WHERE UID = __IDUSER AND item_id = __IDITEM;
						END;
                        END IF;
					END;
					ELSE
					BEGIN
						UPDATE pangya_item_warehouse SET C0 = C0 + __C_0, valid = 1 WHERE UID = __IDUSER AND item_id = __IDITEM;
					END;
                    END IF;
				END;
			ELSE
				BEGIN
					INSERT INTO pangya_item_warehouse(UID, typeid, valid, regdate, Gift_flag, flag, C0, Purchase, ItemType)
							VALUES(__IDUSER, __ITEMTYPEID, 1, now(), __GIFTFLAG, __TYPEFLAG, __C_0, 0, 2);

					SELECT MAX(ITEM_ID) INTO __IDITEM FROM pangya_item_warehouse WHERE UID = __IDUSER;
				END;
                END IF;
			
			SELECT __IDITEM AS ITEM_ID;
		END;
	ELSEIF __NUMERO = 120 THEN -- # Daily quest achievement
    BEGIN
		SELECT ID_ACHIEVEMENT AS ITEM_ID FROM achievement_tipo WHERE UID = __IDUSER AND TypeID = __ITEMTYPEID AND `OPTION` = 1;
    END;
	ELSEIF __NUMERO = 124 THEN -- #Pangya Card Pack #1, #2, #3, #4
	BEGIN
		IF __IDITEM <= 0 THEN
		BEGIN
			SELECT card_itemid INTO __IDITEM FROM pangya_card 
			WHERE UID = __IDUSER AND card_typeid = __ITEMTYPEID;
		END;
        END IF;

		IF __IDITEM > 0 THEN
			BEGIN
				BEGIN
					DECLARE __ATIVO_C CHAR;
					DECLARE	__C0_QNTD INT;

					SELECT USE_YN INTO __ATIVO_C FROM pangya_card WHERE UID = __IDUSER AND card_itemid = __IDITEM;
					IF __ATIVO_C = 'N' THEN
					BEGIN
						UPDATE pangya_card SET QNTD = QNTD + __C_0 WHERE UID = __IDUSER AND card_itemid = __IDITEM;

						SELECT QNTD INTO __C0_QNTD FROM pangya_card WHERE UID = __IDUSER AND card_itemid = __IDITEM;
						IF __C0_QNTD <= 0 THEN
						BEGIN
							UPDATE pangya_card SET USE_YN = 'Y', QNTD = 0 WHERE UID = __IDUSER AND card_itemid = __IDITEM;
						END;
                        END IF;
					END;
					ELSE
					BEGIN
						UPDATE pangya_card SET QNTD = QNTD + __C_0, USE_YN = 'N' WHERE UID = __IDUSER AND card_itemid = __IDITEM;
					END;
                    END IF;
				END;
			END;
		ELSE
			BEGIN
				INSERT INTO pangya_card(UID, card_typeid, card_type, QNTD, GET_DT, USE_YN)
						VALUES(__IDUSER, __ITEMTYPEID, 1, __C_0, now(), 'N');

				SELECT MAX(CARD_ITEMID) INTO __IDITEM FROM pangya_card WHERE UID = __IDUSER;
			END;
            END IF;

		SELECT __IDITEM AS ITEM_ID;
	END;
	ELSEIF __NUMERO = 125 THEN -- #Card NPC
	BEGIN
		IF __IDITEM <= 0 THEN
		BEGIN
			SELECT card_itemid INTO __IDITEM FROM pangya_card 
			WHERE UID = __IDUSER AND card_typeid = __ITEMTYPEID;
		END;
        END IF;

		IF __IDITEM > 0 THEN
				BEGIN
					DECLARE __ATIVO_C CHAR;
					DECLARE	__C0_QNTD INT;
					
					SELECT USE_YN INTO __ATIVO_C FROM pangya_card WHERE UID = __IDUSER AND card_itemid = __IDITEM;
					IF __ATIVO_C = 'N' THEN
					BEGIN
						UPDATE pangya_card SET QNTD = QNTD + __C_0 WHERE UID = __IDUSER AND card_itemid = __IDITEM;

						SELECT QNTD INTO __C0_QNTD FROM pangya_card WHERE UID = __IDUSER AND card_itemid = __IDITEM;
						IF __C0_QNTD <= 0 THEN
						BEGIN
							UPDATE pangya_card SET USE_YN = 'Y', QNTD = 0 WHERE UID = __IDUSER AND card_itemid = __IDITEM;
						END;
                        END IF;
					END;
					ELSE
					BEGIN
						UPDATE pangya_card SET QNTD = QNTD + __C_0, USE_YN = 'N' WHERE UID = __IDUSER AND card_itemid = __IDITEM;
					END;
                    END IF;
				END;
		ELSE
			BEGIN
				INSERT INTO pangya_card(UID, card_typeid, card_type, QNTD, GET_DT, USE_YN)
						VALUES(__IDUSER, __ITEMTYPEID, 1, __C_0, now(), 'N');

				SELECT MAX(CARD_ITEMID) INTO __IDITEM FROM pangya_card WHERE UID = __IDUSER;
			END;
            END IF;

		SELECT __IDITEM AS ITEM_ID;
	END;
	ELSE
		BEGIN  -- #Por outros itens
			IF __IDITEM <= 0 THEN
			BEGIN
				SELECT item_id INTO __IDITEM FROM pangya_item_warehouse 
				WHERE UID = __IDUSER AND typeid = __ITEMTYPEID;
			END;
            END IF;

			IF __IDITEM <= 0 THEN
				BEGIN
					INSERT INTO pangya_item_warehouse(UID, typeid, valid, regdate, Gift_flag, flag, C0, Purchase, ItemType, c1, c2, c3, c4)
							VALUES(__IDUSER, __ITEMTYPEID, 1, now(), __GIFTFLAG, __TYPEFLAG, __C_0, 0, 2, __C_1, __C_2, __C_3, __C_4);

					SELECT MAX(ITEM_ID) INTO __IDITEM FROM pangya_item_warehouse WHERE UID = __IDUSER;
				END;
			END IF;

			SELECT __IDITEM AS ITEM_ID;
		END;
        END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_ADD_UCC` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_ADD_UCC`(
	__IDUSER int,
	__TYPE_ID int,
	__GIFTFLAG int,
	__C_0 smallint,
	__C_1 smallint,
	__C_2 smallint,
	__C_3 smallint,
	__C_4 smallint,
	__PURCHASE_IN smallint,
	__TYPEFLAG smallint,
	__DAYCOUNT int
)
BEGIN

	DECLARE
         __UCC_IDX nvarchar(8) DEFAULT NULL;

      DECLARE
         __SEQU int;

      DECLARE
         __ITEMID bigint;

      SET __SEQU = 0;

      IF __TYPEFLAG = 8 THEN
         BEGIN

            SET __SEQU = 1;

            whLoop: WHILE 1 = 1 DO
            
               BEGIN

                  -- SELECT __UCC_IDX = left(upper((HASHBYTES(N'md5', rand()))), 8)
				  SELECT upper(left(md5(rand()), 8)) INTO __UCC_IDX;

                  IF NOT 
                     CASE 
                        WHEN EXISTS 
                           (
                              SELECT 1
                              FROM pangya.tu_ucc
                              WHERE 
                                 tu_ucc.UID = __IDUSER AND 
                                 tu_ucc.TYPEID = __TYPE_ID AND 
                                 tu_ucc.UCCIDX = __UCC_IDX
                           ) THEN 1
                        ELSE 0
                     END <> 0 THEN
                     lEAVE whLoop;
					END IF;

               END;
               END WHILE whLoop;

         END;
         END IF;

      SET __TYPEFLAG = 5;

      INSERT pangya.pangya_item_warehouse(
         pangya.pangya_item_warehouse.UID, 
         pangya.pangya_item_warehouse.typeid, 
         pangya.pangya_item_warehouse.regdate, 
         pangya.pangya_item_warehouse.Gift_flag, 
         pangya.pangya_item_warehouse.flag, 
         pangya.pangya_item_warehouse.C0, 
         pangya.pangya_item_warehouse.C1, 
         pangya.pangya_item_warehouse.C2, 
         pangya.pangya_item_warehouse.C3, 
         pangya.pangya_item_warehouse.C4, 
         pangya.pangya_item_warehouse.valid, 
         pangya.pangya_item_warehouse.Purchase, 
         pangya.pangya_item_warehouse.ClubSet_WorkShop_Flag, 
         pangya.pangya_item_warehouse.ClubSet_WorkShop_C0, 
         pangya.pangya_item_warehouse.ClubSet_WorkShop_C1, 
         pangya.pangya_item_warehouse.ClubSet_WorkShop_C2, 
         pangya.pangya_item_warehouse.ClubSet_WorkShop_C3, 
         pangya.pangya_item_warehouse.ClubSet_WorkShop_C4, 
         pangya.pangya_item_warehouse.Mastery_Pts, 
         pangya.pangya_item_warehouse.Recovery_Pts, 
         pangya.pangya_item_warehouse.`Level`, 
         pangya.pangya_item_warehouse.Up, 
         pangya.pangya_item_warehouse.Total_Mastery_Pts, 
         pangya.pangya_item_warehouse.Mastery_Gasto)
         VALUES (
            __IDUSER, 
            __TYPE_ID, 
            now(), 
            __GIFTFLAG, 
            __TYPEFLAG, 
            __C_0, 
            __C_1, 
            __C_2, 
            __C_3, 
            __C_4, 
            1, 
            0, 
            0, 
            0, 
            0, 
            0, 
            0, 
            0, 
            0, 
            0, 
            0, 
            0, 
            0, 
            0);

      SET __ITEMID = last_insert_id();

      IF __ITEMID <> 0 THEN
      BEGIN

            INSERT pangya.tu_ucc(
               pangya.tu_ucc.UID, 
               pangya.tu_ucc.TYPEID, 
               pangya.tu_ucc.UCCIDX, 
               pangya.tu_ucc.SEQ, 
               pangya.tu_ucc.UCC_NAME, 
               pangya.tu_ucc.USE_YN, 
               pangya.tu_ucc.IN_DATE, 
               pangya.tu_ucc.ITEM_ID, 
               pangya.tu_ucc.`STATUS`, 
               pangya.tu_ucc.Flag, 
               pangya.tu_ucc.TRADE)
               VALUES (
                  __IDUSER, 
                  __TYPE_ID, 
                  __UCC_IDX, 
                  __SEQU, 
                  NULL, 
                  'N', 
                  ifnull(now(), now()), 
                  __ITEMID, 
                  0, 
                  0, 
                  0);

            SELECT __ITEMID AS ITEM_ID, __UCC_IDX AS UCCIDX, __SEQU AS SD_SEQ;

         END;
      ELSE 
         SELECT 0 AS ITEM_ID, NULL AS UCCIDX, 0 AS SD_SEQ;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_ATT_COUNTER_ITEM` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_ATT_COUNTER_ITEM`(
	__IDUSER int,
	__count_typeid int,
	__id_count int,
	__qntd int,
	__quest_typeid_high smallint,
	__quest_typeid_low smallint
)
BEGIN

	IF 
         __IDUSER > 0 AND 
         __count_typeid > 0 AND 
         __id_count > 0 AND 
         __qntd > 0 THEN
         UPDATE pangya.count_item
            SET 
               count_num_item = count_item.Count_Num_Item + __qntd
         WHERE 
            count_item.UID = __IDUSER AND 
            count_item.Data_Sec = 0 AND 
            count_item.Count_ID = __id_count;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_ATT_COURSE_REWARD_TREASURE` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_ATT_COURSE_REWARD_TREASURE`(
)
BEGIN

	UPDATE pangya.pangya_course_reward_treasure
         SET 
            PANGREWARD = 
               CASE 
                  WHEN (pangya_course_reward_treasure.PANGREWARD < 950) THEN pangya_course_reward_treasure.PANGREWARD + 50
                  ELSE 
                     CASE 
                        WHEN (pangya_course_reward_treasure.PANGREWARD < 1000) THEN 1000
                        ELSE pangya_course_reward_treasure.PANGREWARD
                     END
               END;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_ATT_COURSE_REWARD_TREASURE_ONE` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_ATT_COURSE_REWARD_TREASURE_ONE`(
	__course_in int
)
BEGIN

	UPDATE pangya.pangya_course_reward_treasure
         SET 
            PANGREWARD = 
               CASE 
                  WHEN ((pangya_course_reward_treasure.PANGREWARD - 1) < 700) THEN 700
                  ELSE pangya_course_reward_treasure.PANGREWARD - 1
               END
      WHERE pangya_course_reward_treasure.COURSE = __course_in;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_CHAR_EQUIP_LOAD_S4` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_CHAR_EQUIP_LOAD_S4`(
	__IDUSER int
)
BEGIN
	
	SELECT 
         X.item_id, 
         X.typeid, 
         Y.ITEMID_PARTS_1, 
         Y.ITEMID_PARTS_2, 
         Y.ITEMID_PARTS_3, 
         Y.ITEMID_PARTS_4, 
         Y.ITEMID_PARTS_5, 
         Y.ITEMID_PARTS_6, 
         Y.ITEMID_PARTS_7, 
         Y.ITEMID_PARTS_8, 
         Y.ITEMID_PARTS_9, 
         Y.ITEMID_PARTS_10, 
         Y.ITEMID_PARTS_11, 
         Y.ITEMID_PARTS_12, 
         Y.ITEMID_PARTS_13, 
         Y.ITEMID_PARTS_14, 
         Y.ITEMID_PARTS_15, 
         Y.ITEMID_PARTS_16, 
         Y.ITEMID_PARTS_17, 
         Y.ITEMID_PARTS_18, 
         Y.ITEMID_PARTS_19, 
         Y.ITEMID_PARTS_20, 
         Y.ITEMID_PARTS_21, 
         Y.ITEMID_PARTS_22, 
         Y.ITEMID_PARTS_23, 
         Y.ITEMID_PARTS_24, 
         X.parts_1, 
         X.parts_2, 
         X.parts_3, 
         X.parts_4, 
         X.parts_5, 
         X.parts_6, 
         X.parts_7, 
         X.parts_8, 
         X.parts_9, 
         X.parts_10, 
         X.parts_11, 
         X.parts_12, 
         X.parts_13, 
         X.parts_14, 
         X.parts_15, 
         X.parts_16, 
         X.parts_17, 
         X.parts_18, 
         X.parts_19, 
         X.parts_20, 
         X.parts_21, 
         X.parts_22, 
         X.parts_23, 
         X.parts_24, 
         X.default_hair, 
         X.default_shirts, 
         X.gift_flag, 
         X.PCL0, 
         X.PCL1, 
         X.PCL2, 
         X.PCL3, 
         X.PCL4, 
         X.Purchase, 
         X.auxparts_1, 
         X.auxparts_2, 
         X.auxparts_3, 
         X.auxparts_4, 
         X.auxparts_5, 
         X.CutIn_1, 
         X.CutIn_2, 
         X.CutIn_3, 
         X.CutIn_4, 
         X.Mastery, 
         Z.CARD_CHARACTER_1, 
         Z.CARD_CHARACTER_2, 
         Z.CARD_CHARACTER_3, 
         Z.CARD_CHARACTER_4, 
         Z.CARD_CADDIE_1, 
         Z.CARD_CADDIE_2, 
         Z.CARD_CADDIE_3, 
         Z.CARD_CADDIE_4, 
         Z.CARD_NPC_1, 
         Z.CARD_NPC_2, 
         Z.CARD_NPC_3, 
         Z.CARD_NPC_4
      FROM 
         (
            SELECT 
               pangya_character_information.item_id, 
               pangya_character_information.typeid, 
               pangya_character_information.parts_1, 
               pangya_character_information.parts_2, 
               pangya_character_information.parts_3, 
               pangya_character_information.parts_4, 
               pangya_character_information.parts_5, 
               pangya_character_information.parts_6, 
               pangya_character_information.parts_7, 
               pangya_character_information.parts_8, 
               pangya_character_information.parts_9, 
               pangya_character_information.parts_10, 
               pangya_character_information.parts_11, 
               pangya_character_information.parts_12, 
               pangya_character_information.parts_13, 
               pangya_character_information.parts_14, 
               pangya_character_information.parts_15, 
               pangya_character_information.parts_16, 
               pangya_character_information.parts_17, 
               pangya_character_information.parts_18, 
               pangya_character_information.parts_19, 
               pangya_character_information.parts_20, 
               pangya_character_information.parts_21, 
               pangya_character_information.parts_22, 
               pangya_character_information.parts_23, 
               pangya_character_information.parts_24, 
               pangya_character_information.auxparts_1, 
               pangya_character_information.auxparts_2, 
               pangya_character_information.auxparts_3, 
               pangya_character_information.auxparts_4, 
               pangya_character_information.auxparts_5, 
               pangya_character_information.default_hair, 
               pangya_character_information.default_shirts, 
               pangya_character_information.gift_flag, 
               pangya_character_information.PCL0, 
               pangya_character_information.PCL1, 
               pangya_character_information.PCL2, 
               pangya_character_information.PCL3, 
               pangya_character_information.PCL4, 
               pangya_character_information.Purchase, 
               pangya_character_information.CutIn_1, 
               pangya_character_information.CutIn_2, 
               pangya_character_information.CutIn_3, 
               pangya_character_information.CutIn_4, 
               pangya_character_information.Mastery
            FROM pangya.pangya_character_information
            WHERE pangya_character_information.UID = __IDUSER
         )  AS X 
            INNER JOIN 
            (
               SELECT 
                  A.item_id, 
                   max(
                     CASE 
                        WHEN B.EQUIP_NUM = 1 THEN B.ITEMID
                        ELSE 0
                     END) AS ITEMID_PARTS_1, 
                   max(
                     CASE 
                        WHEN B.EQUIP_NUM = 2 THEN B.ITEMID
                        ELSE 0
                     END) AS ITEMID_PARTS_2, 
                   max(
                     CASE 
                        WHEN B.EQUIP_NUM = 3 THEN B.ITEMID
                        ELSE 0
                     END) AS ITEMID_PARTS_3, 
                   max(
                     CASE 
                        WHEN B.EQUIP_NUM = 4 THEN B.ITEMID
                        ELSE 0
                     END) AS ITEMID_PARTS_4, 
                   max(
                     CASE 
                        WHEN B.EQUIP_NUM = 5 THEN B.ITEMID
                        ELSE 0
                     END) AS ITEMID_PARTS_5, 
                   max(
                     CASE 
                        WHEN B.EQUIP_NUM = 6 THEN B.ITEMID
                        ELSE 0
                     END) AS ITEMID_PARTS_6, 
                   max(
                     CASE 
                        WHEN B.EQUIP_NUM = 7 THEN B.ITEMID
                        ELSE 0
                     END) AS ITEMID_PARTS_7, 
                   max(
                     CASE 
                        WHEN B.EQUIP_NUM = 8 THEN B.ITEMID
                        ELSE 0
                     END) AS ITEMID_PARTS_8, 
                   max(
                     CASE 
                        WHEN B.EQUIP_NUM = 9 THEN B.ITEMID
                        ELSE 0
                     END) AS ITEMID_PARTS_9, 
                   max(
                     CASE 
                        WHEN B.EQUIP_NUM = 10 THEN B.ITEMID
                        ELSE 0
                     END) AS ITEMID_PARTS_10, 
                   max(
                     CASE 
                        WHEN B.EQUIP_NUM = 11 THEN B.ITEMID
                        ELSE 0
                     END) AS ITEMID_PARTS_11, 
                   max(
                     CASE 
                        WHEN B.EQUIP_NUM = 12 THEN B.ITEMID
                        ELSE 0
                     END) AS ITEMID_PARTS_12, 
                   max(
                     CASE 
                        WHEN B.EQUIP_NUM = 13 THEN B.ITEMID
                        ELSE 0
                     END) AS ITEMID_PARTS_13, 
                   max(
                     CASE 
                        WHEN B.EQUIP_NUM = 14 THEN B.ITEMID
                        ELSE 0
                     END) AS ITEMID_PARTS_14, 
                   max(
                     CASE 
                        WHEN B.EQUIP_NUM = 15 THEN B.ITEMID
                        ELSE 0
                     END) AS ITEMID_PARTS_15, 
                   max(
                     CASE 
                        WHEN B.EQUIP_NUM = 16 THEN B.ITEMID
                        ELSE 0
                     END) AS ITEMID_PARTS_16, 
                   max(
                     CASE 
                        WHEN B.EQUIP_NUM = 17 THEN B.ITEMID
                        ELSE 0
                     END) AS ITEMID_PARTS_17, 
                   max(
                     CASE 
                        WHEN B.EQUIP_NUM = 18 THEN B.ITEMID
                        ELSE 0
                     END) AS ITEMID_PARTS_18, 
                   max(
                     CASE 
                        WHEN B.EQUIP_NUM = 19 THEN B.ITEMID
                        ELSE 0
                     END) AS ITEMID_PARTS_19, 
                   max(
                     CASE 
                        WHEN B.EQUIP_NUM = 20 THEN B.ITEMID
                        ELSE 0
                     END) AS ITEMID_PARTS_20, 
                   max(
                     CASE 
                        WHEN B.EQUIP_NUM = 21 THEN B.ITEMID
                        ELSE 0
                     END) AS ITEMID_PARTS_21, 
                   max(
                     CASE 
                        WHEN B.EQUIP_NUM = 22 THEN B.ITEMID
                        ELSE 0
                     END) AS ITEMID_PARTS_22, 
                   max(
                     CASE 
                        WHEN B.EQUIP_NUM = 23 THEN B.ITEMID
                        ELSE 0
                     END) AS ITEMID_PARTS_23, 
                   max(
                     CASE 
                        WHEN B.EQUIP_NUM = 24 THEN B.ITEMID
                        ELSE 0
                     END) AS ITEMID_PARTS_24
               FROM 
                  (
                     SELECT pangya_character_information.item_id
                     FROM pangya.pangya_character_information
                     WHERE pangya_character_information.UID = __IDUSER
                  )  AS A 
                     LEFT OUTER JOIN 
                     (
                        SELECT td_char_equip_s4.CHAR_ITEMID, td_char_equip_s4.ITEMID, td_char_equip_s4.EQUIP_NUM
                        FROM pangya.td_char_equip_s4
                        WHERE td_char_equip_s4.UID = __IDUSER AND td_char_equip_s4.USE_YN = 'Y'
                     )  AS B 
                     ON A.item_id = B.CHAR_ITEMID
               GROUP BY A.item_id
            )  AS Y 
			ON X.item_id = Y.item_id
            INNER JOIN 
            (
               SELECT 
                  E.item_id, 
                   max(
                     CASE 
                        WHEN F.Tipo = 0 AND F.Slot = 1 THEN F.card_typeid
                        ELSE 0
                     END) AS CARD_CHARACTER_1, 
                   max(
                     CASE 
                        WHEN F.Tipo = 0 AND F.Slot = 2 THEN F.card_typeid
                        ELSE 0
                     END) AS CARD_CHARACTER_2, 
                   max(
                     CASE 
                        WHEN F.Tipo = 0 AND F.Slot = 3 THEN F.card_typeid
                        ELSE 0
                     END) AS CARD_CHARACTER_3, 
                   max(
                     CASE 
                        WHEN F.Tipo = 0 AND F.Slot = 4 THEN F.card_typeid
                        ELSE 0
                     END) AS CARD_CHARACTER_4, 
                   max(
                     CASE 
                        WHEN F.Tipo = 1 AND F.Slot = 5 THEN F.card_typeid
                        ELSE 0
                     END) AS CARD_CADDIE_1, 
                   max(
                     CASE 
                        WHEN F.Tipo = 1 AND F.Slot = 6 THEN F.card_typeid
                        ELSE 0
                     END) AS CARD_CADDIE_2, 
                   max(
                     CASE 
                        WHEN F.Tipo = 1 AND F.Slot = 7 THEN F.card_typeid
                        ELSE 0
                     END) AS CARD_CADDIE_3, 
                   max(
                     CASE 
                        WHEN F.Tipo = 1 AND F.Slot = 8 THEN F.card_typeid
                        ELSE 0
                     END) AS CARD_CADDIE_4, 
                   max(
                     CASE 
                        WHEN F.Tipo = 5 AND F.Slot = 9 THEN F.card_typeid
                        ELSE 0
                     END) AS CARD_NPC_1, 
                   max(
                     CASE 
                        WHEN F.Tipo = 5 AND F.Slot = 10 THEN F.card_typeid
                        ELSE 0
                     END) AS CARD_NPC_2, 
                   max(
                     CASE 
                        WHEN F.Tipo = 5 AND F.Slot = 11 THEN F.card_typeid
                        ELSE 0
                     END) AS CARD_NPC_3, 
                   max(
                     CASE 
                        WHEN F.Tipo = 5 AND F.Slot = 12 THEN F.card_typeid
                        ELSE 0
                     END) AS CARD_NPC_4
               FROM 
                  (
                     SELECT pangya_character_information.item_id
                     FROM pangya.pangya_character_information
                     WHERE pangya_character_information.UID = __IDUSER
                  )  AS E 
                     LEFT OUTER JOIN 
                     (
                        SELECT pangya_card_equip.Tipo, pangya_card_equip.Slot, pangya_card_equip.card_typeid, pangya_card_equip.parts_id
                        FROM pangya.pangya_card_equip
                        WHERE pangya_card_equip.UID = __IDUSER AND pangya_card_equip.USE_YN = 1
                     )  AS F 
                     ON F.parts_id = E.item_id
               GROUP BY E.item_id               


            )  AS Z 
            ON X.item_id = Z.item_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_CHAR_EQUIP_LOAD_S4_ONE` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_CHAR_EQUIP_LOAD_S4_ONE`(
	__IDUSER int,
	__IDITEM int
)
BEGIN

	DECLARE
         __CONTADOR int;

      IF __IDITEM < 0 THEN
         SELECT a.character_id INTO __IDITEM
         FROM pangya.pangya_user_equip a
         WHERE a.UID = __IDUSER;
	END IF;

      SELECT count(*) INTO __CONTADOR
      FROM pangya.pangya_character_information
      WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.item_id = __IDITEM;

      IF __CONTADOR > 0 THEN
	  BEGIN

         SELECT 
            X.item_id, 
            X.typeid, 
            Y.ITEMID_PARTS_1, 
            Y.ITEMID_PARTS_2, 
            Y.ITEMID_PARTS_3, 
            Y.ITEMID_PARTS_4, 
            Y.ITEMID_PARTS_5, 
            Y.ITEMID_PARTS_6, 
            Y.ITEMID_PARTS_7, 
            Y.ITEMID_PARTS_8, 
            Y.ITEMID_PARTS_9, 
            Y.ITEMID_PARTS_10, 
            Y.ITEMID_PARTS_11, 
            Y.ITEMID_PARTS_12, 
            Y.ITEMID_PARTS_13, 
            Y.ITEMID_PARTS_14, 
            Y.ITEMID_PARTS_15, 
            Y.ITEMID_PARTS_16, 
            Y.ITEMID_PARTS_17, 
            Y.ITEMID_PARTS_18, 
            Y.ITEMID_PARTS_19, 
            Y.ITEMID_PARTS_20, 
            Y.ITEMID_PARTS_21, 
            Y.ITEMID_PARTS_22, 
            Y.ITEMID_PARTS_23, 
            Y.ITEMID_PARTS_24, 
            X.parts_1, 
            X.parts_2, 
            X.parts_3, 
            X.parts_4, 
            X.parts_5, 
            X.parts_6, 
            X.parts_7, 
            X.parts_8, 
            X.parts_9, 
            X.parts_10, 
            X.parts_11, 
            X.parts_12, 
            X.parts_13, 
            X.parts_14, 
            X.parts_15, 
            X.parts_16, 
            X.parts_17, 
            X.parts_18, 
            X.parts_19, 
            X.parts_20, 
            X.parts_21, 
            X.parts_22, 
            X.parts_23, 
            X.parts_24, 
            X.default_hair, 
            X.default_shirts, 
            X.gift_flag, 
            X.PCL0, 
            X.PCL1, 
            X.PCL2, 
            X.PCL3, 
            X.PCL4, 
            X.Purchase, 
            X.auxparts_1, 
            X.auxparts_2, 
            X.auxparts_3, 
            X.auxparts_4, 
            X.auxparts_5, 
            X.CutIn_1,
            X.CutIn_2,
            X.CutIn_3,
            X.CutIn_4,
            X.Mastery, 
            Z.CARD_CHARACTER_1, 
            Z.CARD_CHARACTER_2, 
            Z.CARD_CHARACTER_3, 
            Z.CARD_CHARACTER_4, 
            Z.CARD_CADDIE_1, 
            Z.CARD_CADDIE_2, 
            Z.CARD_CADDIE_3, 
            Z.CARD_CADDIE_4, 
            Z.CARD_NPC_1, 
            Z.CARD_NPC_2, 
            Z.CARD_NPC_3, 
            Z.CARD_NPC_4
         FROM 
            (
               SELECT 
                  pangya_character_information.item_id, 
                  pangya_character_information.typeid, 
                  pangya_character_information.parts_1, 
                  pangya_character_information.parts_2, 
                  pangya_character_information.parts_3, 
                  pangya_character_information.parts_4, 
                  pangya_character_information.parts_5, 
                  pangya_character_information.parts_6, 
                  pangya_character_information.parts_7, 
                  pangya_character_information.parts_8, 
                  pangya_character_information.parts_9, 
                  pangya_character_information.parts_10, 
                  pangya_character_information.parts_11, 
                  pangya_character_information.parts_12, 
                  pangya_character_information.parts_13, 
                  pangya_character_information.parts_14, 
                  pangya_character_information.parts_15, 
                  pangya_character_information.parts_16, 
                  pangya_character_information.parts_17, 
                  pangya_character_information.parts_18, 
                  pangya_character_information.parts_19, 
                  pangya_character_information.parts_20, 
                  pangya_character_information.parts_21, 
                  pangya_character_information.parts_22, 
                  pangya_character_information.parts_23, 
                  pangya_character_information.parts_24, 
                  pangya_character_information.auxparts_1, 
                  pangya_character_information.auxparts_2, 
                  pangya_character_information.auxparts_3, 
                  pangya_character_information.auxparts_4, 
                  pangya_character_information.auxparts_5, 
                  pangya_character_information.default_hair, 
                  pangya_character_information.default_shirts, 
                  pangya_character_information.gift_flag, 
                  pangya_character_information.PCL0, 
                  pangya_character_information.PCL1, 
                  pangya_character_information.PCL2, 
                  pangya_character_information.PCL3, 
                  pangya_character_information.PCL4, 
                  pangya_character_information.Purchase, 
                  pangya_character_information.CutIn_1, 
                  pangya_character_information.CutIn_2, 
                  pangya_character_information.CutIn_3, 
                  pangya_character_information.CutIn_4, 
                  pangya_character_information.Mastery
               FROM pangya.pangya_character_information
               WHERE pangya_character_information.UID = __IDUSER
            )  AS X 
               INNER JOIN 
               (
                  SELECT 
                     A.item_id, 
                      max(
                        CASE 
                           WHEN B.EQUIP_NUM = 1 THEN B.ITEMID
                           ELSE 0
                        END) AS ITEMID_PARTS_1, 
                      max(
                        CASE 
                           WHEN B.EQUIP_NUM = 2 THEN B.ITEMID
                           ELSE 0
                        END) AS ITEMID_PARTS_2, 
                      max(
                        CASE 
                           WHEN B.EQUIP_NUM = 3 THEN B.ITEMID
                           ELSE 0
                        END) AS ITEMID_PARTS_3, 
                      max(
                        CASE 
                           WHEN B.EQUIP_NUM = 4 THEN B.ITEMID
                           ELSE 0
                        END) AS ITEMID_PARTS_4, 
                      max(
                        CASE 
                           WHEN B.EQUIP_NUM = 5 THEN B.ITEMID
                           ELSE 0
                        END) AS ITEMID_PARTS_5, 
                      max(
                        CASE 
                           WHEN B.EQUIP_NUM = 6 THEN B.ITEMID
                           ELSE 0
                        END) AS ITEMID_PARTS_6, 
                      max(
                        CASE 
                           WHEN B.EQUIP_NUM = 7 THEN B.ITEMID
                           ELSE 0
                        END) AS ITEMID_PARTS_7, 
                     max(
                        CASE 
                           WHEN B.EQUIP_NUM = 8 THEN B.ITEMID
                           ELSE 0
                        END) AS ITEMID_PARTS_8, 
                     max(
                        CASE 
                           WHEN B.EQUIP_NUM = 9 THEN B.ITEMID
                           ELSE 0
                        END) AS ITEMID_PARTS_9, 
                     max(
                        CASE 
                           WHEN B.EQUIP_NUM = 10 THEN B.ITEMID
                           ELSE 0
                        END) AS ITEMID_PARTS_10, 
                     max(
                        CASE 
                           WHEN B.EQUIP_NUM = 11 THEN B.ITEMID
                           ELSE 0
                        END) AS ITEMID_PARTS_11, 
                     max(
                        CASE 
                           WHEN B.EQUIP_NUM = 12 THEN B.ITEMID
                           ELSE 0
                        END) AS ITEMID_PARTS_12, 
                     max(
                        CASE 
                           WHEN B.EQUIP_NUM = 13 THEN B.ITEMID
                           ELSE 0
                        END) AS ITEMID_PARTS_13, 
                     max(
                        CASE 
                           WHEN B.EQUIP_NUM = 14 THEN B.ITEMID
                           ELSE 0
                        END) AS ITEMID_PARTS_14, 
                     max(
                        CASE 
                           WHEN B.EQUIP_NUM = 15 THEN B.ITEMID
                           ELSE 0
                        END) AS ITEMID_PARTS_15, 
                     max(
                        CASE 
                           WHEN B.EQUIP_NUM = 16 THEN B.ITEMID
                           ELSE 0
                        END) AS ITEMID_PARTS_16, 
                     max(
                        CASE 
                           WHEN B.EQUIP_NUM = 17 THEN B.ITEMID
                           ELSE 0
                        END) AS ITEMID_PARTS_17, 
                     max(
                        CASE 
                           WHEN B.EQUIP_NUM = 18 THEN B.ITEMID
                           ELSE 0
                        END) AS ITEMID_PARTS_18, 
                     max(
                        CASE 
                           WHEN B.EQUIP_NUM = 19 THEN B.ITEMID
                           ELSE 0
                        END) AS ITEMID_PARTS_19, 
                     max(
                        CASE 
                           WHEN B.EQUIP_NUM = 20 THEN B.ITEMID
                           ELSE 0
                        END) AS ITEMID_PARTS_20, 
                     max(
                        CASE 
                           WHEN B.EQUIP_NUM = 21 THEN B.ITEMID
                           ELSE 0
                        END) AS ITEMID_PARTS_21, 
                     max(
                        CASE 
                           WHEN B.EQUIP_NUM = 22 THEN B.ITEMID
                           ELSE 0
                        END) AS ITEMID_PARTS_22, 
                     max(
                        CASE 
                           WHEN B.EQUIP_NUM = 23 THEN B.ITEMID
                           ELSE 0
                        END) AS ITEMID_PARTS_23, 
                     max(
                        CASE 
                           WHEN B.EQUIP_NUM = 24 THEN B.ITEMID
                           ELSE 0
                        END) AS ITEMID_PARTS_24
                  FROM 
                     (
                        SELECT pangya_character_information.item_id
                        FROM pangya.pangya_character_information
                        WHERE pangya_character_information.UID = __IDUSER
                     )  AS A 
                        LEFT OUTER JOIN 
                        (
                           SELECT td_char_equip_s4.CHAR_ITEMID, td_char_equip_s4.ITEMID, td_char_equip_s4.EQUIP_NUM
                           FROM pangya.td_char_equip_s4
                           WHERE td_char_equip_s4.UID = __IDUSER AND td_char_equip_s4.USE_YN = 'Y'
                        )  AS B 
                        ON A.item_id = B.CHAR_ITEMID
                  GROUP BY A.item_id
               )  AS Y 
			   ON X.item_id = Y.item_id
               INNER JOIN 
               (

                  SELECT 
                     E.item_id, 
                     max(
                        CASE 
                           WHEN F.Tipo = 0 AND F.Slot = 1 THEN F.card_typeid
                           ELSE 0
                        END) AS CARD_CHARACTER_1, 
                     max(
                        CASE 
                           WHEN F.Tipo = 0 AND F.Slot = 2 THEN F.card_typeid
                           ELSE 0
                        END) AS CARD_CHARACTER_2, 
                     max(
                        CASE 
                           WHEN F.Tipo = 0 AND F.Slot = 3 THEN F.card_typeid
                           ELSE 0
                        END) AS CARD_CHARACTER_3, 
                     max(
                        CASE 
                           WHEN F.Tipo = 0 AND F.Slot = 4 THEN F.card_typeid
                           ELSE 0
                        END) AS CARD_CHARACTER_4, 
                     max(
                        CASE 
                           WHEN F.Tipo = 1 AND F.Slot = 5 THEN F.card_typeid
                           ELSE 0
                        END) AS CARD_CADDIE_1, 
                     max(
                        CASE 
                           WHEN F.Tipo = 1 AND F.Slot = 6 THEN F.card_typeid
                           ELSE 0
                        END) AS CARD_CADDIE_2, 
                     max(
                        CASE 
                           WHEN F.Tipo = 1 AND F.Slot = 7 THEN F.card_typeid
                           ELSE 0
                        END) AS CARD_CADDIE_3, 
                     max(
                        CASE 
                           WHEN F.Tipo = 1 AND F.Slot = 8 THEN F.card_typeid
                           ELSE 0
                        END) AS CARD_CADDIE_4, 
                     max(
                        CASE 
                           WHEN F.Tipo = 5 AND F.Slot = 9 THEN F.card_typeid
                           ELSE 0
                        END) AS CARD_NPC_1, 
                     max(
                        CASE 
                           WHEN F.Tipo = 5 AND F.Slot = 10 THEN F.card_typeid
                           ELSE 0
                        END) AS CARD_NPC_2, 
                     max(
                        CASE 
                           WHEN F.Tipo = 5 AND F.Slot = 11 THEN F.card_typeid
                           ELSE 0
                        END) AS CARD_NPC_3, 
                     max(
                        CASE 
                           WHEN F.Tipo = 5 AND F.Slot = 12 THEN F.card_typeid
                           ELSE 0
                        END) AS CARD_NPC_4
                  FROM 
                     (
                        SELECT pangya_character_information.item_id
                        FROM pangya.pangya_character_information
                        WHERE pangya_character_information.UID = __IDUSER
                     )  AS E 
                        LEFT OUTER JOIN 
                        (
                           SELECT pangya_card_equip.Tipo, pangya_card_equip.Slot, pangya_card_equip.card_typeid, pangya_card_equip.parts_id
                           FROM pangya.pangya_card_equip
                           WHERE pangya_card_equip.UID = __IDUSER AND pangya_card_equip.USE_YN = 1
                        )  AS F 
                        ON F.parts_id = E.item_id
                  GROUP BY E.item_id                  


               )  AS Z 
               ON 
                  X.item_id = Z.item_id AND 
                  X.item_id = __IDITEM;
	
      END;
      ELSE 

         SELECT 
            0 AS ITEM_ID, 
            0 AS TYPEID, 
            0 AS ITEMID_PARTS_1, 
            0 AS ITEMID_PARTS_2, 
            0 AS ITEMID_PARTS_3, 
            0 AS ITEMID_PARTS_4, 
            0 AS ITEMID_PARTS_5, 
            0 AS ITEMID_PARTS_6, 
            0 AS ITEMID_PARTS_7, 
            0 AS ITEMID_PARTS_8, 
            0 AS ITEMID_PARTS_9, 
            0 AS ITEMID_PARTS_10, 
            0 AS ITEMID_PARTS_11, 
            0 AS ITEMID_PARTS_12, 
            0 AS ITEMID_PARTS_13, 
            0 AS ITEMID_PARTS_14, 
            0 AS ITEMID_PARTS_15, 
            0 AS ITEMID_PARTS_16, 
            0 AS ITEMID_PARTS_17, 
            0 AS ITEMID_PARTS_18, 
            0 AS ITEMID_PARTS_19, 
            0 AS ITEMID_PARTS_20, 
            0 AS ITEMID_PARTS_21, 
            0 AS ITEMID_PARTS_22, 
            0 AS ITEMID_PARTS_23, 
            0 AS ITEMID_PARTS_24, 
            0 AS PARTS_1, 
            0 AS PARTS_2, 
            0 AS PARTS_3, 
            0 AS PARTS_4, 
            0 AS PARTS_5, 
            0 AS PARTS_6, 
            0 AS PARTS_7, 
            0 AS PARTS_8, 
            0 AS PARTS_9, 
            0 AS PARTS_10, 
            0 AS PARTS_11, 
            0 AS PARTS_12, 
            0 AS PARTS_13, 
            0 AS PARTS_14, 
            0 AS PARTS_15, 
            0 AS PARTS_16, 
            0 AS PARTS_17, 
            0 AS PARTS_18, 
            0 AS PARTS_19, 
            0 AS PARTS_20, 
            0 AS PARTS_21, 
            0 AS PARTS_22, 
            0 AS PARTS_23, 
            0 AS PARTS_24, 
            0 AS DEFAULT_HAIR, 
            0 AS DEFAULT_SHIRTS, 
            0 AS GIFT_FLAG, 
            0 AS PCL0, 
            0 AS PCL1, 
            0 AS PCL2, 
            0 AS PCL3, 
            0 AS PCL4, 
            0 AS PURCHASE, 
            0 AS AUXPARTS_1, 
            0 AS AUXPARTS_2, 
            0 AS AUXPARTS_3, 
            0 AS AUXPARTS_4, 
            0 AS AUXPARTS_5, 
            0 AS CUTIN_1, 
            0 AS CUTIN_2, 
            0 AS CUTIN_3, 
            0 AS CUTIN_4, 
            0 AS MASTERY, 
            0 AS CARD_CHARACTER_1, 
            0 AS CARD_CHARACTER_2, 
            0 AS CARD_CHARACTER_3, 
            0 AS CARD_CHARACTER_4, 
            0 AS CARD_CADDIE_1, 
            0 AS CARD_CADDIE_2, 
            0 AS CARD_CADDIE_3, 
            0 AS CARD_CADDIE_4, 
            0 AS CARD_NPC_1, 
            0 AS CARD_NPC_2, 
            0 AS CARD_NPC_3, 
            0 AS CARD_NPC_4;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_CHAR_EQUIP_SAVE_S4` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_CHAR_EQUIP_SAVE_S4`(
	__IDUSER INT,
	__ITEM_ID INT,
	__STR VARCHAR(8000)
)
BEGIN
	
    DECLARE  __sparts_1 VARCHAR(13);
	DECLARE __sparts_2 VARCHAR(13);
	DECLARE __sparts_3 VARCHAR(13);
	DECLARE __sparts_4 VARCHAR(13);
	DECLARE __sparts_5 VARCHAR(13);
	DECLARE __sparts_6 VARCHAR(13);
	DECLARE __sparts_7 VARCHAR(13);
	DECLARE __sparts_8 VARCHAR(13);
	DECLARE __sparts_9 VARCHAR(13);
	DECLARE __sparts_10 VARCHAR(13);
	DECLARE __sparts_11 VARCHAR(13);
	DECLARE __sparts_12 VARCHAR(13);
	DECLARE __sparts_13 VARCHAR(13);
	DECLARE __sparts_14 VARCHAR(13);
	DECLARE __sparts_15 VARCHAR(13);
	DECLARE __sparts_16 VARCHAR(13);
	DECLARE __sparts_17 VARCHAR(13);
	DECLARE __sparts_18 VARCHAR(13);
	DECLARE __sparts_19 VARCHAR(13);
	DECLARE __sparts_20 VARCHAR(13);
	DECLARE __sparts_21 VARCHAR(13);
	DECLARE __sparts_22 VARCHAR(13);
	DECLARE __sparts_23 VARCHAR(13);
	DECLARE __sparts_24 VARCHAR(13);
	DECLARE __sparts_id_1 VARCHAR(13);
	DECLARE __sparts_id_2 VARCHAR(13);
	DECLARE __sparts_id_3 VARCHAR(13);
	DECLARE __sparts_id_4 VARCHAR(13);
	DECLARE __sparts_id_5 VARCHAR(13);
	DECLARE __sparts_id_6 VARCHAR(13);
	DECLARE __sparts_id_7 VARCHAR(13);
	DECLARE __sparts_id_8 VARCHAR(13);
	DECLARE __sparts_id_9 VARCHAR(13);
	DECLARE __sparts_id_10 VARCHAR(13);
	DECLARE __sparts_id_11 VARCHAR(13);
	DECLARE __sparts_id_12 VARCHAR(13);
	DECLARE __sparts_id_13 VARCHAR(13);
	DECLARE __sparts_id_14 VARCHAR(13);
	DECLARE __sparts_id_15 VARCHAR(13);
	DECLARE __sparts_id_16 VARCHAR(13);
	DECLARE __sparts_id_17 VARCHAR(13);
	DECLARE __sparts_id_18 VARCHAR(13);
	DECLARE __sparts_id_19 VARCHAR(13);
	DECLARE __sparts_id_20 VARCHAR(13);
	DECLARE __sparts_id_21 VARCHAR(13);
	DECLARE __sparts_id_22 VARCHAR(13);
	DECLARE __sparts_id_23 VARCHAR(13);
	DECLARE __sparts_id_24 VARCHAR(13);
	DECLARE __sdefault_hair VARCHAR(13);
	DECLARE __sdefault_shirts VARCHAR(13);
	DECLARE __sgift_flag VARCHAR(13);
	DECLARE __spurchase VARCHAR(13);
	DECLARE __sPCL_1 VARCHAR(13);
	DECLARE __sPCL_2 VARCHAR(13);
	DECLARE __sPCL_3 VARCHAR(13);
	DECLARE __sPCL_4 VARCHAR(13);
	DECLARE __sPCL_5 VARCHAR(13);
	DECLARE __scutin_1 VARCHAR(13);
	DECLARE __scutin_2 VARCHAR(13);
	DECLARE __scutin_3 VARCHAR(13);
	DECLARE __scutin_4 VARCHAR(13);
	DECLARE __sauxparts_1 VARCHAR(13);
	DECLARE __sauxparts_2 VARCHAR(13);
	DECLARE __sauxparts_3 VARCHAR(13);
	DECLARE __sauxparts_4 VARCHAR(13);
	DECLARE __sauxparts_5 VARCHAR(13);
	DECLARE __smastery VARCHAR(13);
	
    SET __sdefault_hair = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 2), '|',-1);
    SET __sdefault_shirts = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 3), '|',-1);
    SET __sgift_flag = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 4), '|',-1);
    SET __spurchase = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 5), '|',-1);
	SET __sparts_1 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 6), '|',-1);
	SET __sparts_2 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 7), '|',-1);
	SET __sparts_3 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 8), '|',-1);
	SET __sparts_4 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 9), '|',-1);
	SET __sparts_5 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 10), '|',-1);
	SET __sparts_6 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 11), '|',-1);
	SET __sparts_7 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 12), '|',-1);
	SET __sparts_8 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 13), '|',-1);
	SET __sparts_9 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 14), '|',-1);
	SET __sparts_10 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 15), '|',-1);
	SET __sparts_11 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 16), '|',-1);
	SET __sparts_12 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 17), '|',-1);
	SET __sparts_13 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 18), '|',-1);
	SET __sparts_14 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 19), '|',-1);
	SET __sparts_15 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 20), '|',-1);
	SET __sparts_16 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 21), '|',-1);
	SET __sparts_17 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 22), '|',-1);
	SET __sparts_18 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 23), '|',-1);
	SET __sparts_19 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 24), '|',-1);
	SET __sparts_20 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 25), '|',-1);
	SET __sparts_21 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 26), '|',-1);
	SET __sparts_22 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 27), '|',-1);
	SET __sparts_23 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 28), '|',-1);
	SET __sparts_24 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 29), '|',-1);
	SET __sparts_id_1 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 30), '|',-1);
	SET __sparts_id_2 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 31), '|',-1);
	SET __sparts_id_3 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 32), '|',-1);
	SET __sparts_id_4 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 33), '|',-1);
	SET __sparts_id_5 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 34), '|',-1);
	SET __sparts_id_6 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 35), '|',-1);
	SET __sparts_id_7 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 36), '|',-1);
	SET __sparts_id_8 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 37), '|',-1);
	SET __sparts_id_9 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 38), '|',-1);
	SET __sparts_id_10 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 39), '|',-1);
	SET __sparts_id_11 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 40), '|',-1);
	SET __sparts_id_12 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 41), '|',-1);
	SET __sparts_id_13 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 42), '|',-1);
	SET __sparts_id_14 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 43), '|',-1);
	SET __sparts_id_15 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 44), '|',-1);
	SET __sparts_id_16 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 45), '|',-1);
	SET __sparts_id_17 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 46), '|',-1);
	SET __sparts_id_18 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 47), '|',-1);
	SET __sparts_id_19 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 48), '|',-1);
	SET __sparts_id_20 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 49), '|',-1);
	SET __sparts_id_21 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 50), '|',-1);
	SET __sparts_id_22 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 51), '|',-1);
	SET __sparts_id_23 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 52), '|',-1);
	SET __sparts_id_24 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 53), '|',-1);
	SET __sauxparts_1 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 54), '|',-1);
	SET __sauxparts_2 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 55), '|',-1);
	SET __sauxparts_3 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 56), '|',-1);
	SET __sauxparts_4 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 57), '|',-1);
	SET __sauxparts_5 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 58), '|',-1);
    SET __scutin_1 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 59), '|',-1);
    SET __scutin_2 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 60), '|',-1);
    SET __scutin_3 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 61), '|',-1);
    SET __scutin_4 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 62), '|',-1);
	SET __sPCL_1 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 63), '|',-1);
	SET __sPCL_2 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 64), '|',-1);
	SET __sPCL_3 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 65), '|',-1);
	SET __sPCL_4 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 66), '|',-1);
	SET __sPCL_5 = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 67), '|',-1);
    SET __smastery = SUBSTRING_INDEX(SUBSTRING_INDEX(__STR,'|', 68), '|',-1);

	UPDATE pangya_character_information 
		SET parts_1 = __sparts_1
			 ,parts_2 = __sparts_2
			 ,parts_3 = __sparts_3
			 ,parts_4 = __sparts_4
			 ,parts_5 = __sparts_5
			 ,parts_6 = __sparts_6
			 ,parts_7 = __sparts_7
			 ,parts_8 = __sparts_8
			 ,parts_9 = __sparts_9
			 ,parts_10 = __sparts_10
			 ,parts_11 = __sparts_11
			 ,parts_12 = __sparts_12
			 ,parts_13 = __sparts_13
			 ,parts_14 = __sparts_14
			 ,parts_15 = __sparts_15
			 ,parts_16 = __sparts_16
			 ,parts_17 = __sparts_17
			 ,parts_18 = __sparts_18
			 ,parts_19 = __sparts_19
			 ,parts_20 = __sparts_20
			 ,parts_21 = __sparts_21
			 ,parts_22 = __sparts_22
			 ,parts_23 = __sparts_23
			 ,parts_24 = __sparts_24
             ,default_hair = __sdefault_hair
             ,default_shirts = __sdefault_shirts
             ,gift_flag = __sgift_flag
             ,purchase = __spurchase
			 ,PCL0 = __sPCL_1
			 ,PCL1 = __sPCL_2
			 ,PCL2 = __sPCL_3
			 ,PCL3 = __sPCL_4
			 ,PCL4 = __sPCL_5
			 ,auxparts_1 = __sauxparts_1
			 ,auxparts_2 = __sauxparts_2
			 ,auxparts_3 = __sauxparts_3
			 ,auxparts_4 = __sauxparts_4
			 ,auxparts_5 = __sauxparts_5
             ,cutin_1 = __scutin_1
             ,cutin_2 = __scutin_2
             ,cutin_3 = __scutin_3
             ,cutin_4 = __scutin_4
             ,mastery = __smastery
	WHERE UID = __IDUSER AND item_id = __ITEM_ID;

	IF (SELECT CHAR_ITEMID FROM pangya.td_char_equip_s4 WHERE UID = __IDUSER AND CHAR_ITEMID = __ITEM_ID LIMIT 1) IS NULL THEN
	BEGIN
		DECLARE __COUNT INT DEFAULT 0;

		WHILE __COUNT < 24 DO
		BEGIN
			INSERT INTO pangya.td_char_equip_s4(UID, CHAR_ITEMID, IN_DATE, EQUIP_NUM, USE_YN)
			VALUES(__IDUSER, __ITEM_ID, now(), __COUNT + 1, 'Y');
			
			SET __COUNT = __COUNT + 1;
		END;
        END WHILE;
	END;
    END IF;
	
	UPDATE td_char_equip_s4 SET ITEMID = __sparts_id_1, EQUIP_TYPE = CASE WHEN __sparts_id_1 > 0 THEN __sparts_1 ELSE 0 END
	WHERE UID = __IDUSER AND EQUIP_NUM = 1 AND CHAR_ITEMID = __ITEM_ID;
	UPDATE td_char_equip_s4 SET ITEMID = __sparts_id_2, EQUIP_TYPE = CASE WHEN __sparts_id_2 > 0 THEN __sparts_2 ELSE 0 END
	WHERE UID = __IDUSER AND EQUIP_NUM = 2 AND CHAR_ITEMID = __ITEM_ID;
	UPDATE td_char_equip_s4 SET ITEMID = __sparts_id_3, EQUIP_TYPE = CASE WHEN __sparts_id_3 > 0 THEN __sparts_3 ELSE 0 END
	WHERE UID = __IDUSER AND EQUIP_NUM = 3 AND CHAR_ITEMID = __ITEM_ID;
	UPDATE td_char_equip_s4 SET ITEMID = __sparts_id_4, EQUIP_TYPE = CASE WHEN __sparts_id_4 > 0 THEN __sparts_4 ELSE 0 END
	WHERE UID = __IDUSER AND EQUIP_NUM = 4 AND CHAR_ITEMID = __ITEM_ID;
	UPDATE td_char_equip_s4 SET ITEMID = __sparts_id_5, EQUIP_TYPE = CASE WHEN __sparts_id_5 > 0 THEN __sparts_5 ELSE 0 END
	WHERE UID = __IDUSER AND EQUIP_NUM = 5 AND CHAR_ITEMID = __ITEM_ID;
	UPDATE td_char_equip_s4 SET ITEMID = __sparts_id_6, EQUIP_TYPE = CASE WHEN __sparts_id_6 > 0 THEN __sparts_6 ELSE 0 END
	WHERE UID = __IDUSER AND EQUIP_NUM = 6 AND CHAR_ITEMID = __ITEM_ID;
	UPDATE td_char_equip_s4 SET ITEMID = __sparts_id_7, EQUIP_TYPE = CASE WHEN __sparts_id_7 > 0 THEN __sparts_7 ELSE 0 END
	WHERE UID = __IDUSER AND EQUIP_NUM = 7 AND CHAR_ITEMID = __ITEM_ID;
	UPDATE td_char_equip_s4 SET ITEMID = __sparts_id_8, EQUIP_TYPE = CASE WHEN __sparts_id_8 > 0 THEN __sparts_8 ELSE 0 END
	WHERE UID = __IDUSER AND EQUIP_NUM = 8 AND CHAR_ITEMID = __ITEM_ID;
	UPDATE td_char_equip_s4 SET ITEMID = __sparts_id_9, EQUIP_TYPE = CASE WHEN __sparts_id_9 > 0 THEN __sparts_9 ELSE 0 END
	WHERE UID = __IDUSER AND EQUIP_NUM = 9 AND CHAR_ITEMID = __ITEM_ID;
	UPDATE td_char_equip_s4 SET ITEMID = __sparts_id_10, EQUIP_TYPE = CASE WHEN __sparts_id_10 > 0 THEN __sparts_10 ELSE 0 END
	WHERE UID = __IDUSER AND EQUIP_NUM = 10 AND CHAR_ITEMID = __ITEM_ID;
	UPDATE td_char_equip_s4 SET ITEMID = __sparts_id_11, EQUIP_TYPE = CASE WHEN __sparts_id_11 > 0 THEN __sparts_11 ELSE 0 END
	WHERE UID = __IDUSER AND EQUIP_NUM = 11 AND CHAR_ITEMID = __ITEM_ID;
	UPDATE td_char_equip_s4 SET ITEMID = __sparts_id_12, EQUIP_TYPE = CASE WHEN __sparts_id_12 > 0 THEN __sparts_12 ELSE 0 END
	WHERE UID = __IDUSER AND EQUIP_NUM = 12 AND CHAR_ITEMID = __ITEM_ID;
	UPDATE td_char_equip_s4 SET ITEMID = __sparts_id_13, EQUIP_TYPE = CASE WHEN __sparts_id_13 > 0 THEN __sparts_13 ELSE 0 END
	WHERE UID = __IDUSER AND EQUIP_NUM = 13 AND CHAR_ITEMID = __ITEM_ID;
	UPDATE td_char_equip_s4 SET ITEMID = __sparts_id_14, EQUIP_TYPE = CASE WHEN __sparts_id_14 > 0 THEN __sparts_14 ELSE 0 END
	WHERE UID = __IDUSER AND EQUIP_NUM = 14 AND CHAR_ITEMID = __ITEM_ID;
	UPDATE td_char_equip_s4 SET ITEMID = __sparts_id_15, EQUIP_TYPE = CASE WHEN __sparts_id_15 > 0 THEN __sparts_15 ELSE 0 END
	WHERE UID = __IDUSER AND EQUIP_NUM = 15 AND CHAR_ITEMID = __ITEM_ID;
	UPDATE td_char_equip_s4 SET ITEMID = __sparts_id_16, EQUIP_TYPE = CASE WHEN __sparts_id_16 > 0 THEN __sparts_16 ELSE 0 END
	WHERE UID = __IDUSER AND EQUIP_NUM = 16 AND CHAR_ITEMID = __ITEM_ID;
	UPDATE td_char_equip_s4 SET ITEMID = __sparts_id_17, EQUIP_TYPE = CASE WHEN __sparts_id_17 > 0 THEN __sparts_17 ELSE 0 END
	WHERE UID = __IDUSER AND EQUIP_NUM = 17 AND CHAR_ITEMID = __ITEM_ID;
	UPDATE td_char_equip_s4 SET ITEMID = __sparts_id_18, EQUIP_TYPE = CASE WHEN __sparts_id_18 > 0 THEN __sparts_18 ELSE 0 END
	WHERE UID = __IDUSER AND EQUIP_NUM = 18 AND CHAR_ITEMID = __ITEM_ID;
	UPDATE td_char_equip_s4 SET ITEMID = __sparts_id_19, EQUIP_TYPE = CASE WHEN __sparts_id_19 > 0 THEN __sparts_19 ELSE 0 END
	WHERE UID = __IDUSER AND EQUIP_NUM = 19 AND CHAR_ITEMID = __ITEM_ID;
	UPDATE td_char_equip_s4 SET ITEMID = __sparts_id_20, EQUIP_TYPE = CASE WHEN __sparts_id_20 > 0 THEN __sparts_20 ELSE 0 END
	WHERE UID = __IDUSER AND EQUIP_NUM = 20 AND CHAR_ITEMID = __ITEM_ID;
	UPDATE td_char_equip_s4 SET ITEMID = __sparts_id_21, EQUIP_TYPE = CASE WHEN __sparts_id_21 > 0 THEN __sparts_21 ELSE 0 END
	WHERE UID = __IDUSER AND EQUIP_NUM = 21 AND CHAR_ITEMID = __ITEM_ID;
	UPDATE td_char_equip_s4 SET ITEMID = __sparts_id_22, EQUIP_TYPE = CASE WHEN __sparts_id_22 > 0 THEN __sparts_22 ELSE 0 END
	WHERE UID = __IDUSER AND EQUIP_NUM = 22 AND CHAR_ITEMID = __ITEM_ID;
	UPDATE td_char_equip_s4 SET ITEMID = __sparts_id_23, EQUIP_TYPE = CASE WHEN __sparts_id_23 > 0 THEN __sparts_23 ELSE 0 END
	WHERE UID = __IDUSER AND EQUIP_NUM = 23 AND CHAR_ITEMID = __ITEM_ID;
	UPDATE td_char_equip_s4 SET ITEMID = __sparts_id_24, EQUIP_TYPE = CASE WHEN __sparts_id_24 > 0 THEN __sparts_24 ELSE 0 END
	WHERE UID = __IDUSER AND EQUIP_NUM = 24 AND CHAR_ITEMID = __ITEM_ID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_CHAR_USER_EQUIP` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_CHAR_USER_EQUIP`(
	__IDUSER int
)
BEGIN
	
	DECLARE __Skin_Temp int DEFAULT 0;

      SELECT 
         pangya_user_equip.caddie_id, 
         pangya_user_equip.character_id, 
         pangya_user_equip.club_id, 
         pangya_user_equip.ball_type, 
         pangya_user_equip.item_slot_1, 
         pangya_user_equip.item_slot_2, 
         pangya_user_equip.item_slot_3, 
         pangya_user_equip.item_slot_4, 
         pangya_user_equip.item_slot_5, 
         pangya_user_equip.item_slot_6, 
         pangya_user_equip.item_slot_7, 
         pangya_user_equip.item_slot_8, 
         pangya_user_equip.item_slot_9, 
         pangya_user_equip.item_slot_10, 
          IFNULL(
            (
               SELECT pangya_item_warehouse.item_id
               FROM pangya.pangya_item_warehouse
               WHERE pangya_item_warehouse.UID = __IDUSER AND pangya_item_warehouse.typeid = pangya_user_equip.Skin_1
			   ORDER BY EndDate DESC LIMIT 1
            ), N'0') AS skin_id_1, 
          IFNULL(
            (
               SELECT pangya_item_warehouse.item_id
               FROM pangya.pangya_item_warehouse
               WHERE pangya_item_warehouse.UID = __IDUSER AND pangya_item_warehouse.typeid = pangya_user_equip.Skin_2
			   ORDER BY EndDate DESC LIMIT 1
            ), '0') AS skin_id_2, 
          IFNULL(
            (
               SELECT pangya_item_warehouse.item_id
               FROM pangya.pangya_item_warehouse
               WHERE pangya_item_warehouse.UID = __IDUSER AND pangya_item_warehouse.typeid = pangya_user_equip.Skin_3
			   ORDER BY EndDate DESC LIMIT 1
            ), '0') AS skin_id_3, 
          IFNULL(
            (
               SELECT pangya_item_warehouse.item_id
               FROM pangya.pangya_item_warehouse
               WHERE pangya_item_warehouse.UID = __IDUSER AND pangya_item_warehouse.typeid = pangya_user_equip.Skin_4
			   ORDER BY EndDate DESC LIMIT 1
            ), '0') AS skin_id_4, 
          IFNULL(
            (
               SELECT pangya_item_warehouse.item_id
               FROM pangya.pangya_item_warehouse
               WHERE pangya_item_warehouse.UID = __IDUSER AND pangya_item_warehouse.typeid = pangya_user_equip.Skin_5
			   ORDER BY EndDate DESC LIMIT 1
            ), '0') AS skin_id_5, 
          IFNULL(
            (
               SELECT pangya_item_warehouse.item_id
               FROM pangya.pangya_item_warehouse
               WHERE pangya_item_warehouse.UID = __IDUSER AND pangya_item_warehouse.typeid = pangya_user_equip.Skin_6
			   ORDER BY EndDate DESC LIMIT 1
            ), '0') AS skin_id_6, 
         pangya_user_equip.Skin_1, 
         pangya_user_equip.Skin_2, 
         pangya_user_equip.Skin_3, 
         pangya_user_equip.Skin_4, 
         pangya_user_equip.Skin_5, 
         pangya_user_equip.Skin_6, 
         pangya_user_equip.mascot_id, 
         pangya_user_equip.poster_1, 
         pangya_user_equip.poster_2
      FROM pangya.pangya_user_equip
      WHERE pangya_user_equip.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_CreateAchievementUser` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_CreateAchievementUser`(
	__IDUSER INT
)
BEGIN

	INSERT INTO ACHIEVEMENT_TIPO(UID, NOME, TYPEID, TIPO, `OPTION`) SELECT __IDUSER, nome, typeid, tipo, `option` FROM achievements group by typeid, nome, typeid, tipo, `option`, `index` ORDER BY `index`;

	-- #INSERT INTO COUNT_ITEM(UID, NOME, TYPEID, TIPO) SELECT IDUSER, nome, typeid, 1 as tipo_ FROM counter_items;

	INSERT INTO ACHIEVEMENT_QUEST(UID, ID_ACHIEVEMENT, TYPEID_ACHIEVE, COUNT_ID, OBJETIVO_QUEST) SELECT __IDUSER, x.ID_ACHIEVEMENT, x.typeid_d, 0, x.objetivo_quest FROM
	(
		SELECT e.* FROM
			(SELECT c.*, d.* FROM
				(SELECT a.*, b.* FROM (SELECT * FROM ACHIEVEMENT_TIPO) a
				INNER JOIN
				(SELECT typeid as typeid_b, quest_typeid, `index` as index_b FROM achievements) b
				ON a.typeid = b.typeid_b) as c
			INNER JOIN
			(SELECT typeid as typeid_d, counter_typeid, counter_qntd as Objetivo_Quest FROM quest_stuffs) d
			ON c.quest_typeid = d.typeid_d) e
            WHERE e.UID = __IDUSER
	)x  ORDER BY x.index_b;
    
    INSERT INTO COUNT_ITEM(UID, NOME, ID_ACHIEVEMENT, TYPEID, TIPO) SELECT __IDUSER, K.NOME, G.ID_ACHIEVEMENT, K.TYPEID, 1 FROM
		(SELECT J.*, H.* FROM
		(SELECT __IDUSER as UID, x.ID_ACHIEVEMENT, x.typeid_d, 0 as column4, x.objetivo_quest FROM
			(
				SELECT e.* FROM
					(SELECT c.*, d.* FROM
						(SELECT a.*, b.* FROM (SELECT * FROM ACHIEVEMENT_TIPO) a
						INNER JOIN
						(SELECT typeid as typeid_b, quest_typeid, `index` as index_b FROM achievements) b
						ON a.typeid = b.typeid_b) c
					INNER JOIN
					(SELECT typeid as typeid_d, counter_typeid, counter_qntd as Objetivo_Quest FROM quest_stuffs) d
					ON c.quest_typeid = d.typeid_d) e
					WHERE e.UID = __IDUSER
			)x 
			GROUP BY x.ID_ACHIEVEMENT, x.typeid_d, x.Objetivo_Quest, x.index_b ORDER BY x.index_b LIMIT 9223372036854775807) J
		INNER JOIN
        (SELECT * FROM quest_stuffs) H
        ON J.typeid_d = H.typeid) G
        INNER JOIN
        (SELECT * FROM counter_items) K
	ON K.typeid = G.counter_typeid;
    
    UPDATE pangya.achievement_quest a
	INNER JOIN (SELECT * FROM pangya.count_item) b
	ON a.uid = __IDUSER AND a.ID_ACHIEVEMENT = b.ID_ACHIEVEMENT
		SET a.count_id = b.count_id;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_EXP_CADDIE_ATT` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_EXP_CADDIE_ATT`(
	__IDUSER int,
	__caddie_id int,
	__xp int
)
BEGIN

	DECLARE __cEXP_LVL INT DEFAULT 0;
	DECLARE __cLvl INT;
	DECLARE __exp INT;

	SET __cLvl = (SELECT cLevel FROM pangya_caddie_information WHERE UID = __IDUSER AND item_id = __caddie_id);
    
    IF __cLvl < 3 THEN
	BEGIN
		SET __exp = (SELECT Exp FROM pangya_caddie_information WHERE UID = __IDUSER AND item_id = __caddie_id) + __xp;
		
		whLoop: WHILE 1 = 1 DO
		BEGIN
			SET __cEXP_LVL = 520 + (160 * __cLvl);
			
			IF __exp >= __cEXP_LVL THEN
			BEGIN
				SET __cLvl = __cLvl + 1;
                
                IF __cLvl = 3 THEN
				BEGIN
					UPDATE pangya_caddie_information SET Exp = 0, cLevel = __cLvl
					WHERE UID = __IDUSER AND item_id = __caddie_id;
                    LEAVE whLoop;
				END;
                ELSE
				BEGIN
					SET __exp = __exp - __cEXP_LVL;
					
					UPDATE pangya_caddie_information SET Exp = __exp, cLevel = __cLvl
					WHERE UID = __IDUSER AND item_id = __caddie_id;
                END;
                END IF;
			END;
			ELSE
			BEGIN
				UPDATE pangya_caddie_information SET Exp = __exp WHERE UID = __IDUSER AND item_id = __caddie_id;
                LEAVE whLoop;
			END;
			END IF;
		END;
        END WHILE whLoop;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_EXP_MASCOT_ATT` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_EXP_MASCOT_ATT`(
	__IDUSER int,
	__mascot_id int,
	__xp int
)
BEGIN

	DECLARE __mEXP_LVL INT DEFAULT 0;
	DECLARE __mLvl INT;
	DECLARE __exp INT;

	SET __mLvl = (SELECT mLevel FROM pangya_mascot_info WHERE UID = __IDUSER AND item_id = __mascot_id);
    
    IF __mLvl < 9 THEN
	BEGIN
		SET __exp = (SELECT mExp FROM pangya_mascot_info WHERE UID = __IDUSER AND item_id = __mascot_id) + __xp;
		
		whLoop: WHILE 1 = 1 DO
		BEGIN
			SET __mEXP_LVL = 50 + (10 + (10 * __mLvl));
			
			IF __exp >= __mEXP_LVL THEN
			BEGIN
				SET __mLvl = __mLvl + 1;
                
                IF __mLvl = 9 THEN
				BEGIN
					UPDATE pangya_mascot_info SET mExp = 0, mLevel = __mLvl
					WHERE UID = __IDUSER AND item_id = __mascot_id;
                    LEAVE whLoop;
				END;
                ELSE
				BEGIN
					SET __exp = __exp - __mEXP_LVL;
					
					UPDATE pangya_mascot_info SET mExp = __exp, mLevel = __mLvl
					WHERE UID = __IDUSER AND item_id = __mascot_id;
                END;
                END IF;
			END;
			ELSE
			BEGIN
				UPDATE pangya_mascot_info SET mExp = __exp WHERE UID = __IDUSER AND item_id = __mascot_id;
                LEAVE whLoop;
			END;
            END IF;
		END;
        END WHILE whLoop;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_EXP_PLAYER_ATT` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_EXP_PLAYER_ATT`(
	__IDUSER int,
	__EXP int,
	__OPT_IN int
)
BEGIN

	-- #ATT EXP Player
	DECLARE __OPT INT DEFAULT 0;
	DECLARE __caddie_id INT;
	DECLARE __mascot_id INT;
	DECLARE __EXP_1 INT;
	DECLARE __EXP_2 INT;
    
    IF __OPT_IN = 0 THEN -- # add o EXP para o caddie e mascot tbm se for 0 a opção
	BEGIN
		-- #ATT EXP DO CADDIE TBM
		SET __caddie_id = (SELECT caddie_id FROM pangya_user_equip WHERE UID = __IDUSER);
		
		IF __caddie_id != 0 AND __caddie_id IS NOT NULL THEN
		BEGIN
			call USP_EXP_CADDIE_ATT(__IDUSER, __caddie_id, __EXP);
		END;
        END IF;
        
        SET __mascot_id = (SELECT mascot_id FROM pangya_user_equip WHERE UID = __IDUSER);
        
        IF __mascot_id != 0 AND __mascot_id IS NOT NULL THEN
		BEGIN
			call USP_EXP_MASCOT_ATT(__IDUSER, __mascot_id, __EXP);
        END;
        END IF;
    END;
    END IF;

	SET __EXP_1 = (SELECT xp FROM user_info WHERE UID = __IDUSER) + __EXP;

	whLoop: WHILE 1 = 1 DO
	BEGIN
		SET __EXP_2 = pangya.GetEXPByLevel(__IDUSER);

		IF __EXP_1 >= __EXP_2 THEN
		BEGIN
			SET __EXP_1 = __EXP_1 - __EXP_2;

			UPDATE user_info SET `level` = `level` + 1, xp = __EXP_1
			WHERE UID = __IDUSER;

			call USP_LEVEL_REWARD(__IDUSER);

			SET __OPT = 1;
		END;
		ELSE
		BEGIN
			UPDATE user_info SET xp = __EXP_1 WHERE UID = __IDUSER;
			LEAVE whLoop;
		END;
        END IF;
	END;
    END WHILE whLoop;

	SELECT __OPT as OPT;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_FLUSHCHARACTERCUTIN` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_FLUSHCHARACTERCUTIN`(
	__IDUSER int,
	__CHARACTER_ID int,
	__CUTIN_TYPEID_1 int,
	__CUTIN_TYPEID_2 int,
	__CUTIN_TYPEID_3 int,
	__CUTIN_TYPEID_4 int
)
BEGIN
	
    UPDATE pangya.pangya_character_information
         SET 
            CutIn_1 = __CUTIN_TYPEID_1,
            CutIn_2 = __CUTIN_TYPEID_2,
            CutIn_3 = __CUTIN_TYPEID_3,
            CutIn_4 = __CUTIN_TYPEID_4
      WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.item_id = __CHARACTER_ID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_FLUSH_CADDIE` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_FLUSH_CADDIE`(
	__IDUSER int,
	__IDCADDIE int
)
BEGIN
	
    UPDATE pangya.pangya_user_equip
         SET 
            caddie_id = __IDCADDIE
      WHERE pangya_user_equip.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_FLUSH_CHARACTER` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_FLUSH_CHARACTER`(
	__IDUSER int,
	__IDCHARACTER int
)
BEGIN

	UPDATE pangya.pangya_user_equip
         SET 
            character_id = __IDCHARACTER
      WHERE pangya_user_equip.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_FLUSH_CLUB` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_FLUSH_CLUB`(
	__IDUSER int,
	__IDCLUB int
)
BEGIN
	
    UPDATE pangya.pangya_user_equip
         SET 
            club_id = __IDCLUB
      WHERE pangya_user_equip.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_FLUSH_COMET` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_FLUSH_COMET`(
	__IDUSER int,
	__IDCOMET int
)
BEGIN
	
    UPDATE pangya.pangya_user_equip
         SET 
            ball_type = __IDCOMET
      WHERE pangya_user_equip.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_FLUSH_EQUIP_CADDIE` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_FLUSH_EQUIP_CADDIE`(
	__IDUSER int,
	__IDCADDIE int
)
BEGIN

	UPDATE pangya.pangya_user_equip
         SET 
            caddie_id = __IDCADDIE
      WHERE pangya_user_equip.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_FLUSH_EQUIP_CHARACTER` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_FLUSH_EQUIP_CHARACTER`(
	__IDUSER int,
	__IDCHARACTER int
)
BEGIN

	UPDATE pangya.pangya_user_equip
         SET 
            character_id = __IDCHARACTER
      WHERE pangya_user_equip.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_FLUSH_EQUIP_COMET_CLUBSET` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_FLUSH_EQUIP_COMET_CLUBSET`(
	__IDUSER int,
	__IDCOMET int,
	__IDCLUB int
)
BEGIN

	UPDATE pangya.pangya_user_equip
         SET 
            ball_type = __IDCOMET, 
            club_id = __IDCLUB
      WHERE pangya_user_equip.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_FLUSH_EQUIP_ITEM` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_FLUSH_EQUIP_ITEM`(
	__IDUSER int,
	__slot1 int,
	__slot2 int,
	__slot3 int,
	__slot4 int,
	__slot5 int,
	__slot6 int,
	__slot7 int,
	__slot8 int,
	__slot9 int,
	__slot10 int
)
BEGIN

	UPDATE pangya.pangya_user_equip
         SET 
            item_slot_1 = __slot1, 
            item_slot_2 = __slot2, 
            item_slot_3 = __slot3, 
            item_slot_4 = __slot4, 
            item_slot_5 = __slot5, 
            item_slot_6 = __slot6, 
            item_slot_7 = __slot7, 
            item_slot_8 = __slot8, 
            item_slot_9 = __slot9, 
            item_slot_10 = __slot10
      WHERE pangya_user_equip.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_FLUSH_EQUIP_MASCOT` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_FLUSH_EQUIP_MASCOT`(
	__IDUSER int,
	__IDMASCOT int
)
BEGIN

	UPDATE pangya.pangya_user_equip
         SET 
            mascot_id = __IDMASCOT
      WHERE pangya_user_equip.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_FLUSH_EQUIP_POSTER` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_FLUSH_EQUIP_POSTER`(
	__IDUSER int,
	__poster1 int,
	__poster2 int
)
BEGIN

	UPDATE pangya.pangya_user_equip
         SET 
            poster_1 = __poster1, 
            poster_2 = __poster2
      WHERE pangya_user_equip.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_FLUSH_GAMEPOINT` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_FLUSH_GAMEPOINT`(
	__IDUSER int,
	__EXPERIENCE int
)
BEGIN

	UPDATE pangya.user_info
         SET 
            xp = user_info.Xp + __EXPERIENCE
      WHERE user_info.UID = __IDUSER;

      SELECT user_info.`level`, user_info.Xp
      FROM pangya.user_info
      WHERE user_info.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_FLUSH_MASCOT` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_FLUSH_MASCOT`(
	__IDUSER int,
	__IDMASCOT int
)
BEGIN
	
    UPDATE pangya.pangya_user_equip
         SET 
            mascot_id = __IDMASCOT
      WHERE pangya_user_equip.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_FLUSH_MOEDAS` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_FLUSH_MOEDAS`(
	__IDUSER int,
	__mPang bigint,
	__mCookie bigint
)
BEGIN

	UPDATE pangya.user_info
         SET 
            Pang = __mPang, 
            Cookie = __mCookie
      WHERE user_info.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_FLUSH_SKIN` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_FLUSH_SKIN`(
	__IDUSER int,
	__iSKIN_1 int,
	__iSKIN_2 int,
	__iSKIN_3 int,
	__iSKIN_4 int,
	__iSKIN_5 int,
	__iSKIN_6 int
)
BEGIN
	
	UPDATE pangya.pangya_user_equip
         SET 
            Skin_1 = __iSKIN_1, 
            Skin_2 = __iSKIN_2, 
            Skin_3 = __iSKIN_3, 
            Skin_4 = __iSKIN_4, 
            Skin_5 = __iSKIN_5, 
            Skin_6 = __iSKIN_6
      WHERE pangya_user_equip.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_FLUSH_STAT_CHARACTER` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_FLUSH_STAT_CHARACTER`(
	__IDUSER int,
	__IDITEM int,
	__C_0 int,
	__C_1 int,
	__C_2 int,
	__C_3 int,
	__C_4 int,
	__PANG_IN bigint)
BEGIN

	UPDATE pangya.pangya_character_information
         SET 
            PCL0 = pangya_character_information.PCL0 + __C_0, 
            PCL1 = pangya_character_information.PCL1 + __C_1, 
            PCL2 = pangya_character_information.PCL2 + __C_2, 
            PCL3 = pangya_character_information.PCL3 + __C_3, 
            PCL4 = pangya_character_information.PCL4 + __C_4
      WHERE pangya_character_information.UID = __IDUSER AND pangya_character_information.item_id = __IDITEM;

      UPDATE pangya.user_info
         SET 
            pang = user_info.Pang - __PANG_IN
      WHERE user_info.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_FLUSH_STAT_CLUBSET` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_FLUSH_STAT_CLUBSET`(
	__IDUSER int,
	__IDITEM int,
	__C_0 int,
	__C_1 int,
	__C_2 int,
	__C_3 int,
	__C_4 int,
	__PANG_IN bigint
)
BEGIN

	DECLARE
         __item int DEFAULT 0;

      SELECT pangya_clubset_enchant.item_id INTO __item
      FROM pangya.pangya_clubset_enchant
      WHERE pangya_clubset_enchant.uid = __IDUSER AND pangya_clubset_enchant.item_id = __IDITEM;

      IF __item = 0 THEN

         INSERT pangya.pangya_clubset_enchant(
            pangya.pangya_clubset_enchant.uid, 
            pangya.pangya_clubset_enchant.item_id, 
            pangya.pangya_clubset_enchant.pang, 
            pangya.pangya_clubset_enchant.c0, 
            pangya.pangya_clubset_enchant.c1, 
            pangya.pangya_clubset_enchant.c2, 
            pangya.pangya_clubset_enchant.c3, 
            pangya.pangya_clubset_enchant.c4)
            VALUES (
               __IDUSER, 
               __IDITEM, 
               0, 
               0, 
               0, 
               0, 
               0, 
               0);
	END IF;

      UPDATE pangya.pangya_clubset_enchant
         SET 
            C0 = pangya_clubset_enchant.c0 + __C_0, 
            C1 = pangya_clubset_enchant.c1 + __C_1, 
            C2 = pangya_clubset_enchant.c2 + __C_2, 
            C3 = pangya_clubset_enchant.c3 + __C_3, 
            C4 = pangya_clubset_enchant.c4 + __C_4, 
            pang = pangya_clubset_enchant.pang + __PANG_IN
      WHERE pangya_clubset_enchant.uid = __IDUSER AND pangya_clubset_enchant.item_id = __IDITEM;

      UPDATE pangya.user_info
         SET 
            pang = user_info.Pang - __PANG_IN
      WHERE user_info.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_FLUSH_TIKI_POINTS` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_FLUSH_TIKI_POINTS`(
	__IDUSER int,
	__TIKI_PTS int
)
BEGIN

	UPDATE pangya.pangya_tiki_points
         SET 
            Tiki_Points = pangya_tiki_points.Tiki_Points + __TIKI_PTS, 
            MOD_DATE = ifnull(now(), now())
      WHERE pangya_tiki_points.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_ITEM_ACTIVE_ATT` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_ITEM_ACTIVE_ATT`(
	__IDUSER int,
	__ITEMTYPEID int
)
BEGIN

	IF 
         (
            SELECT pangya_user_equip.item_slot_1
            FROM pangya.pangya_user_equip
            WHERE pangya_user_equip.UID = __IDUSER AND pangya_user_equip.item_slot_1 = __ITEMTYPEID
         ) IS NOT NULL THEN
         UPDATE pangya.pangya_user_equip
            SET 
               item_slot_1 = 0
         WHERE pangya_user_equip.UID = __IDUSER;
      ELSEIF 
            (
               SELECT pangya_user_equip.item_slot_2
               FROM pangya.pangya_user_equip
               WHERE pangya_user_equip.UID = __IDUSER AND pangya_user_equip.item_slot_2 = __ITEMTYPEID
            ) IS NOT NULL THEN
            UPDATE pangya.pangya_user_equip
               SET 
                  item_slot_2 = 0
            WHERE pangya_user_equip.UID = __IDUSER;
         ELSEIF 
               (
                  SELECT pangya_user_equip.item_slot_3
                  FROM pangya.pangya_user_equip
                  WHERE pangya_user_equip.UID = __IDUSER AND pangya_user_equip.item_slot_3 = __ITEMTYPEID
               ) IS NOT NULL THEN
               UPDATE pangya.pangya_user_equip
                  SET 
                     item_slot_3 = 0
               WHERE pangya_user_equip.UID = __IDUSER;
            ELSEIF 
                  (
                     SELECT pangya_user_equip.item_slot_4
                     FROM pangya.pangya_user_equip
                     WHERE pangya_user_equip.UID = __IDUSER AND pangya_user_equip.item_slot_4 = __ITEMTYPEID
                  ) IS NOT NULL THEN
                  UPDATE pangya.pangya_user_equip
                     SET 
                        item_slot_4 = 0
                  WHERE pangya_user_equip.UID = __IDUSER;
               ELSEIF 
                     (
                        SELECT pangya_user_equip.item_slot_5
                        FROM pangya.pangya_user_equip
                        WHERE pangya_user_equip.UID = __IDUSER AND pangya_user_equip.item_slot_5 = __ITEMTYPEID
                     ) IS NOT NULL THEN
                     UPDATE pangya.pangya_user_equip
                        SET 
                           item_slot_5 = 0
                     WHERE pangya_user_equip.UID = __IDUSER;
                  ELSEIF 
                        (
                           SELECT pangya_user_equip.item_slot_6
                           FROM pangya.pangya_user_equip
                           WHERE pangya_user_equip.UID = __IDUSER AND pangya_user_equip.item_slot_6 = __ITEMTYPEID
                        ) IS NOT NULL THEN
                        UPDATE pangya.pangya_user_equip
                           SET 
                              item_slot_6 = 0
                        WHERE pangya_user_equip.UID = __IDUSER;
                     ELSEIF 
                           (
                              SELECT pangya_user_equip.item_slot_7
                              FROM pangya.pangya_user_equip
                              WHERE pangya_user_equip.UID = __IDUSER AND pangya_user_equip.item_slot_7 = __ITEMTYPEID
                           ) IS NOT NULL THEN
                           UPDATE pangya.pangya_user_equip
                              SET 
                                 item_slot_7 = 0
                           WHERE pangya_user_equip.UID = __IDUSER;
                        ELSEIF 
                              (
                                 SELECT pangya_user_equip.item_slot_8
                                 FROM pangya.pangya_user_equip
                                 WHERE pangya_user_equip.UID = __IDUSER AND pangya_user_equip.item_slot_8 = __ITEMTYPEID
                              ) IS NOT NULL THEN
                              UPDATE pangya.pangya_user_equip
                                 SET 
                                    item_slot_8 = 0
                              WHERE pangya_user_equip.UID = __IDUSER;
                           ELSEIF 
                                 (
                                    SELECT pangya_user_equip.item_slot_9
                                    FROM pangya.pangya_user_equip
                                    WHERE pangya_user_equip.UID = __IDUSER AND pangya_user_equip.item_slot_9 = __ITEMTYPEID
                                 ) IS NOT NULL THEN
                                 UPDATE pangya.pangya_user_equip
                                    SET 
                                       item_slot_9 = 0
                                 WHERE pangya_user_equip.UID = __IDUSER;
                              ELSE 
                                 BEGIN
                                    IF 
                                       (
                                          SELECT pangya_user_equip.item_slot_10
                                          FROM pangya.pangya_user_equip
                                          WHERE pangya_user_equip.UID = __IDUSER AND pangya_user_equip.item_slot_10 = __ITEMTYPEID
                                       ) IS NOT NULL THEN
                                       UPDATE pangya.pangya_user_equip
                                          SET 
                                             item_slot_10 = 0
                                       WHERE pangya_user_equip.UID = __IDUSER;
									END IF;
                                 END;
                                 END IF;

      SELECT pangya_item_warehouse.item_id
      FROM pangya.pangya_item_warehouse
      WHERE pangya_item_warehouse.UID = __IDUSER AND pangya_item_warehouse.typeid = __ITEMTYPEID;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_LEVEL_REWARD` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_LEVEL_REWARD`(
	__IDUSER iNT
)
BEGIN

	-- #Level Reward Player, SEND; Prize For Mail
	DECLARE __EXP INT DEFAULT 0;
	DECLARE __MSGID INT DEFAULT 0;
	DECLARE __LVL INT;
	
	SET __LVL = (SELECT `level` FROM user_info WHERE UID = __IDUSER);

	IF __LVL != 0 THEN
	BEGIN
		INSERT INTO pangya_gift_table(UID, FROMID, MESSAGE, GIFTDATE, LIDA_YN, VALID)
				VALUES(__IDUSER, '@SUPER', 'Rewards Level Up', now(), 0, 1);

		SELECT MAX(MSG_ID) INTO __MSGID FROM pangya_gift_table;

		IF __LVL = 1 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 402653192, 0, 10, 0);
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 402653191, 0, 10, 0);
		END;
		ELSEIF __LVL = 2 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 402653189, 0, 10, 0);
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 402653188, 0, 5, 0);
		END;
		ELSEIF __LVL = 3 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 436207633, 0, 60, 0);
		END;
		ELSEIF __LVL = 4 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 402653188, 0, 10, 0);
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 436207633, 0, 50, 0);
		END;
		ELSEIF __LVL = 5 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A00000F, 0, 5, 0);
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 436207633, 0, 50, 0);
		END;
		ELSEIF __LVL = 6 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A000010, 0, 10000, 0);
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 436207656, 0, 5, 0);
		END;
		ELSEIF __LVL = 7 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 402653200, 0, 5, 0);
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 402653190, 0, 5, 0);
		END;
		ELSEIF __LVL = 8 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 402653202, 0, 5, 0);
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 402653198, 0, 5, 0);
		END;
		ELSEIF __LVL = 9 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 402653201, 0, 5, 0);
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 402653223, 0, 5, 0);
		END;
		ELSEIF __LVL = 10 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 436207618, 0, 20, 0);
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 402653224, 0, 5, 0);
		END;
		ELSEIF __LVL = 11 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A000010, 0, 30000, 0);
		END;
		ELSEIF __LVL = 12 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 436207667, 0, 1, 0);
		END;
		ELSEIF __LVL = 13 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 1073741827, 1, 1, 1);
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 335544321, 0, 18, 0);
		END;
		ELSEIF __LVL = 14 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 1073741826, 1, 1, 1);
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 335544322, 0, 36, 0);
		END;
		ELSEIF __LVL = 15 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 1073741825, 1, 1, 1);
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 436207877, 0, 1, 0);
		END;
		ELSEIF __LVL = 16 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A000010, 0, 50000, 0);
		END;
		ELSEIF __LVL = 17 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 2092957699, 0, 3, 0);
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 436207680, 0, 50, 0);
		END;
		ELSEIF __LVL = 18 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 2092957698, 0, 2, 0);
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 436207680, 0, 50, 0);
		END;
		ELSEIF __LVL = 19 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 2092957697, 0, 1, 0);
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 436207680, 0, 50, 0);
		END;
		ELSEIF __LVL = 20 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 2092957696, 0, 1, 0);
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 2092957700, 0, 1, 0);
		END;
		ELSEIF __LVL = 21 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A000010, 0, 70000, 0);
		END;
		ELSEIF __LVL = 22 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 436207710, 0, 1, 0);
		END;
		ELSEIF __LVL = 23 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 436207709, 0, 1, 0);
		END;
		ELSEIF __LVL = 24 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 436207708, 0, 1, 0);
		END;
		ELSEIF __LVL = 25 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 436207707, 0, 1, 0);
		END;
		ELSEIF __LVL = 26 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A000010, 0, 90000, 0);
		END;
		ELSEIF __LVL = 27 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A0000F7, 0, 1, 0);
		END;
		ELSEIF __LVL = 28 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A0000F7, 0, 1, 0);
		END;
		ELSEIF __LVL = 29 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A0000F7, 0, 1, 0);
		END;
		ELSEIF __LVL = 30 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A0000F7, 0, 1, 0);
		END;
		ELSEIF __LVL = 31 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A000010, 0, 110000, 0);
		END;
		ELSEIF __LVL = 32 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 2092957699, 0, 4, 0);
		END;
		ELSEIF __LVL = 33 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 2092957698, 0, 3, 0);
		END;
		ELSEIF __LVL = 34 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 2092957697, 0, 2, 0);
		END;
		ELSEIF __LVL = 35 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A0000F7, 0, 2, 0);
		END;
		ELSEIF __LVL = 36 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A000010, 0, 130000, 0);
		END;
		ELSEIF __LVL = 37 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 1073741826, 1, 1, 3);
		END;
		ELSEIF __LVL = 38 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 2092957698, 0, 5, 0);
		END;
		ELSEIF __LVL = 39 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A0000F7, 0, 2, 0);
		END;
		ELSEIF __LVL = 40 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 1073741825, 1, 1, 3);
		END;
		ELSEIF __LVL = 41 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A000010, 0, 150000, 0);
		END;
		ELSEIF __LVL = 42 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 1073741826, 1, 1, 5);
		END;
		ELSEIF __LVL = 43 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 2092957697, 0, 3, 0);
		END;
		ELSEIF __LVL = 44 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A0000F7, 0, 2, 0);
		END;
		ELSEIF __LVL = 45 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 1073741825, 1, 1, 5);
		END;
		ELSEIF __LVL = 46 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A000010, 0, 170000, 0);
		END;
		ELSEIF __LVL = 47 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 436207667, 0, 3, 0);
		END;
		ELSEIF __LVL = 48 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 436207667, 0, 5, 0);
		END;
		ELSEIF __LVL = 49 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 436207667, 0, 7, 0);
		END;
		ELSEIF __LVL = 50 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 436207667, 0, 10, 0);
		END;
		ELSEIF __LVL = 51 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A000010, 0, 190000, 0);
		END;
		ELSEIF __LVL = 52 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A0000F7, 0, 2, 0);
		END;
		ELSEIF __LVL = 53 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A0000F7, 0, 3, 0);
		END;
		ELSEIF __LVL = 54 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A0000F7, 0, 4, 0);
		END;
		ELSEIF __LVL = 55 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 1073741826, 1, 1, 7);
		END;
		ELSEIF __LVL = 56 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A000010, 0, 210000, 0);
		END;
		ELSEIF __LVL = 57 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 436207667, 0, 5, 0);
		END;
		ELSEIF __LVL = 58 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 436207667, 0, 10, 0);
		END;
		ELSEIF __LVL = 59 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 436207667, 0, 15, 0);
		END;
		ELSEIF __LVL = 60 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 1073741825, 1, 1, 15);
		END;
		ELSEIF __LVL = 61 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A000010, 0, 230000, 0);
		END;
		ELSEIF __LVL = 62 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A000010, 0, 250000, 0);
		END;
		ELSEIF __LVL = 63 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A000010, 0, 300000, 0);
		END;
		ELSEIF __LVL = 64 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A000010, 0, 350000, 0);
		END;
		ELSEIF __LVL = 65 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A000010, 0, 400000, 0);
		END;
		ELSEIF __LVL = 66 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A000010, 0, 6000000, 0);
		END;
		ELSEIF __LVL = 67 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A000010, 0, 700000, 0);
		END;
		ELSEIF __LVL = 68 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A000010, 0, 800000, 0);
		END;
		ELSEIF __LVL = 69 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A000010, 0, 900000, 0);
		END;
		ELSEIF __LVL = 70 THEN
		BEGIN
			call pangya.ProcInsertItemNoEmail(0, __IDUSER, __MSGID, -1, 0x1A000010, 0, 1000000, 0);
		END;
        END IF;
	END;
    END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_SAVE_MACROS` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_SAVE_MACROS`(
	__IDUSER int,
	__Macro_1 nvarchar(64),
	__Macro_2 nvarchar(64),
	__Macro_3 nvarchar(64),
	__Macro_4 nvarchar(64),
	__Macro_5 nvarchar(64),
	__Macro_6 nvarchar(64),
	__Macro_7 nvarchar(64),
	__Macro_8 nvarchar(64),
	__Macro_9 nvarchar(64),
	__Macro_10 nvarchar(64)
)
BEGIN

	UPDATE pangya.pangya_user_macro
         SET 
            Macro1 = 
               CASE 
                  WHEN __Macro_1 IS NOT NULL THEN __Macro_1
                  ELSE 'Pangya!'
               END, 
            Macro2 = 
               CASE 
                  WHEN __Macro_2 IS NOT NULL THEN __Macro_2
                  ELSE 'Pangya!'
               END, 
            Macro3 = 
               CASE 
                  WHEN __Macro_3 IS NOT NULL THEN __Macro_3
                  ELSE 'Pangya!'
               END, 
            Macro4 = 
               CASE 
                  WHEN __Macro_4 IS NOT NULL THEN __Macro_4
                  ELSE 'Pangya!'
               END, 
            Macro5 = 
               CASE 
                  WHEN __Macro_5 IS NOT NULL THEN __Macro_5
                  ELSE 'Pangya!'
               END, 
            Macro6 = 
               CASE 
                  WHEN __Macro_6 IS NOT NULL THEN __Macro_6
                  ELSE 'Pangya!'
               END, 
            Macro7 = 
               CASE 
                  WHEN __Macro_7 IS NOT NULL THEN __Macro_7
                  ELSE 'Pangya!'
               END, 
            Macro8 = 
               CASE 
                  WHEN __Macro_8 IS NOT NULL THEN __Macro_8
                  ELSE 'Pangya!'
               END, 
            Macro9 = 
               CASE 
                  WHEN __Macro_9 IS NOT NULL THEN __Macro_9
                  ELSE 'Pangya!'
               END, 
            Macro10 = 
               CASE 
                  WHEN __Macro_10 IS NOT NULL THEN __Macro_10
                  ELSE 'Pangya!'
               END
      WHERE pangya_user_macro.UID = __IDUSER;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_SAVE_ROOM` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_SAVE_ROOM`(
	__IDUSER int,
	__IDITEM int,
	__IDTYPE int,
	__NO_ROOM int,
	__X float(24),
	__Y float(24),
	__Z float(24),
	__R float(24),
	__YN_USE smallint
)
BEGIN

	DECLARE __Contador int;
	DECLARE __Contador2 int;

      SELECT count(*) INTO __Contador
      FROM pangya.td_room_data
      WHERE td_room_data.UID = __IDUSER AND td_room_data.MYROOM_ID = __IDITEM;

      SELECT count(*) INTO __Contador2
      FROM pangya.td_room_data;

      IF __Contador > 0 THEN
         UPDATE pangya.td_room_data
            SET 
               ROOM_NO = __NO_ROOM, 
               POS_X = __X, 
               POS_Y = __Y, 
               POS_Z = __Z, 
               POS_R = __R, 
               DISPLAY_YN = 
                  CASE 
                     WHEN __YN_USE = 1 THEN 'Y'
                     ELSE 'N'
                  END
         WHERE td_room_data.UID = __IDUSER AND td_room_data.MYROOM_ID = __IDITEM;
      ELSEIF __IDITEM IS NULL OR __IDITEM = 0 THEN
            BEGIN
               INSERT pangya.td_room_data(
                  pangya.td_room_data.UID, 
                  pangya.td_room_data.ROOM_NO, 
                  pangya.td_room_data.TYPEID, 
                  pangya.td_room_data.POS_X, 
                  pangya.td_room_data.POS_Y, 
                  pangya.td_room_data.POS_Z, 
                  pangya.td_room_data.POS_R, 
                  pangya.td_room_data.MOD_SEQ, 
                  pangya.td_room_data.DISPLAY_YN, 
                  pangya.td_room_data.MOD_DT)
                  VALUES (
                     __IDUSER, 
                     __NO_ROOM, 
                     __IDTYPE, 
                     __X, 
                     __Y, 
                     __Z, 
                     __R, 
                     __Contador2 + 1, 
                     'Y', 
                     now());
            END;
         ELSE 
            BEGIN

               INSERT pangya.td_room_data(
                  pangya.td_room_data.UID, 
                  pangya.td_room_data.ROOM_NO, 
                  pangya.td_room_data.TYPEID, 
                  pangya.td_room_data.MYROOM_ID, 
                  pangya.td_room_data.POS_X, 
                  pangya.td_room_data.POS_Y, 
                  pangya.td_room_data.POS_Z, 
                  pangya.td_room_data.POS_R, 
                  pangya.td_room_data.MOD_SEQ, 
                  pangya.td_room_data.DISPLAY_YN, 
                  pangya.td_room_data.MOD_DT)
                  VALUES (
                     __IDUSER, 
                     __NO_ROOM, 
                     __IDTYPE, 
                     __IDITEM, 
                     __X, 
                     __Y, 
                     __Z, 
                     __R, 
                     __Contador2 + 1, 
                     'Y', 
                     now());

            END;
            END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `USP_UPDATE_GUILD_RANKING` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `USP_UPDATE_GUILD_RANKING`()
BEGIN
	
    DECLARE GUID INT;
	DECLARE _RANK INT DEFAULT 1;
    DECLARE FINISHED INT DEFAULT TRUE;

	DECLARE tmp CURSOR FOR
		SELECT 
			GUILD_UID 
		FROM pangya.pangya_guild
		WHERE GUILD_POINT <> 0 AND GUILD_PANG <> 0 AND (GUILD_WIN <> 0 OR GUILD_LOSE <> 0 OR GUILD_DRAW <> 0)
			AND (GUILD_STATE NOT IN(4, 5) OR GUILD_CLOSURE_DATE IS NULL OR now() < GUILD_CLOSURE_DATE)
		ORDER BY GUILD_WIN DESC, GUILD_LOSE, GUILD_DRAW, GUILD_POINT DESC, GUILD_PANG DESC;
        
	DECLARE CONTINUE HANDLER FOR NOT FOUND SET FINISHED = FALSE;

	OPEN tmp;
    
	FETCH FROM tmp INTO GUID;
	WHILE FINISHED DO

		IF (SELECT GUILD_UID FROM pangya.pangya_guild_ranking WHERE GUILD_UID = GUID) IS NOT NULL THEN
		BEGIN
		
			-- Já tem a Guild no Rank Atualiza
			UPDATE pangya.pangya_guild_ranking
				SET LAST_RANK = `RANK`,
					`RANK` = _RANK,
					REG_DATE = now()
			WHERE GUILD_UID = GUID;

		END;
		ELSE
		BEGIN

			-- Não tem a Guild no Rank Adiciona
			INSERT INTO pangya.pangya_guild_ranking(GUILD_UID, `RANK`, LAST_RANK, REG_DATE)
			VALUES(GUID, _RANK, -1/*LAST RANK*/, now());
		END;
        END IF;

		-- SOMA RANK + 1
		SET _RANK = _RANK + 1;

		-- FETCH NEXT
		FETCH FROM tmp INTO GUID;
	END WHILE;

	CLOSE tmp;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `VerificaCouponDesconto` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `VerificaCouponDesconto`(
	__IDUSER int,
	__ITEMID int
)
BEGIN

	DECLARE
         __TIPOID int DEFAULT 0;

      SELECT pangya_item_warehouse.typeid INTO __TIPOID
      FROM pangya.pangya_item_warehouse
      WHERE pangya_item_warehouse.UID = __IDUSER AND pangya_item_warehouse.item_id = __ITEMID;

      SET __TIPOID = 
         CASE 
            WHEN 
               (
                  SELECT pangya_coupon_desconto.typeid
                  FROM pangya.pangya_coupon_desconto
                  WHERE pangya_coupon_desconto.typeid = __TIPOID
               ) IS NULL THEN 0
            ELSE __TIPOID
         END;

      IF __TIPOID = 0 THEN
         SELECT __TIPOID AS valor;
      ELSE 
         IF __TIPOID = 436207676 THEN
            SELECT 1 AS valor;
         ELSE 
            SELECT pangya_coupon_desconto.valor
            FROM pangya.pangya_coupon_desconto
            WHERE pangya_coupon_desconto.typeid = __TIPOID;
		END IF;
	END IF;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!50003 DROP PROCEDURE IF EXISTS `VerificaWareHouseItemTime$IMPL` */;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;
/*!50003 SET @saved_cs_client      = @@character_set_client */ ;
/*!50003 SET @saved_cs_results     = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client  = utf8mb4 */ ;
/*!50003 SET character_set_results = utf8mb4 */ ;
/*!50003 SET collation_connection  = utf8mb4_unicode_ci */ ;
/*!50003 SET @saved_sql_mode       = @@sql_mode */ ;
/*!50003 SET sql_mode              = 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION' */ ;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `VerificaWareHouseItemTime$IMPL`(
	__IDUSER int,
	OUT __returnvalue int
)
BEGIN

	SET __returnvalue = NULL;

      UPDATE pangya.pangya_item_warehouse
         SET 
            valid = 0
      WHERE 
         pangya_item_warehouse.UID = __IDUSER AND 
         pangya_item_warehouse.flag <> 96 AND 
         pangya_item_warehouse.Applytime <> pangya_item_warehouse.EndDate AND 
         timestampdiff(second, now(), pangya_item_warehouse.EndDate) <= 0;

      SET __returnvalue = 1;
END ;;
DELIMITER ;
/*!50003 SET sql_mode              = @saved_sql_mode */ ;
/*!50003 SET character_set_client  = @saved_cs_client */ ;
/*!50003 SET character_set_results = @saved_cs_results */ ;
/*!50003 SET collation_connection  = @saved_col_connection */ ;
ALTER DATABASE `pangya` CHARACTER SET utf8mb4 COLLATE utf8mb4_bin ;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2022-03-20 18:00:27
